Initialization time: 2025-06-18 09:32:47

**************************************************  Experiment 65 | Version 1 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 3, 1.0: 13}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 2}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 3, 1.0: 13}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 4, 1.0: 12}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 1, 1.0: 1}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 1, 1.0: 1}

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Currently logged in as: maria-i-paiva (maria-i-paiva-inesc-tec) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: WARNING Using a boolean value for 'reinit' is deprecated. Use 'return_previous' or 'finish_previous' instead.
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_1/wandb/run-20250618_093502-r0lgsrry
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_1_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/r0lgsrry
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ██▁▄█▁▁█████████████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▅█▇█▅▆▆▆▃▅▅▃▅▅▁▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▃▅▅▅▅▇▅▅▅
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁███▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▇▁█▂█▁▁██▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▇▇█▇▅▆▃█▄▃▄▃▅▂▆▃▁▅▄▂▁▄▃▅▃▃▄▄▁▁▄▅▄▄▂▄▄▇▅▄
wandb:                 train_loss ▄▄█▁█▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▂▇███▁██████████████████████████████████
wandb:           val_accuracy0.75 █▇▇▁▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:                  val_auroc ▆▆▇▆▇▂▆█▁▁▁▁▄▅▇▇▅▅▆▆▅▆▇▆▆▆▆▆▆▅▆▆▆▆▆▇▆▆▆▆
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▃▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁█▇▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁█▄▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁█▅▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.5
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.55384
wandb:                 train_loss 2.09419
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.49367
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_1_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/r0lgsrry
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_1/wandb/run-20250618_093502-r0lgsrry/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_1/wandb/run-20250618_094237-daoggykc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_1_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/daoggykc
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 █▁▁▁▁▁▁█████████████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▃▃▅▅▄▁▁▅▅▅▅▁▂▃▄▇▆▅▆▅▄▂▄▅▅▅▆▅▇▆▅▅▅▅▅█▅▄▅
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁██▁████▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁██
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁███████████████████████████████████████
wandb:             test_recall0.5 █▁▁█▁███████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁████
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▇▄▃▃▄▅▆▃▄▅▇▂▃▃▂▄▆▄▄▄▆▇▅▇▆▃▂▆▆▁▇▆▄▁█▇▄█▅▆
wandb:                 train_loss ▇▆▁▅█▅▄▄▅▅▄▆▅▅▆▄▅▃▅▅▅▅▅▃▆▃▄▅▄▄▄▅▅▅▅▅▅▅▅▅
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁█▁▁▁██▁▁█▁███████████████████████████▁▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▃▆▇▇██▄▇▂▁▄▆▅▅▄▄▅▅▄▄▄▄▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 █▁██████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█████
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 █▁█▁▁████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁████
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.25316
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.51695
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.25316
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 1
wandb:            test_recall0.75 0
wandb:                train_auroc 0.44485
wandb:                 train_loss 2.09482
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.24762
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.50633
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.24762
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 1
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_1_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/daoggykc
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_1/wandb/run-20250618_094237-daoggykc/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_1/wandb/run-20250618_095926-6iswbt2k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_1_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/6iswbt2k
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 █▁▁███▁███▁█▁▁▁████▁███▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc █▆▄▅▄▄▄▃▅▄▅▄▅▅▅▁▂▃▄▅▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 █████▁▁█▁█▁████▁▁▁▁▁▁▁▁▁▁███████████████
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁██▁██▁▁██▁███▁▁▁▁▁▁▁▁▁▁▁██▁▁██████████
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▅█▅▄▄▄▄▁▅▅▅▃▇▃▄▂▆▄▂▆▄▄▄▅▅▆▄▂▄▅▄▃▄▂▅▆█▃▃▃
wandb:                 train_loss █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 █▁█▁██▁▁▁▁██████▁███▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ██▂▁▄▇█▇▄▅█▇▇▇▇▇▇▆▆▃▃▅▄▃▃▃▃▃▃▃▃▃▃▃▃▃▄▄▃▃
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 █▄▄▁▄▁▁▁▄▄▁▁▄▄▄▁▁▁▁▄▁▁▄▄▄▄▁▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁█▁█▁▁▁█▁█▁▁▁▁▁▁▁▁▁▁▁██████████████████
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.25316
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.5
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.25316
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 1
wandb:            test_recall0.75 0
wandb:                train_auroc 0.48528
wandb:                 train_loss 2.09282
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.24762
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.5
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.24762
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 1
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_1_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/6iswbt2k
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_1/wandb/run-20250618_095926-6iswbt2k/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_1/execution_datetimes.json

**************************************************  Experiment 65 | Version 2 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 10, 1.0: 22}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 10, 1.0: 22}
    Batch label distribution: {0.0: 11, 1.0: 7}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 20, 1.0: 12}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 5, 1.0: 13}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 8, 1.0: 10}

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_2/wandb/run-20250618_100717-8vdg6ss8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_2_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/8vdg6ss8
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 195-199, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ████▁███▁▁█▁████████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▇▁▆▅▆▅▅▅▆▆▆▅▆▆▅▇▃▅▅▅▃▆▄▆▅▇▅▅▅▆▆██▇▄▅▅▆▇▇
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▇▇▇▇▇▁▁▁▇█▁▇▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▇▁
wandb:         test_precision0.75 ▁▁▁▅▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁██▁█▁▁███▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▅█▃▄▅▇█▆▁▄▄▄▄▅▄▃▃▂▄▃▃▂▃▄▂▅▄▄▅▅▅▃▅▆▃▄▃▄▁▃
wandb:                 train_loss █▃▄▂▂▂▂▄▃▁▄▂▂▂▂▂▂▂▂▂▂▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁███▁█▁████████████████████████████████
wandb:           val_accuracy0.75 ███████████▁████████████████████████████
wandb:                  val_auroc ▆▄▄▃▇▅▅▅▅▅▃▆▃▄▁▁▃▄▅▄▅▅▆▆▇▃▄▆▅▆▅█▇▇▄▃▄▄▅▄
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▅▅▁▅▅▅▅▅▅▅▅▅▅▅▅█▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 █▁▁▁█▁▁█▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ██▁███▁██▁▆▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█
wandb:             val_recall0.75 ▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.57627
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.39674
wandb:                 train_loss 2.09366
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.57449
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_2_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/8vdg6ss8
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_2/wandb/run-20250618_100717-8vdg6ss8/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_2/wandb/run-20250618_101746-ojdj4cse
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_2_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/ojdj4cse
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁▁▁▁▁█▁▁▁█▁▁▁▁███████████████████▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▃▃▄▂▂▇█▇▅▆▄▆▅▂▃▁▂▂▂▂▂▂▂▂▂▃▁▁▂▂▁▃▃▃▃▆▆▅▅▃
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 █▁██▁██▁██▁▁███▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁███
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ███▁█████▁██▁████████▁█▁▁▁▁▁▁▁▁▁▁▁▁████▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▂▃▂▃▆▂▅▃▂▅▃▄▇█▅▃▃▄▅▃▃▄▃▅▄▃▄▄▄▃▄▁▅▃▆▃▃▂▅▃
wandb:                 train_loss █▃▂▂▃▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁▁█▁▁▁█▁▁█▁▁█▁▁▁█▁▁████████████████▁▁▁▁
wandb:           val_accuracy0.75 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▄███▆▇█▆▄▃▃▆▆▇▆▆▅▅▅▅▆▆▅▆▄▄▄▄▄▄▅▁▆▅▅▅▃▅▂▄
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ███████▁█████▁▁██████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁██▁█
wandb:          val_precision0.75 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ██▁█████▁█▁██████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁███▁█
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.25316
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.48051
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.25316
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 1
wandb:            test_recall0.75 0
wandb:                train_auroc 0.42818
wandb:                 train_loss 2.0935
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.24762
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.53554
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.24762
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 1
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_2_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/ojdj4cse
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_2/wandb/run-20250618_101746-ojdj4cse/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_2/wandb/run-20250618_102610-ae9b9g25
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_2_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/ae9b9g25
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 █▁███▁███▁█▁███▁▁▁▁▁█▁████████▁▁▁▁██▁▁▁▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▆▆▆▇▆▅▆▆▆▅▅▆▆▆▆▄▅▄▆▃▃▇▇▆▄▅▅▅▅▅▄▅▃▂▁▄█▅▅▅
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▃▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁███████████████████████████████████████
wandb:          test_precision0.5 ▁▁▇▇▇▁▁▁▁▁▇▇▇▇█▁▁▁▁▁▁▁▁▁▁▇▇▇▇▇▇▇▇▁▁▁▁▁▇▇
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 █▁▁▁█████▁▁█████▁▁█▁▁▁█▁▁▁▁▁▁▁████▁▁▁███
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▅▁▄▄█▆▄▄▅▆▄▃▄▄▄▃▄█▃█▄▅▄▆▅▂▄▂▃▅▃▃▅▄▃▃█▇▆▅
wandb:                 train_loss ███▇█▇▇▇█▇▇▇▇█▇▇▅▁▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 █▁▁▁█▁█▁▁█▁▁▁███▁▁▁███████▁▁▁▁▁▁▁▁▁██▁█▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ██▇▇▄█▇▇█▇████▇▁▃▃▄▆▂▆██▆▅▅▅▃▄▄▄▄▄▂▅▄▄▄▃
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▇▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄█▁▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▃▁▃▃▁▃▃▁▃▃▃▃▁▁▁▃▃▃▁▁▃█▁▁▁▁▃▃▃▃▃▃▃▃▁▁▁▁▃▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ██▁█▁█▁▁▁▁▁██▁▁▁▁▁▁▁▁██████▁▁▁▁▁▁▁███▁▁█
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.25316
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.5
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.25316
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 1
wandb:            test_recall0.75 0
wandb:                train_auroc 0.4902
wandb:                 train_loss 2.09345
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.24762
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.5
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.24762
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 1
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_2_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/ae9b9g25
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_2/wandb/run-20250618_102610-ae9b9g25/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_2/execution_datetimes.json

**************************************************  Experiment 65 | Version 3 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 34, 1.0: 30}
    Batch label distribution: {0.0: 28, 1.0: 36}
    Batch label distribution: {0.0: 28, 1.0: 36}
    Batch label distribution: {0.0: 10, 1.0: 8}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 36, 1.0: 28}
    Batch label distribution: {0.0: 30, 1.0: 34}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 8, 1.0: 10}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 36, 1.0: 28}
    Batch label distribution: {0.0: 32, 1.0: 32}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 8, 1.0: 10}

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_3/wandb/run-20250618_104231-9lt4bubi
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_3_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/9lt4bubi
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁██▂▃███████████████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▅▅▆▆▅▆▆▅▅▃▄▃▆▅▆▆▄▆▅▆▅▄▃▆▆▂▁▅▅▅▄▄▄▅▅█▇▇██
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁█▇█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁█▁▇▁▁▁▅▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▄▄▃▄█▆▇▆▄▄▅▂▃▂▄▁▂▄▂▂▃▃▁▃▂▃▃▃▃▂▄▂▂▂▂▃▃▂▄▃
wandb:                 train_loss █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁█▂██▅▆▇████████████████████████████████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▄▅▄▄▄▄▅▄▅▅▄▄▅▆▆▄▁▂▂▂▂▂▃▂▁▃▄█▃▂▃▄▆▄▄▄▄▄▄▄
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ████▆█▁█████████████████████████████████
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▆▁▆▆▁▆▆█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁█▁▇▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.52712
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.54365
wandb:                 train_loss 2.09263
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.49197
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_3_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/9lt4bubi
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_3/wandb/run-20250618_104231-9lt4bubi/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_3/wandb/run-20250618_105128-1a00a88w
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_3_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/1a00a88w
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁█▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁██▁▁▁▁▁███▁▁█▁████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▆▃▂▂▁▃▁▅█▅▆▁▂▄▃▅▃▂▁▂▂▁▁▁▅▁▁▂▄▂▂▃▂▆▆▃▄▁▃▃
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ███████████████████████████▁████████████
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 █████████████████▁█▁█████▁▁▁▁▇█▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 █▁██████████▁█▁▁▁█████▁▁▁█▇▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▄▄▇▃▄▅▄▅▃▆▄▃▃▁▆▆▄▃▄▂▂▆▆▅▄▆▆█▄▅▃▇▅▅▆▆▅▅█▇
wandb:                 train_loss █▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁███▁▁██▁▁▁▁▁███▁█████████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▂▄▇▇█▄▃▃▆▆▅▅▅▃▄█▇▇▇▇▇▇█▄▆▆█▇▇▇▇▁██▃▃▄▄▄▄
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▆▆█▁▆▆▁▆▆▆▆▆▆▆▆▆▆▁▁▁▆▆▁▆▆▆▁▁▁▆▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ██▁███████▁█▁▁▇████████▁▁▁▁▁███▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.5
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.42054
wandb:                 train_loss 2.09553
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.5
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_3_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/1a00a88w
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_3/wandb/run-20250618_105128-1a00a88w/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_3/wandb/run-20250618_111150-i3gof3jr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_3_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/i3gof3jr
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ███▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁███████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ███▁████████████████████████████████████
wandb:                 test_auroc ▄▄▅▄█▅▄▄▆▇▅▅▁▂▄▄▃▃▃▄▅▃▃▅▅▅▅▅▅▅▅▆▅▅▆▅▅▅▆▁
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁█▁▁▁█████████████▁▁▁▁██████████████████
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 █▁▁▁▁███████████▁▁▁█████████████████████
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▄▅▄▆▅▅▇▇▄▆▇▄▃▆▄▅▄▆▃▅▅▆▆▁▅▂▂▂▇▇▅█▄▃▅▅▆▇▃▄
wandb:                 train_loss ▃█▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ██▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▃▁▇▇▇▇▇█▆▅▆▆▃▄▅▅▅▅▅▅▅▆▆▅▆▂▆▆▆▆▆▆▆▆▆▆▆▆▇▇
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁█████████████▁▁▁███████████████████
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ██▁███████████████▁▁████████████████████
wandb:             val_recall0.75 ▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.25316
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.47203
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.25316
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 1
wandb:            test_recall0.75 0
wandb:                train_auroc 0.5519
wandb:                 train_loss 2.09313
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.24762
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.47249
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.24762
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 1
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_3_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/i3gof3jr
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_3/wandb/run-20250618_111150-i3gof3jr/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_3/execution_datetimes.json

**************************************************  Experiment 65 | Version 4 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 3, 1.0: 13}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 4, 1.0: 12}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 1, 1.0: 1}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 2}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 1, 1.0: 1}

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_4/wandb/run-20250618_112229-kvc7gwcz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_4_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/kvc7gwcz
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▄▇▃▆▇█▇██▇▇▇▇████████▇▇▇███████
wandb:           test_accuracy0.5 █▁██▁▇█▇▇▂▅▅▇▆▇▇▆▇▄▇▆▆▇▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          test_accuracy0.75 ▇▇▆█▇█▇█▇▇▇▄▆▅▃▃▁▄▄▁▄▄▃▃▃▃▃▃▃▃▃▃▂▃▃▃▃▃▃▃
wandb:                 test_auroc █▁▁▁▄▄▄▄▃▅▃▂▂▁▃▃▃▃▃▃▃▃▃▃▃▃▂▂▃▃▂▂▂▂▂▂▂▂▂▂
wandb: test_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▂▆▄▁▃▂█▂▂▆▂▃▃▃▃▄▄▂▃▃▃▃▃▅▅▃▅▅▅▅▅
wandb:  test_balanced_accuracy0.5 ▄▄▄▄▂▄▄▅█▇▄▄▄▄▇▄▁▄▃▂▁▁▂▂▂▂▃▃▃▁▁▁▁▁▃▃▃▃▃▃
wandb: test_balanced_accuracy0.75 ▆▆▆▆▆██▆▇▇▆▃▄▇▄▂▄▂▂▂▂▂▂▂▄▂▂▂▂▂▂▂▂▁▁▁▃▃▃▃
wandb:         test_precision0.25 ▃▃▃▃▃▃▃▃▃▃▃▄▁▁▂▆▇█▄▂▄▄▄█▆▂▄▄▇▇▇▆▇▄▇▄▇▇▇▇
wandb:          test_precision0.5 ▅▅▅▆▆▆▅▁▇█▅▅▅▄▄▃▄▄▄▄▄▄▅▄▄▄▄▅▅▄▅▅▅▅▅▅▅▅▅▅
wandb:         test_precision0.75 ▁▁▁▁▁█▁▁▆▃▂▃▂▃▂▃▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:            test_recall0.25 █████████████▅▃▂▁▃▂▁▁▂▁▂▂▃▂▁▁▁▂▂▂▂▂▂▂▂▂▂
wandb:             test_recall0.5 ▁▁▁▂█▁▃▄▅▅▃▃▂▅▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▃▃▅▂▄▃█▃▂▆▃▃▃▃▃▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:                train_auroc ▁▂▁▁▂▂▂▃▄▅▅▆▆███████████████████████████
wandb:                 train_loss ██████▇▇▆▆▄▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▃▄▄▇▇▇██████████████████████████
wandb:            val_accuracy0.5 █▁▁▇▆▆▅▅▄▅▆▁█▇██████████████████████████
wandb:           val_accuracy0.75 ▆▆▆▆▆▆▇▆▇▇▂▅▇▅▅▆▅▁█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:                  val_auroc ▅▅▅▅▄▄▄▃▄▃▁▇▄▄▇▇█▇██████████████████████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁█▃▆▅▇▃▅▅▅▆▃▆▄▄▆▆▄▄▆▆▆▄▄▄▄▄▄▄▄
wandb:   val_balanced_accuracy0.5 ▃▃▃▃▃▂▁▃▅▃▃▇▇█▆▇▇▇▇▇▇▇▇▇▇▇▇▇█▇▇▇▇▇▇▇▇▇▇▇
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▃▃▅▁▄▃▃▂▇▅▃▅▇▅█▅▅▅▅▅▇▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▄▁▂▁▆▆▇█▄▇▇▇▅▅▆▅▅▅▅▅███▅▅▅▅▅▅▅
wandb:           val_precision0.5 ▁▄▄▁▄▄▄▄▄▄▄▃▁▄▅▅██▇▇█▇▇█████▇▇██████████
wandb:          val_precision0.75 ▁▁▁▁█▃▄▄▇▅▅▃▅▅▇▆▆▆▆▆▆▆▆▆▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:             val_recall0.25 █████████▄▂▂▂▁▂▁▁▁▁▁▁▁▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁███▃▄▃▃▂▄▃▄▃▃▂▄▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             val_recall0.75 ▁▁▁▂▁▅▄▃▂▃▆█▄▆▄▄▄▄▄▄▄▄▄▄▄▅▅▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.63291
wandb:           test_accuracy0.5 0.62025
wandb:          test_accuracy0.75 0.60759
wandb:                 test_auroc 0.52669
wandb: test_balanced_accuracy0.25 0.53941
wandb:  test_balanced_accuracy0.5 0.48136
wandb: test_balanced_accuracy0.75 0.45636
wandb:         test_precision0.25 0.30435
wandb:          test_precision0.5 0.22222
wandb:         test_precision0.75 0.17647
wandb:            test_recall0.25 0.35
wandb:             test_recall0.5 0.2
wandb:            test_recall0.75 0.15
wandb:                train_auroc 0.99908
wandb:                 train_loss 0.0612
wandb:           val_accuracy0.25 0.71429
wandb:            val_accuracy0.5 0.7619
wandb:           val_accuracy0.75 0.7619
wandb:                  val_auroc 0.63973
wandb:  val_balanced_accuracy0.25 0.52629
wandb:   val_balanced_accuracy0.5 0.55794
wandb:  val_balanced_accuracy0.75 0.55794
wandb:          val_precision0.25 0.33333
wandb:           val_precision0.5 0.57143
wandb:          val_precision0.75 0.57143
wandb:             val_recall0.25 0.15385
wandb:              val_recall0.5 0.15385
wandb:             val_recall0.75 0.15385
wandb: 
wandb: 🚀 View run resnet18_2d_65_4_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/kvc7gwcz
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_4/wandb/run-20250618_112229-kvc7gwcz/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_4/wandb/run-20250618_113700-ka5dic4l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_4_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/ka5dic4l
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 █▁▁██▁██▁▁██▁▃███████▁█▁▁▁▆▁▁█▁▁▁▆█▁▁▁▁▁
wandb:          test_accuracy0.75 ▁███████████████████████████████████████
wandb:                 test_auroc ▂▅▃▇▄█▄▃▄▄▃▃▃▄▃▄▄▅▃▂▅▅▄▄▃▂▄▃▇▄▄▄▃▄▃▅▁▃▂▅
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▂▆▆▆▆▆▆▆▆▆█▁▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ████▁▁██▁█████▁█▁▁▁██▇██▁▁▁███████▁██▁██
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 █▁▁▁▁█▁▁███▁▁▁█▁▂▁▁▁█▁▁▁▁▁▁█▁▁███▁▄▁▁▁██
wandb:            test_recall0.75 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▄▄▁▃▃▄▂▄▃▅▅▄▆▇▃▅█▁▄▄▂▃▅▃▂▅▂▂▂▁▆█▃▃▃▂▄▃▃▃
wandb:                 train_loss ▄▃▃▂█▂▃▂▂▃▁▂▂▄▂▂▁▂▂▁▂▁▂▂▁▂▂▂▂▂▁▂▂▂▂▂▂▂▂▂
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ██▅▁████▁█▃█████▁▁██▁▁▆▁▁█▁▁▁▁▁▁▁▁▁▁▁▁█▁
wandb:           val_accuracy0.75 ▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▇▇▇▅▄▄▄▇▇█▇▅▅▆▆▇▁▇▇▆▆▆▆▇▆▁▇▁▆▅▄▆▇▆▆█▄▅▄▆
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁█▁▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▇▁▇▇▁▇▇▇▇▇▇▁▁▁▁▇▇█▇▇▇▁▁▇▇▇▇▇▁▁▁▇▁▇▇▁▇▇
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 █▁▁█████▁██▁███▁▁▁▁▁▁▁▁▁▅█▁██▁▁▁█▁███▁██
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.25316
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.51441
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.25316
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 1
wandb:            test_recall0.75 0
wandb:                train_auroc 0.47356
wandb:                 train_loss 2.10386
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.24762
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.37756
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.24762
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 1
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_4_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/ka5dic4l
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_4/wandb/run-20250618_113700-ka5dic4l/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_4/wandb/run-20250618_115728-9iuwv7xj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_4_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/9iuwv7xj
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: uploading config.yaml
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆███████████████████
wandb:           test_accuracy0.5 ██▁▃▃▁▄▁▂▂█▂▁▃▄▇▅▅▆▂▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          test_accuracy0.75 ▇▇▇▇▇▇▇▇▇▇▇▇▆▇▇▇█▇▇▇▆▃▁▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:                 test_auroc ▄▄▅▅█▅▂▂▃▄▅▁▂▄▂▄▄▂▃▁▇▁▂▁▂▂▂▁▁▁▁▁▁▁▁▂▂▁▁▁
wandb: test_balanced_accuracy0.25 ▇▇▇▇▇▇▇▇▇▇▁▇▇▇▇▆█▅▅▁▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:  test_balanced_accuracy0.5 ▅▅▅▄▁▅▅█▅▂▂▁▁▆▄▃▂▇▅▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb: test_balanced_accuracy0.75 ███████████████▅█▄▁▅▂▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:         test_precision0.25 ▇▁▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▆▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          test_precision0.5 ▃▁▁▃▁▃▃▄▃▃▃▃█▃▂▅▃▃▃▃▂▃▂▂▃▂▂▂▃▃▃▃▃▃▃▃▃▃▃▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▄█▁▅▄▃▅▄▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:            test_recall0.25 ██████████████▅████████▇▆▅▃▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▅▃▁▂▅▆█▃▃▁▅▂██▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▄▁▁▂▁▁▁▁▁▅█▁▂▅▂▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:                train_auroc ▁▃▁▄▂▂▃▃▂▄▄▃▄▃▂▃▄▄▄▅▄▄▄▄▅███████████████
wandb:                 train_loss ██████████▇▇▇▇▇▇▆█▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▁▇████▇███████████████
wandb:            val_accuracy0.5 ██▁▁▂▃██▄▅█▁█▄█▄▄█▅▅▆▆▇▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:           val_accuracy0.75 ▆▆▆▆▆▆▆▆▆▆▆▇▇█▆▅▅▄▁▃▂▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:                  val_auroc ▂▆▇▃▆▆▆▁▅▅▇█▅▄▅▄▆▅▃▅▃▃▅▄▄▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▄▇██▇▃▄▃▂▅▅▅▅▅▅▅▅▅
wandb:   val_balanced_accuracy0.5 ▂▂▂▂▂▃▂▄▃▄▃▃▃▆▆▁█▁▄▅▅▃▇█▆▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▄▃▇▇▂█▄▇█▅▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▃▄█▄▅▂▁▂▁▄▃▄▅▅▄▅▅▅▅▅▅▅
wandb:           val_precision0.5 ▆▆▆▆▆▁▅▆▆▆▅█▆▆▅▅▆▆▅████▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          val_precision0.75 ▁▁▁▁▁▅▁▁▁▅▅▆▆▅▅█▁▅▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:             val_recall0.25 ███▁████████████████▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:              val_recall0.5 ▁█▁█▇▅▁▃▂▃█▃▅▃▃▆▄▅▃▄▅▃▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▂▁▁▁▃▅▅▂▅▅▅▁▃█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.64557
wandb:           test_accuracy0.5 0.64557
wandb:          test_accuracy0.75 0.65823
wandb:                 test_auroc 0.44576
wandb: test_balanced_accuracy0.25 0.48178
wandb:  test_balanced_accuracy0.5 0.48178
wandb: test_balanced_accuracy0.75 0.49025
wandb:         test_precision0.25 0.21429
wandb:          test_precision0.5 0.21429
wandb:         test_precision0.75 0.23077
wandb:            test_recall0.25 0.15
wandb:             test_recall0.5 0.15
wandb:            test_recall0.75 0.15
wandb:                train_auroc 1
wandb:                 train_loss 1e-05
wandb:           val_accuracy0.25 0.65714
wandb:            val_accuracy0.5 0.64762
wandb:           val_accuracy0.75 0.66667
wandb:                  val_auroc 0.59396
wandb:  val_balanced_accuracy0.25 0.53992
wandb:   val_balanced_accuracy0.5 0.52069
wandb:  val_balanced_accuracy0.75 0.53335
wandb:          val_precision0.25 0.30769
wandb:           val_precision0.5 0.28
wandb:          val_precision0.75 0.30435
wandb:             val_recall0.25 0.30769
wandb:              val_recall0.5 0.26923
wandb:             val_recall0.75 0.26923
wandb: 
wandb: 🚀 View run resnet18_2d_65_4_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/9iuwv7xj
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_4/wandb/run-20250618_115728-9iuwv7xj/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_4/execution_datetimes.json

**************************************************  Experiment 65 | Version 5 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 11, 1.0: 7}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 20, 1.0: 12}
    Batch label distribution: {0.0: 13, 1.0: 19}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 20, 1.0: 12}
    Batch label distribution: {0.0: 14, 1.0: 4}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 5, 1.0: 13}

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_5/wandb/run-20250618_121529-ojq3uwk1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_5_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/ojq3uwk1
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁█▇▇██▇▇▆▆▆▅▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           test_accuracy0.5 █▁▁█▇▇██▆▆▇▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          test_accuracy0.75 █████▇██████▄▇▅▇▂▆▆▁▂▄▄▄▄▅▄▃▂▃▄▄▄▆▄▄▄▄▄▆
wandb:                 test_auroc ▆█▅▆▆▅▆▆▅▆▁▅▅▄▆▂▅▅▄▅▃▆▇▆▅▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb: test_balanced_accuracy0.25 ▅▅▅▅▅▅▅▅▅▅▅▁▄█▇▆▅▇▅▅▇▅▅▅▆▇▆▆▆▆▅▇▇▅▅▅▅▆▆▆
wandb:  test_balanced_accuracy0.5 ▃▃▃▃▅▅▅█▅█▃▁▃▇▆▃▄▂▅▂▁▂▁▂▂▃▃▃▂▂▂▂▂▃▂▂▂▂▂▃
wandb: test_balanced_accuracy0.75 ▃▃▃▃▄▄▄▃▄▄▃▅▃▂▇▁▁▄▃▂█▁▃▃▃▂▂▂▃▃▃▃▃▃▃▄▃▃▃▄
wandb:         test_precision0.25 ▃▃▃▃▃▃▃▃▄▃▄▂▃▁▃█▅▅▄▄▆▅▅▆▆▄▅▅▄▅▅▄▄▆▆▄▄▅▅▅
wandb:          test_precision0.5 ▁▁▅▁▅▇█▆▆▅▆▇▅▄▃▇▆▅█▅▅▅▅▅▆▆▅▅▅▅▅▅▆▅▅▅▅▅▅▅
wandb:         test_precision0.75 ▁▁▃▁▁▁▁██▁▁▄▂▃▂▃▃▂▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:            test_recall0.25 ████████████▁▂▂▁▄▃▃▄▃▃▃▂▃▃▂▂▂▂▂▂▂▂▃▂▂▂▂▂
wandb:             test_recall0.5 ▁█▁▂▂▃▄▃▃▂▃▂▃▂▂▂▃▂▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:            test_recall0.75 ▁▁▁▁▂▃▁▃▁▃▅▅▆█▂▆▆▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:                train_auroc ▂▃▂▁▄▄▆▇████████████████████████████████
wandb:                 train_loss ████▇▇▇▇▇▇▅▄▃▂▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▃█▇▇▆▇▆▅▆▅▅▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            val_accuracy0.5 █▁▅██▇▆▇▇▆▄▆█▅▆▅▇▆▇▇▇▇▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_accuracy0.75 ▇▇▇███▆▇▅▆▄▃▅▄▅▅▆▁▄▆▅▅▆▅▅▅▅▅▅▆▆▆▆▅▅▅▅▅▆▆
wandb:                  val_auroc █▅▄▃▄▃▃▂▃▅▁▆▄▂▄▄▄▅▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▂▄▁█▃▁▁▂▂▂▁▂▄▃▄▄▃▃▃▃▃▃▄▄▄▃▄▃▃▃▃
wandb:   val_balanced_accuracy0.5 ▃▃▃▇▅▇█▃▆▄▅▃▃▃▆▅▆▁▃▄▆▆▅▅▆▆▆▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:  val_balanced_accuracy0.75 ▄▄▇▄▅▅▅█▇▆▆▄▃▅▅▄▁▅▅▅▅▅▇▇▇▅▅▅▆▅▆▆▆▆▅▅▅▅▆▆
wandb:          val_precision0.25 ▃▃▃▃▃▃▃▃▃▃▅█▆▄▁▃▃▃▆▃▃▂▅▅▅▄▄▆▆▄▄▄▄▄▄▆▄▄▄▄
wandb:           val_precision0.5 ▁█▅▂▁▁▁▁▂▂▂▂▂▂▁▂▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:          val_precision0.75 ▁▁▁▁▃▆█▅▇▆▃▁▄▃▃▂▃▃▃▄▃▂▃▃▄▃▃▃▃▃▄▄▃▃▄▃▃▃▃▄
wandb:             val_recall0.25 ██████████▂▂▁▂▁▁▁▁▅▄▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁█▁█▁▆▃▆▃▂▃▃▄▃▃▄▃▂▂▂▃▃▃▃▃▂▃▃▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             val_recall0.75 ▁▁▃▂▁▄▆▁▆▇▅▆█▆▅▆▇▇▇▆▆▆▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.65823
wandb:           test_accuracy0.5 0.67089
wandb:          test_accuracy0.75 0.70886
wandb:                 test_auroc 0.5661
wandb: test_balanced_accuracy0.25 0.52331
wandb:  test_balanced_accuracy0.5 0.49873
wandb: test_balanced_accuracy0.75 0.52415
wandb:         test_precision0.25 0.29412
wandb:          test_precision0.5 0.25
wandb:         test_precision0.75 0.33333
wandb:            test_recall0.25 0.25
wandb:             test_recall0.5 0.15
wandb:            test_recall0.75 0.15
wandb:                train_auroc 1
wandb:                 train_loss 0.02067
wandb:           val_accuracy0.25 0.66667
wandb:            val_accuracy0.5 0.70476
wandb:           val_accuracy0.75 0.72381
wandb:                  val_auroc 0.53408
wandb:  val_balanced_accuracy0.25 0.50755
wandb:   val_balanced_accuracy0.5 0.53286
wandb:  val_balanced_accuracy0.75 0.54552
wandb:          val_precision0.25 0.26316
wandb:           val_precision0.5 0.33333
wandb:          val_precision0.75 0.38462
wandb:             val_recall0.25 0.19231
wandb:              val_recall0.5 0.19231
wandb:             val_recall0.75 0.19231
wandb: 
wandb: 🚀 View run resnet18_2d_65_5_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/ojq3uwk1
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_5/wandb/run-20250618_121529-ojq3uwk1/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_5/wandb/run-20250618_122844-8ovhb8b2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_5_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/8ovhb8b2
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 245-247, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▅▅▅▇▇█▆▆▇▇████████████████████
wandb:           test_accuracy0.5 █████▃▄▁▄▄▆▄▆▇▆▆▄▅▅▅▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:          test_accuracy0.75 █████▇▇█▅▁▇▆▆▆▆▆▆▅▇▅▇▇▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▅▆
wandb:                 test_auroc ▂▂█▃▄▁▆▃▃▂▂▆▇▅▅▅▃▄▆▆▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▅
wandb: test_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▂▁▅▄█▇█▇▅▆▇▅▅▅▅▅▅▅▅▅▅▅▅▅▅▄▅▅▅▅▆
wandb:  test_balanced_accuracy0.5 ▂▂▁▂▇▃▂▂▃▄▃▅█▇▅▄▅▆▃▄█▅▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb: test_balanced_accuracy0.75 ▃▃▃▃▄▁▂▂▅▆█▆▅▆▆▆▆▄▄▆▆▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▃▆▇▆█▇▇▇▇▆▅▆▇▆▄▆▆▆▆▆▆▆▅▆▆▆▆▇▇
wandb:          test_precision0.5 ▃█▁▄▄▃▂▄▃▅▃▄▃▃▄▄▄▃▃▃▃▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▇▁▇▆▇▄▆▅▇▇▇▆▇▇▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            test_recall0.25 █████▄▄█▃▂▃▂▂▂▂▂▂▂▁▁▂▁▁▂▂▂▂▁▁▂▂▂▂▂▂▂▂▂▂▂
wandb:             test_recall0.5 ██▁▁▁▃▃▂▅▃▃▂▄▄▃▃▂▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:            test_recall0.75 ▁▁▁▁▂▁▁▁▄▆▄▃▅▄█▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:                train_auroc ▁▃▃▂▂▃▃▃▄▄▇█████████████████████████████
wandb:                 train_loss █████▇▇▆▆▃▅▂▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▅▄▅███▆████▇██▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            val_accuracy0.5 ▁▁▁█▁█▁▆▇▄██▆▆▅▆▆▆▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:           val_accuracy0.75 ▇▇▇█▇▇██▇▅▃▂▃▂▅▄▂▂▂▂▂▂▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▂▂
wandb:                  val_auroc ███▅▆▇▅▃▂▄▂▃▁▁▁▂▂▂▂▂▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:  val_balanced_accuracy0.25 ▇▇▇▇▇▇▃▅▁█▅▆▆▃▃▃▄▇▅▅▆▆▆▄▄▁▁▃▃▃▃▃▃▃▃▂▃▃▃▃
wandb:   val_balanced_accuracy0.5 ▄▄▄▄█▇█▇▆▆▄▃▂▃▁▂▂▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▅▅▅▅▇█▅▅▇█▆▃▇▆▅▅▄▃▃▂▂▅▂▂▂▃▂▂▂▂▂▂▂▂▁▂▁▂▁▂
wandb:          val_precision0.25 ███████▅▆▁▂▇▅▂▂██▅▆▆▄▂▃▂▃▃▂▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:           val_precision0.5 ▂▂▃▂█▃▃▄▃▃▂▂▂▁▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁█▁▇█▅▁▄▄▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:             val_recall0.25 ███████▂▄▆▅▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ██▃▂▄▁▂▂▂▂▃▁▁▃▂▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             val_recall0.75 ▁▃▁▁▁▂▂▂▂▁▃▁▅▅▂▃█▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.68354
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.6962
wandb:                 test_auroc 0.5572
wandb: test_balanced_accuracy0.25 0.57331
wandb:  test_balanced_accuracy0.5 0.54025
wandb: test_balanced_accuracy0.75 0.54873
wandb:         test_precision0.25 0.36842
wandb:          test_precision0.5 0.33333
wandb:         test_precision0.75 0.35714
wandb:            test_recall0.25 0.35
wandb:             test_recall0.5 0.25
wandb:            test_recall0.75 0.25
wandb:                train_auroc 0.99891
wandb:                 train_loss 0.0784
wandb:           val_accuracy0.25 0.5619
wandb:            val_accuracy0.5 0.57143
wandb:           val_accuracy0.75 0.59048
wandb:                  val_auroc 0.39679
wandb:  val_balanced_accuracy0.25 0.43793
wandb:   val_balanced_accuracy0.5 0.43135
wandb:  val_balanced_accuracy0.75 0.44401
wandb:          val_precision0.25 0.16667
wandb:           val_precision0.5 0.14815
wandb:          val_precision0.75 0.16
wandb:             val_recall0.25 0.19231
wandb:              val_recall0.5 0.15385
wandb:             val_recall0.75 0.15385
wandb: 
wandb: 🚀 View run resnet18_2d_65_5_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/8ovhb8b2
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_5/wandb/run-20250618_122844-8ovhb8b2/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_5/wandb/run-20250618_124308-klucikaw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_5_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/klucikaw
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁██▇▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           test_accuracy0.5 █████▁▇███▆▅▆▆▇▆▇▆▆▇▇▆▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          test_accuracy0.75 ▇█▇▇▇▇▇█▇▇▇▇▆▃▁▃▃▃▅▁▃▄▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:                 test_auroc ▃▅▄▃▃▂▂▂▂▂▁▃▂▃▁▆▃▇▆▅▅▅▄▇█▆▇▇▆▆▆▆▆▆▆▆▆▆▆▆
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▆▂█▁▇▇▄▄▅▄▅▅▅▄▄▄▄▄▅▂▂▄▂▄▄▂▂▂▂
wandb:  test_balanced_accuracy0.5 ▇▅▅▅▅▆▆▅▃▅▃▃▄▆▅▁▃▅▅█▄▆▇▇▇▇▇▇▇▇▇▆▇▆▆▆▆▆▆▆
wandb: test_balanced_accuracy0.75 ▄▄▄▄▄▆▄▄▄▄█▄▁▂▁▄▃▅▄▄▆▄▆▅▅▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▁█▃▄▄▃▁▃▃▃▃▂▂▃▁▁▁▂▂▁▂▂
wandb:          test_precision0.5 ▃▃▃▃▁▃█▃▂▅▃▃▃▂▁▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:         test_precision0.75 █▁█▁▁▁███▅▁▁▁▁▁▁▃▁▂▃▃▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:            test_recall0.25 ████████████▃▁▄▁▂▂▅▅▂▃▂▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             test_recall0.5 █▂▁▂█▁▆▂▁▁▁▁▄▁▃▃▃▂▂▂▂▃▅▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:            test_recall0.75 ▁▁▂▂▂▁▁▁▂▁▁▁▁▁▁▆▆▇▅▆▆▇▆▃▅▇██████████████
wandb:                train_auroc ▁▃▃▃▄▄▄▄▅▃▃▄▅▆▇█████████████████████████
wandb:                 train_loss ███████▇▇█▇▇▇▆▆▃▃▂▂▂▁▁▂▅▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▇▇▆▇▇▇▇██████████████████████
wandb:            val_accuracy0.5 ▁██████▁▂██▇▆▆▆▆▇▇▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_accuracy0.75 ▇▇▇▇▆▇▇▆▇▇▇█▇▇▃▅▃▄▅▁▅▁▄▂▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:                  val_auroc ▆▃▄▃▂▆▄▃▃▄▁▂▂▄▂▃▂▂▄▅▄▅▇▆▃▅█▆▇▇██████████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃█▁▄▁█▅▆▆▅▅▆▆▆▆▆▆▆▆▆▆▆▆
wandb:   val_balanced_accuracy0.5 ▄▄▇▇▇▆▂▁▅▇█▁▆▆▂▃▃▄▆▄▇▆▇██████▇▇▇█▇▇▇▇▇▇▇
wandb:  val_balanced_accuracy0.75 ▁▇▆▇▅▁▁▅▂▇▅▅▇▇▁▃▅▃▇▅▃▄▃▅▃▇█▄▇▆▇▇▇▇▇▇▇▇▇▇
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▄▇▅▇▁██▇▇▇▇▇▇▇▇▇▇██▇█████
wandb:           val_precision0.5 ▁▁█▃▃▇▆▆▆▆██▇▆▃▆▄▄▃▃▅▄▄▅▄▄▄▄▄▅▅▅▅▅▅▅▅▅▅▅
wandb:          val_precision0.75 ▆▆▇▇█▇▆▇▆████▁▆▄▄▄▅▄▄▅▅▄▄▄▄▅▄▄▄▄▄▄▅▄▅▄▄▄
wandb:             val_recall0.25 ██████████████▂▁▄▄▄▃▃▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:              val_recall0.5 ▃▂▂▂▂█▂▂▃▁▂▂▂▃▃▂▃▂▄▅▃▄▃▃▄▃▃▃▃▄▃▃▃▄▃▃▃▃▃▃
wandb:             val_recall0.75 ▁▄▄▄▃▄▄▄▃▄▁▄▄▂▂▆▇▆█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.62025
wandb:           test_accuracy0.5 0.63291
wandb:          test_accuracy0.75 0.65823
wandb:                 test_auroc 0.57627
wandb: test_balanced_accuracy0.25 0.51441
wandb:  test_balanced_accuracy0.5 0.52288
wandb: test_balanced_accuracy0.75 0.53983
wandb:         test_precision0.25 0.27273
wandb:          test_precision0.5 0.28571
wandb:         test_precision0.75 0.31579
wandb:            test_recall0.25 0.3
wandb:             test_recall0.5 0.3
wandb:            test_recall0.75 0.3
wandb:                train_auroc 1.0
wandb:                 train_loss 3e-05
wandb:           val_accuracy0.25 0.68571
wandb:            val_accuracy0.5 0.68571
wandb:           val_accuracy0.75 0.68571
wandb:                  val_auroc 0.64314
wandb:  val_balanced_accuracy0.25 0.58471
wandb:   val_balanced_accuracy0.5 0.57181
wandb:  val_balanced_accuracy0.75 0.57181
wandb:          val_precision0.25 0.37037
wandb:           val_precision0.5 0.36
wandb:          val_precision0.75 0.36
wandb:             val_recall0.25 0.38462
wandb:              val_recall0.5 0.34615
wandb:             val_recall0.75 0.34615
wandb: 
wandb: 🚀 View run resnet18_2d_65_5_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/klucikaw
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_5/wandb/run-20250618_124308-klucikaw/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_5/execution_datetimes.json

**************************************************  Experiment 65 | Version 6 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 37, 1.0: 27}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 10, 1.0: 8}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 30, 1.0: 34}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 13, 1.0: 5}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 24, 1.0: 40}
    Batch label distribution: {0.0: 30, 1.0: 34}
    Batch label distribution: {0.0: 38, 1.0: 26}
    Batch label distribution: {0.0: 8, 1.0: 10}

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_6/wandb/run-20250618_130030-jfgcp639
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_6_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/jfgcp639
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▇▇▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇██▇▇▇▇█▇
wandb:           test_accuracy0.5 ███▁▆▅▇▅█▆▇▂▆▆▇▇▅▇▇▇▆▇▇▇▇▇▇▇███▇▇▇▇▇▇▇▇█
wandb:          test_accuracy0.75 ▇▇█▇▇▇▇███▄▅▄▁▃▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:                 test_auroc █▄▃▅▆▆▆▅▆▆▅▆▆▅▆▁▇▇▆▂▇▅▆▆▆▇▇▇▇▇▇▇▇█▇▇███▇
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▂▃▄▃▄▄▅▅▅▅▇▆▆▆▆▇██▆▆▆▆▆▆▆▆▆▆▆
wandb:  test_balanced_accuracy0.5 ▁▅▅█▅▆▃▆▆▇▄▂▃▂▄▆▆▇▅▅▆▇▇▇▇▇██▇▇▇▇▇▇▇███▆▆
wandb: test_balanced_accuracy0.75 ▂▃▂▃▃▂▂▄▄▄▅▂▃▃▄▇▁▇▃▃▆▆▇▆▇▇▇▇▇▇▇█▇▇▇▇▇█▇▇
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▂▂▂▄▃▂▄▆▄▄▆▅▅▅▆▅▆▆▇▇▅▅▅▅▅▇█▅▅▅
wandb:          test_precision0.5 ▁▁▄▁▄▅▄▅▅▅▆▆▆▆▇▅▇▇▇▆▇▇▇▇▇▇█▇▆▆▇▆▇▇██▆▆▆▆
wandb:         test_precision0.75 ▁▁▁▁▁▁▃▁▁▁▁█▁▁█▅▃▂▂▃▃▄▄▄▄▄▅▅▅▅▅▅▅▅▅▅▄▄▄▄
wandb:            test_recall0.25 ██████▆▂▃▂▁▄▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             test_recall0.5 ▁█▂▄▂▂▁▂▃▅▂▄▃▃▁▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:            test_recall0.75 ▁▁▁▁▂▁▁▁▂▁▂▆▇▃█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:                train_auroc ▁▃▂▃▃▃▄▄▄▃▄▄▄▅██████████████████████████
wandb:                 train_loss █▇▇▇▇▇▇▇▇▆▆▄▄▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▆▇▆█▇▇███▇█▇▇▇▇▇▇▇▇▇▇▇▇▇██▇▇▇▇
wandb:            val_accuracy0.5 ▁▆▆▆▆▇██▆▇█▇▇▇▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_accuracy0.75 ▆█▆▆▆▇▇▇▅▆▃▆▂▁▆▃▃▃▃▃▃▃▃▃▃▃▃▄▄▄▃▃▃▃▃▄▄▃▃▃
wandb:                  val_auroc ▄▅▃▄▄▄▄▄▅▄▁▂▆█▆▆▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:  val_balanced_accuracy0.25 ▅▅▅▅▅▃█▂▆▆▂▂▁▄▃▁▂▂▂▂▂▂▁▁▂▁▁▁▁▂▂▂▂▁▁▃▃▃▂▂
wandb:   val_balanced_accuracy0.5 ▄▄█▇▃▃█▅▃▄▄▅▃▇▇▄▁▇█▄▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▄▄▄▄█▇▄▅▅▇▅▅▅▅▇▆▅▃▁▄▇▆▃▂▂▂▂▂▃▂▂▂▂▃▃▂▂▂▂▂
wandb:          val_precision0.25 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆██▇▅▇▆▅▃▁▁▃▃▃▁▁▁▁▃▁▃▃▃▁▃▃
wandb:           val_precision0.5 ▁▃▃▄█▃▃▃▃▃▃▄▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:          val_precision0.75 ▁▁████▄▆▅▃▃▃▂▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             val_recall0.25 ███████▇████▆▄▂▄▄▄▂▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▁▁
wandb:              val_recall0.5 █▂▄▄▂▂▄▂▂▃▃▃▅▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▅▆▃▅▆▁▃▄▇▂▅▃▇█▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.6962
wandb:           test_accuracy0.5 0.70886
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.56949
wandb: test_balanced_accuracy0.25 0.58178
wandb:  test_balanced_accuracy0.5 0.5572
wandb: test_balanced_accuracy0.75 0.58263
wandb:         test_precision0.25 0.38889
wandb:          test_precision0.5 0.38462
wandb:         test_precision0.75 0.5
wandb:            test_recall0.25 0.35
wandb:             test_recall0.5 0.25
wandb:            test_recall0.75 0.25
wandb:                train_auroc 0.9995
wandb:                 train_loss 0.05859
wandb:           val_accuracy0.25 0.6381
wandb:            val_accuracy0.5 0.67619
wandb:           val_accuracy0.75 0.67619
wandb:                  val_auroc 0.54649
wandb:  val_balanced_accuracy0.25 0.44985
wandb:   val_balanced_accuracy0.5 0.46227
wandb:  val_balanced_accuracy0.75 0.46227
wandb:          val_precision0.25 0.125
wandb:           val_precision0.5 0.1
wandb:          val_precision0.75 0.1
wandb:             val_recall0.25 0.07692
wandb:              val_recall0.5 0.03846
wandb:             val_recall0.75 0.03846
wandb: 
wandb: 🚀 View run resnet18_2d_65_6_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/jfgcp639
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_6/wandb/run-20250618_130030-jfgcp639/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_6/wandb/run-20250618_131622-zfl7xx6v
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_6_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/zfl7xx6v
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▇▅▇█▃▇▇████████▇▇▇▇▇▇▇▇
wandb:           test_accuracy0.5 ██▁██▁▁██▁▁▁█▅█▇█▆▇▇▇▇▇█▇▇▆▇▇███████▇██▇
wandb:          test_accuracy0.75 ▇▇█▇▇▇▇▇▇▇▇▆▃▅▂▆▆▆▃▅▁█▇▇█████████▇▇▅▆▅▅▅
wandb:                 test_auroc ▂▃▃▃▅▃▁▄▃▂▆▂▃▄▃▄▃▄▅▃▁▅▆▆▆▆▆▇███████▇██▇█
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▆▅▅▅▅▄▆▆▅▅▆▆▆▆▇▅▆▆█
wandb:  test_balanced_accuracy0.5 ▂▃▂▂▄▂▂▂▂▂▂▂▂▂▂▂▄▄▅▄▂▁▅█▅▄▅▁▇▇▇▇▇▇▇▇▇▆▇▇
wandb: test_balanced_accuracy0.75 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂█▄▅▅▁▅▇▅▇▇█████▇▇▇▇▆▄▅▅▆
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▂▆▆▆▅▆▄▅▆▇▇▇▇▇█▅▆▇▇▆▆
wandb:          test_precision0.5 ▁▄▄▁▄▁▄▁▁▁▄▄▆▇▆▁▆▆▃▅▆▄▇▆▇▆▇██▇▇▆▇▆▆▇▇▇▇▇
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁▃▅▇▇▇█████████▇▇▇▆▆▆
wandb:            test_recall0.25 ███████████████▇▅▄▄▂▁▁▁▁▄▃▂▂▃▄▂▂▂▂▂▃▃▄▄▃
wandb:             test_recall0.5 █▁▁▁██▁▁▁█▁▁▄▁▂▃▂▂▃▁▁▃▃▂▂▃▃▂▃▃▃▃▄▄▄▃▃▄▄▄
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▁▁▅▄▅▄▅▅▅▆▆▇▅▇▇▇▇▇▇█▇▇▇
wandb:                train_auroc ▂▃▂▂▁▃▃▃▃▃▃▂▃▃▃▆▇██▇████████████████████
wandb:                 train_loss ███████▇████████▇▇▇▇█▅▂▁▁▃▄▂▁▂▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▁▃▇▂█▇████████▇▇▇▆▇
wandb:            val_accuracy0.5 ▁██▁██████▁▁▁▁█▅█▁▆██▅█▆▇▇▇▆▇▆▆▆▆▆▆▆▆▆▅▆
wandb:           val_accuracy0.75 ▇█▇▇▇▇▇▇▇██████▆▇▆▆▃▃▅▅▅▄▂▂▂▂▂▁▁▂▂▂▁▂▁▁▁
wandb:                  val_auroc █▇▇▇▇▇█▅▅▇▅█▇▅▆▃▂▃▃▄▃▁▂▂▃▃▃▃▃▃▄▄▄▄▄▃▂▂▂▂
wandb:  val_balanced_accuracy0.25 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▁▅▇█▇▅▄▆▇▆▅▆▆▅▅▄▃▄▄▅
wandb:   val_balanced_accuracy0.5 ▄▄▄▆▃▃▃▃▃▃▃▃▆▃▃▆▅█▅▂▆▆▅▂▅▄▃▂▃▃▂▂▂▁▂▂▂▂▂▁
wandb:  val_balanced_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▃▅▃▃▄█▅▆▄▅▄▃▃▃▂▂▂▂▂▂▁▂▂▂▂▂▁▂▃▁
wandb:          val_precision0.25 ▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▄▂█▅▅▂▄▄▃▂▃▄▄▄▅▅▁▂▃▃▃
wandb:           val_precision0.5 ▁▃█▆█▃▃▁█▃█▄▄▄▄▄▃▃▃▂▃▃▃▃▃▃▃▃▂▃▃▃▃▂▂▂▃▂▂▂
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▄▁█▅▆█▅▄▅▄▂▃▃▃▃▃▃▃▂▂▂▂▂▂▂▂▃▃▂▂
wandb:             val_recall0.25 ██████████████▇▂▅▂▂▂▁▂▂▂▂▂▂▂▂▂▂▂▃▂▂▂▂▂▂▂
wandb:              val_recall0.5 ▁█▃▁▁████▂██▅▃▃▃▃▃▅▄▃▅▂▃▂▃▂▂▂▂▂▂▂▂▂▃▃▃▃▂
wandb:             val_recall0.75 ▁▁▂▁▁▁▁▁▁▁▁▂▁▁▁▃▂▂▃▄▃▃▅▅█▄▄▂▃▃▃▃▃▃▆▄▃▄▄▃
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.72152
wandb:           test_accuracy0.5 0.72152
wandb:          test_accuracy0.75 0.70886
wandb:                 test_auroc 0.6322
wandb: test_balanced_accuracy0.25 0.64831
wandb:  test_balanced_accuracy0.5 0.61525
wandb: test_balanced_accuracy0.75 0.59025
wandb:         test_precision0.25 0.45455
wandb:          test_precision0.5 0.44444
wandb:         test_precision0.75 0.41176
wandb:            test_recall0.25 0.5
wandb:             test_recall0.5 0.4
wandb:            test_recall0.75 0.35
wandb:                train_auroc 0.99918
wandb:                 train_loss 0.07143
wandb:           val_accuracy0.25 0.59048
wandb:            val_accuracy0.5 0.6
wandb:           val_accuracy0.75 0.60952
wandb:                  val_auroc 0.39241
wandb:  val_balanced_accuracy0.25 0.46981
wandb:   val_balanced_accuracy0.5 0.45034
wandb:  val_balanced_accuracy0.75 0.45667
wandb:          val_precision0.25 0.2069
wandb:           val_precision0.5 0.16667
wandb:          val_precision0.75 0.17391
wandb:             val_recall0.25 0.23077
wandb:              val_recall0.5 0.15385
wandb:             val_recall0.75 0.15385
wandb: 
wandb: 🚀 View run resnet18_2d_65_6_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/zfl7xx6v
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_6/wandb/run-20250618_131622-zfl7xx6v/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_6/wandb/run-20250618_133645-4lhiafa5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_6_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/4lhiafa5
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▅▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇█▆▆▆▆▆▆▆▆▆▆▆
wandb:           test_accuracy0.5 ▇██▇█▁▇▆▅▁▄▇▇▆▇▆▇▆▇▇▆▇▆▆▆▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          test_accuracy0.75 ██████████▂▅▃▄▄▆▆▅▅▆▅▁▁▄▄▅▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:                 test_auroc ▅▅▂▃▂▄▄▄▃▄▄▄▅▇▆▇█▇▇▇▆▆▆▅▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▆█▅▄▃▄▃▃▂▃▄▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:  test_balanced_accuracy0.5 ▄▇▅▄▁▅▄▄▂▂▁▂▄▅▃▃▆█▃▆▃▃▆▆▄▄▂▁▃▃▃▃▂▂▂▂▂▂▂▂
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃▃▄▃▃▃▂▃█▃▄▄▄▄▂▃▄▇▁▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▆▄█▇▇▂▄▅▄▄▄▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▅▁▁▅▆▆▁▄█▄▅▁▁▅▁▄▆▄▆▆▆▅▅▅▅▄▄▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁█▁▁▁▄▃▄▃▂▃▃▃▂▃▂▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:            test_recall0.25 ██████████████▃▇▂▄▁▃▂▂▂▂▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             test_recall0.5 ▁▁▁▁▁▁▂▁▁▆█▃▁▁▂▃▁▅▃▁▂▃▄▂▂▃▂▃▂▄▃▂▂▂▃▂▂▂▂▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▂▃▅▅▆▅▅▅▅██▅▆▃▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:                train_auroc ▂▂▁▃▄▂▄▃▃▅▆█████████████████████████████
wandb:                 train_loss ███▇▇▇▇▇▇▇▆█▇▆▇▅▃▃▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▂▂▇█▇██▇▇████████████████████
wandb:            val_accuracy0.5 ████▂▃█▆▄▂▆▁▆▆▅▆▇▆▆▇▆▅▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:           val_accuracy0.75 ▇▇▇▇▇▇▇▇▇███████▇▁▅▅▆▆▆▆▇▆▆▆▆▆▅▅▅▅▅▅▅▅▅▅
wandb:                  val_auroc ▇███▆▅▄▃▃▄▁▂▃▁▃▂▂▂▂▂▂▃▂▅▄▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▄▄▄▃▃▂▁▃▆▆▅▇▅▅▅▅▆██▅▇▇▇▇▇▇▇▇▇▇▇▇
wandb:   val_balanced_accuracy0.5 ▂▂▃▆▇█▅▆▆▂▇▄▄▅▅▂▆▁▂▇▃▃▃▄▅▄▆▃▅▄▅▆▆▆▆▆▆▆▆▆
wandb:  val_balanced_accuracy0.75 ▄█▅▇▃▃█▇█▃▅▆▁▇▅▄▅▅█▇▅▆▅▅▆▆▆▆▅▇▆▆▆▆▆▆▇▇▇▇
wandb:          val_precision0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▅▅▄▇▆▇▅▄▆▅▆█▆▆▆▆▆▆▆▆▆▆▆
wandb:           val_precision0.5 ▁▁▇█▄▆▇▄▄▄▇▇▄▄▄▄▃▄▃▄▅▄▅▄▅▄▄▅▅▅▄▅▄▄▄▄▄▄▄▄
wandb:          val_precision0.75 ▅▁▇▁▇▆▅█▁▁▄▆▄▃▄▃▄▃▄▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:             val_recall0.25 ████████████████▆▁▁▂▁▁▁▃▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:              val_recall0.5 ▁▁█▁▁▂█▂▂▅▃▅▃▄▆▄▂▂▃▃▃▃▃▂▃▅▃▃▄▃▄▃▃▃▃▃▃▃▃▃
wandb:             val_recall0.75 ▁▂▂▄▂▂▄▂▂▂▂▁▁▅▇▅▅▄▄▄▃█▃▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.59494
wandb:           test_accuracy0.5 0.59494
wandb:          test_accuracy0.75 0.60759
wandb:                 test_auroc 0.41525
wandb: test_balanced_accuracy0.25 0.46441
wandb:  test_balanced_accuracy0.5 0.44788
wandb: test_balanced_accuracy0.75 0.45636
wandb:         test_precision0.25 0.2
wandb:          test_precision0.5 0.16667
wandb:         test_precision0.75 0.17647
wandb:            test_recall0.25 0.2
wandb:             test_recall0.5 0.15
wandb:            test_recall0.75 0.15
wandb:                train_auroc 1
wandb:                 train_loss 2e-05
wandb:           val_accuracy0.25 0.6381
wandb:            val_accuracy0.5 0.64762
wandb:           val_accuracy0.75 0.66667
wandb:                  val_auroc 0.58788
wandb:  val_balanced_accuracy0.25 0.54017
wandb:   val_balanced_accuracy0.5 0.54649
wandb:  val_balanced_accuracy0.75 0.55915
wandb:          val_precision0.25 0.3
wandb:           val_precision0.5 0.31034
wandb:          val_precision0.75 0.33333
wandb:             val_recall0.25 0.34615
wandb:              val_recall0.5 0.34615
wandb:             val_recall0.75 0.34615
wandb: 
wandb: 🚀 View run resnet18_2d_65_6_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/4lhiafa5
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_6/wandb/run-20250618_133645-4lhiafa5/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_6/execution_datetimes.json

**************************************************  Experiment 65 | Version 7 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 1, 1.0: 1}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 4, 1.0: 12}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 2, 1.0: 14}
    Batch label distribution: {0.0: 2}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 1, 1.0: 1}

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_7/wandb/run-20250618_135437-tkwbafv3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_7_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/tkwbafv3
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 255-259, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▄▅▇▆▇▇█▇█▇▇██▆▄█▇█▇████▇█████
wandb:           test_accuracy0.5 █▅▁▄▃█▇█▆▅▅▇▇▃███▇▇███▇█▇█▇▇▇▇█▇▇▇▇▇█▇█▇
wandb:          test_accuracy0.75 ▆▆▆▆▆▆▇▆▆▆▆▇▇▇█▆█▆▆▆▆▆▆▆▆▇▇▅▁▂▇▆▆▆▆▆▆▆▆▆
wandb:                 test_auroc ▄▁▂▃▃▄▄▃▄▃▃▄▃▃▄▄▅▆▇███▇██▆▇▇▇█▇█▇███▇███
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▂▁▁▃▃▂▃▃▁▃▅▃▆▆▄▅▄▆▄▇▄▅▄▄▇▄▇▆█▅███▅
wandb:  test_balanced_accuracy0.5 ▃▁▃▃▁▃▅▄▅▅▆▅▄▄▄▅▄▄▅▅▅▄▅█▅▆▄▄▆▆▇▅▄▅▅▆▅▅▅▆
wandb: test_balanced_accuracy0.75 ▂▂▂▂▃▂▇▅▂▂▂▅▁▄▅▅▅▇▇█▆▅▄▅█▇▅▇▇▇▆▄▆▇▆▆▆▆▇▆
wandb:         test_precision0.25 ▂▂▂▂▂▂▂▂▁▂▁▁▁▁▂▃▂▆▅▄▅▄▅▅▆▆▄▂▃▅▆▆▅▅██████
wandb:          test_precision0.5 ▂█▁▂█▂▂▄▅▃▂▅▃▂▃▃▅▂▁▄██▄██▄▅▄▄▅▅▄▄▅▆▄▇▆▆▇
wandb:         test_precision0.75 ▁▁▁▁▁▁███▅█▆▃█▄▄▄▃▅▅▅▃▅▅▃▃▅▅▄▄▄▅▅▄▄▄▄▅▄▄
wandb:            test_recall0.25 ███████▇██▇████▇▃▅▂▃▅▃▃▃▃▂▃▂▁▃▂▃▃▂▃▃▃▃▃▃
wandb:             test_recall0.5 ▁█▂▅▄▃▄▃▅▄▂▃▄▆▃▂▁▃▂▂▃▂▂▂▃▃▂▃▂▂▂▃▂▂▂▂▂▂▂▃
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▂▂▁▁▂▃▃▃▂▄▃▂▃▃▄▃▅█▄▄▄▅▄▄▄▆▄▄▄▄▄▄
wandb:                train_auroc ▁▃▂▄▄▄▅▄▃▄▅▆▇███████████████████████████
wandb:                 train_loss ████▇▇▇▇▇█▇▇▇▇▇▅▄▄▂▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▂▁▁▁▂▂▂▂▇█▇███▇▆▇▇█▆▇██▇▇███▇█▇███
wandb:            val_accuracy0.5 ▄▆▃▆▅▃█▃▆▁▄▁▇██▇▇▇███▇█▇▇▅▇██▇▇▇▇▇▇█████
wandb:           val_accuracy0.75 ▆▆▆▆▆▆█▇▆█▇▁█▇▆▇▇▇▇▆▇▅▅▁▇▆▆▆▆▅▅▆▆▆▆▅▆▆▇▇
wandb:                  val_auroc ▁▁▂▂▂▃▃▃▃▃▃▃▇▆▆█▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▇▇▇▇▇▇▇
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▂▂▅▆▅▄▆▇▅▅▅▆▆▅█▇▆███▆▆█
wandb:   val_balanced_accuracy0.5 ▃▃▃▄▅▄▂▄▂▁▄▅▄▅▄▄▆▆▅▅▆▆▅▅▆▄▆▇▄▄▅▆▄▆▆▇▄▅▅█
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▇▇▇▂▆▄▆▂▅▄▇▆▇█▆▆▆▇▆▄▆█▆▄▃▄▇▆▃▄█▃▃█▄
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▂▃▂▄▅▄█▅▇▃▇▇▅▅▅▅▆▆▆▆▆▆▆
wandb:           val_precision0.5 ▁▁▂▁▁▅▁▁▁▂▅▃▂█▄▄█▄▄▃▄▃▃▄▃▃▄▃▄▃▄▃▃▄▄▄▄▃▄▄
wandb:          val_precision0.75 ▁▁▁▁▁▁█▅██▅▅███▅▃█▆▇█▄▅▄▇▇▅▆▅▅▅▅▄▅▅▅▅▅▅▅
wandb:             val_recall0.25 ██████████▇█▇█▇▇█▂▄▂▃▂▂▃▂▄▂▂▁▄▃▂▂▁▂▃▂▃▃▂
wandb:              val_recall0.5 ██▆█▆▂▂▃▂▆▃▅▂▅▂▁▂▁▂▂▂▂▂▁▂▂▂▁▂▂▂▁▃▁▂▂▂▂▂▃
wandb:             val_recall0.75 ▁▁▁▄▆▅▂▆▆▆▅▅▅▃▆▅▃▃▃▅▅▅▅▅▆▇█▂▄▄▄▄▄▄▄▄▄▄▄▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.70886
wandb:           test_accuracy0.5 0.73418
wandb:          test_accuracy0.75 0.73418
wandb:                 test_auroc 0.64153
wandb: test_balanced_accuracy0.25 0.5572
wandb:  test_balanced_accuracy0.5 0.55763
wandb: test_balanced_accuracy0.75 0.5411
wandb:         test_precision0.25 0.38462
wandb:          test_precision0.5 0.44444
wandb:         test_precision0.75 0.42857
wandb:            test_recall0.25 0.25
wandb:             test_recall0.5 0.2
wandb:            test_recall0.75 0.15
wandb:                train_auroc 0.99908
wandb:                 train_loss 0.06213
wandb:           val_accuracy0.25 0.75238
wandb:            val_accuracy0.5 0.77143
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.61831
wandb:  val_balanced_accuracy0.25 0.59031
wandb:   val_balanced_accuracy0.5 0.59007
wandb:  val_balanced_accuracy0.75 0.5387
wandb:          val_precision0.25 0.5
wandb:           val_precision0.5 0.6
wandb:          val_precision0.75 0.5
wandb:             val_recall0.25 0.26923
wandb:              val_recall0.5 0.23077
wandb:             val_recall0.75 0.11538
wandb: 
wandb: 🚀 View run resnet18_2d_65_7_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/tkwbafv3
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_7/wandb/run-20250618_135437-tkwbafv3/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_7/wandb/run-20250618_140952-5nt0p2ms
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_7_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/5nt0p2ms
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▃▅▅█▅▄▆▇▇▇██▇▇▇▇██▆▇▇█▇█▇███▇██▄
wandb:           test_accuracy0.5 █▄▁█▇▅██▇▇▇█▇▇▇▇▆▇▇▇▇▇▇▇▆▇▇▇▆▇▇▇▇▇▇▇▇▇▇▆
wandb:          test_accuracy0.75 ███████████▃▅▇▅▆▅▅▆▆▅▅▆▅▆▅▅▆▅▄▅▅▅▆▅▅▆▆▆▁
wandb:                 test_auroc ▁▂▂▂▃▃▅▆█▆▄▂▄▄▄▄▄▄▃▃▃▄▄▄▃▃▃▃▃▄▄▄▄▄▄▄▄▄▄▃
wandb: test_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▄▁▅▃▄▆▄▅▆▅▆█▇▆▆▄▇▇▆▇▆▇█▇▇▇█▆▆▆▆▄
wandb:  test_balanced_accuracy0.5 ▄▄▄▃▃▄▇▄▅▂▅▆▃▄▃▄▄▁▃▁▁▅▄▃▄▄▃▄▂▄▅█▃▆▄▄▅▄▅▅
wandb: test_balanced_accuracy0.75 ▅▅▅▅▅▅▅▅▇▅▅▅▅▁▄▆▃▅▂▂▅▃▃▃▃▂▆▄▄▅▄█▅▅▅▇▃▄▅▂
wandb:         test_precision0.25 ▂▂▂▂▂▂▂▂▃▂▃▄▇▆▂▅▃▇█▆▄▁▄▅▅▆▂▂▄▅▇▇▆▆▆▅▅▅▆▅
wandb:          test_precision0.5 ▆▆▁▆▆▆▆▆▆▇▁▆▇▇▆▆▅█▆▅▆▆▄▆▆▆▇▇▇▅▇▆▇▅▆▇██▇▆
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁█▆▁▃▄▃▃▅▅▃▃▃▃▃▅▄▂▃▄▄▃▃▃▅▅▄▃▄
wandb:            test_recall0.25 ██████████▃▃▃▃▂▃▂▃▁▂▂▃▃▄▃▁▃▃▃▃▃▂▁▃▃▃▃▃▃▂
wandb:             test_recall0.5 ▁▁▆▃▁▇▁█▄▂▁▂▁▂▂▂▂▂▂▂▂▂▄▂▁▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▇▁▇▂▂▂▄█▂▇▇▂▅▂▂▂▇▄▂▂▄▅▂▂▂▂▄▄▄
wandb:                train_auroc ▁▂▂▂▃▃▂▃▄▅▆▆██████▆█████████████████████
wandb:                 train_loss ███████▇▇▇▂▁▁▁▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▃
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▅▂▄▄▆▆▆▇▆▅▅▅█▅▆▇▇▇▇▇▇███▇██▇▄▇
wandb:            val_accuracy0.5 ▁██▁▂█▇█▆▃▆▅█▇█▇▇▇▇▇▇▇▆▇▇▆▇▇▇▇▇▅▇▇▇▇▇▇█▆
wandb:           val_accuracy0.75 ▆▆▆▆▆▆▆▆▆▆▇▇██▇▄▂▇▃▄▅▃▄▂▃▃▃▃▃▁▄▂▂▅▃▃▃▃▃▄
wandb:                  val_auroc ▃█▆▆▆▇█▇▇▇▆▇▄▅▄▄▃▅▄▁▄▄▄▄▄▄▄▃▃▃▃▃▃▃▄▄▄▄▄▂
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▂▂▁▁▂▃▄▅▂▃▃▆▅▅▄▃▂▂▄▄▄▇▅▇▅█
wandb:   val_balanced_accuracy0.5 ▃▃▆▃▅▃▆▆▇███▆▆▅▄▄▄▄▁▅▄▃▄▄▄▄▃▄▄▆▄▄▄▄▄▆▄▄▂
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▃▅▄▄▄▃▆▆▄▅▁▂█▃▂▁▁▄▁▁▁▂▁▁▁▂▂▂▂▂▂▁
wandb:          val_precision0.25 ▄▄▄▄▄▄▄▄▄▄▄▄▄▅▄▅▄▄▄▃▄▄▃▅▅▅▃▅▃▅▅▄▄▅▆███▃▁
wandb:           val_precision0.5 ▄▄█▅▄▅▇▄▄▆▆▄▅▄▃▄▃▄▄▄▄▄▄▃▄▅▄▄▃▃▄▅▃▄▄▄▄▄▅▁
wandb:          val_precision0.75 ▁▁▁▁▁██▇▇▆▄▅▄▄▄▁▃▃▄▃▃▃▃▃▃▃▃▄▃▂▄▃▃▃▃▃▃▃▃▄
wandb:             val_recall0.25 ███████▄█▄▂▁▃▂▂▂▃▃▂▃▃▃▃▂▃▁▂▂▂▂▁▂▃▃▂▂▂▂▃▄
wandb:              val_recall0.5 █▁▁█▁▁█▇▂▆▆▅▄▅▃▂▂▂▂▁▂▂▂▂▂▂▂▃▃▂▂▄▂▃▂▂▂▂▂▂
wandb:             val_recall0.75 ▁▁▁▁▁▂▅▄▄▄▂▅▄▅▂▁▅▅▄▅▅▄▇▅▅▅▅▄▅▄▅▅▅▅▅▅▅█▇▄
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.67089
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.6962
wandb:                 test_auroc 0.53559
wandb: test_balanced_accuracy0.25 0.53178
wandb:  test_balanced_accuracy0.5 0.49068
wandb: test_balanced_accuracy0.75 0.4661
wandb:         test_precision0.25 0.3125
wandb:          test_precision0.5 0.22222
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.25
wandb:             test_recall0.5 0.1
wandb:            test_recall0.75 0
wandb:                train_auroc 0.99712
wandb:                 train_loss 0.28436
wandb:           val_accuracy0.25 0.64762
wandb:            val_accuracy0.5 0.69524
wandb:           val_accuracy0.75 0.74286
wandb:                  val_auroc 0.39727
wandb:  val_balanced_accuracy0.25 0.44328
wandb:   val_balanced_accuracy0.5 0.46203
wandb:  val_balanced_accuracy0.75 0.49367
wandb:          val_precision0.25 0.07692
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.03846
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_7_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/5nt0p2ms
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_7/wandb/run-20250618_140952-5nt0p2ms/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_7/wandb/run-20250618_142446-bao3n302
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_7_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/bao3n302
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▃▂▂▄█▆▆▆▇█▇▅▇▇▇▇▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           test_accuracy0.5 ▁█▄▄██▃▄▅▇▄▇▂▇█▇▇▇▇▇▇▆▇▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆
wandb:          test_accuracy0.75 ▇▇▇▇▇▇▇█▇▇▅▆▅▇█▆▆▄▆▆▆▁▆▅▅▅▄▃▃▃▂▂▂▅▅▃▂▂▂▂
wandb:                 test_auroc ▂▂▂▁▂▁▁▁▂▂▁▂▃▁▄▅▅▆▆▇▇▅▆▆▇▇▇▇▆▅▆▆██▆▅▅▅▅▅
wandb: test_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▂▂▁▃▁▆▇▇█▅▄▃▃▇▂▄▇▇█▆██▇▇▇▇▇█▇▇▇
wandb:  test_balanced_accuracy0.5 ▂▄▃▃▃▁▅▆▄▂▅▄▃▅▂▄▄▂▂▄▂▁▃▄▄▇▇▇▇▅▆▆▇█▆▇▇▇▁▆
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃▃▃▃▂▅▆▃▄▄▅▆▃▅▄▃▄▃▂▆▅█▇▇▇▆▆▄▂▁█▃▃▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▃▄▃▂▂▃▁▃▃▂▁▁▁▃▂▅▄▄▄▄▄▄▄▄
wandb:          test_precision0.5 ▁▁▁▁▁█▄▃▃█▄▅▆▅▅▄▅▅▅▃▄▃▃▄▄▃▃▄▅▅▅▅▅▅▄▅▅▄▄▃
wandb:         test_precision0.75 ▁▁▁▁▁█▃▁▁▁▁▁▁▁█▃▁▅▃▅▄▄▃▅▃▃▃▂▄▄▂▂▃▃▂▂▃▃▂▂
wandb:            test_recall0.25 ██████████▆▅▄▃▃▃▃▂▃▂▁▁▃▂▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:             test_recall0.5 ▁█▁▁▅▅▅▄▄▂▂▄▂▂▂▃▁▂▂▂▂▂▃▁▂▃▃▃▃▃▃▃▃▃▃▂▃▃▃▃
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▄▁▁▃▂▃▅▃▃▃▃▂▂▂▄▁▄▂▆▇█▃▆▇▄▄▄▃▃▅
wandb:                train_auroc ▂▁▁▂▂▂▃▄▃▃▄▄████████████████████████████
wandb:                 train_loss ████▇▇▇▇▆▄▃▃▂▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▇▆▇▆▇▆▇▆█▇█▇▇▆▆▇▇▇█▇▇▇▇▇▇
wandb:            val_accuracy0.5 █▁█▅▄█▄▆█▇▅▇▆▇▆▆▆▆▇▇▇▆▇▆▇▇▅▆▇▇▆▆▇▆▆▆▇▇▇▇
wandb:           val_accuracy0.75 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▇▇▃▃▃▃▃▅▂▅▅▄▁▃▃▄▃▃▃▃▃▃▃▃▃
wandb:                  val_auroc █████▇█▇▅▄▅▅▅▄▅▅▆▄▆▅▃▁▁▂▂▂▂▂▂▁▁▁▁▁▁▁▁▂▂▂
wandb:  val_balanced_accuracy0.25 ▅▅▅▅▅▅▅▅▅▅▅▄▆▆▄▅▄▅▅▂▄█▃▄▅▅▁▃▄▄▆▅▅▅▄▄▄▄▅▆
wandb:   val_balanced_accuracy0.5 ▃▃▆▆▃▆▅▂█▇▃▃▇▆▄▃▃▂▁▂▃▂▂▃▁▃▂▄▂▁▂▃▃▅▄▄▃▄▄▃
wandb:  val_balanced_accuracy0.75 ▃▃▆▅▆▇▅█▄▇▆▅▆▂▃▄▃▃▃▃▃▃▃▅▃▃▄▆▃▁▄▄▅▄▄▄▅▅▅▅
wandb:          val_precision0.25 ▅▅▅▅▅▅▅▅▅▅▅▅▅▅▂█▄▂▄▄▃▆▄▆█▄▁▄▂▂▄▂▄▃▃▃▃▃▃▅
wandb:           val_precision0.5 ▄▁▄▄▅▆▄▄█▇▄▅▄▄▅▄▄▃▄▄▄▄▄▄▄▄▄▅▄▄▄▃▄▄▄▅▅▅▅▅
wandb:          val_precision0.75 ▁▇▇▆▇▇█▇▆▆▃▇▃▁▃▄▃▃▃▄▅▄▃▃▃▃▄▄▃▃▄▄▄▄▄▃▄▄▄▄
wandb:             val_recall0.25 █████████████▇▄▃▂▃▂▂▂▁▃▁▂▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:              val_recall0.5 ▁█▁▁▆▃▄▃▄▇▂▃▂▂▂▂▁▂▂▂▄▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             val_recall0.75 ▁▁▁▁▁▁▄▁▄▃▃▅▄▄▄▄▄▃▅▃▄▂▃▅▃▅█▅▆▆▆▆▅▆▆▆▆▆▆▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.6962
wandb:           test_accuracy0.5 0.65823
wandb:          test_accuracy0.75 0.65823
wandb:                 test_auroc 0.56525
wandb: test_balanced_accuracy0.25 0.58178
wandb:  test_balanced_accuracy0.5 0.49025
wandb: test_balanced_accuracy0.75 0.47373
wandb:         test_precision0.25 0.38889
wandb:          test_precision0.5 0.23077
wandb:         test_precision0.75 0.18182
wandb:            test_recall0.25 0.35
wandb:             test_recall0.5 0.15
wandb:            test_recall0.75 0.1
wandb:                train_auroc 1
wandb:                 train_loss 0.00017
wandb:           val_accuracy0.25 0.66667
wandb:            val_accuracy0.5 0.68571
wandb:           val_accuracy0.75 0.70476
wandb:                  val_auroc 0.45351
wandb:  val_balanced_accuracy0.25 0.50755
wandb:   val_balanced_accuracy0.5 0.5202
wandb:  val_balanced_accuracy0.75 0.53286
wandb:          val_precision0.25 0.26316
wandb:           val_precision0.5 0.29412
wandb:          val_precision0.75 0.33333
wandb:             val_recall0.25 0.19231
wandb:              val_recall0.5 0.19231
wandb:             val_recall0.75 0.19231
wandb: 
wandb: 🚀 View run resnet18_2d_65_7_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/bao3n302
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_7/wandb/run-20250618_142446-bao3n302/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_7/execution_datetimes.json

**************************************************  Experiment 65 | Version 8 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 20, 1.0: 12}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 13, 1.0: 19}
    Batch label distribution: {0.0: 9, 1.0: 9}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 9, 1.0: 23}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 20, 1.0: 12}
    Batch label distribution: {0.0: 8, 1.0: 10}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 20, 1.0: 12}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 13, 1.0: 19}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 10, 1.0: 8}

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_8/wandb/run-20250618_144113-puicwk0k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_8_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/puicwk0k
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 282-284, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃█▅█▇▆▇▇▇█▇▇▇▇▇▇██████▇
wandb:           test_accuracy0.5 ▇▁▇▇█▇▅▆▄▄█▆▇▅█▆█▇▆▇▇▆▇▇▇▇▆▆█▆▇▇▇▆▇▆▆▇▇▇
wandb:          test_accuracy0.75 ▆▆▅▆▇▇▆▆▆▇█▆▇▆▆▄▃▂▄▂▅▃▃▄▂▄▄▄▄▄▃▆▃▃▄▃▄▁▄▃
wandb:                 test_auroc ▂▁▁▁▃▄▄▄▅▄▄▄▄▄▅▃▃▃▃▃▄▇▇▇▅▇█▇▇▅██▇█▇▇▇█▇█
wandb: test_balanced_accuracy0.25 ▄▄▄▄▄▂▄▄▄▄▄▄▂▄▄▃▄▃▂▁▃▄▄▄▆▇▆▅▇█▇▄█▇▇▇▆██▇
wandb:  test_balanced_accuracy0.5 ▃▁▃▁▂▄▂▂▆██▇▇▄▅▅▄▇▆▄▃▂▄▄▁▄▂▂▅▃▅▅▃▄▆▆▃▅▃▄
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▅▆▇▃▆▆▇▆▇▆▇▂█▆▃▅▁▄▂▃▃▃▃▆▃▃▆▃▅▃▁▆▄▇▄
wandb:         test_precision0.25 ▄▄▄▃▄▄▄▄▃▃▄▃▂▃▃▅▅▄▇▅█▇▁▆▅▄▃▅▆▆▆▂▆▆█▄█▇▆▆
wandb:          test_precision0.5 ▆▃▄▆▃▃▄▄▃▃█▄▄▄▄▄▄▁▃▃▄▄▁▄▄█▂▃▃▅▄▂▅▄▃▃▃▄▅▄
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁█▁▁▅████▃█▁▂▂▂▃▂▃▃▃▃▃▃▂▃▄▂▃▃▃▃▃▃
wandb:            test_recall0.25 ██████████████▇█▆▄▆▆▁▁▂▁▂▂▃▂▂▂▁▃▁▃▃▂▃▁▃▃
wandb:             test_recall0.5 ▁▁█▄▅▂▄▁▃▅▁▅▁▅▂▂▃▂▁▁▁▃▁▂▂▃▃▃▂▁▂▁▁▁▃▂▂▃▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▄▁▂▁▁▂▂▂▄▂▁▁▂▇▄▂▂▂▂▂▇▇▂█▂▂▇▄▅▇▂▄▂▇
wandb:                train_auroc ▁▄▃▃▃▅▄▅▄▄▄▅▅▅▄▆▆▇██████████████████████
wandb:                 train_loss █████████▇█▇▇▇▇▇▇▅▅▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▂▂▁▁▂▁▂▄▆▆▇▆▇▇▇█▇▆▇▇▇▇▇▇▇██▇▆
wandb:            val_accuracy0.5 ██▁▆▂▆▄▆▅▄▄▆▄▄▅▇▇▄▆▄▅▆██▆▇▇█▇██▆▇███▇█▇▇
wandb:           val_accuracy0.75 ▆▇██▇▁█▅▄▇▆▇▅█▇█▇▃▇▆▇▅▇▄▇▇▇▄▇▅█▅▂▂▇▅▅▆▅█
wandb:                  val_auroc ▁▃▃▄▄▄▄▄▄▄▄▄▄▄▄▅▅▆▇▇▇▇▇▇▇▇▇▇▇▇▇█████████
wandb:  val_balanced_accuracy0.25 ▁▁▁▃▁▁▁▁▁▁▂▂▁▂▆▃▆▇▅▅▅▅▆▅▅▃▇▅▆▅▅▆▇▅██▅▇█▇
wandb:   val_balanced_accuracy0.5 ▃▄▃▂▂▂▂▁▂▃▂▃▂▃▃▆▅▅▄▅▆▆▆▆▅▆▇▆▅▅▆▆▆▆▆▅▆▆█▇
wandb:  val_balanced_accuracy0.75 ▁▁▆▅▅▇▆▆▂▇▇▂▂▄▆▅▃▅▄▆▃▃▅▄▅▆▄█▅▅▄▆▆▄█▆▄▆▆█
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▄▃▄▂▆▃▃▆▂▃▃▄▄█▄▃█▆
wandb:           val_precision0.5 ▃▄▃▁▃▃▃▃▃▃▃▄▃▃▃▄▄▄▄▄▄▄▅▆▄▅█▃▅▅▃▃▄▄▅▅▅▅▅▅
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁█▆█▅▇▅▆▅█▃▆▃▃▅▅▅▄▄▄▄█▆▆▇▄▄▆▄▅▄▅
wandb:             val_recall0.25 █████▇███▇████▇▇▆▆▆▅▄▁▁▃▂▃▃▂▁▃▁▃▃▂▃▂▂▃▁▂
wandb:              val_recall0.5 ▁▇█▆▇▆▄▄▄▄▂▂▃▅▃▂▂▂▃▂▂▄▂▃▃▂▄▃▃▃▃▃▂▂▃▃▃▃▃▃
wandb:             val_recall0.75 ▁▁▁▂▅▅▅▅▅▂▅▅▅▅▅▅▂▅▅▅▅▅▅▅▅▅▄▅▃▅▅▄▅▅▅██▄▅█
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.67089
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.70886
wandb:                 test_auroc 0.5822
wandb: test_balanced_accuracy0.25 0.53178
wandb:  test_balanced_accuracy0.5 0.52373
wandb: test_balanced_accuracy0.75 0.4911
wandb:         test_precision0.25 0.3125
wandb:          test_precision0.5 0.30769
wandb:         test_precision0.75 0.2
wandb:            test_recall0.25 0.25
wandb:             test_recall0.5 0.2
wandb:            test_recall0.75 0.05
wandb:                train_auroc 0.99991
wandb:                 train_loss 0.02534
wandb:           val_accuracy0.25 0.72381
wandb:            val_accuracy0.5 0.72381
wandb:           val_accuracy0.75 0.78095
wandb:                  val_auroc 0.63145
wandb:  val_balanced_accuracy0.25 0.58423
wandb:   val_balanced_accuracy0.5 0.55842
wandb:  val_balanced_accuracy0.75 0.57059
wandb:          val_precision0.25 0.42105
wandb:           val_precision0.5 0.4
wandb:          val_precision0.75 0.8
wandb:             val_recall0.25 0.30769
wandb:              val_recall0.5 0.23077
wandb:             val_recall0.75 0.15385
wandb: 
wandb: 🚀 View run resnet18_2d_65_8_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/puicwk0k
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_8/wandb/run-20250618_144113-puicwk0k/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_8/wandb/run-20250618_145752-5tzy6cta
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_8_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/5tzy6cta
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▅▆██▇███▇▇█████▇█████▇▇▇▇████
wandb:           test_accuracy0.5 ▁▁██▇█▁█▇▇▇▇▄▇▇▇▇▇▆▆▇▆▆▆▆▆▆▇▇▇▆▆▆▇▆▆▆▆▆▆
wandb:          test_accuracy0.75 ████████████▇▆▂▃▅▅▇▆▄▅▅▃▅▂▆▆▆▄▂▁▄▅▃▂▂▂▂▅
wandb:                 test_auroc ▁▄▃▄▄▅▅█▇▇▇▇▅▄▆▆▇▆▆▇▆▇▆▇▆▇▇▇▆▆▆▆▆▆▆▆▆▆▆▆
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▄▃▆▄▄▄▄▃▄▃▂▅▆▄▄▆▃▁▁█▄▅▄▄▅▄▄▃
wandb:  test_balanced_accuracy0.5 ▄▄▄▄▄▄█▇▃▅▄▇▃█▅▃▂▂▃▄▂▃▅▁▂▂▄▁▄▂▄▂▃▄▄▁▄▃▁▁
wandb: test_balanced_accuracy0.75 ▆▆▆▆▆▆█▇▆▇▆▇▆▄▃▂▂▅▅▅▄▅▅▂▂▂▅▅▅▅▄▄▃▄▃▅▃▄▁▄
wandb:         test_precision0.25 ▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▆▆▅▆▆▅▅▅█▇▆█▆▃▇▆▇▇▆▇▅▆▇▆▁
wandb:          test_precision0.5 ▄▁▄▃▄▄▄▅██▅▄▄▄▁▄▃▅▄▃▂▄▂▄▄▃▃▄▃▃▄▄▄▃▂▃▄▅▃▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁█▁▁█▁▁▁▄▂▃▄▃▃▄▅▂▃▄▄▃▃▅▃▃▃▄▃▃▃▂▂▄
wandb:            test_recall0.25 ██████████████▆▃▃▂▂▁▃▂▂▁▃▁▃▂▃▁▂▂▃▃▃▃▃▃▃▂
wandb:             test_recall0.5 █▁█▁▄▃▃▃▁▃▂▁▃▁▂▂▁▂▁▂▂▃▂▂▂▂▂▂▂▁▃▄▂▂▂▁▁▁▂▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▄▁▂▁▅▁▄▁▂▂▂▂▂▂▇▄▄▂▇▂▂▄▂▅▄█▂▂▂▄▂▂
wandb:                train_auroc ▃▂▁▂▂▃▃▃▃▃▄▅▅▅▆▇████████████████████████
wandb:                 train_loss █████████████▇▇▇▇▇▆▆▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▅▆▆▇▇▇██▇██▇▇▅██▆███▇▅▇▇
wandb:            val_accuracy0.5 ▁▁██▅▇▁█▆▇▇▇▇███▇▇▆▇▇▇▇▇▇▇█▅██▇█▇▇▇█▇▇██
wandb:           val_accuracy0.75 ▆▆▆▆▆▆▆▆▆██▆▇▇█▆▄▆▁▃▃▅▅▆▅▆▆▆▆▆▆▁▄▅▃▆▆▆▆▆
wandb:                  val_auroc █████▇▆▆▅▅▅▄▁▄▂▃▃▃▁▂▃▄▃▃▃▃▄▄▄▄▃▄▅▄▂▃▄▂▃▃
wandb:  val_balanced_accuracy0.25 ▅▅▅▅▅▅▅▅▅▅▅▃▅▄▁▂▂█▃▄▆▆▄▅▅▇▆▇▇▇▅▆▄▇▇▆▇█▆▇
wandb:   val_balanced_accuracy0.5 ▂▂▂▂▃█▆█▃▆▆▇▆▅▃▂▅▂▂▂▁▂▃▂▂▅▃▃▄▄▅▂▆▆▁▃▆▆▅▅
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▄▇▅▃▃▃▁█▄▂▁▁▁▂▃▃▃▂▄▄▇▄▄▇▅▁▃▃▂█▆▆▇▃
wandb:          val_precision0.25 ▂▂▂▂▂▂▂▂▂▂▂▂▂▃▁▂▂▂▁▃▃▂▂▂▃▄▃▃▄▆▅▃▅▆▄▄▇▇█▅
wandb:           val_precision0.5 ▂▄▂▂█▂▃▃▃▃▂▃▁▂▂▂▃▂▂▂▂▄▃▄▂▃▄▃▄▂▂▃▄▂▃▂▃▃▃▄
wandb:          val_precision0.75 ▁▁▁▁▁█▁██▅▆▆██▄▄▃▃▅▃▄▃▄▄▃▃▅▄▅▅▅▅▅▂▄▄▅▆▄▄
wandb:             val_recall0.25 ████████████▇▆▄▇▅▄▂▂▂▂▂▄▁▂▂▃▅▁▃▁▃▄▃▃▃▃▃▃
wandb:              val_recall0.5 ▁█▁▁▂▆▆▃▄▆▅▃▃▃▄▂▂▂▁▂▂▁▂▃▂▃▂▂▃▂▂▃▂▂▃▃▃▃▂▂
wandb:             val_recall0.75 ▁▁▁▁▁▃▃▃▇▃▃▃▃▅▂▂▂▅▅▄▅▄▄▄▄█▃▇▄▄▇▄▄█▇▅▂▃█▃
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.63291
wandb:           test_accuracy0.5 0.64557
wandb:          test_accuracy0.75 0.68354
wandb:                 test_auroc 0.53305
wandb: test_balanced_accuracy0.25 0.45678
wandb:  test_balanced_accuracy0.5 0.44873
wandb: test_balanced_accuracy0.75 0.47415
wandb:         test_precision0.25 0.15385
wandb:          test_precision0.5 0.1
wandb:         test_precision0.75 0.14286
wandb:            test_recall0.25 0.1
wandb:             test_recall0.5 0.05
wandb:            test_recall0.75 0.05
wandb:                train_auroc 1
wandb:                 train_loss 0.02318
wandb:           val_accuracy0.25 0.7619
wandb:            val_accuracy0.5 0.74286
wandb:           val_accuracy0.75 0.74286
wandb:                  val_auroc 0.48734
wandb:  val_balanced_accuracy0.25 0.58374
wandb:   val_balanced_accuracy0.5 0.54528
wandb:  val_balanced_accuracy0.75 0.51947
wandb:          val_precision0.25 0.54545
wandb:           val_precision0.5 0.44444
wandb:          val_precision0.75 0.4
wandb:             val_recall0.25 0.23077
wandb:              val_recall0.5 0.15385
wandb:             val_recall0.75 0.07692
wandb: 
wandb: 🚀 View run resnet18_2d_65_8_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/5tzy6cta
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_8/wandb/run-20250618_145752-5tzy6cta/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_8/wandb/run-20250618_151416-rqs5biem
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_8_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/rqs5biem
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▃▇▃▇▇█▇▇█████████▇██████
wandb:           test_accuracy0.5 █▄█▅▄▁▃█▃█▆▃▄▆▇▄█▃▇▅▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          test_accuracy0.75 ▇▇▇▇▇▇█▇▇▇▇▇▆▇█▅█▇▂▇▅▃▅▁▂▁▂▅▂▃▂▃▃▂▂▂▁▁▂▃
wandb:                 test_auroc ▂▂▂▂▂▂▁▁▂▂▂▂▂▂▃▅▆██▇▇▇▆▆▆▆▆▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb: test_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▄▄▄▄▄▁▄▂▆▃▂▇█▄▇▄▅▄▅▇▅▅▆▆▆▆▆▆▆▄▆▆
wandb:  test_balanced_accuracy0.5 ▄▇▅▄▄▁▆▆▂▃▄▂▆▆▂▆█▆▃█▃▆▄▄▅▅▄▆▃▆▄▅▅▄▆▆▃▄▆▄
wandb: test_balanced_accuracy0.75 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▄▂▇█▅▄▃▄▃▃▃▃▃▄▂▂▃▂▃▃▃▂▁▂▂
wandb:         test_precision0.25 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁█▆▆▅▇▆▂▆▁▆▃▄▃▄▄▆▆▄▆▆▆▆▆▆▄
wandb:          test_precision0.5 ▁▂▃▃▂▃█▃▃▃▃▅▃▃▃▃▃▃▅▃▃▃▃▄▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁█▁▁▅▄▅▅▃▃▆▅▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:            test_recall0.25 ██████████████▆▅▃▃▃▃▃▂▂▃▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁█▁▆▁▆▃▅▃▅▃▁▅▄▄▅▃▃▃▂▂▃▃▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▄▁▁▁▃▃▂▃▂▂█▂▃▃▃▃▃▅▃▃▃▅▃▃▄▃▃▃▃
wandb:                train_auroc ▁▂▂▂▁▂▃▃▄▃▅▅▄▄▄▆▇▇██████████████████████
wandb:                 train_loss ████████▇▇▇▇▇▄▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▃▄▆▇▅████▇▇█████████▇▇██
wandb:            val_accuracy0.5 ▆▄███▅▅▂▁▃▂▇▆▁▅▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_accuracy0.75 ▇▇▇▇▇▇▇▇▇██▇█▁▆▆▆▇▆▆▆▆▆▆▆▅▅▆▆▅▆▆▆▆▆▆▅▅▅▆
wandb:                  val_auroc █▇▆▆▆▆▇▆▃▅▄▂▂▁▂▄▄▃▄▃▆▄▆▇▆▇▇▆▇▆▇▇▇▇▇▇▇▇▇▇
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▂▃▃▅▅▄▄▇▇▇▅▇▇█▇▇▇▇▆▆███▆▇
wandb:   val_balanced_accuracy0.5 ▆▆▁▃▁▆▂▅▅▅▃▂▂▅▃▃▃▄▄▇▆▂██▁▆█▆▆▆▇▆▇▆▅▇▇▆▅▇
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▂▆▄▄▄▂▄▆▂▅▃▂▃▆▁▃▅▃▂██▃█▇▇▇▇▃██▆▂▃▂▅▂
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▃▂█▂▁▅▇▇▆▇▇▆▇▆▇▇█▇▇▆██
wandb:           val_precision0.5 ▁▅▁▄▄█▇▅▄▄▄▄▄▄▄▅▄▄▅▅▅▃▅▄▆▆▆▄▆▆▆▅▆▆▆▆▆▆▆▅
wandb:          val_precision0.75 ▁▁▁▁▁▆█▁▇▆▇▇█▅▆▄▄▆▃▇▄▅▅▅▄▅▄▄▃▅▄▅▄▅▄▅▅▄▄▄
wandb:             val_recall0.25 █████████▇██▇▆▅▁▁▃▁▂▃▃▂▂▂▂▁▂▁▁▁▂▁▂▂▂▂▂▂▁
wandb:              val_recall0.5 █▁▁██▇▆▄▅▅▆▆▆▆▃▄▅▇▄▄▅▃▅▁▃▅▄▃▂▄▄▄▄▄▄▅▄▄▄▄
wandb:             val_recall0.75 ▁▁▁▁▁▁▃▃▂▃▃▃▁▄▄▃▅▃▃▃█▄▃▆▇▃▅▃▄▅▃▃▇▆▃▇▇▅▄▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.67089
wandb:           test_accuracy0.5 0.6962
wandb:          test_accuracy0.75 0.68354
wandb:                 test_auroc 0.53475
wandb: test_balanced_accuracy0.25 0.51525
wandb:  test_balanced_accuracy0.5 0.5322
wandb: test_balanced_accuracy0.75 0.5072
wandb:         test_precision0.25 0.28571
wandb:          test_precision0.5 0.33333
wandb:         test_precision0.75 0.27273
wandb:            test_recall0.25 0.2
wandb:             test_recall0.5 0.2
wandb:            test_recall0.75 0.15
wandb:                train_auroc 1.0
wandb:                 train_loss 0.00055
wandb:           val_accuracy0.25 0.70476
wandb:            val_accuracy0.5 0.69524
wandb:           val_accuracy0.75 0.71429
wandb:                  val_auroc 0.60443
wandb:  val_balanced_accuracy0.25 0.62317
wandb:   val_balanced_accuracy0.5 0.59104
wandb:  val_balanced_accuracy0.75 0.6037
wandb:          val_precision0.25 0.41379
wandb:           val_precision0.5 0.38462
wandb:          val_precision0.75 0.41667
wandb:             val_recall0.25 0.46154
wandb:              val_recall0.5 0.38462
wandb:             val_recall0.75 0.38462
wandb: 
wandb: 🚀 View run resnet18_2d_65_8_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/rqs5biem
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_8/wandb/run-20250618_151416-rqs5biem/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_8/execution_datetimes.json

**************************************************  Experiment 65 | Version 9 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 30, 1.0: 34}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 10, 1.0: 8}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 32, 1.0: 32}
    Batch label distribution: {0.0: 38, 1.0: 26}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 9, 1.0: 9}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 34, 1.0: 30}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 23, 1.0: 41}
    Batch label distribution: {0.0: 11, 1.0: 7}

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_9/wandb/run-20250618_153024-80puww3b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_9_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/80puww3b
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading output.log
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▁▁▇▇▇▇▇▇▇▇▅▇▇█▆▇▇▇▇▇▅█
wandb:           test_accuracy0.5 ▁▇█▅▇▇▄▅▆▅▅▅▅▆▄▆▅▃▇▇▇▇▆█▇▇▇█▇▇▇▇█▇██▇██▇
wandb:          test_accuracy0.75 ▇▇▇▇▇▇▇▇▇▇▇█▇██▇███▁▃▆▇▃█▇▆▆▅▃▆▂▇▆▄▇▆█▆▇
wandb:                 test_auroc ▁▂▂▂▃▃▃▃▃▃▃▃▃▃▄▅▆▅▆▇▇▇▇██▇▇██▇█████▇█▆██
wandb: test_balanced_accuracy0.25 ▃▃▃▃▂▃▃▁▂▃▂▃▃▃▂▆▃▃▂▆▅██▄▆▄▄▄▆█▄█▄▆▃█▅▄▅▇
wandb:  test_balanced_accuracy0.5 ▃▄▁▃▁▅▃▄▄▄█▆▃█▃▃█▄▅█▆▃▆▄▂▄▄▄▅▃▅▆▆▂▄▆▆▄▄▅
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▃▁▃▁▃▁▃▄▃▅▅▁▇▃▃▃▂▃▂▂▁▁▂▃█▃▄▄▂▂▅▁▂▅▅
wandb:         test_precision0.25 ▂▂▂▂▂▂▂▂▂▂▁▁▁▁▂▂▂▂▁▁▂▅▆▂▅▂▅▄▄█▅▅▅█▅▅▅▅▇▅
wandb:          test_precision0.5 ▃▄▄▁▁▄▄▅▆▄▅▄▅█▄▅▄▄▅▃▄▅▃▄▅▅▄▆▅▅▅▅▄▅▄▆▅▄▅▅
wandb:         test_precision0.75 ▁▁▁▁▃▅▁▁▁█▅█▅███▅█▁▁▃█▅▃▄▃▃▃▅▃▃▄▃▄▃▃▃▃█▃
wandb:            test_recall0.25 ███████████▇▇▇▇████▄▄▄▃▃▅▁▃▃▄▂▁▂▅▄▂▃▂▁▂▃
wandb:             test_recall0.5 ▁█▅▆▆▂▅▄▂▅▃▂▇▂▇▅▃▃▇▂▁▅▅▂▁▁▁▄▅▂▁▄▅▁▃▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▂▃▂▂▂▂▂▂▃▆▃▃▂▂▅▂▃▂▁▂▇▂▅▂▂▂▂▆█▂▂▂▂▂▂
wandb:                train_auroc ▁▂▂▃▂▃▃▂▂▂▃▃▂▃▃▅▅▅▅▆████████████████████
wandb:                 train_loss █████▇▇▇▇▇▇▇▇▇▇▇▇▆▆▆▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▃▂▁▁▄▂▄▁▅▁▆▅▅▆▇▇▇▆▇▆█▅██▇▇█▇▇
wandb:            val_accuracy0.5 █▁▂██▅▆▄▄▆▄▆▅▅▆█▇▅▇▇▇█▇█▇▇▇▇█▆▇▇█▇█▆▅█▇▇
wandb:           val_accuracy0.75 ▆▆▆▆▇███▇▅▇▆███▇██▆▇▁▆▇▆██▇▅▇▆▇▇█▆▇███▄▆
wandb:                  val_auroc ▁▂▃▄▄▅▄▅▅▄▄▅▅▅▅▇▇█▆▆▆▇▆▆▅▆▆▆▆▆█▆▆▆█▇▇▆▇▇
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▅▄▄▄▄▄▄▃▆▄▆▅▁▅▇▆▅▄▆▃▆▅▄▄█▆▆▇█▅▅▄
wandb:   val_balanced_accuracy0.5 ▃▂▁▃▃▃▄▄▂▄▄▅▂▁▅▁▄▇▄▇▆▅█▅▆▇▄█▄█▇▇▇▇▅▇▇▃▅▇
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▇▄▇▃▇▇██▆▇▆▆▇▅▃▃▅▇▇▇▇▆▄▄▆▆▇▇▇▆▆▇▆▃▆
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▃▁▁▃▄▁▃▁▆▁▁█▂▄▄▂▃
wandb:           val_precision0.5 ▁▃▃▁▁▃▂▃▃▃▃▂▃▃▃▂▃▂▃▃▃▄▃▃▃▄▄▃▃▃▅▅█▄▆▃▅█▄▅
wandb:          val_precision0.75 ▁▁▁▁▁▁▁██▄▄▆█▃▅█▆██▃██▅██▅▇▃▅▅▇██▅▅█▅▄██
wandb:             val_recall0.25 █████████▇▇▇▅▄▅▃▂▂▂▁▃▂▁▃▂▁▂▂▁▂▂▂▃▂▁▂▂▂▁▂
wandb:              val_recall0.5 ▁▂▃█▁▅▂▄▃▂▃▃▄▃▃▃▃▃▆▆▂▃▃▂▃▃▂▂▃▂▃▂▃▃▂▂▂▂▂▂
wandb:             val_recall0.75 ▁▁▆▂▅▆▆▆▅▆▅▄▄▂▆▆▆▆▆▅█▆▇▆▅▆▅▅▆▅▆▅▃▆▄▇▇▆▇▄
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.70886
wandb:           test_accuracy0.5 0.72152
wandb:          test_accuracy0.75 0.73418
wandb:                 test_auroc 0.62458
wandb: test_balanced_accuracy0.25 0.54068
wandb:  test_balanced_accuracy0.5 0.49958
wandb: test_balanced_accuracy0.75 0.50805
wandb:         test_precision0.25 0.36364
wandb:          test_precision0.5 0.25
wandb:         test_precision0.75 0.33333
wandb:            test_recall0.25 0.2
wandb:             test_recall0.5 0.05
wandb:            test_recall0.75 0.05
wandb:                train_auroc 0.99926
wandb:                 train_loss 0.14
wandb:           val_accuracy0.25 0.74286
wandb:            val_accuracy0.5 0.7619
wandb:           val_accuracy0.75 0.7619
wandb:                  val_auroc 0.5409
wandb:  val_balanced_accuracy0.25 0.57108
wandb:   val_balanced_accuracy0.5 0.57084
wandb:  val_balanced_accuracy0.75 0.55794
wandb:          val_precision0.25 0.46154
wandb:           val_precision0.5 0.55556
wandb:          val_precision0.75 0.57143
wandb:             val_recall0.25 0.23077
wandb:              val_recall0.5 0.19231
wandb:             val_recall0.75 0.15385
wandb: 
wandb: 🚀 View run resnet18_2d_65_9_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/80puww3b
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_9/wandb/run-20250618_153024-80puww3b/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_9/wandb/run-20250618_154958-tforf3u8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_9_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/tforf3u8
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▄▄▂▆▆▆▇▇▇▇▇▇▇▇▇▇▆██▆▇▇
wandb:           test_accuracy0.5 ▁▁▁█▁▆█▇█▅▇▆▇▇██▇▆▅▇▇▇▆▇▇█▇▇▇█▇▇▇▇▇█▇▆▇▇
wandb:          test_accuracy0.75 ▇▇▇▇▇▇▇█▇█▇▇▇▇█▇▇▆▇▆▇▅▃▇▆▆▆▆▇▇▅▅▇▅▅▄▇▇▁▅
wandb:                 test_auroc ▂▁▁▁▂▅▄▅▄▅▅▅▆▅█▇▆▇███▇▇▇▇█▇▇▇▇▇▇▇▇▇▇▇▇▆▅
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▆█▅▁▅▅▄▆▂▃█▄▂▇▅▃▇▄▃▄▇█
wandb:  test_balanced_accuracy0.5 ▃▃▅▃▂▁▄▅▆▂▄▅▃▆▃█▃▇▅▄▅▆▅▆▃▂▄▂▄▃▅▄▅▆▅▅▅▄▃▃
wandb: test_balanced_accuracy0.75 ▂▂▂▂▂▂▂▂▂▂▂▅▅▂▅▂▂▂▃▃▂▆▃▇▇▆█▇▆▂▇▆▆▁▁▅▇█▆▃
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▁▂▂▂▂▂▂▅▂▃▂▂▄▅▅▁▃▃█▃▂▃▁▄▁
wandb:          test_precision0.5 ▃▁▃▁▃▃▂▃▆█▃█▃▃▂▃▆▄▅▃▃▃▃▃▅▄▅▆▃▃▅▆▃▆▃▃▅▃▃▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▆▁▁▆▁▁▅▁▁▁▅▆▆▅▅█▅█▅▄▅▆▁▅▆▄▆█▄▄
wandb:            test_recall0.25 █████████████▇█▇▃▇▅▂▂▄▂▂▂▂▃▂▃▂▂▂▂▂▁▃▂▃▁▂
wandb:             test_recall0.5 █▇▆▁▂▁▆▂▆▃▅▂▂▅▃▅▂▄▂▃▂▂▂▂▂▂▂▂▂▂▂▂▁▂▂▂▂▂▁▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▂▁▁▁▂▂▂▇▃▂▃▃▃▅▂▅▁▃▃▂▅▃▅▁▃▃▃▂▃▅▅█
wandb:                train_auroc ▃▂▁▂▂▂▃▂▂▃▄▅▆▆▇▆▇▇▇▆████████████████████
wandb:                 train_loss ██████████▇▇▆▇▄▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▂▂▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▆▆▆▆▆▆▇▇▇█▇▇█▇▇█▇▇▇█▇
wandb:            val_accuracy0.5 ▁▁▁▁█▅▂██▇▆▇▇▇█▇▄▆▇█▇▇▇▇▇▇▇█▇█▇▇█▇██▇▇▇▇
wandb:           val_accuracy0.75 ▆▆▆▆▆▆▆▆▇▇█▇▇▇▅█▆▅▇▅▄▆▇▄▄▅▆▄▅▅▅▅▇▄▄▅▃▆▁▆
wandb:                  val_auroc ▇▇███████▇▆▇▆▆▄▆▂▄▄▂▂▃▂▃▂▁▂▁▃▂▂▁▃▂▁▁▂▂▂▅
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▂▂▂▆▁▃▂▄▆▄▇▄▅▃▅▆▅▄▆▆▆▇▆▅▄█▆▆▆▆▅
wandb:   val_balanced_accuracy0.5 ▃▁▂▃█▇█▇▅▇▇▇▆▇█▅▆▁▃▄▂▁▂▄▃▅▅▄▄▅▃▂▄▅▄▃▅▄▄▃
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▂▂▃▄▄▃▇▆▃▇▆█▇▄▅▆▁▄▃▃▅▂▄▃▂▃▆▃▆▆▆▆▇█
wandb:          val_precision0.25 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▂▂▂▂▄▂▃▅▂▃▆▄▄▇▄▃▆▄▄█▇█▄▆
wandb:           val_precision0.5 ▃▃▁▁█▃▃▆▃▄▄▄▄▄▄▄▃▄▃▃▃▃▃▄▄▃▄▄▄▄▄▄▄▄▃▅▄▄▃▄
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁█▆▆▇▆▆▄███▄▃▆▄▄▄▄▄▄▃▄▄▄▃▄▄▃▄█▄
wandb:             val_recall0.25 █████████████▅▆▂▇▃▂▃▃▂▂▂▃▂▂▃▃▂▂▂▁▂▁▃▂▂▃▃
wandb:              val_recall0.5 ▁████▂▂▅▃▃▆▄▃▅▃▃▂▃▃▃▄▅▃▄▃▄▂▃▃▂▃▃▂▃▃▃▂▃▃▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▂▃▄▃▃▆▇▆▅▅▄▅▅▅▅█▄▄▇▇▅█▆▄█▆▇▅▇▇▇▆▂
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.64557
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.6962
wandb:                 test_auroc 0.57966
wandb: test_balanced_accuracy0.25 0.56441
wandb:  test_balanced_accuracy0.5 0.54025
wandb: test_balanced_accuracy0.75 0.5322
wandb:         test_precision0.25 0.33333
wandb:          test_precision0.5 0.33333
wandb:         test_precision0.75 0.33333
wandb:            test_recall0.25 0.4
wandb:             test_recall0.5 0.25
wandb:            test_recall0.75 0.2
wandb:                train_auroc 1
wandb:                 train_loss 0.10294
wandb:           val_accuracy0.25 0.65714
wandb:            val_accuracy0.5 0.70476
wandb:           val_accuracy0.75 0.71429
wandb:                  val_auroc 0.51655
wandb:  val_balanced_accuracy0.25 0.53992
wandb:   val_balanced_accuracy0.5 0.57157
wandb:  val_balanced_accuracy0.75 0.5779
wandb:          val_precision0.25 0.30769
wandb:           val_precision0.5 0.38095
wandb:          val_precision0.75 0.4
wandb:             val_recall0.25 0.30769
wandb:              val_recall0.5 0.30769
wandb:             val_recall0.75 0.30769
wandb: 
wandb: 🚀 View run resnet18_2d_65_9_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/tforf3u8
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_9/wandb/run-20250618_154958-tforf3u8/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_9/wandb/run-20250618_161048-82klf15h
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_9_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/82klf15h
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▂▂▃▂▃▂▄▆▇▇▇▆▇██▇▇█▇▇▇█
wandb:           test_accuracy0.5 ▁▁▂▇▁▅▇▇▄▅▇▇▃▇▆▆▇▇█▇██▇▆▇▇▇▇█▆▇▇▇▇▅▇▇▇▇▇
wandb:          test_accuracy0.75 ▇▇▇▇▇▇▇▇▇▇█▇▇▇▇█▇▆▇▇▇▇▅▁▇▆▆▃▂▆▅▅▆▅▆▆▅▅▆▅
wandb:                 test_auroc ▂▂▂▂▂▂▂▃▂▁▂▂▁▁▃▇█▇▇██▇▆▆▆▆▇▆▆▅▆▆▆▆▆▆▆▆▆▆
wandb: test_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▄▄▇▁███▆▅▆▆▃▄▄██▆▄▆▆▆▄█▅▅▅▆▅▅▅█▆
wandb:  test_balanced_accuracy0.5 ▄▄▄▄▁▅▆▁▆▆▅▆▃▆▆▂▆▆██▇▇▄▇██▇▆▆▇▆▆▆▆▆▆▆▆▆▆
wandb: test_balanced_accuracy0.75 ▂▂▂▃▂▅▂▂▂▂▂▂▂▅▅▃▆▅▃█▃▁▂▄▄▂▃▂▅▇▂▂▆▅▅▃▄▅▄▄
wandb:         test_precision0.25 ▂▂▂▂▂▂▂▂▂▂▂▁▂▂▂▁▇▁▂▄▄▄▄▃▃▇█▂▂▂▃▁▁▃▄▂▄▂▄▂
wandb:          test_precision0.5 ▁▁▁▁▁▁▂▁▂▁▂▂▂▁▂█▃▂▂▃▁▄▂▂▂▁▂▂▃▂▃▁▂▂▂▂▂▂▂▂
wandb:         test_precision0.75 ▁▁▁▁▁▁██▁▁▁██▁█▆▁▅▃█▄▅▅▄▃▄▄▄▃▄▄▄▄▄▄▄▄▄▃▃
wandb:            test_recall0.25 ██████████▇█▅█▇▃▄▄▃▃▃▂▃▁▄▃▂▂▂▃▂▂▂▂▂▂▂▂▂▂
wandb:             test_recall0.5 ▁█▅▃▄▅▃▃▆▇▃▇▄▄▃▆▂▅▅▅▄▄▄▄▄▄▃▂▃▄▄▃▄▄▄▄▄▄▃▄
wandb:            test_recall0.75 ▁▁▁▁▁▁▂▂▁▁▁▄▁▃▂█▆▅▃▂▃▂▅▅▅▅▅▄▅▆▅▅▅▅▅▅▅▅▄▅
wandb:                train_auroc ▁▃▃▃▄▃▃▄▃▅▆▆▇▇▇█████████████████████████
wandb:                 train_loss ████▇▇▇▇▇▇▇▇▇▇▆▆▅▄▄▃▂▂▂▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▄▄▇▂▆▆▆▆▆▆▇▇██▇▇█▇█▇▇█▇▇█
wandb:            val_accuracy0.5 █▁▇▆▁▇██▃▄█▄▄██▃▇▄▆▆▇▆▇▇▇▇▅▇▆▇▇▇▆▇▆▇▆▆▇▇
wandb:           val_accuracy0.75 ▆▆▆▆▆▆▆▆▆▆▆▇▇▆▇█▇▇▇▇▇▆▃▂▁▁▃▃▄▄▃▁▃▃▂▃▃▂▂▂
wandb:                  val_auroc ▆████▇█▇▅▆▄▅▄▅▃▃▃▄▆▅▃▃▂▅▄▄▄▅▁▂▃▄▃▃▃▃▃▃▃▂
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▃▂▁▄▃▃▅▆▅▄▅▃█▅▃▄█▅▆▃▅▄█▄
wandb:   val_balanced_accuracy0.5 ▂▂▃▅▆▆█▇▅▅▆▃▄▆▂▃▁▄▄▃▂▃▃▃▃▁▂▅▅▅▃▃▃▂▂▂▂▃▅▂
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▃▅▆▆▅▇▇█▆▂▄▃▃▃▃▃▃▃▃▂▂▂▃▃▃▃▃▃▂▂▂▃
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▃▂▂▃▅▄▆▅▆▂▅▄▇▂▆▃▇▇█
wandb:           val_precision0.5 ▃▃▃▁▃█▃▄▄▄▃▅▃▃▅▅▃▅▃▄▃▄▃▃▃▃▃▃▃▃▃▃▃▃▄▃▃▃▃▃
wandb:          val_precision0.75 ▁▁▁▁▁▅▆▇▆▆▇█▆▇▆▇▇█▇▄▄▄▄▄▄▄▄▄▄▃▄▄▄▄▄▃▄▃▃▄
wandb:             val_recall0.25 ███████████████████▇▆▇▂▁▇▂▁▄▂▂▂▁▄▁▃▃▂▃▂▂
wandb:              val_recall0.5 ▅▁▁▇█▅▅▅▆▃▃▅▄▂▆▅▃▃▅▆▅▃▃▃▃▄▄▃▅▅▃▅▃▂▄▂▂▄▂▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▂▂▃▃▂▂▃▃▃▃▂▂█▄▆▃▃▁▁▃▂▄▃▃▃▄▃▃▃▃▃
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.65823
wandb:           test_accuracy0.5 0.6962
wandb:          test_accuracy0.75 0.70886
wandb:                 test_auroc 0.5839
wandb: test_balanced_accuracy0.25 0.52331
wandb:  test_balanced_accuracy0.5 0.54873
wandb: test_balanced_accuracy0.75 0.54068
wandb:         test_precision0.25 0.29412
wandb:          test_precision0.5 0.35714
wandb:         test_precision0.75 0.36364
wandb:            test_recall0.25 0.25
wandb:             test_recall0.5 0.25
wandb:            test_recall0.75 0.2
wandb:                train_auroc 1
wandb:                 train_loss 0.00091
wandb:           val_accuracy0.25 0.65714
wandb:            val_accuracy0.5 0.67619
wandb:           val_accuracy0.75 0.69524
wandb:                  val_auroc 0.54844
wandb:  val_balanced_accuracy0.25 0.52702
wandb:   val_balanced_accuracy0.5 0.51388
wandb:  val_balanced_accuracy0.75 0.52653
wandb:          val_precision0.25 0.29167
wandb:           val_precision0.5 0.27778
wandb:          val_precision0.75 0.3125
wandb:             val_recall0.25 0.26923
wandb:              val_recall0.5 0.19231
wandb:             val_recall0.75 0.19231
wandb: 
wandb: 🚀 View run resnet18_2d_65_9_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/82klf15h
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_9/wandb/run-20250618_161048-82klf15h/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_9/execution_datetimes.json

**************************************************  Experiment 65 | Version 10 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 4, 1.0: 12}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {1.0: 2}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 4, 1.0: 12}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 1, 1.0: 1}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 4, 1.0: 12}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 2}

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_10/wandb/run-20250618_163125-rmi6fb58
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_10_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/rmi6fb58
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▂▃▃▇▅▇▆▇▃▇▅▆▆▇█▇
wandb:           test_accuracy0.5 █▅▁▁▁▇▇▃▇▅▆▇▇▇▆▇▄█▆▇█▇▇█▇▇▄▇▇▆▆█▇▇▆▆▆▇▆▇
wandb:          test_accuracy0.75 ▅▅▅▅▅▅▇▇▇▇▇▇▇▇▇▇▇▅▇▇▅▇██▄██▂█▇▄▇▇▁▇▅▇▇▄▅
wandb:                 test_auroc ▁▂▂▁▂▂▂▂▃▃▃▃▄▄▃▄▃▄▄▄▅▅▅▅▆▅▅▇▆▇▇▇▇▇▇▇█▇▇█
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▂▂▃▃▃▃▂▃▃▂▁▃▂▅▂▅▅▆▄▅▆█▆▄▃▅▄▅▄▅▇▆▆
wandb:  test_balanced_accuracy0.5 ▃▁▁▁▄▅▃▂▇▇▇█▃▅▅▇█▆▇█▅█▇▇▇▆▆▆█▅█▅▄▅▅▄▄▅▅▅
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▄▁▁▄▄▄▄▄▁▆▄▄██▄▇▄█▁██▄▄▄▄▄▄▇▄
wandb:         test_precision0.25 ▂▂▂▂▂▂▂▂▂▂▂▁▁▁▂▂▂▁▁▂▁▁▂▁▂▃▃▄▄▅▆▅▅▃█▆█▂▅█
wandb:          test_precision0.5 ▁▁▄▅▅▄▆▄▆▄▄▄▅▆▄▇▆▆▆▅▅▅▇▆▅▆▆▇▇▅▆▆▅█▇▅▅▅▇▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁█████▅█████▁█▁████▆▅██▅█▅███▄▅▅▄▅
wandb:            test_recall0.25 ██████▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▇▇█▆▆▆▆█▄▁▄▄▆▅▂▆▃
wandb:             test_recall0.5 ▁█▁▆▇▅▅▅▂▄▃▅▄▄▄▅▄▃▄▄▄▃▄▃▇▃▅▃▂▄▂▅▃▅▃▃▃▂▂▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▅▅▁▅▁▁▅▅▅▅▁▅▅██████████▅▅▅▅▅▅▅▅▅▅
wandb:                train_auroc ▁▁▁▁▁▂▂▄▃▂▃▂▂▃▁▂▂▃▂▃▄▄▄▄▄▅▆▇▇▇█▇██▇█████
wandb:                 train_loss █████████▇▇▇▇▇▇▇▇▇▇▇▆▇▇▇▇▆▅▅▅▄▃▃▃▂▁▂▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▂▂▁▂▁▁▁▁▁▂▂▂▅▅▁▁▆▃▆▆▅▆▅▄▅▆▅▆▆▅█▇▄▆▆█
wandb:            val_accuracy0.5 ▁▇█▃▄▃▄▅▅▄▅▅▅▅▂▁▆▄▅▁▆▄▇▂▆▄▃▇▄▄▄▆▅▆▆█▇▇██
wandb:           val_accuracy0.75 ▂▂▂▂▂▃▃▆▇▃▇█▅▆▅▆▅▅▅▅▅▂▂▅▅▁▁▅▃▃▃▂▃▆▃▆▆▃▆▆
wandb:                  val_auroc ▁▁▁▂▃▂▃▃▃▃▃▃▃▃▃▃▃▃▃▄▄▅▅▅▅▅▅▅▇▇▇▇▇█▇█▆▇▇█
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▃▂▂▃▃▃▃▂▂▃▃▂▃▃▃▂▁▂▃▃▃▅▄▄▅▃▅▄▄▅▄▇▄▆▄█
wandb:   val_balanced_accuracy0.5 ▅▅▄▁▃▅▃▄▄▅▄▂▅▂▄▅▄▆▂▃▆▃▅▄▇▄▆▅▇▇▅▆▇▇▇▇▇▇▇█
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▄▆█▇█▇███▄▄█▇▆▆▆▅▇▆▇▅▇▇▅▅▅▆▅█████▇▅
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▃▁▂▁▂▂▂▂▃▁▁▂▃▂█▅▂▆
wandb:           val_precision0.5 ▄▁▃▃▄▃▄▄▄▄▄▄▄▃▃▄▃▄▄▃▄▃▄▄▄▅▄▅▄▄▅▄▅▄▄██▅▇▅
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁██▆██████▆▆▆███▇█▅▅▆▅▅▅▄▅▅▅▆▅▅▆▅
wandb:             val_recall0.25 ██████████▇▇▇█▇▇▇▇▇▇█▆▆▇▆▆▅▅▄▂▄▄▂▂▃▂▂▃▂▁
wandb:              val_recall0.5 ▁█▁▅█▃▅▁▃▂▂▂▂▃▃▃▁▂▂▂▂▃▁▂▆▂▁▁▃▃▂▁▂▂▂▁▂▁▃▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▂▂▄▅▂▇▂█████▇▇█▇▄█▇▇▇▅▅▇▇▅█▅█▅█▅▅▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.60759
wandb:           test_accuracy0.5 0.70886
wandb:          test_accuracy0.75 0.75949
wandb:                 test_auroc 0.62797
wandb: test_balanced_accuracy0.25 0.48941
wandb:  test_balanced_accuracy0.5 0.4911
wandb: test_balanced_accuracy0.75 0.525
wandb:         test_precision0.25 0.2381
wandb:          test_precision0.5 0.2
wandb:         test_precision0.75 1
wandb:            test_recall0.25 0.25
wandb:             test_recall0.5 0.05
wandb:            test_recall0.75 0.05
wandb:                train_auroc 0.99882
wandb:                 train_loss 0.21013
wandb:           val_accuracy0.25 0.69524
wandb:            val_accuracy0.5 0.7619
wandb:           val_accuracy0.75 0.7619
wandb:                  val_auroc 0.59737
wandb:  val_balanced_accuracy0.25 0.57814
wandb:   val_balanced_accuracy0.5 0.57084
wandb:  val_balanced_accuracy0.75 0.54503
wandb:          val_precision0.25 0.375
wandb:           val_precision0.5 0.55556
wandb:          val_precision0.75 0.6
wandb:             val_recall0.25 0.34615
wandb:              val_recall0.5 0.19231
wandb:             val_recall0.75 0.11538
wandb: 
wandb: 🚀 View run resnet18_2d_65_10_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/rmi6fb58
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_10/wandb/run-20250618_163125-rmi6fb58/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_10/wandb/run-20250618_172147-2vw6hrn4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_10_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/2vw6hrn4
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 855-857, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▁▂▄▅▆▆▇▆▆▇▇▇▇████▇█
wandb:           test_accuracy0.5 ▂█▂▆▁▄▇▇▅▇▆▇▇█▄█▇█▆▇▇▅▅▅▅▆▆▅▆▆▆▆▆▆▆▆▆▆▅▆
wandb:          test_accuracy0.75 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆▆▇█▅▆▇▂▁▂▇▄▆▂▆▅▆▆
wandb:                 test_auroc ▂▂▂▁▁▁▁▂▂▂▄▄▄▄▄▃▄▆▅▅█▇█▇▅▆▆▆▆▆▆▆▆▆▆▆▇▆▆▇
wandb: test_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▅▇▇█▆▂▆▆██▅▅▃▃▅▁▆▄▃
wandb:  test_balanced_accuracy0.5 ▅▅▅▅▂▇▁▃▆▁▄▆▅▇▇█▇▇▅█▇▄▆▇▅▃▄▃▆▅▆▃▄▅▄▃▄▄▄▃
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▆▃▃▃▃▃▃▃▃▃▃▃▃▃▄▆█▂▅▆▄▁▃▅▅▆▃▄▆▃
wandb:         test_precision0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▅▅▅▅▅▅▆▇█▆▄▄▇▅▇▇▄█▁▁▆▅
wandb:          test_precision0.5 ▁▃▄▅▄▄▅▄▄▆▅▇▆▆▆▅▃▆▄█▄▄▅▅▄▄▃▃▃▃▄▂▃▃▄▃▄▄▃▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁██▁▁▁▁▁█▁▃▅▄▃▅▃▂▃▃▃▅▃▅▂▂
wandb:            test_recall0.25 ████████████████████▇▆▆▄▆▆▇▅▅▄▄▂▃▄▁▁▂▂▁▂
wandb:             test_recall0.5 ▁█▅▃▇▆▅▅▃▃▃▃▂▃▃▂▂▄▃▃▂▃▃▂▆▂▂▃▂▂▄▂▂▂▂▂▂▂▃▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▃▁▁▁▁▁▃▁▁▁▁▁▁▆▆▆▆▁▆▆▆▆▆▃▆█▃▆▆▆
wandb:                train_auroc ▃▁▁▁▂▂▂▂▃▃▃▂▄▂▂▃▃▃▃▅▅▄▅▆▅▇▇▇▇█▇█████████
wandb:                 train_loss ██████████▇▇▇█▇▇▇▆▅▆▅▄▄▄▅▃▃▃▂▂▂▁▁▁▁▂▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▃▄▄▃▅▅▆▆▅▅▅▆▇█
wandb:            val_accuracy0.5 ▁▄▂▆█▆▅▅█▆▇█▇▇▇▆█▇▇▅▇▅▇▇▇▆▆▇▆▅▇▆▇▇▇▆▇▇▆▇
wandb:           val_accuracy0.75 ▅▅▅▅▅▅▅▆▆▆▅▅▇▇▆█▆▆▆▅▅▆▅▅▅▄▄▃▃▂▃▂▂▃▂▂▂▂▃▁
wandb:                  val_auroc ▄▆▇▇▇████▇▅▅▅▃▃▃▂▃▃▃▂▂▂▂▂▁▂▂▁▁▂▁▁▂▂▁▃▂▂▁
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▄▃▃▁▅▂▄▅▂▃▄▆▃▄▄▇▅▆▃██
wandb:   val_balanced_accuracy0.5 ▁▁▁▂██▅▃▅▄▆▅▄▆▆▆▅▅▅▆▄▅▄▃▃▄▂▄▃▄▄▃▃▃▄▁▄▅▄▄
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▂▃▄▆▄▆▄▄▆▇▄█▃▅▄█▅▅▅▅▅▁▄▅▁▄▁▁▄▁▂▂
wandb:          val_precision0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▃▁▃▃▃▂▃▄▃▃▂▄▁▄▇█▃█▇█
wandb:           val_precision0.5 ▃▄▃▂▃▂▅▆▅▅▇▅▅▅▅▅▅▆█▆▅▄▅▃▄▃▃▄▅▃▃▄▁▂▇▅▆▃▅▅
wandb:          val_precision0.75 ▁▁▁▁▁▁█▆▆▆▆▆▆▅▅▅▅▆▅▅▅▅▅▅▄▅▄▃▄▄▄▃▄▄▄▄▃▃▄▄
wandb:             val_recall0.25 ██████████████████████▇▅▃▅▂▄▃▃▃▁▁▁▁▁▁▂▁▁
wandb:              val_recall0.5 ▁██▁▃▄▆▃▃▃▃▄▄▄▃▃▃▃▃▄▃▃▃▃▄▃▃▃▃▃▃▃▃▂▃▃▃▃▃▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▂▃▃▃▃▄▄▅▅▅▄█▄▃▆▃▆▃▅▆▃▆▅▆▆▃▃▆█▆▄▃▃
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.60759
wandb:           test_accuracy0.5 0.63291
wandb:          test_accuracy0.75 0.70886
wandb:                 test_auroc 0.57966
wandb: test_balanced_accuracy0.25 0.52246
wandb:  test_balanced_accuracy0.5 0.48983
wandb: test_balanced_accuracy0.75 0.50763
wandb:         test_precision0.25 0.28
wandb:          test_precision0.5 0.23529
wandb:         test_precision0.75 0.28571
wandb:            test_recall0.25 0.35
wandb:             test_recall0.5 0.2
wandb:            test_recall0.75 0.1
wandb:                train_auroc 0.99954
wandb:                 train_loss 0.12706
wandb:           val_accuracy0.25 0.68571
wandb:            val_accuracy0.5 0.69524
wandb:           val_accuracy0.75 0.71429
wandb:                  val_auroc 0.49757
wandb:  val_balanced_accuracy0.25 0.55891
wandb:   val_balanced_accuracy0.5 0.55234
wandb:  val_balanced_accuracy0.75 0.50049
wandb:          val_precision0.25 0.34783
wandb:           val_precision0.5 0.35
wandb:          val_precision0.75 0.25
wandb:             val_recall0.25 0.30769
wandb:              val_recall0.5 0.26923
wandb:             val_recall0.75 0.07692
wandb: 
wandb: 🚀 View run resnet18_2d_65_10_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/2vw6hrn4
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_10/wandb/run-20250618_172147-2vw6hrn4/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_10/wandb/run-20250618_180939-x5dvbxi2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_10_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/x5dvbxi2
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▂▅▆▇▆▅▄▆▇▇████
wandb:           test_accuracy0.5 ▁▁██▇▄▃▃▇▆▇▄▆██▇▇▆▇▇▇▅▅▇▇▇▇▇▇▇▇██▇▇█▇▇██
wandb:          test_accuracy0.75 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆█▆▆▆▆▆▆▃▁▆▁▆▁▆▁▆▆▃▁▁▁▁▃▁▁▁
wandb:                 test_auroc ▁▁▁▁▁▂▂▂▂▂▂▂▃▃▃▄▃▃▄▄▅▅▆▆▆▆▇▇▇▇▇▇▇▇███▇██
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▁▂▃▁▃▅▄▄▄▄▅▄▆▇▆▆▆██▅▅▂▃▃▅▄▆▇
wandb:  test_balanced_accuracy0.5 ▁▄▄▅▃▇▃▆▅▄▃▅▆▅▆▅▆█▆▅▇▂▇▆▆▇▂▆▃▃▃▆▆▃▃▅▂▃▃▃
wandb: test_balanced_accuracy0.75 ▄▄▄▄▄▄▄▄▄▄▄█▄▄▄▄▄▃▄▂▁▁▄▁▄▃▁▃▅▁▁▂▃▂▃▁▅▃▄▄
wandb:         test_precision0.25 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▅▆▆▆▇▇▇▇▇███▇▇▆▁▇▅
wandb:          test_precision0.5 ▁▄▅▅▅▅▅▆▆▆▆▅▆▆▆▆▆▆█▇▅▇▅▆█▁▆▆▆▅▅▅▆▄▄▄▅▆▄▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▆▆▁▁▁▁▁▅▁▃▄▆▁▁▄▁▁▅▄
wandb:            test_recall0.25 ████████████████▆▆▆▆█▅▆▆▄▃▃▃▃▃▅▄▄▂▂▃▂▁▁▂
wandb:             test_recall0.5 ▁▂█▆▅▄▄▇▄▆▆▇▄▁▇▅▄▄▇▂▂▄▅▄▂▃▂▂▂▂▂▂▂▂▂▂▃▂▂▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▃▁▁▁▁▁▁▃▃▁▁▃▁▁▁
wandb:                train_auroc ▁▂▂▂▁▂▂▄▂▂▁▂▃▃▄▃▃▄▅▅▅▅▇▆▆▇▇▇█▇██████████
wandb:                 train_loss █████████▇▇▇▇▇▇▇▇▇▆▇▆▅▄▅▄▄▃▄▃▃▂▂▂▂▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▄▂▃▆▃▅▆▇▇█▇█▇██
wandb:            val_accuracy0.5 █▇▂█▆▁▅▅▅▆▃▆▃▆▆▄▄▄▃▅▆▃▇▃▅▅▃▃▅▄▆▅▆▅█▇█▇▆█
wandb:           val_accuracy0.75 ▆▆▆▆▆▆▆▆▆▆▇▇▆▆▇▇▇▇▇▇█▇▇▇▇▃▄▇▆▅▁▆▇▆▆▅▄▄▅▅
wandb:                  val_auroc █▇█████▇▇▇▇▇▆▆▆▆▆▆▅▄▅▅▅▅▃▂▃▃▃▂▂▁▂▁▁▁▃▁▁▃
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▁▄▄▄▅▄▇▅▂▃▅▆▅▇▄▆▆▃▄█▄▄▆▄▄
wandb:   val_balanced_accuracy0.5 ▁▁▃██▆▅▃▄▇▄▆▅▂▆▁█▄█▃▂▅▃▃▁▂▂▄▁▂▂▂▂▃▂▂▃▄▂▄
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▄▄▄▄▄▅▆▄▅█▆▅▅▄▅▅▄▅▄▄▄▅▂▄▂▄▄▃▃
wandb:          val_precision0.25 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▅▄▄▅▇▂▅▅▅▇▂▇▄▆▁▄▅█▅▄▅▆
wandb:           val_precision0.5 ▆▄▅▆▁▆▅▆▇█▆▅▅▅▆▅▆▆▅▆▅▅▅▅▅▅▇▄▆▄▄▅▅▄▅▄▅▅▅▄
wandb:          val_precision0.75 ▁▁▁▁▁▅██████▆█▆█████▇█▆▅▅▄▅▆▅▇▆▅▅▅▆▄▅▄▅▅
wandb:             val_recall0.25 ████████████████▇█▆▆█▆▆▅▅▆▆▇▄▄▆▄▆▂▂▃▄▂▃▁
wandb:              val_recall0.5 ▄▂▇█▄▄▆▅█▆▅▅▆▆▇▅▄▅▇█▄▅▄▅▆▅▅▁▁▂▁▁▄▁▁▁▂▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▂▂▅▅▅▅██▅▅▇██▅██▇▇▅▇█▇▇▇▇▇▅▇▅▇▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.63291
wandb:           test_accuracy0.5 0.6962
wandb:          test_accuracy0.75 0.72152
wandb:                 test_auroc 0.60932
wandb: test_balanced_accuracy0.25 0.48983
wandb:  test_balanced_accuracy0.5 0.48263
wandb: test_balanced_accuracy0.75 0.49958
wandb:         test_precision0.25 0.23529
wandb:          test_precision0.5 0.16667
wandb:         test_precision0.75 0.25
wandb:            test_recall0.25 0.2
wandb:             test_recall0.5 0.05
wandb:            test_recall0.75 0.05
wandb:                train_auroc 1
wandb:                 train_loss 0.09628
wandb:           val_accuracy0.25 0.60952
wandb:            val_accuracy0.5 0.67619
wandb:           val_accuracy0.75 0.73333
wandb:                  val_auroc 0.54017
wandb:  val_balanced_accuracy0.25 0.53408
wandb:   val_balanced_accuracy0.5 0.51388
wandb:  val_balanced_accuracy0.75 0.53895
wandb:          val_precision0.25 0.28571
wandb:           val_precision0.5 0.27778
wandb:          val_precision0.75 0.4
wandb:             val_recall0.25 0.38462
wandb:              val_recall0.5 0.19231
wandb:             val_recall0.75 0.15385
wandb: 
wandb: 🚀 View run resnet18_2d_65_10_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/x5dvbxi2
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_10/wandb/run-20250618_180939-x5dvbxi2/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_10/execution_datetimes.json

**************************************************  Experiment 65 | Version 11 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 7}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 12, 1.0: 20}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 8, 1.0: 10}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 13, 1.0: 19}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 10, 1.0: 8}

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_11/wandb/run-20250618_185851-oyzbq3bg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_11_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/oyzbq3bg
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▂▁▁▁▂▁▁▁▂▁▁▂▁▂▁▁▁▁▆▄▄▁▁▃▂▃▄▃█▆█
wandb:           test_accuracy0.5 █▁▁▆▃▄▄▃▄▃▇▆▇▇▄▃▆▅▇▅▆▆▇▅▄▇█▇▇▅▇▆▆▆▆▇▇▇▇▇
wandb:          test_accuracy0.75 ▅▅▅▅▅▅▅▅▅▅▆▅▆▆▆▆▆▆▆▆███▅█▅████▃▁▆▅▆▆▁▃▆▃
wandb:                 test_auroc ▂▁▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▃▃▄▄▄▄▄▅▅▅▆▆▆▆▆▇▇▇▇███
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▂▃▃▂▂▂▂▁▁▁▂▁▂▁▂▃▁▄▁▂▂▃▃▄▇▅▆▆▆▇█▇▇
wandb:  test_balanced_accuracy0.5 ▃▂▃▄▄▁▆▄▃▂▃▂▂▅▄▅▆▅▅▄▅█▅█▇▇██▇▆▅██▅▆▅▅▆▆▇
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▄▄▄▃▄▄▄▄▄▄█▇▄▁▇▇▄▇▇▁▄▄▄▁▄▂▄▄▄▃
wandb:         test_precision0.25 ▃▃▃▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▃▂▁▂▂▃▂▂▃▄▅█▄▅█
wandb:          test_precision0.5 ▁▅▅▄▆▅▅▅▆▅▅▆▅▅▇▅▅▇▆▅▅▅▆▇▆▅▅█▅▇▆▆▅▆▆▆▆▆▅▇
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁█████▅█▅█████▆████▁██▁▁▄▅▃▃█▂█
wandb:            test_recall0.25 █████▇▇▇▆▆▆▆▆▆▆▆▆▅▆▆▆▆▆▆▆▆▆▅▇▅█▇▃▃▁▂▄▂▁▂
wandb:             test_recall0.5 ▁▆█▆▆▇▃▆▆▆▅▅▅▄▆▅▅▆▄▄▆█▆▄▃▅▇▄▆▆▆▃▅▆▅▅▅▅▅▄
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅▅▅▅▅▅▅█▅█▁▅███▅██▅▅▅▅▅▅▅
wandb:                train_auroc ▁▁▃▃▃▃▄▄▄▃▃▄▄▄▄▄▄▄▄▅▅▅▆▅▅▇▇▆▇██▇████████
wandb:                 train_loss ███████▇▇▇▇▇▇▇▇▇▇▇▇▆▆▆▆▅▆▆▅▅▆▆▄▄▄▃▃▃▂▂▂▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▂▂▂▂▂▂▂▁▂▂▂▂▂▂▂▄▂▂▃▆▄▆▄▃▅▃▆▄█▇█▆▅█
wandb:            val_accuracy0.5 ▂▂▁▃▃▄▃▃▅▆▃▅▅▅▃▂▃▂▂▄▆▄▃▂▄▆▆▅▆▆▇██▆▇▆██▇▆
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▃▃▃▃██▃▆█▅█▅▆▅▃▃▃▃▆▃▅▅▅▃▃▅▁▃▃▅▃▅
wandb:                  val_auroc ▁▃▄▄▄▄▅▄▄▄▄▄▅▅▅▅▅▅▅▅▅▅▆▆▆▇▆▇▇▇███████▇▇▇
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▃▂▂▂▂▂▂▁▂▂▂▂▂▁▂▁█▅▃█▃▅▄▆▆▅▄▇▆▁▅
wandb:   val_balanced_accuracy0.5 ▅▃▅▅▂▇▆▁▃▅▂▅▅▃▃▂▅▃▅▆▃▂▅▆▂▃▅▆▄▆▅▅▇▆▆▆▇▆▆█
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▄▄▄▃▃▃▆▇▆▄█▇▇▆▇▇▃▄▇▅▅▄▄▆▅▆▅▆▅▆▅▆▇▇
wandb:          val_precision0.25 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▂▂▂▁▂▂▅▃▂▂▂▂▆▁▆▆▆█▆▄▆
wandb:           val_precision0.5 ▂▃▃▁▃▃▂▅▂▂▁▁▂▃▂▂▂▁▂▂▃▃▂▃▂▄▃▄▅▃▄▄▇▄█▄▅▄▄▆
wandb:          val_precision0.75 ▁▁▁▁▁▁▁███████▆█▆███▆█▅▆▅▆▅▆▆▅▅▅▅▅▅▇▅▆▇▆
wandb:             val_recall0.25 ████████████▇█▇▆▇▇█▇▆██▆▇▆██▆▆▆▅▆▆▅▃█▄▁▃
wandb:              val_recall0.5 ▁▅█▇▂█▆▃▄▇▇▇▅▆▃▄▃▃▄▄▄▄▃▃▃▇▃▄▃▃▄▄▂▂▂▂▄▂▃▄
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▂▄▇▂▅█▇▇█▇█▇███▇██▇▇█▇▇▇▇▅▇▇██▇▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.50633
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.73418
wandb:                 test_auroc 0.62288
wandb: test_balanced_accuracy0.25 0.57034
wandb:  test_balanced_accuracy0.5 0.55678
wandb: test_balanced_accuracy0.75 0.50805
wandb:         test_precision0.25 0.29787
wandb:          test_precision0.5 0.35294
wandb:         test_precision0.75 0.33333
wandb:            test_recall0.25 0.7
wandb:             test_recall0.5 0.3
wandb:            test_recall0.75 0.05
wandb:                train_auroc 0.99509
wandb:                 train_loss 0.47181
wandb:           val_accuracy0.25 0.44762
wandb:            val_accuracy0.5 0.67619
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.56475
wandb:  val_balanced_accuracy0.25 0.49099
wandb:   val_balanced_accuracy0.5 0.53968
wandb:  val_balanced_accuracy0.75 0.56451
wandb:          val_precision0.25 0.24194
wandb:           val_precision0.5 0.31818
wandb:          val_precision0.75 0.5
wandb:             val_recall0.25 0.57692
wandb:              val_recall0.5 0.26923
wandb:             val_recall0.75 0.19231
wandb: 
wandb: 🚀 View run resnet18_2d_65_11_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/oyzbq3bg
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_11/wandb/run-20250618_185851-oyzbq3bg/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_11/wandb/run-20250618_195416-940pru0p
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_11_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/940pru0p
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁█▁▁▁▂▁▁▇▂███▆▅▄▅▆▂▂▂▂▇▃▅▅▇▅▂▇█▆▄▄▆▃▄▅▆▅
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▆▁▅▇▇█▇▆▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▆▅▅▅▅▅▅▅▅▅▄▅▄▄▄▄▅
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▄▁▄▆▄▅▅▆▆▁▂▆▅▅▂▂▂▃▅▅▄▆▃▇▆▁▃▂▄▇▇▅▄▇█▅▃▆▄▇
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▃▃▁▃▃▃▃▃▃▃▃▃▅▄▄▃▃▃▃█▃▃▃▃▃▃▃▅▃▃▅▅▄▃▃▃▃▃▃▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ██▇▁▁▁█▇█▃▄▆▆▂▆▆▆▅▁▆▆▇▂▂▆▄▄▅▆▆▃▆▅▃▃▃▆▅▅▃
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▂▇▄▅▅▄█▄▅▅▅▃▇█▄█▃▅▄▆▆▅▂▃▅▄▅▅▆▅▅█▆█▅▇▄▃▄▁
wandb:                 train_loss █▆▆▆▅▆▅▅▆▅▅▅▅▄▅▅▄▄▃▅▅▃▅▅▅▄▄▄▄▂▄▅▄▄▄▂▁▃▃▂
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁█▆▂▂▃▄▆█▅▄▂██▅▅▄▆█▅▄▃▃▄▄▄▅▅▅▄█▄▄▄█▅█▅▅▄
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▄▃▂▅▄▄▃▁▂▄▃▃▃▂▂▄▄▃▂▃▂▂▂▂▂▄▄▄▄▅▆██▅▄▆▆▆▆▆
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▄▂▆▁▁▃▄▁▇▇▇▇▄▆▅▇▃▄▄▇█▇▅▇▅█▆▇▄▄▄▆▆▅▇█▆▆
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁█▁▁▁▂▂▁▂▄▂▂▂▂▂▂▂▁▂▂▃▄▂▂▂▂▂▂▂▂▃▃▂▂▂▂▂▂▂▂
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ████▇█▂▆█▁███▁▆██▆▆▄█▅▄▆▂▄▆▆▇▃▁▃▆▂▅▅▇▇▇▄
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.51899
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.49661
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.51271
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.26316
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.5
wandb:            test_recall0.75 0
wandb:                train_auroc 0.64779
wandb:                 train_loss 2.01793
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.53333
wandb:           val_accuracy0.75 0.7619
wandb:                  val_auroc 0.69182
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.58666
wandb:  val_balanced_accuracy0.75 0.51923
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.30508
wandb:          val_precision0.75 1
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.69231
wandb:             val_recall0.75 0.03846
wandb: 
wandb: 🚀 View run resnet18_2d_65_11_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/940pru0p
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_11/wandb/run-20250618_195416-940pru0p/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_11/wandb/run-20250618_200606-nuyr1u3l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_11_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/nuyr1u3l
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: uploading history steps 995-999, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▂▂▁▁▃▂▇▄▅▄█▅█
wandb:           test_accuracy0.5 ▁▁▇▅▃▇▃▇▅▇▅▅▅▆▆▇▅█▇▇▇▆▇▇███▆▇▇▆█▆▇▇▆████
wandb:          test_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▆▃▃▃▃█▃▆▃▃▃▃█▃▃▃▃▃▁▆▃▃▃▃▁▁
wandb:                 test_auroc ▁▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▂▂▂▃▃▃▄▄▅▅▅▆▆█████
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▄▃▄▄▁█▄▇▇
wandb:  test_balanced_accuracy0.5 ▃▄▄▅▃▁▁▄▃▄▃▁▄▂▁▂▅▂▄▆▃▄▅▄▅▅▅▅▂▂▇█▆▆▇▇▇▇▄█
wandb: test_balanced_accuracy0.75 ▂▂▂▂▂▂▂▂▅▂▂▂▂▅▂▂▅▂▅▂▅▂▅▂▂▅▅█▂▂▆▅▂▆▂▂▁▄▄▂
wandb:         test_precision0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▄▂▁█▂▂█▄▆▆▅▆
wandb:          test_precision0.5 ▃▃▃█▄▃▂▄▃▄▄▄▃▃▄▄▃▃▃▃▃▃▃▅▃▃▃▄▄▄▅▄▃▅▄▅▄▁▃▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁█▁▁▁▁▁▁▁▁▁█▁▁▆█▁▆▁▁▁▅▆▅
wandb:            test_recall0.25 ███████████████████████████████▆▆▆▆▅▆▆█▁
wandb:             test_recall0.5 ▇▃██▅▃▃▃▃▃▃▃▃▃▃▃▃▁▃▃▃▃▃▄▂▄▄▁▅▂▅▆▅▃▄▃▅▃▃▄
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁▁▁▅▁▁▅▅▁▁▁▁▁█▁▁▁▁▁▅
wandb:                train_auroc ▂▁▂▂▂▂▂▃▂▂▂▂▃▃▃▂▂▃▄▃▃▃▅▄▃▃▃▅▅▅▅▄▆▆▇█▇███
wandb:                 train_loss ████████▇▇▇▇▇▇█▇▇▇▇▆▇▇▆▆▆▇▆▅▅▅▄▄▄▄▃▂▂▂▂▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▃▁▃▃▆▅▅▄▇▇█
wandb:            val_accuracy0.5 ▁▁█▆▆▆█▃▃▄▇▅▇▇▆▅▇▇▅▆▄▇▆▇▆▅▆▅▆▄█▆▅▆▆▇▆▅▇▆
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▃▁▁▃▆▆▃▃▃▆▆▃▆▆▆▃▃▃█▆▆▆▁▃▁▃▃▆
wandb:                  val_auroc ▇▇▇██▇█▇▇█▇▇▇▇▇▆▆▆▆▄▄▃▄▂▂▁▂▁▂▃▂▂▃▄▄▄▆▄▅▅
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▂▃▃▁▄▃▇▃▆▆▅▇▆█
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▆▃▃▃▃█▆▆▅█▅▅▇▄▆▃▂▃▄▅▂▂▂▃▂▄▂▁▂▃▃▄▂▂▃
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▃▄▄▄▆▅▅▅▅▅▅▄▆▅▆▅▅█▅▇▆▅▅▆
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▄▃██
wandb:           val_precision0.5 ▁▁▁▃█▄▃▃▄▄▃▃▃▅▃▂▂█▃▃▂▅▆▁▁▆▂▁▂▂▁▂▁▂▂▂▂▁▁▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁█▅▆▅▆▆▆▆▇▆▆▆▅▇▆▅▅▆▅▅▅▆▅▆▅▅▄▄
wandb:             val_recall0.25 ████████████████████████████▇▇██▆█▆▅▄█▁▆
wandb:              val_recall0.5 █▆▁▄▅▆▇▆▅▆▅▅▅▅▄▄▅▄▅▄▃▃▄▄▃▃▃▄▃▅▃▃▃▄▃▅▃▃▄▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▂▃▃▃▄▄▅▄▅▅▅▆▅▆▅▅▆▆▅█▆▇▇▇▇▇▇▆▇▃
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.60759
wandb:           test_accuracy0.5 0.75949
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.62966
wandb: test_balanced_accuracy0.25 0.55551
wandb:  test_balanced_accuracy0.5 0.57458
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.31034
wandb:          test_precision0.5 0.57143
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.45
wandb:             test_recall0.5 0.2
wandb:            test_recall0.75 0
wandb:                train_auroc 0.96333
wandb:                 train_loss 0.85198
wandb:           val_accuracy0.25 0.57143
wandb:            val_accuracy0.5 0.68571
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.55526
wandb:  val_balanced_accuracy0.25 0.52167
wandb:   val_balanced_accuracy0.5 0.53311
wandb:  val_balanced_accuracy0.75 0.5258
wandb:          val_precision0.25 0.26829
wandb:           val_precision0.5 0.31579
wandb:          val_precision0.75 0.5
wandb:             val_recall0.25 0.42308
wandb:              val_recall0.5 0.23077
wandb:             val_recall0.75 0.07692
wandb: 
wandb: 🚀 View run resnet18_2d_65_11_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/nuyr1u3l
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_11/wandb/run-20250618_200606-nuyr1u3l/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_11/execution_datetimes.json

**************************************************  Experiment 65 | Version 12 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 30, 1.0: 34}
    Batch label distribution: {0.0: 24, 1.0: 40}
    Batch label distribution: {0.0: 25, 1.0: 39}
    Batch label distribution: {0.0: 9, 1.0: 9}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 34, 1.0: 30}
    Batch label distribution: {0.0: 30, 1.0: 34}
    Batch label distribution: {0.0: 36, 1.0: 28}
    Batch label distribution: {0.0: 8, 1.0: 10}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 30, 1.0: 34}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 10, 1.0: 8}

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_12/wandb/run-20250618_210117-t5dgbsq2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_12_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/t5dgbsq2
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁████▁
wandb:           test_accuracy0.5 ▁▁▇▃██▇▆▄▄▄▃▃▃▃▄▄▆▇▅▅▇▅▅▃▅▅▄▇▇▇▇▅▇█▄▄▅▆▇
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁█▁██▁▁▁████
wandb:                 test_auroc █▃▁▂▂▂▃▃▂▃▃▃▂▂▂▃▃▃▃▃▃▂▃▄▅▅▆▇▆▇▇▇▇▇▇▇▇▇▇▇
wandb: test_balanced_accuracy0.25 ██████████████████████████████▃▃███▃▅▅▅▁
wandb:  test_balanced_accuracy0.5 ▃▂▆▄▂▁▄▂▇▄▄▃▆▄▅▅▁▆▅▂▆▄▅▁▄▄▆▆█▄▇▃▆█▃▃▇███
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁█▁█
wandb:         test_precision0.25 ████████████████████████████████▄▄▃▃▃▃▄▁
wandb:          test_precision0.5 ▅▆▅▅▁▁▁▁▆▅▇▇▅▅▅▆▇▅▅▆▅▅▆█▆▅▆█▇▇▅█▆▅▅▅▅▅█▇
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁██▁▁▁█▁█▁█
wandb:            test_recall0.25 ████████████████████████████▃█▃▃▃▃▃▁▁▁▁▃
wandb:             test_recall0.5 ▇█▇▁▃▄▅▅▃▆▃▆▃▄▄▃▃▆▁▃▃▃▃▃▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁███▁▁████████
wandb:                train_auroc ▁▁▂▄▆▅▆▅▄▄▆▄▆▃▅▅▅▅▆▅▅▆▆▅▆▇▇▆▅▅▆▇▇▅█▆▅▅██
wandb:                 train_loss █████▇▇▇▇▇▇▇▇▇▇▇▆▇▆▆▆▆▅▅▆▅▅▂▄▃▂▃▂▃▂▂▁▂▃▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▆▁▁▆█▆▆▆
wandb:            val_accuracy0.5 ▁▇▁██▄▄▄▆▅▃▃▄▅▃▅▃▃▄▅▅▄▄▄▆▄▄▅▅▄▄▅▅▄▆▅▄▅▄▅
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▃▁▃▃▃▅▃▆█▆
wandb:                  val_auroc ▁▂▃▃▃▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▇▇▇▇▇█▇██▇██████████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▃█▃▁▁
wandb:   val_balanced_accuracy0.5 ▆▆▇▇▆▅▄▅▆▆▆▃▁█▅▄▄▇▃▄▄▅▅▄▄▅▄▅▅▄▅▄▆▅▅▄▄▅▅▄
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▇▃█▃▇
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅▅▅▅█▁▅▅▁▅▅▅▅
wandb:           val_precision0.5 ▇▇▇▇▁▁▇▇▆▆▇▇▇▇▇▆▆█▇▆▇▆▇█▆▇██▇▆▇▇▇▇▇▇▇▇▆▆
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁███████████
wandb:             val_recall0.25 █████████████████████████████▄▄▄▄▁▄▁▁▁▁▄
wandb:              val_recall0.5 ███▂▁▃▆▄▃▅▆▃▃▅▄▂▃▆▃▆▄▃▄▄▃▄▄▃▄▄▃▃▃▃▃▃▄▃▃▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▁▃▃▃▃▃▆█▆█
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.75949
wandb:                 test_auroc 0.52627
wandb: test_balanced_accuracy0.25 0.45042
wandb:  test_balanced_accuracy0.5 0.57331
wandb: test_balanced_accuracy0.75 0.525
wandb:         test_precision0.25 0.23288
wandb:          test_precision0.5 0.36842
wandb:         test_precision0.75 1
wandb:            test_recall0.25 0.85
wandb:             test_recall0.5 0.35
wandb:            test_recall0.75 0.05
wandb:                train_auroc 0.74272
wandb:                 train_loss 1.83871
wandb:           val_accuracy0.25 0.28571
wandb:            val_accuracy0.5 0.5619
wandb:           val_accuracy0.75 0.78095
wandb:                  val_auroc 0.50341
wandb:  val_balanced_accuracy0.25 0.49951
wandb:   val_balanced_accuracy0.5 0.46373
wandb:  val_balanced_accuracy0.75 0.55769
wandb:          val_precision0.25 0.24742
wandb:           val_precision0.5 0.20588
wandb:          val_precision0.75 1
wandb:             val_recall0.25 0.92308
wandb:              val_recall0.5 0.26923
wandb:             val_recall0.75 0.11538
wandb: 
wandb: 🚀 View run resnet18_2d_65_12_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/t5dgbsq2
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_12/wandb/run-20250618_210117-t5dgbsq2/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_12/wandb/run-20250618_212241-9sbcjg3c
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_12_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/9sbcjg3c
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 █████████▇▆▆▅███▁▁▆█▂▁▃█▃▆▆▆▃▅▂▅▅▅▅██▆▇▇
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█
wandb:                 test_auroc ▁▄▄▄▄▅▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▇▇▇▇▇▇████
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▅▅▅▅▅▅▅▅▅▁▅▅▇▅▅▅▇▂▂▂▅▃▇▆█▅▅▇▁▅▄▅▅▆▇▅█▇█▇
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▅▅▁▁▁▁▅▅█▅▁█▇▅▁▆▅▄▄▄▄▄▄▅▅▅▄▄▅▅▅▅▅▆▄▅▅▆▇▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 █▁▁▁▅▁▁▃▅█▁▅▁▁▁▁▁▁▁▅▆▆▃▄▅▃▃▅▃▆▃▃▅▃▂▃▃▃▂▃
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▂▃▄▄▄▆▆▅▆▅▆▄▄▄▆▄▆▅▄▆▆▅▅█▅▄▄▄▄▆▅▆▁▄▆▅▄▅▇▆
wandb:                 train_loss █████████▇█▇█▇▇▇▇▇▇▇▆▇▇▇▆▆▆▆▆▆▆▅▄▄▄▂▃▁▅▂
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁████▄▂▁▇█▅█▅█▇▄▅▆▃▄▄▇▄██▄▅▆▆▆▄▅███▆▆▆▇▅
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅██████
wandb:                  val_auroc ▅▇▆█▃▃▂▁▁▁▂▁▂▂▁▂▃▃▃▄▄▄▅▅▆▆▆▆▆▅▆▅▅▆▆▆▆▅▅▅
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▇▇▆▁▄▂▂▄▄▇▆▆█▇▇▄█▄▅▅▅▅▆▆▆▆▆▇▆▆▃▆▃▅▆▆▅
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅▅▅▅▅▅█████
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁█▃▃▃▄▅▃█▃█▃▅██▄█▃▃▃▄▅▃▃▃▃▃▃▃▃▃▃▃▃▃▄▄
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█████████
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 █▁▁▁▁▁█████▃▃▁█▂▅▇██▃▇█▇▄▅▅▃▅▇▇▅▅▆▅▆▇▃▄▄
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▆▆▆▆▆█
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.50633
wandb:          test_accuracy0.75 0.75949
wandb:                 test_auroc 0.52542
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.53729
wandb: test_balanced_accuracy0.75 0.525
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.27907
wandb:         test_precision0.75 1
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.6
wandb:            test_recall0.75 0.05
wandb:                train_auroc 0.64007
wandb:                 train_loss 1.97407
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.52381
wandb:           val_accuracy0.75 0.77143
wandb:                  val_auroc 0.6816
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.61904
wandb:  val_balanced_accuracy0.75 0.55136
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.31818
wandb:          val_precision0.75 0.75
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.80769
wandb:             val_recall0.75 0.11538
wandb: 
wandb: 🚀 View run resnet18_2d_65_12_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/9sbcjg3c
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_12/wandb/run-20250618_212241-9sbcjg3c/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_12/wandb/run-20250618_214518-kb8nk214
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_12_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/kb8nk214
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ███▁▃▆▇▆▆▅▅▅▅▃▂▃▆▄▄▆▄▅▆▄▅▅▅▅▅▅▆▅▅▇▇▇▅▅▆▇
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc █▇▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▃▂▂▂▂▂▁▁▁▁▁
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▅▂▅▆▇▅▃██▁▄▇▄▆▃▆▆▇▃▃▇▅▇▅▄▄▅█▅▄▆▆▇▅▆▅▄▄▅▇
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁▁▄█▆▆▆▇▅▇▇▅▅▄▆▅▅▆▅▅▄▅▆▆▅▅▆▅▆▆▆▆▅▆▆▅▇▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁█▆▁▅▆▅▆▆█▇▆▃▅▆▆▆▅▅▅▅▅▅▄▄▅▄▄▄▄▄▄▄▄▃▄▄▄▄
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁
wandb:                train_auroc ▂▁▆▆▆▇▅▃▃▄▄▃▆▆▇▇▃▁▄▆▆██▃▆▄▅▅▆▆▃▅▇▆▇▄▄▅▄█
wandb:                 train_loss ████▇▇▇▇▇▇▇▇▆▆▆▆▆▅▇▂▄▃▅▃▂▂▂▃▃▂▁▂▄▂▅▂▅▂▃▃
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ███▁▃▇▇▅▆▇▇▃▃▂▅▅▄▅▅▅▅▅▅▅▅▆▆▇▇▇▅▆▅▆█▇▆▇▄█
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁▅█▅▅
wandb:                  val_auroc ▁▆▇▇▇▇▇▇▇▇▇▇██████████████████████████▇▇
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▂▂▂▂▂▄▁▁▄▃▄▅▇▅▂▅▆▅▃▅▅▆▆▃▂▇▇▇▆▆▇▆█▇██▄▇█▇
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▃▁▃▃▃▃▃▃▃▅▃▅▅▅█▅▅
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▅▅▅▁█▇▆▆▅▇█▆▇▅▆▇▇▇▆▆▆▇▆▆▆▆▇▆▇██▇██▆███▆
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▆▆▆▆▆▇▇▇▇▆▆▇█▇▇▇▇
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▂█▁▁▆▆▇▇▆▆▅▃▄▇▆▅▄▆▅▆▆▆▆▆▆▅▆▅▅▅▅▅▃▅▅▅
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅▅█▅▅▅▅█████
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.67089
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.48475
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.49873
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.25
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.15
wandb:            test_recall0.75 0
wandb:                train_auroc 0.70002
wandb:                 train_loss 1.89753
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.72381
wandb:           val_accuracy0.75 0.7619
wandb:                  val_auroc 0.59177
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.59713
wandb:  val_balanced_accuracy0.75 0.53213
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.42857
wandb:          val_precision0.75 0.66667
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.34615
wandb:             val_recall0.75 0.07692
wandb: 
wandb: 🚀 View run resnet18_2d_65_12_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/kb8nk214
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_12/wandb/run-20250618_214518-kb8nk214/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_12/execution_datetimes.json

**************************************************  Experiment 65 | Version 13 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 1, 1.0: 1}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 2}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 4, 1.0: 12}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 2}

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_13/wandb/run-20250618_221102-66v0xfvs
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_13_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/66v0xfvs
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁▁▁▁▇██▅▇█▆▅▆▅▆▅▅▅▇▇▄▄▃▆▅▄▄▅▅▅▅▅▅▅▅▅▆▅▂▄
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc █▇▄▄▃▂▂▂▂▁▁▁▁▁▂▂▂▂▃▂▃▃▃▃▂▃▃▃▃▃▄▃▃▃▃▃▄▄▃▃
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▆▆▆▆▆▄▁▆▄▆▂▆▃▃▅▅▃█▆▆▅▅▅▅▃▅▅▅▅▇▇▇▇▇▇▃▅▄▄▄
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▂▂▂▂▂▂▂▂▁▁▁█▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ████▁▁▁▁▂▁▅▄▄▅▅▂▂▅▄▂▅▅▄▅▄▄▄▄▄▄▄▂▄▄▄▅▄▄▄▅
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▅▄▁▆▂▂▆▄▄▅▅▅▆▇▁▅▄▅▅▃▆▄▇▆▅▃▄▄▅█▅▃▄▅▅▄▄▆▄▅
wandb:                 train_loss █▆▆▆▅▅▄▅▅▅▄▄▅▅▅▅▅▃▄▃▃▂▄▃▅▄▃▄▅▃▁▁▂▃▄▃▁▁▂▃
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁▁▁▁██▇▆▆▅▅▆▇▇▄▄▄▃▄▄▄▄▂▃▄▄▅▄▄▅▅▅▅▅▅▂▄▄▅
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▃▂▁▁▂▃▃▃▄▅▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▇▇██████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▆▆▆▆▆▆▇█▆▇▆▅▂▅▅▁▁▁▁▇▄▂▁▅▂▇▃▄▇▆▂▁▁▄▄▆▃▃▇█
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▃▃▃▁▆█▂▁▂▂▂▂▃▂▂▂▂▂▂▂▃▃▂▁▂▃▂▃▃▃▂▂▂▂▂▂▂▂▃▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ███▁▁▂▂▃▅▅▃▃▃▃▂▁▁▂▅▃▅▆▅▅▅▅▅▄▂▂▃▂▃▂▂▂▅▆▆▅
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.44304
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.47288
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.47839
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.23913
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.55
wandb:            test_recall0.75 0
wandb:                train_auroc 0.67948
wandb:                 train_loss 2.05103
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.47619
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.4815
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.52288
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.2623
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.61538
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_13_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/66v0xfvs
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_13/wandb/run-20250618_221102-66v0xfvs/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_13/wandb/run-20250618_223111-app5utsx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_13_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/app5utsx
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 █████████████▆▆▂▁▄▄▄▁▁▁▂▂▃▄▂▄█▄▁▁▁▆▄▂▄▆▆
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▄▆▇▇█▇▇▇▇█████▇▇▇▇▇██▇▆▆▇▆▆▆▆▅▆▆▆▆▅▆▅▅▅
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▅▅▅▅▆▅▇▇▃▇▁▂▃▃▃▂▅▁▁▂▇▇▃▃▂▁█▇▃▃▇▇▃▂▁▃▇▇▇▃
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁▁▁▃▅█▁▃▃▃▂▂▂▂▃▃▃▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▂▃▂▃▃▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▂▁▁▂▅▆▇▅▇▅▆▇▆▅█▆▆▇▆▆▆▃▅▅▅██▇▇██▅
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▂▃▃▅▄▄▅▄▆▇▅▇█▆▅▇▅▄▄▆▅█▇▆▇▇▆█▅▆▅▅▇▅▇▇▆█▅
wandb:                 train_loss ▇█▇▇▇▇▆▆█▇▇▇▆▆▆▇▆▇▅▆█▆▆▃▅▄▃▇▄▇▇▅▆▄▄▃▂▁▃▃
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ██████████▃▄▇▁▁▃▅▃▃▃▄▄▄▃▄▄▅▄▅▅▁▃▃▂▂▃▅▃▄▄
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc █▇▇▆▆▆▅▅▄▄▄▄▃▃▂▁▁▁▂▂▂▂▂▂▂▁▁▁▂▂▂▂▂▁▂▂▃▃▄▄
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▃▁▁▁▃▄▅▅▆▅▃▅▇▅▆▅█▇██▇▇▂▄▂▁▃▆▃▅▅▇█▅▄
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁▆▃█▁▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▂▂▂▂▄▆████▇███▄▇█████████▃▄▃▆████▇
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.35443
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.50593
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.43559
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.21818
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.6
wandb:            test_recall0.75 0
wandb:                train_auroc 0.57418
wandb:                 train_loss 2.08678
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.50476
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.6704
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.67089
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.33333
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 1
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_13_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/app5utsx
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_13/wandb/run-20250618_223111-app5utsx/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_13/wandb/run-20250618_225745-r5x88lt5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_13_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/r5x88lt5
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: uploading history steps 304-305, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ██████▇▁▁▁██▇▅▂▃▅▆▆▄▅▄▂▂▁▂▂▂▃▅▆█▇▇▇▆▂▄▃▂
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▆▅▂▁▁▂▂▂▃▃▃▄▄▄▄▇▇▇██████████████████████
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▅▅▅▅▅▅▅▃▅▅▅▅▅▅▅▇▇▆▂▃▄▄▁▃▇▇▆▅▆▆▇▄▆▆█▃▅▃▄▆
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁▁▁▄▅▅▅▅▅▅▆▁▅▇▅▇▇▇▅▆▆▆▅▅▅▆▆█▆▆▅▇▆▅▅▅▅▆
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▂▇█▇█▅▁▁▂▄▄▅▂▅▅▅▃▅▅▆▅▅▅▅▅▅▂▃▃▃▅▃▅
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▃▄▅▆▅▆▅▆▆▄▅▄▅▇▆▅█▇▇▄▅▄▅▃▆▆▇▆▅▃▆▅█▅▄▅▇▅▅
wandb:                 train_loss ▆▇█▇▇▇▆▆▆█▆▇▇▆▆▆▅▅▅▅▅▆▄▅▅▅▅▅▄▅▄▄▃▃▄▁▃▃▃▄
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 █████▁▂▁▁▅█████▃▄▅▇▆▅▃▂▄▃▃▂▃▅▆▆▇▇▇▅▄▅▄▃▇
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▁▁▂▄▅▆▆▆▇▇▇▇▇▇▇████████████████████████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▄▂▁▂▁▁▅▆▅▆▁▆▅▇▅▆▂▂▁▄▅▇▅▆▆▅▅▆▆█▆▅▆▅▅▆
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▇▆▄▄▄▄▁▆▆▅▅▅▆▅▅▅▄▄▅▅▆▆█▇▆▅▆▇▆▅▅▅▅▆
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▂▄███▇▅▁▁▁▃▃▃▆▆▆▃▅▅▆▆▅▆▆▆▆▅▃▃▃▃▃▆▆
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.62025
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.47966
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.53093
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.29167
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.35
wandb:            test_recall0.75 0
wandb:                train_auroc 0.69494
wandb:                 train_loss 2.06405
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.6381
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.60492
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.59177
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.34211
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.5
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_13_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/r5x88lt5
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_13/wandb/run-20250618_225745-r5x88lt5/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_13/execution_datetimes.json

**************************************************  Experiment 65 | Version 14 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 13, 1.0: 19}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 7}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 8, 1.0: 10}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 10, 1.0: 22}
    Batch label distribution: {0.0: 11, 1.0: 7}

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_14/wandb/run-20250618_231518-k1dis63h
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_14_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/k1dis63h
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▃▃▄▆▇▇▄▄▄▄▅██▆▄▅▅▄▅▅▆▆▅▄▆▅▅▆▇▄▃▄▅
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▇▇███▃▃▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▆▆▆▃▄▆▆▇▇▆▃▁▃█▅█▆▆▇▆▂█▆▆▆▃▄▆▅▆▆▇▇▅▄▂█▃▅▇
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▆▆▆▆▆█▆▁▆▅▇▆▇▅█▅▄▇▇▆▆▇▅▆▅▇▇▇▇▇▆▅██▅▅▄▅▆▆
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ██████████▆▅▄▃▂▂▁▁▂▂▄▅▅▆▅▅▄▃▄▄▃▃▂▂▃▂▃▃▅▄
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▃▄▃▆▄▄▅▄▄▄▆▄▅▅▅▆▅▆▇█▅▇▅▄▄▅▆▄▄▅▆▆▅▆▄▆▆▇▅
wandb:                 train_loss █▆▇▇▆▅▅▅▅▅▄▄▄▄▄▄▄▅▄▄▅▃▅▂▃▄▃▁▄▂▂▃▁▂▄▂▃▂▃▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▂▂▂▄▂▃▃▅▅▇▇█▇▄▄▂▂▄▅▅▅▄▄▄▅▅▅▆▇▂▄▄▅▄
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▆▄▃▂▁▂▂▃▄▅▅▅▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇████████████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▇▇▇▇▇▂▃▆▄▃▂▁▁▁▃██▇▇█▁▂▆▃▁▄▄▄▄▆▃▂▂▅▅▄▄█▂▃
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▄▄▄▄▄▄▄▄▄▄▄▃▂▃▃▃▃▃▃▃▁▄█▄▁▂▂▃▃▃▂▃▄▂▃▂▂▃▄▂
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ██████▇▇▄▅▃▂▁▁▁▂▅▄▃▂▃▅▃▂▂▅▃▂▂▂▂▂▂▂▂▂▆▅▅▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.50633
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.4839
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.47119
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.22857
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.4
wandb:            test_recall0.75 0
wandb:                train_auroc 0.67821
wandb:                 train_loss 2.06895
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.48571
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.46495
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.4389
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.19565
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.34615
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_14_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/k1dis63h
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_14/wandb/run-20250618_231518-k1dis63h/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_14/wandb/run-20250618_233534-ywxtcbws
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_14_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/ywxtcbws
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 469-469, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ████████████▇▄▅▂▂▂▄▂▂▂▂▃▃▆▆▆▇█▄▁▁▁▁▃▂▂▄▄
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▂▂▁▁▂▃▃▆▆▆▆▆▇▆▆▆▇▇▇▇█▇███████████▇████▇▇
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▅▅▅▅▅▅▅▅▄▅▅▅▅▃▅▁▂▂▁▁▂▂█▄▂▇▇██▃▃▁▁▂▂▅▅▄▅▅
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁▆▅▁▁▁▁▁▁▁▁▁▇▅▅▅▄▅▄▄▄▅▄▄▄▅▅▄▅▇▆█▆▄▅▄▄▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▃▁▁▁▁▁▁▁▂▁▆▅▅▆▆▆▆▆▆▆▅▃▅▅▅▃▁▅█▇▆▆▆▆▆▆
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▅▄▃▄▅▄▅▇▅▆▇▆▇▇▇▇▆▇▇▆▇▆▆▅██▇█▅▇▇█▇▇▇▇▅▇▆
wandb:                 train_loss ▃▃▅█▅▄▅▆▆▅▃▇▅▅▂▅▄▄▃▅▅▄▄▅▄▃▃▂▄▂▂▃▅▄▁▁▁▁▁▂
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ████████████▆▃▅▄▄▃▅▄▃▄▄▅▅▅▄▄▆▅▇▁▁▃▂▆▄▄▅▅
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▄▆███████▇▇▇▇▆▆▆▆▆▆▆▆▅▅▅▅▅▅▅▄▅▅▅▅▅▅▅▅▄▅
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▄▆▇█▇▅▅▆▆▇▇█▇██▇▅▄▃▄▅▆▅▃▆▆▅█
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▆▁▁█▁▁▁▁▁▁▁▁█▆▃▃▃▃▃▃▃▃▃▃▄▄▄▃▃▃▃▃▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▃▁▁▁▁▁▁▁▁▂▂▂▂▅███▅█████▆███▇████▇
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.37975
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.5
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.45254
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.22642
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.6
wandb:            test_recall0.75 0
wandb:                train_auroc 0.56483
wandb:                 train_loss 2.09049
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.49524
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.67478
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.65166
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.32468
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.96154
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_14_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/ywxtcbws
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_14/wandb/run-20250618_233534-ywxtcbws/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_14/wandb/run-20250619_000237-t82nepi5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_14_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/t82nepi5
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 █████████▆▆▆▇████▅▆▆▅▄▄▃▃▁▁▁▁▆▇▇▇█▇▄▄▄▁▄
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▅▅▂▁▁▁▂▅▅▆▆▆▆▇▇█████████████████████████
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▅▅▅▅▅▅▃▇▆▆▅▅▆▆▆▆▆▆▄▂▁▂▁▇▇▇▇▇▆▇█▇▇▇▆▅▂▂▁▂
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▄▄▁▅▁▁▁▁▅▅▅▅▄▅▅▄▄▄▄▄▄▄▆█▁▁▆▇▆▆▅▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▄▄█▇▄▂▂▁▁█▆▆███▇████▁▃▆▆▃▂▃▆▇▇▇█
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▃▅▂▃▄▆▅▆▅▅▅▇█▇▅█▆▇▇▆▄▄▆▇▆▆▆▅▆▅▇▄▅▄▆▅▃▆▅
wandb:                 train_loss █▆▅▅▅▅▅▄▅▅▅▅▅▅▅▅▅▄▅▅▃▃▄▄▄▃▂▃▃▃▁▄▄▂▄▅▂▂▄▂
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ██████████▂▆██▇▆▅▅▄▆▃▃▄▄▃▁▁▂▄▆███▇▇█▇▅▃▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▁▂▅▅▅▇▇▇▇▇█████████████████████████████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▂▂▁▂▁▂▄▅▄▂██▅▇▆▆▆▃▁▁▂██▅▅▆▇▇▅▅▆▇▆▅▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▄▁▁▁▆▆▅▁▆▆▆▆▇▆▆▆▆▆▆▅▅▅▅▅▇███▇▇▆▆▅▆
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▇▇▁▇▇▇▆▇██████████▇▆▅▄▃▁▃▄▄▄▄▆▇▇█
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.50633
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.48644
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.50424
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.25641
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.5
wandb:            test_recall0.75 0
wandb:                train_auroc 0.68433
wandb:                 train_loss 2.07748
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.59048
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.60248
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.59883
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.32653
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.61538
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_14_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/t82nepi5
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_14/wandb/run-20250619_000237-t82nepi5/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_14/execution_datetimes.json

**************************************************  Experiment 65 | Version 15 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

Using WeightedRandomSampler for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 30, 1.0: 34}
    Batch label distribution: {0.0: 34, 1.0: 30}
    Batch label distribution: {0.0: 11, 1.0: 7}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 30, 1.0: 34}
    Batch label distribution: {0.0: 8, 1.0: 10}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 34, 1.0: 30}
    Batch label distribution: {0.0: 36, 1.0: 28}
    Batch label distribution: {0.0: 25, 1.0: 39}
    Batch label distribution: {0.0: 11, 1.0: 7}

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

Using WeightedRandomSampler for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

Using WeightedRandomSampler for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_15/wandb/run-20250619_002006-hdm6n0ze
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_15_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/hdm6n0ze
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▂▂▂▃███▆▅▆▆▆▆▃▄▃▄▆▆▆▇▇▆▆▇▆▆▅▆
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ██▇▇▅▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▅▅▅▅▅▅▃▁▃▅▂▃▂▄▅▄▄▄▄▇▅▅▅▅▃▃█▇▂▅▁▆▁▄▄▄▂▅▃█
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▂▄█▁▁▃▅▃▄▂▂▂▁▁▃▅▃▅▁▅▅▂▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 █████████▇▇▇▆▆▆▁▁▁▁▁▁▁▁▂▄▂▂▃▃▅▃▄▄▃▂▁▂▃▃▃
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▆▅▅▇▆▇▆▆▆▆▇▅▆▅▆▅▇▇▇▅▅▆▆█▆▇▆▇▆▇▆█▇▇▇▇▇█▇
wandb:                 train_loss █▅▅▄▄▄▄▄▃▃▃▄▃▄▅▂▃▃▃▄▂▃▃▄▃▂▃▃▂▂▂▃▂▂▂▁▂▁▂▂
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▄██▇▅▅▆▅▅▃▄▅▆▆▅▇▇▇▇▆▅▆▆▆▆
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▆▄▂▁▁▁▁▂▁▂▃▃▃▄▄▄▄▄▄▄▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇█
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▇▇▇▇▇▇▇▇██▇▇▄▅▆▃▃▃▄▃▅▄▅▄▄▂▁▃▃▃▅▅▄▃▆▃▄▆▆▃
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▆▆▆▆▆▆▆▆▆▆▆▆▄▄▄█▄▄▃▃▁▂▅▅▅▅▅▄▄▁▄▁▂▁▁▃▂▁▅▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ██████████▇▇▇▇▅▄▁▂▁▂▄▄▂▂▃▅▅▅▅▅▂▂▂▂▂▂▂▂▅▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.60759
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.48305
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.53898
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.2963
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.4
wandb:            test_recall0.75 0
wandb:                train_auroc 0.691
wandb:                 train_loss 2.07915
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.54286
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.47079
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.43817
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.17647
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.23077
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_15_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/hdm6n0ze
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_15/wandb/run-20250619_002006-hdm6n0ze/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_15/wandb/run-20250619_004224-769qhjts
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_15_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/769qhjts
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁▂▂█▁████▃▅▅▅▅▅▅▆▆▇▅▆▂▂▆▅▂▂▆▆▇▁▁▁▁▁▃▁▁▂▃
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▇▅▄▃▁▁▁▃▄▄▄▄▆▅▅▆▅▅▅▆▆▆▆▆▆▇▆▆▇▇▇▇▇██▇████
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▅▅▅▅▄▃▂▅▁▃▅▅▅▅▅▅▅▇▃▄▃▄▆▃▆▆██▁▁▂▆▇▆▂█▅▂▃▃
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▇▇▇▇▆▁▇▆▆▆▁▁▁▁▁▁▁█▅▄▇▇▆▇█▅▇▇▆▆█▆▆▆▆▆▆▆▆▆
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ███▁█▂▁▁▁▁▁▁▁▁▅▅▅▃▃▅▅▂▂▅▅▅▅▄▂▄▃▂▁▇▆▅▆▇▆▅
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▅▃▂▁▃▃▅▃▄▄▇▅▅▃▅▄▇▆▅▅▅▆▅▆▇▇█▅▇▇▇▅▆▅▆▅▇▆▇▆
wandb:                 train_loss ▆█▅▆▆▆▆▆▅▆▅▅▃▆█▆▄▅▅▅▄▅▅▅▅▅▃▆▄▅▅▃▄▃▄▂▃▁▅▃
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁▁▁▁▃▂▂█▇███████▇▆▆▆▆▇▇▇▆▆▆▄▄▄▄▇▇█▂▁▂▂▄
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▄▅▆▆▇▇▇▇▇██████████████████████████████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▂▂▂▁▂▂▂▆▂▃▂▂▂▂██▆▅▅█▅▆▆▆▇▇▇▇▇█▄▄▃▇▅▇▇█▅▇
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▃▃▃▃▃▃▃█▁▁▁▄▄▄▄▃▃▄▄▃▃▃▃▃▄▄▅██▄▃▃▃▃▃▃▃▃▃▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ██▇▅▇▄▁▁▁▁▂▅▆▃▆▇▅▄▅▆▇▇▇▇▇█▆▄▂▂▃█████▇▇██
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.32911
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.47203
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.41864
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.21053
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.6
wandb:            test_recall0.75 0
wandb:                train_auroc 0.59255
wandb:                 train_loss 2.09098
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.47619
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.68014
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.6519
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.32099
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 1
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_15_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/769qhjts
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_15/wandb/run-20250619_004224-769qhjts/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_15/wandb/run-20250619_011006-8z69xb7a
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_65_15_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/8z69xb7a
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 █████████████████████▇▆▆▇▇▆▅▂▁▁▆▇▇█████▇
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▃▂▁▁▁▃▄▄▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▇█████▇▇▇▇▇█
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▂▆▃███▅▅▂▂▃▅▇▇▅▄▅▃█
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▄▅▆▅▅▅▅▅▅▅▆█▁▇▇█▁▁▁▇▇
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▅▅▅▆██████▆▆▆▂▃▃▁▅
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▄▅▃▅▅▄▅▄▄▅▃▆▅▅▅▅▅▅▇██▇▅▅▆▇▆▆▆▅▆▄▅▇▄▅▆▆▇
wandb:                 train_loss ▇▅██▃▂▄█▄▄▄▄▂▄▆▃▅▄▄▃▃▃▂▃▃▃▂▃▃▂▁▂▁▂▂▁▃▃▁▂
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ████████████████▇▇▇▇▆▅▅▄▄▁▁▂▂▄▆▇▇▇▇▇▇▇█▇
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▁▂▂▂▂▃▃▄▄▄▄▄▅▅▆▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇█████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▂▂▂▂▂▄▆▄▅▅█▅▇▃▃▆▄▆▅▂▃▂
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▆▆▆▆▆▅▅▅▆▆▇█▇▇▇▅▅▅▇
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▄▄▆▆▇▇█▆▅▄▃▂▄▁▃▃▅
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.65823
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.50339
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.55636
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.33333
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.35
wandb:            test_recall0.75 0
wandb:                train_auroc 0.61691
wandb:                 train_loss 2.08874
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.67619
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.58447
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.57838
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.35714
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.38462
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_65_15_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs/runs/8z69xb7a
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_wrs
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_15/wandb/run-20250619_011006-8z69xb7a/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_65/version_15/execution_datetimes.json
Finish time: 2025-06-19 01:27:17
