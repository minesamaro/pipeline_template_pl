Initialization time: 2025-06-18 05:00:04

**************************************************  Experiment 60 | Version 1 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 2}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 1, 1.0: 1}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 2}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Currently logged in as: maria-i-paiva (maria-i-paiva-inesc-tec) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: WARNING Using a boolean value for 'reinit' is deprecated. Use 'return_previous' or 'finish_previous' instead.
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_1/wandb/run-20250618_050032-1qu8xsr8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_60_1_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/1qu8xsr8
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 178-184, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▅██▁█▁██▁▁▁▁▁▁▁▁███▁▁██▁▁██████▁▁█▁▁▁▁█▁
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▆▄▃▆▅▆▃▅▄▄▅▄▆▆▄█▁▅▄▄▂▅▅▅▃▂▄▃█▇▆▃▇▄▄▅▅▄▆▆
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▁▃▃▃▃▃█▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▅▅▁▅▁▅█▁▅▅▅▅▁▅▅▅▁▁▅▁▁▅▅▅▅▁▁▅▅▁▅▁▅▅▅▁▅▅▅
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▄▁█▃█▁▁▁▁▁▁█▁█▁▁▁▁█▁▁▁█▁▁█████████▁▁▁█
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▄▆▅▄▃▄▄▆▅▄█▆▅▇▄▆▅▄▅▅▆▆▅▅▆▅▇▆▄▅▄█▆▇▃▆▃▆▃
wandb:                 train_loss ▄▃▂▂▂▃▂▂▂▂▃▂▁▂█▁▁▂▂▂▂▂▂▂▂▂▂▁▂▂▂▂▂▂▂▂▂▂▂▂
wandb:           val_accuracy0.25 █████▁▁█▁███▁▁█▁█▁▁▁▁███▁██▁▁▁▁▁▁▁▁██▁▁▁
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.75 ▁███████████████████████████████████████
wandb:                  val_auroc ▅▇▄▆▅▅▄▆▅▅▅▆▅▅▅▄▅▅▃▅▅▇▄█▃▁▄▁▄▂▃▂▂▇▇▇▆▅▂▆
wandb:  val_balanced_accuracy0.25 ▄▃▃▃▃▃▃▃▃▁▃▃▁▃▃█▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▃▁▁▃▃▁▂▃▁▁▁▃▃█▁▁▁▃▃▃▁▃▁▁▃▁▁▁▁▃▃▃▃▃▃▃▁▁▁
wandb:           val_precision0.5 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁█▁▁▂▁██▁▁▁█▁█▁▁▁██▁▁▁▁▁█▁███████▁▁█
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.55847
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.48071
wandb:                 train_loss 1.69292
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.56134
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_60_1_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/1qu8xsr8
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_1/wandb/run-20250618_050032-1qu8xsr8/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_1/wandb/run-20250618_050730-2yywv23l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_60_1_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/2yywv23l
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading output.log; uploading config.yaml
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁█▁▁▁▁▁▁▁▁▁▁█▁▁▁█▁▁█████▁▁█▁▁███▄▁▄█▁▁██
wandb:           test_accuracy0.5 ██████▁█████████████████████████████████
wandb:          test_accuracy0.75 █████▁██████████████████████████████████
wandb:                 test_auroc ▆█▄▁▅▇▇▆▇█▃▄▇▇▆▆▇▆▅▅▆▅▆▆▆▅▅▆▆▄▆▄▇▇▇▃▃▅▆▆
wandb: test_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▁█▄▄▄▄▄▄▄▄
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 █▁▁▁█▁▁▁█▁█▁██▁█▁▁▁▁▁▁█▁▁▁▁▁▁▁▁██▁█▁▁██▁
wandb:          test_precision0.5 █▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁█▁█▁█▁▁▁█████▁█▁██▁▁▁▁█▁▁▁▁███▅██▃▁▁██▁
wandb:             test_recall0.5 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▂▅▁█▂▆▃▃▂▃▂▂▇▅▅▅▂▃▃▃▂▃▅▁▄▄▄▆▅▆▄▃▃▄▄▄▁▄▄▃
wandb:                 train_loss █▃▂▁▂▂▁▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁█▁█▁▁██▁██▁█▁████▁█▁████▃▁▁██▁██████▁█
wandb:            val_accuracy0.5 ██▁█████████████████████████████████████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▇▁█▆▅▅▅▂▅▁▆▁▁▅▃▄▃▁▃▄▇▇▇▇▇▇▇▇▆▆█▅▅▅▁▃█▅▆▆
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▇█▃▁█▃▃▃▃▃
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▇▆▁▇▇▇▇▁▁▇▇▇▁▁▇▁▇▇▁▁▇▁▁▁▁▁▁▁▁▁▁▁▇▆█▇▁▇▁▁
wandb:           val_precision0.5 ▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ██████▁█▁███▁█▁█▁▁▁▁▁█▁▁▁▁▁▁▁█▁▆██▁█▁▁██
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.74684
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.48983
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.42502
wandb:                 train_loss 1.69708
wandb:           val_accuracy0.25 0.75238
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.56865
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_60_1_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/2yywv23l
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_1/wandb/run-20250618_050730-2yywv23l/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_1/wandb/run-20250618_051334-yinsvd1l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_60_1_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/yinsvd1l
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ██▁█▁█▁▁▁▁█▁███▁███▁▁██▁███▁██▁▃▁▁█▁████
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ██▁█████████████████████████████████████
wandb:                 test_auroc ▆▇▅▅▄▁▁▃▃▄▃▄▄▃▃▄▅▄▄▄▄▅▃▄▄▄▄▄▄▄▃▂▅▄▃▆▄▇▆█
wandb: test_balanced_accuracy0.25 █████████████████████████████▁██████████
wandb:  test_balanced_accuracy0.5 ██████▁█████████████████████████████████
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 █▁▁▁▁██▁██▁▁▁▁▁█▁▁██▁█▁▁▁▁██████▁█▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 █▁█▁▁▁█▁▁█▁█▁▁█▁█▁▁▁█▁▁▁███▁████▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▄▅▄▄▄▄▃▂▆▁▅▄▅▃█▃▄▄▆▃▄▃▂▄▃▄▄▄▂▃▃▅▄▄▅▄▂▆▆▅
wandb:                 train_loss ▂▁▂▁▂▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▂▁▁█▂▂▁▁
wandb:           val_accuracy0.25 ▁▁▁▁█▁▁█▁█▁█████▁█▁█▁█▁▁▁███▁█▁▁███▁▁███
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▃▇▆▇▃▁▅▅▃▃▃▅▄▆▇▆▇▇▆▇▇▇▇▇▇▇▇▇▇▅███▃▂▅▆▃▆▄
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ███████▁████████████████████████████████
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁█▁▁▁▁▁███▁██▁█▁██▁██▁█▁▁▁█▁▁▁█▁▁▁▁▁█▁▁█
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁█▁████▁▁▁▁▁█▁▁█▁██▁▁▁▁████▁█▁█▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.74684
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.61864
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.39393
wandb:                 train_loss 1.69514
wandb:           val_accuracy0.25 0.75238
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.46397
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_60_1_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/yinsvd1l
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_1/wandb/run-20250618_051334-yinsvd1l/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_1/execution_datetimes.json

**************************************************  Experiment 60 | Version 2 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 29, 1.0: 3}
    Batch label distribution: {0.0: 20, 1.0: 12}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 14, 1.0: 4}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 13, 1.0: 5}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 15, 1.0: 3}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_2/wandb/run-20250618_052255-yaoo18w0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_60_2_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/yaoo18w0
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁█▁█▁██▄▇▆█▇█▁▁▁▁▁█▁██▁▁██▁▁▁▁█▁▁█▁▁█▁█
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▇██▂▆▆▆▆▇▇▆▇▇█▄█▇▂▁▄▆▆▄▄▅▅▃▄▅▅▅▅▅▅▅▇▅▅▅▅
wandb: test_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▄▁▃▆▅▅▄█▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▇▇▁▇██▇▇▁█▇▇▁▁▁▇▇▁▇▁▁▇▁▇▁▇▇▇▁▁▁▇▁▇▁▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁██▆▆▁▁▆▇▄▆█▁▁▁▁█▁█▁█▁▁█▁█▁▁███▁▁█▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▄▇█▄▇▅▇▆▇▇▇▆▇█▃▄▄▅▁▄▁▂▂▃▃▁▂▄▃▄▄▁▁▃▂▃▃▃▃▆
wandb:                 train_loss █▂▄▄▄▄▃▃▃▃▃▂▂▃▆▃▃▁▃▃▃▄▃▃▃▃▃▄▄▃▃▃▄▄▃▃▃▄▃▄
wandb:           val_accuracy0.25 ▁▇▁▄▄█▇▅▃▃▅█▅▃▂██▅▃█▁▁███▁▁▁▁█▁██████▁██
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▄▃▆▃▃▃▄▃▄▄▄▄▃▃▄▄▄▃▂▄▅▆▆▇██████▇▇▆▆▇▇▄▆▆
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▁▂▂▂▂▇▂▂▁█▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▄▄▁▄▄▄▅▄█▄▄▅▁▁▄▁▄▁▄▁▄▄▁▁▄▄▁▁▄▄▄▁▄▄▁▁▄▄▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▇██▁█▁▂▆▂▇▅▁█▁███▁▁█▁██▁▁▁▁▁██▁██▁▁███▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.49237
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.52641
wandb:                 train_loss 1.69089
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.54674
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_60_2_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/yaoo18w0
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_2/wandb/run-20250618_052255-yaoo18w0/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_2/wandb/run-20250618_053109-fniuesdq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_60_2_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/fniuesdq
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▅█████▁▁█▁███▅▁█▁█▁███▆██▁██▁▁▁▁▁████▁▁▁
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▃▅▂▁▆▅▅▆▆▇▆▇▅▅▅▅▄▅▅▅▅▅▆▅▅▄▄▆█▇▅▆▆▆▅▅▆▆▅▇
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▂▆█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▅▅▅▁▅▁▅▁▅▁█▅▅▁▅▁▁▅▅▅▁▅▅▅▁▅▅▅▅▁▁▁▁▁▁▁▅▁▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁██▁█▁▆███▁█▁▇▁▂▁▃▁▁▁▁▂▁█▁██▁██▁▁█▁█▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▅▄▄▄▂▄▄▇▃▃█▇▄▅▄▂▃▆█▃▃▅▅▃▁▄▂▅▂▅▃▃▄▅▃▄▁▆▇▇
wandb:                 train_loss █▂▃▄▃▃▂▂▂▁▂▂▁▁▂▂▂▂▁▂▂▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:           val_accuracy0.25 ▁█████▁██▄█▁▁███▁██▆▁▁▁▁▁▁▁█▁▁█▁█▁██████
wandb:            val_accuracy0.5 ▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▄▇▅██▇▇██▇▂███▇▆▃▁▁▁▃▅▆▆▇▇▇████████▇▇█▇▇
wandb:  val_balanced_accuracy0.25 ▅▁▅▅▅▅▅▅▅▅▅▅▇▇█▅▅▅▅▅▅▅▅▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁██▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▃▂▁▁▃▁▃█▃▁▅▃▃▃▃▁▁▁▃▁█▃▁▃▃▁▃▃▁▃▃▃▁▁▁▁▁▁▃▃
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▃█▁▁▁███▁▁▆▄▅█▁▁█▁▁▁█▁▁█▁██▁█▁██▁▁██▁▁▁█
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.74684
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.51441
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.43841
wandb:                 train_loss 1.70822
wandb:           val_accuracy0.25 0.75238
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.61733
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_60_2_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/fniuesdq
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_2/wandb/run-20250618_053109-fniuesdq/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_2/wandb/run-20250618_053930-c4ahuzxn
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_60_2_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/c4ahuzxn
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 █▁▁█████▁█▁███▁██▁██▁███▁▁██▁█▁███▁▁████
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc █▆▆█▆▆▇▇▁▁▂▃▃▃▄▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▅▅▄▅▄▅▅▂▃▂
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁██▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▇▁▁▇▇▇▁▁▁▇▁▁▁▁▁▇▁▇▇▇▇▁▁▁▇▇▁▁▇█▁▁▇▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ███▁▁▁▁███▁▁█▁▁█▁███▁▁▁▁▁█▁▁█▁▁██▁▁▁█▁▁█
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▆▄▁▁▂▅▅▂▅▇▆▅▃▂▁▅▆▃▅▆▆▅▃▃▂▄▄▃▄▃▄▃▂▄▅█▄▄▅▂
wandb:                 train_loss ▂▂▃▁▂▂▂▂▁▂▂▂█▂▂▁▁▂▂▁▂▁▂▂▁▁▂▁▂▂▁▁▁▂▂▁▁▁▂▂
wandb:           val_accuracy0.25 ▁▁████▅█▁█████▁█▁██▁███▁███▁█▁████▁██▁█▁
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ██▇██▆▇█▃▁▅▅▅▅▅▅▅▅▅▅▆▆▆▅▅▆▆▅▅▆▅▆▆▅▆▁▂▂▂▁
wandb:  val_balanced_accuracy0.25 ▃▃▃▃█▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▇▃▃▃▃▃
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▆▁▆▆▆▆▁█▁▁▆▁▁▁▆▁▁▁▁▁▁▁▁▁▆▁▁▁▁▆▆▁▁▇▁▆▆▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁█▁▁███▁▁▁▁▁█▁▁▁██▁▁▁▁▁▁▁▁▁██▁▁▇▁▁███▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.43644
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.43172
wandb:                 train_loss 1.69317
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.47176
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_60_2_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/c4ahuzxn
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_2/wandb/run-20250618_053930-c4ahuzxn/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_2/execution_datetimes.json

**************************************************  Experiment 60 | Version 3 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 47, 1.0: 17}
    Batch label distribution: {0.0: 54, 1.0: 10}
    Batch label distribution: {0.0: 43, 1.0: 21}
    Batch label distribution: {0.0: 14, 1.0: 4}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 46, 1.0: 18}
    Batch label distribution: {0.0: 51, 1.0: 13}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 13, 1.0: 5}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 51, 1.0: 13}
    Batch label distribution: {0.0: 43, 1.0: 21}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 15, 1.0: 3}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_3/wandb/run-20250618_054817-xzovw4a3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_60_3_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/xzovw4a3
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: updating run config
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▇█▁▁▄▇▄▁██▁███▆▁▆▇▆▇█▇█▇▇▆▇▇▇▇▁▁█▁█
wandb:           test_accuracy0.5 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆▇▇▇▅▁█▇▆▄▅▆▅▄▄▃▄▃▅▇▇▇
wandb:          test_accuracy0.75 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▇▇▂█▅▆▆▃▅▁▁▃▃▆▆▆▆▆
wandb:                 test_auroc ▃▃▄▃▁▃▃▂▂▃▄▄▅▃▃▄▃▅▄▆▃▄▇█▆▃▁▂▁▃▄▃▃▄▄▄▄▄▄▄
wandb: test_balanced_accuracy0.25 ▄▅▄▄▄▄▄▄▄▆▄▆▅▁▄▅▆▅▃▅█▅█▆▆█▅▇█▄▅▅▆▄▄▄▄▄▄▄
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▃▁▁▅▃▂▃▁▂▅▂▆█▂▆▆▃▂▅▂▂▄▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▃▃▆▃█▄▆▂▃▂▅▆▁▁▄▂▂▂▂▂▂▂▂▂▂
wandb:         test_precision0.25 ▄▁▁▁▄▁▄▄▄▄▁▅▅▄▄▃▁▄▄▄▄▇▄▇▅▃▅█▄▄▅▄▅▅▄▄▁▄▁▄
wandb:          test_precision0.5 ▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃█▃█▄▃▃▄▅▄▄▄▃▃▄▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▁█▃█▃█▃▅▅▅▂▄▃▃▂▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁█▁▁▁▁██▁▁▃▂▄██▁▅▃▃▃▃▄▁▂▂▂▃▂▃▃▂▂▃█▁▁█▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▂▃▂▆█▂▅▆██▅▇▅▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▃▁▅▂▇▂▆▅▇▃▇█▆▅▁▁▁▁▁
wandb:                train_auroc ▁▂▂▃▂▂▁▂▃▃▂▄▄▄▂▃▄▄▄▅▇▇█▄▆██▇██▇██▃▃▁▂▃▁▂
wandb:                 train_loss █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 █▁█▁▁▁▁▁▂▂████▅▁██▄▆▆▅▄█▆▅▅▆▇▇▇▆▆▄█▁███▁
wandb:            val_accuracy0.5 ████████████▇████████▇▇▂▁▆▅▃▃▃▃▇▆▇▃█████
wandb:           val_accuracy0.75 █████████████████████▇▇▆██▄▇▆█▁▁▁▆▇█████
wandb:                  val_auroc ▅▅▄▂▂▄▄▃▃▃▄▄▄▄▄▄▄▄▃▂▂▁▂▁▂▂▄▃▃▃▃▃▄▄█▃▃▄▄▄
wandb:  val_balanced_accuracy0.25 ▅▅▅▅▅▄▅▇▄▅▅▅▅▇▃▅▆▃▄▄▇▁▂▆▅▃▃▇▃▂▃▅█▇▅▅▅▅▅▅
wandb:   val_balanced_accuracy0.5 ▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▆█▇▅▅▅▅▆▅▅▂▁▄▆▄▇▅▃▄▄▇▅▅▅▅
wandb:  val_balanced_accuracy0.75 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▇█▇▇▅▂▅▅▄▅▇▁▃▃▄▃▆█▆▆▆▆▆▆▆▆
wandb:          val_precision0.25 ▁▁▁▁▁▃▃▁▃▁█▂▃▃▁▁▃▃▂▂▂▂▂▂▂▃▃▂▂▂▄▃▄▃▁▃▃▁▁▃
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁██▆▁▁█▆▃▂▃▂▃▁▂▂▂▂▂▃▃▄▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▇▁▃▃▁▃▃▃▅▄▃▁▃▄▂▃▃▄▆▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▃█▁▁██▁█▁▇▇▆▄▁▁▁▇▃▃▄█▂▂▃▂▂▃▂▂▂▃▃▃█▁█▁█
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▇▁▅▁▁▁▁▁▁▁▁▃▆▅▅▅▅▅▄▃▃█▅▇▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▃▁▁▁▁▂▁▃▄▅▅▁▂▅▅▃█▂▅▅▅▃▃▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.52924
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.46428
wandb:                 train_loss 1.6922
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.51071
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_60_3_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/xzovw4a3
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_3/wandb/run-20250618_054817-xzovw4a3/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_3/wandb/run-20250618_061245-61jkh3wg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_60_3_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/61jkh3wg
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 █▅█▇▆█▁████▇▇▇▇▆▇▇▇▁█▄▆▆▆▆▆▇▁▁████▁█▁▁█▁
wandb:           test_accuracy0.5 ▇▇▇▇▇█▇▇▇▇▇▇▇█▇▄▇▆▄▄▅▇▇▇▇▇▅▂▂▂▁▇▇▇▇▇▇▇▇▇
wandb:          test_accuracy0.75 ███████████████▆▇█▇▇███▁▇▅██████████████
wandb:                 test_auroc ▃▃▄▄▄▄▃▃▃▂▂▄▂▃▅▄▆▆█▂▂▃▂▃▂▄▄▄▅▇▆▂▁▃▂▂▂▂▂▁
wandb: test_balanced_accuracy0.25 ▂▃▃▄▃▃▂▂▂▂▂▂▂▂▂▄▃▃▂▁▃▃▃▆█▂▂▂▂▆▂▂▂▂▂▂▂▂▂▂
wandb:  test_balanced_accuracy0.5 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▃▂▃▂▃▅▆▅█▂▂▂▁▄▂▂▂▂▂▂▂▂▂▂
wandb: test_balanced_accuracy0.75 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▃▃█▁▂▃▂▂▂▂▄▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:         test_precision0.25 ▅▅▅▆▅▁▁▁▁▅▄▇▅▅▇▇▇███▁▆▄▇▆▆▅▅▅▁▁▁▁▅▅▁▁▅▁▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁█▁▅▃▃▃▄▄▁▁▁▁▁▃▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▄▁▂▃▃▁▁▃▃▂▃▂█▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▂▃▁▁█▁▁▁▁▁▁▂▂▃▆▆█▁▁██▁▁▄▄▂██▁▁█▁█▁▁▁▁█
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▅▂█▁▁▁▁▁▁▁▁▁▃▃▃▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▃▇▅█▁▁▁▁▁▅▅▄▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▂▂▃▃▂▂▂▂▃▂▃▁▃▃▄▇▆███▂▂▂▂▂▃████▂▂▂▂▃▁▁▃▃▂
wandb:                 train_loss ██▇▇▇▇▇█▇█████▇▇▇▄▅▃█████▁▁█████████████
wandb:           val_accuracy0.25 ███▁▁▁██▆▆▅▅▄▄▄██▁▁█▁█▅▅▄▅▁▁█▁▁███▁██▁██
wandb:            val_accuracy0.5 ▇███▇▇▇▇▇▇▇██▆▇▅▆▇▂▅▃▂▇▇▇▃▅▁▂▂▃▃▇▇▇▇▇▇▇▇
wandb:           val_accuracy0.75 ▇▇▇▇▇▇▇▇▇▇▇▇▇█▇▇▅▅▇▇▇▇▇▂▂▂▁▂▂▃▇▇▇▇▇▇▇▇▇▇
wandb:                  val_auroc ▁▁███▅▅▆████▇█▇▃▃▃▁▇▄▁▂▂▂▁▅▅▄▄▅▅▅▅▅▄▅▅▆▆
wandb:  val_balanced_accuracy0.25 ▃▃▇█▄▆▃▃▃▆▃▃▄▃▃▇▃█▆▆▄▃▃▃▃▃▃▃▁▁▃▃▃▃▃▃▃▃▃▃
wandb:   val_balanced_accuracy0.5 ▄▄▅▇▄▄▄▄▄▄▇▇▆▅▄▆█▅▅▄▄▄▄▄▄▄▃▄▄▁▃▂▄▄▄▄▄▄▄▄
wandb:  val_balanced_accuracy0.75 ▄▃▃▃▃▃▃▃▃▃▃▃▄▃▃▃▃▃▄▃▄█▂▃▃▃▃▃▁▂▃▃▃▃▃▃▃▃▃▃
wandb:          val_precision0.25 █▃▁█▁▃▃███▅▅█▄▅▂▃▂▃▃▃▃▃▁▁▁▁▂▂▂▂▃▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁███▁▁▁▁▁▁▁▄▅▃▃▂▁▁▁▁▁▁▁▃▂▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁█▁▁▁▁▁██▄▃▃▄▂▂▁▁▁▁▁▁▃▃▂▃▃▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ███▁▄▅▁▁▂█▁█▂▆▅▃▃▄▃▅▃▂▃▂▄█▁▄▄▃▃▃▃▃█▁█▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▂▂▁▁▂▁▁▁▁▆▂▃▄█▄▅▅▂▄▄▅█▇▇▁▁▅▅▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▂▂▂▁▁▁▁▁▁▂▅▅▆▃▅█▆▇▄█▁▁▁▁▁▄▄▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.74684
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.45085
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.46397
wandb:                 train_loss 1.69638
wandb:           val_accuracy0.25 0.75238
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.56183
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_60_3_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/61jkh3wg
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_3/wandb/run-20250618_061245-61jkh3wg/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_3/wandb/run-20250618_063456-y3kjtgj2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_60_3_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/y3kjtgj2
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁██▁▄▁▁██▁███▁█████▂▁█▂▂▁█▁█▁███▁██▂▁▁▇▇
wandb:           test_accuracy0.5 ███████████████▁████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▆▄▅▄▄▅▄▄▄▄▅▁▄▄▅▅▅▄▄▃▅▅▅▅▇▃▃▄▄▄▄▃▃▃▃▂▆▅█▅
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▄▁█▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▇▇▁▁▁▁▁▇▇▁▁▇▇▇▁▁▁▇▇▁▁▁▁▁▁█▇▁▇▇▁▇▁▁▁▁▇▇▁▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁█▁▂▅███▁▁▁▁▇▄▁▁▁▁▁▆▁▇▅▁█▁█▁▁█▁▁█▁▁▁▆▂▁▆
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▄▇▆▆▂▁▆▅▁▃█▅▅▅▂▂▂▃▇▆▇▇▆█▅▄▄▆▆▃▄▂▆▃▂▇▂█▄▃
wandb:                 train_loss █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 █▁▁█▇█▁▁██▁▁█▁▁█▁▁█████▄█▇▄▂█▃▁█▁█▁▂███▄
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▆█▄▃▃▅▅▅▅▅▅▅▅▃▆▆▆▆▇▇▆▇▇▇▆▅▆▇▇▁▇█▆▆▄▆▆▅▅▆
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▇▁▄██▁▇▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ████████████████████████▁███████████████
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▆▆▆▆▆▁▁▁▁▆▆▆▆▁▇▁▁▆▁▁▆▁▁▁█▁▁▆▆▁▆▁▆▆▁▆▇▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ██▁▁▄▁▁▁███▃▁▁▁▁▇▁▁▁█▆▂▂█▁▁▁▁▁█▁▁▁▁▁▇▁▂▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.74684
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.50593
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.48576
wandb:                 train_loss 1.69286
wandb:           val_accuracy0.25 0.75238
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.41018
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_60_3_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/y3kjtgj2
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_3/wandb/run-20250618_063456-y3kjtgj2/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_3/execution_datetimes.json

**************************************************  Experiment 60 | Version 4 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 2}
  - Fold 2: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 1, 1.0: 1}
  - Fold 3: 210 samples
    Label distribution: {0: 158, 1: 52}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 2}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_4/wandb/run-20250618_064619-s2d7ijbm
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_60_4_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/s2d7ijbm
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ███▁█▄▁██▅▁█▁███▄█▇▅▇▆▆▆▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:           test_accuracy0.5 ██████████████████████▄▂▄▃▄▃▃▄▄▄▃▃▂▃▂▂▂▁
wandb:          test_accuracy0.75 ███████████████▃▂▃▃▃▃▃▂▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂
wandb:                 test_auroc █▃▅▄▄▄█▆▆▆▅▆▇▇▆██▅▁▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▄▄▄▄▄▅▅▄█▃▆▇▆▄▃▄▅▂▂▂▂▂▂▁▁▂▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▇▇▇▇▇▇▇▇▇▇▇▇█████▄▆▄▃▃▄▄▃▄▄▃▃▃▂▁▂▁▁▁▂▁▁▁
wandb: test_balanced_accuracy0.75 ███████████████████▇▆▄▃▃▁▃▁▁▁▁▁▁▁▁▁▂▂▂▂▁
wandb:         test_precision0.25 ▃▃▁▁▁▃▃▃▁▃▁▃▃█▃▂▃▃▃▂▂▁▂▂▂▂▂▁▂▂▂▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▄▅▃▁▁▁▄▄▄▄▄▄▄▄▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▇█▁▅▄▁▁▁▁▁▁▃▃▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁█▁██▁▅█▅▁▇▅▁▂▃▄▃▃▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▁▃▁▆▁▃█▁▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁███▁█▁▁▁▅▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▂▁▂▁▁▂▂▂▃▃▄▃███████▇███████████████████
wandb:                 train_loss ███████████████▇▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ██▁▁███▁█▁▂▄▅█▇▄▅▅▇▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            val_accuracy0.5 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▇▇▇▅▂▁▅▄▄▃▃▄▄▅▅▅▅▅▅▅▅▅▅
wandb:           val_accuracy0.75 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▇▇▇▁▅▅▅▅▅▅▅▄▅▅▅▅▅▅▅▅▅▅▅
wandb:                  val_auroc ▁▇▆▆▆▅▆▅▇▆▅▅█▆▅▅▅▅▅▃▅▆▆▆▆▆▆▆▇▇▇▇▇▆▆▇▇▇▆▇
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▄▄▄▇▄▄▃▂▁▂▃▅▇▇▇▅▅▅▇▆▆▇▇▇▇▇██████
wandb:   val_balanced_accuracy0.5 ▂▂▂▂▂▂▂▂▂▂▂▇▅▇▅▃▁▄▃▅▅▃▃▅▅▇▇██▇██▇███████
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▃▄▆▂▁▃▂▂▅▅▅▄▅▅▄▆▅▆▆▆▆▇▆▆▇▇█
wandb:          val_precision0.25 ▁▁▃▃▁▃█▃▃▁▁▄▂▄▂▃▂▃▃▃▃▃▃▃▃▃▃▃▃▃▄▄▄▄▄▃▄▃▄▄
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▆▆▅▅▆▆▆▆▆▆▆▅▅▆▇▇▇▇▇█▇▇▇▇▇▇▇▇
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▅▃▄▄▃▃▃▄▄▄▄▄▃▃▄▄▄▄▄▄▄
wandb:             val_recall0.25 ▁▃▁▁██▁▂▁█▁▁█▂▅▂▃▂▂▃▂▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▅▇▆▇▆▅▅▇▅▆▆▆▇█████████████████
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▃▂▄▄▅▅▅▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▇█
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.58228
wandb:           test_accuracy0.5 0.58228
wandb:          test_accuracy0.75 0.63291
wandb:                 test_auroc 0.45763
wandb: test_balanced_accuracy0.25 0.38983
wandb:  test_balanced_accuracy0.5 0.38983
wandb: test_balanced_accuracy0.75 0.42373
wandb:         test_precision0.25 0
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.99939
wandb:                 train_loss 0.03903
wandb:           val_accuracy0.25 0.69524
wandb:            val_accuracy0.5 0.71429
wandb:           val_accuracy0.75 0.72381
wandb:                  val_auroc 0.57059
wandb:  val_balanced_accuracy0.25 0.55234
wandb:   val_balanced_accuracy0.5 0.565
wandb:  val_balanced_accuracy0.75 0.57132
wandb:          val_precision0.25 0.35
wandb:           val_precision0.5 0.38889
wandb:          val_precision0.75 0.41176
wandb:             val_recall0.25 0.26923
wandb:              val_recall0.5 0.26923
wandb:             val_recall0.75 0.26923
wandb: 
wandb: 🚀 View run resnet18_2d_60_4_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/s2d7ijbm
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_4/wandb/run-20250618_064619-s2d7ijbm/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_4/wandb/run-20250618_070429-fio8tzbq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_60_4_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/fio8tzbq
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁█▁▁█▁▁█▅▃▆▅▆▄▆▆▆▆▆▆▆▆▆▆▇▇▆▆▆▆▆▇▇▇▆▇▇▇▇
wandb:           test_accuracy0.5 ███████████████▁▃▁▃▃▄▄▄▄▄▄▄▄▄▄▄▃▄▄▄▄▄▄▄▄
wandb:          test_accuracy0.75 ███████████████████▄▁▄▃▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:                 test_auroc █▆█▅█▄▄▄▅▅▄▄▅▅▅▅▄▄▄▅▄▂▁▅▅▅▄▄▄▅▅▅▅▅▅▅▅▅▅▅
wandb: test_balanced_accuracy0.25 ▆▆▆▆▆▁▆▆▆▆▆▇▃▄▂▆▄▅▅▅▆▇▇▇▇▇▇▇▇▇█▇▇██▆▆█▇█
wandb:  test_balanced_accuracy0.5 ▂▂▂▂▂▂▂▂▂▂▂▂█▁▅████████████████████▁████
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▃▅▅▅▅▅▅▅▅▅▅▅▅▅▅████▅██
wandb:         test_precision0.25 ▇▇▇▇▁▇▇▁▁▇▇▇▁▇▇█▇▇▆▇▇▇▇███████▇█▇████▇██
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▇▅▇▇████████████████████
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆█▆▇█████████████████████
wandb:            test_recall0.25 █▁▂▂▁██▁▁▃▁▁▄▅▃▃▁▂▄▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▃▂█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅██▅██████████████████████
wandb:                train_auroc ▁▁▃▂▂▂▂▂▃▂▂▂▄▃▃█████████████████████████
wandb:                 train_loss ███████▇▇▇▇▇▄▄▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁███▁▁▁▆█▁█▅▅▅▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            val_accuracy0.5 ███████████████▁█▄▄▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▄▅▅▄▅▅
wandb:           val_accuracy0.75 █████████████▃▆▁▂▃▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▃▂▂
wandb:                  val_auroc ▁█▇█▆▆▆▇█▇▇▆▆▅▆▆▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▂▁▄▅▁▅▂█▅██▁▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:   val_balanced_accuracy0.5 ▃▃▃▃▃▇▃▃▃▃▃▃▅▃▃▃▃▃▃▃▁▁▄▄▃██████▆██▆█████
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁█▆█▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆█
wandb:          val_precision0.25 ▅▆▅▁▅▅▅▆▅▁▆▆█▆▆▆▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▆▆▆▇▆▆▆
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▃▄▄▄▄▄▄▄▄▄▄▃▃▄▄▃▄▄▃▄▄
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▇████████████████████
wandb:             val_recall0.25 ██▁█▁█▁▁▁▁██▂▆▄▁▄▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▇▁▁█▇▅▇▇▇▇▇▇▇▇▇▇▇▇▇▆▇▇▇▇▇▇▇▇▇▇
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▇▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.64557
wandb:           test_accuracy0.5 0.64557
wandb:          test_accuracy0.75 0.65823
wandb:                 test_auroc 0.47373
wandb: test_balanced_accuracy0.25 0.51483
wandb:  test_balanced_accuracy0.5 0.51483
wandb: test_balanced_accuracy0.75 0.52331
wandb:         test_precision0.25 0.27778
wandb:          test_precision0.5 0.27778
wandb:         test_precision0.75 0.29412
wandb:            test_recall0.25 0.25
wandb:             test_recall0.5 0.25
wandb:            test_recall0.75 0.25
wandb:                train_auroc 0.99921
wandb:                 train_loss 0.04385
wandb:           val_accuracy0.25 0.70476
wandb:            val_accuracy0.5 0.71429
wandb:           val_accuracy0.75 0.70476
wandb:                  val_auroc 0.50876
wandb:  val_balanced_accuracy0.25 0.54576
wandb:   val_balanced_accuracy0.5 0.55209
wandb:  val_balanced_accuracy0.75 0.53286
wandb:          val_precision0.25 0.35294
wandb:           val_precision0.5 0.375
wandb:          val_precision0.75 0.33333
wandb:             val_recall0.25 0.23077
wandb:              val_recall0.5 0.23077
wandb:             val_recall0.75 0.19231
wandb: 
wandb: 🚀 View run resnet18_2d_60_4_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/fio8tzbq
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_4/wandb/run-20250618_070429-fio8tzbq/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_60/version_4/wandb/run-20250618_071753-03e6v3tl
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_60_4_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_lung_slice_oneclass_22_splits/runs/03e6v3tl
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
