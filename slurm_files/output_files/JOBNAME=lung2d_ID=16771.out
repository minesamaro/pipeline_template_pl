Initialization time: 2025-07-25 15:30:40

**************************************************  Experiment 87 | Version 1 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 212 samples
    Label distribution: {0: 159, 1: 53}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 16}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 3, 1.0: 1}
  - Fold 2: 213 samples
    Label distribution: {0: 159, 1: 54}
    Batch label distribution: {0.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 3, 1.0: 2}
  - Fold 3: 213 samples
    Label distribution: {0: 160, 1: 53}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 3, 1.0: 2}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 107 samples
    Label distribution: {0: 80, 1: 27}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 4}
  - Fold 2: 106 samples
    Label distribution: {0: 80, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 2}
  - Fold 3: 106 samples
    Label distribution: {0: 79, 1: 27}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 2: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 3: 80 samples
    Label distribution: {0: 60, 1: 20}
wandb: Currently logged in as: maria-i-paiva (maria-i-paiva-inesc-tec) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: WARNING Using a boolean value for 'reinit' is deprecated. Use 'return_previous' or 'finish_previous' instead.
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_1/wandb/run-20250725_153130-iwu2ryx9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_1_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/iwu2ryx9
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 335-335, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁█▁███▁█▃▃▃▅▅▅▆█▁▄▆▅▃▇▅▇▆▅▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           test_accuracy0.5 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▁▃▃▃▃▃▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂
wandb:          test_accuracy0.75 ████████████████████▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▄▂▂
wandb:                 test_auroc █▃▅▄▆▃▄▃▄▃▃▃▃▃▃▃▅▅▅▁▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb: test_balanced_accuracy0.25 ▄▄▄▄▄▆▆▆▃▅▅▄▄▄▄▅▁▆▄▃█▇▅▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:         test_precision0.25 ▁▁▁▃▃▃▁▁▃▃▃▃▃▃▁▂▃▃▃▂▃▃█▃▃▂▃▃▃▃▄▄▄▄▄▄▄▄▄▄
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▄▁▁▁▁▁▁▁▁█▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:            test_recall0.25 █▁█▇▁▅▅▅▄▁▅█▁▁▃▆▅▂█▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅▇▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃█████████████████
wandb:                train_auroc ▂▁▂▁▂▁▃▂▃▂▃▂▃▂▃▃▃▃▄▄████████████████████
wandb:                 train_loss ███████████████▇▇▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁██▁▁▁█▁▄▇▃▅▃▃▁▄█▁▂▅▆▃▇▄▅▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            val_accuracy0.5 █████████████████████████▁▅▅▅▄▄▄▄▄▄▄▄▄▄▄
wandb:           val_accuracy0.75 █████████████████████████▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:                  val_auroc ▆▆█▄▄▇▆▆▇▆▆▆▅▆▆▇▂▇▇▆▇█▅▇▆▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.25 ▃▃▃▂▃▃▃▇▄▃▆▅▃▃▃▄▇▄▄█▆▃▂▁▄▄▄▄▃▃▃▄▄▄▄▄▄▄▄▄
wandb:   val_balanced_accuracy0.5 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▁▁█████▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▃▅▅▅▅▅▅▅▅▅██▇▇▇▇▇▇▇▇
wandb:          val_precision0.25 ▁▁▁▁▁▆▇▅▆▆▆▅▆▅▁██▇▇▅▆▆▆▆▄▆▆▆▆▅▆▆▆▆▆▆▆▆▆▆
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆█████████████████
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▇▆▇▇▇▇▇▇▇▇▇█████████
wandb:             val_recall0.25 ▁▁█▁▁▅▁▇▅▅▂▁▇▄▆▆▆▃▄█▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█████████████████████
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▇▂▇▇▇▇▇▇▇██████████████
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.7
wandb:           test_accuracy0.5 0.7
wandb:          test_accuracy0.75 0.7125
wandb:                 test_auroc 0.50417
wandb: test_balanced_accuracy0.25 0.55
wandb:  test_balanced_accuracy0.5 0.53333
wandb: test_balanced_accuracy0.75 0.54167
wandb:         test_precision0.25 0.35714
wandb:          test_precision0.5 0.33333
wandb:         test_precision0.75 0.36364
wandb:            test_recall0.25 0.25
wandb:             test_recall0.5 0.2
wandb:            test_recall0.75 0.2
wandb:                train_auroc 1
wandb:                 train_loss 1e-05
wandb:           val_accuracy0.25 0.66355
wandb:            val_accuracy0.5 0.66355
wandb:           val_accuracy0.75 0.70093
wandb:                  val_auroc 0.40926
wandb:  val_balanced_accuracy0.25 0.50509
wandb:   val_balanced_accuracy0.5 0.50509
wandb:  val_balanced_accuracy0.75 0.53009
wandb:          val_precision0.25 0.26316
wandb:           val_precision0.5 0.26316
wandb:          val_precision0.75 0.33333
wandb:             val_recall0.25 0.18519
wandb:              val_recall0.5 0.18519
wandb:             val_recall0.75 0.18519
wandb: 
wandb: 🚀 View run resnet18_2d_87_1_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/iwu2ryx9
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_1/wandb/run-20250725_153130-iwu2ryx9/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_1/wandb/run-20250725_154431-ohqgqdqa
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_1_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/ohqgqdqa
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 █▁██▁▆█▁▁▁▁▇▄▄▃▅▆▆██████████████████████
wandb:           test_accuracy0.5 ▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅█▁█████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃█▃▁▁▁▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:                 test_auroc ▂▅▅▄▄▄▃▃▃▃▁▁▄▃▅▆█▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▄▃▄▄▃▃▁▂▆▆▆▇██▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▆█▆████████████████████
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▆██████████████████
wandb:         test_precision0.25 ▁▄▄▁▄▁▄▄▄▄▄▄▃▄▆█████████████████████████
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▄█▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▇▇▇████████████████████
wandb:            test_recall0.25 ▁███▁█▁▇▇▆▇▁▄▃▄▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅█▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆█▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:                train_auroc ▂▁▁▁▂▁▂▂▁▂▃▃▃▄▄▅▄▅▇█████████████████████
wandb:                 train_loss ███████████████▇▆▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁█▁▁▁██▁▁▁▄▆▅▅▄▃▄▃▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:            val_accuracy0.5 ████████████████▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂▂
wandb:           val_accuracy0.75 ███████████████████▇▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc █▆▂▆▆▆▆▅▇▆▆█▇▅▃▄▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.25 ▆▆▆▇▆▆▆▆█▆█▆▅▆▁▆▃▃▃▄▄▄▄▄▄▄▄▄▄▄▄▄▅▅▅▅▅▅▄▅
wandb:   val_balanced_accuracy0.5 █████████████████▄▇▃▇█▁▄▂▂▂▂▂▂▂▂▂▄▄▄▄▄▄▄
wandb:  val_balanced_accuracy0.75 ███████████████▅▅▆▇▄▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:          val_precision0.25 ▇▇▇▇▇▁█▇█▇█▇██▇▅▇▃▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▇▇▇▇▇
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▃▆▆▆▆▆▆▆▆▆▇▆▇▆▆▇▇▇▇▇▇▇▇▇
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅████████████████
wandb:             val_recall0.25 ███▄█▁▂█▆▄▂▁▄▄▃▂▂▂▂▂▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃█▅█▂▄▄▄▄▄▅▅▅▅▅▅▅▅▅▅
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅▅▅▅▅█████████
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.775
wandb:           test_accuracy0.5 0.775
wandb:          test_accuracy0.75 0.7625
wandb:                 test_auroc 0.64708
wandb: test_balanced_accuracy0.25 0.61667
wandb:  test_balanced_accuracy0.5 0.61667
wandb: test_balanced_accuracy0.75 0.59167
wandb:         test_precision0.25 0.6
wandb:          test_precision0.5 0.6
wandb:         test_precision0.75 0.55556
wandb:            test_recall0.25 0.3
wandb:             test_recall0.5 0.3
wandb:            test_recall0.75 0.25
wandb:                train_auroc 1
wandb:                 train_loss 1e-05
wandb:           val_accuracy0.25 0.59434
wandb:            val_accuracy0.5 0.59434
wandb:           val_accuracy0.75 0.59434
wandb:                  val_auroc 0.44375
wandb:  val_balanced_accuracy0.25 0.48462
wandb:   val_balanced_accuracy0.5 0.44567
wandb:  val_balanced_accuracy0.75 0.41971
wandb:          val_precision0.25 0.22581
wandb:           val_precision0.5 0.16
wandb:          val_precision0.75 0.09524
wandb:             val_recall0.25 0.26923
wandb:              val_recall0.5 0.15385
wandb:             val_recall0.75 0.07692
wandb: 
wandb: 🚀 View run resnet18_2d_87_1_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/ohqgqdqa
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_1/wandb/run-20250725_154431-ohqgqdqa/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_1/wandb/run-20250725_155524-t1ghzufj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_1_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/t1ghzufj
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 █▁█▁██▁██▁██▁█▁███▁██▁▁▅▄█▁██▁▁▁████▁▁██
wandb:           test_accuracy0.5 █▁▁█████████████████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▆▄▅▄▆▇▇▇▇▇▁█▇██▇▆▇▇▇▇▇▇▇▅▆▆▅▅▆▆▆▇▆▆▆▆▆▆▆
wandb: test_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▁▂▂▂▁▂▁▂▂▁▁▂█▇▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ██████████████▁█████████████████████████
wandb:         test_precision0.25 ▁▁██▁█▁█▁▁█▁█████▁▁▁▁██▁▁▁▁█▁▁▁▁██▁█▁██▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁█▁██▁▁▁▁▁█▁▁▁█▁▁▁▁█▇▁▁█▁██▁█▁██▁▁██▁▁█▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▆▆▆▃▄▄▆▁▆▄▃▂▁▁▄▃▇█▃▃▅▃▃▃▃▂▃▅▁▄▃▂▃▄▄▂▂▅▂▄
wandb:                 train_loss █▁▂▂▁▂▁▂▁▂▂▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ███▁▁███▁███▁█▆▁▁▁█▁██▃▁▁███████████████
wandb:            val_accuracy0.5 ▁▁█████████████▁████████████████████████
wandb:           val_accuracy0.75 ▁███████████▁███████▁███████████████████
wandb:                  val_auroc ▇▁▆▅▆▆▂▃▇▇▅▇▇▇▅▆█▇▇▆▆▅▆▆▅▆▅▆▆▆▇▆▆▆▇▆▇▆▆▇
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▁▂▂▂▂▂▂▂█▂▂▂▂▂▂▂▄▁█▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▇▇▁▇▁▁▁▁▇▁█▇▁▇▁▁▁▁▁▁▁▇▁▇▁▁▇▇▇▇▇▁▇▁▁▁▁▁▇
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁█▁▁█▁█▁▁▁█▁█▁█▇▁███▁▁███▁▁█▁▁▁▁██▁██▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.57333
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.43031
wandb:                 train_loss 1.6802
wandb:           val_accuracy0.25 0.25472
wandb:            val_accuracy0.5 0.74528
wandb:           val_accuracy0.75 0.74528
wandb:                  val_auroc 0.56306
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.25472
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_1_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/t1ghzufj
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_1/wandb/run-20250725_155524-t1ghzufj/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_1/execution_datetimes.json

**************************************************  Experiment 87 | Version 2 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 212 samples
    Label distribution: {0: 159, 1: 53}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 29, 1.0: 3}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 15, 1.0: 5}
  - Fold 2: 213 samples
    Label distribution: {0: 159, 1: 54}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 14, 1.0: 7}
  - Fold 3: 213 samples
    Label distribution: {0: 160, 1: 53}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 17, 1.0: 4}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 107 samples
    Label distribution: {0: 80, 1: 27}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 7, 1.0: 4}
  - Fold 2: 106 samples
    Label distribution: {0: 80, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 2}
  - Fold 3: 106 samples
    Label distribution: {0: 79, 1: 27}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 9, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 28, 1.0: 4}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 2: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 28, 1.0: 4}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 3: 80 samples
    Label distribution: {0: 60, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_2/wandb/run-20250725_160822-rh1yh62q
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_2_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/rh1yh62q
    Batch label distribution: {0.0: 28, 1.0: 4}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▇▇▃▄▂▅▅▅█▄▆▄▆▅█▇██████████████████████
wandb:           test_accuracy0.5 ██████████████████▁█████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁███████████████████
wandb:                 test_auroc ▄▇▅▅▅▃▂▂▄▆▂▃▃▃▂▃▃▃▂▂█▁▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▁▂▅▅█▄▂▅▄▄▇▄▄▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁██████████████████████
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▇█████████████████
wandb:         test_precision0.25 ▅▅▅▅▁▅▅▃▂▅▅▆▅▅▆▇████████████████████████
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▅█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▇▇█████████████
wandb:            test_recall0.25 █▁█▅▁▁█▁▆▆▅▅▅▆▂▅▅▆▁▅▇▇▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅█▂▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▃▁▁▁▁▁██████████████████████
wandb:                train_auroc ▁▂▃▂▂▃▃▃▃▃▃▃▅▄██████████████████████████
wandb:                 train_loss ██████████████▇▆▄▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 █▁▅▄▆▇▅▄▁▁▅▅▇▆▇▅▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            val_accuracy0.5 ███████████████████▆▃▂▁▃▃▄▄▄▄▄▄▄▄▄▄▃▃▃▃▃
wandb:           val_accuracy0.75 ████████████████▁▆▃▄▅▅▅▅▅▄▄▄▄▄▄▄▅▅▅▅▅▅▅▅
wandb:                  val_auroc ▇▇▇▇▆▆▆▅▅▇▇█▇▇▆▅▂▃▃▃▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▄▄▇▃▅▆▄▅█▆▁▇▃▃▃▄▄▄▄▅▅▅▅▅▅▄▄▄▄▄▄▄▄▄▄▄
wandb:   val_balanced_accuracy0.5 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▁▅▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:  val_balanced_accuracy0.75 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▃▁▇▆▆▆▅▅▅▅▅▅▅▅▅▇▇▇███████
wandb:          val_precision0.25 ▁▁▇▇▁▃█▄█▇▇█▇▆▇▅█▆▆▅▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▆█▆██▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▄▄█▅▆▆▆▆▆▆▅▅▅▅▅▅▆▇▇
wandb:             val_recall0.25 █▁█▁▁▇▁▁▆▄▁▆▃▇▄▇▇▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▇██████▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▆▅▅▅▅▅▅▅▅▅▅▅▅▅▆▆▆▆▆▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.75
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.7625
wandb:                 test_auroc 0.61667
wandb: test_balanced_accuracy0.25 0.55
wandb:  test_balanced_accuracy0.5 0.55
wandb: test_balanced_accuracy0.75 0.55833
wandb:         test_precision0.25 0.5
wandb:          test_precision0.5 0.5
wandb:         test_precision0.75 0.6
wandb:            test_recall0.25 0.15
wandb:             test_recall0.5 0.15
wandb:            test_recall0.75 0.15
wandb:                train_auroc 1
wandb:                 train_loss 1e-05
wandb:           val_accuracy0.25 0.66355
wandb:            val_accuracy0.5 0.6729
wandb:           val_accuracy0.75 0.69159
wandb:                  val_auroc 0.45231
wandb:  val_balanced_accuracy0.25 0.49282
wandb:   val_balanced_accuracy0.5 0.49907
wandb:  val_balanced_accuracy0.75 0.51157
wandb:          val_precision0.25 0.23529
wandb:           val_precision0.5 0.25
wandb:          val_precision0.75 0.28571
wandb:             val_recall0.25 0.14815
wandb:              val_recall0.5 0.14815
wandb:             val_recall0.75 0.14815
wandb: 
wandb: 🚀 View run resnet18_2d_87_2_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/rh1yh62q
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_2/wandb/run-20250725_160822-rh1yh62q/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_2/wandb/run-20250725_161940-4joakk4n
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_2_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/4joakk4n
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁█▁▇▁█▃▆▇▁▄▆█▄▅█████████████████████████
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁▁▁▅▅▅██████████████████
wandb:          test_accuracy0.75 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▇▁▆▆▇▇▇▇▇▇▇█████▇▇▇▇▇▇▇█
wandb:                 test_auroc █▄▅▄▂▄▃▂▂▂▁▁▃▇▅▅▅▅▅▅▄▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb: test_balanced_accuracy0.25 ▃▃▃▂▁▆▄▅▆▆▃▂▅██▇▇▇▇▇▇▇▇▇▇▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▅▆█▇▅▅▅▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅▅▅▅▅▅▅▅▅▅▅▅▅▄▄▄▄▄▄▄▄▅▅▅▅
wandb:         test_precision0.25 ▁▄▄▄▅▅▃▄▄▄▄▄▃▁▄▃▄▄▅▇████████▇▇▇█████████
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▆▇▅▄▆▇█████████████████████
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▃▇▇▇▇▇▇▇▇▇▇█████▇▇▇▇▇▇▇▇███
wandb:            test_recall0.25 ▁▁█▁▆▁▇▆▅▇▇▇▅▆▂▂▅▃▅▃▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▂▁█▇▇▅▅▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁█▁█▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▃▃▃▃▃▃▅▅▅
wandb:                train_auroc ▂▁▁▂▂▂▂▁▃▃▃▄▄▃▄▄▇▇▅█████████████████████
wandb:                 train_loss ███████████▇▇▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 █▁▅▃██▂▄▅▆▂█▆▃▆▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            val_accuracy0.5 ████████████▇█▁▄▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:           val_accuracy0.75 ███████████████▄▅▁▄▄▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▅▅
wandb:                  val_auroc ▇██▇█▇█▇▇▇▇▇▆▇▅▂▆▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.25 ▅▅▅▅▅▅▆▄█▅▅▄▆▅▅▁▄▁▄▃▂▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:   val_balanced_accuracy0.5 ███████████▁▅▃▄▅▅▅▅▅▅▅▅▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:  val_balanced_accuracy0.75 █████████████▄▁▅▆▇▇▇▇▇▇▆▆▆▆▆▆▆▇▇▇▇▇▇▇▆▆▆
wandb:          val_precision0.25 ▁▁▁▇▇▁▇▇█▇▇▇▄▆▆▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▅█▄▄▃▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▆▄▅▇▇███▁▁▁▁▁████████▆▆▆▆▆▆▆
wandb:             val_recall0.25 ▁▁██▃▄█▁█▇▅▆▇▆▄▂▇▁▄▂▄▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▃▆█▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁███████████▁▁▁▁▁██████████
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.775
wandb:           test_accuracy0.5 0.775
wandb:          test_accuracy0.75 0.775
wandb:                 test_auroc 0.56833
wandb: test_balanced_accuracy0.25 0.58333
wandb:  test_balanced_accuracy0.5 0.58333
wandb: test_balanced_accuracy0.75 0.56667
wandb:         test_precision0.25 0.66667
wandb:          test_precision0.5 0.66667
wandb:         test_precision0.75 0.75
wandb:            test_recall0.25 0.2
wandb:             test_recall0.5 0.2
wandb:            test_recall0.75 0.15
wandb:                train_auroc 1
wandb:                 train_loss 1e-05
wandb:           val_accuracy0.25 0.66981
wandb:            val_accuracy0.5 0.69811
wandb:           val_accuracy0.75 0.70755
wandb:                  val_auroc 0.3476
wandb:  val_balanced_accuracy0.25 0.45673
wandb:   val_balanced_accuracy0.5 0.47548
wandb:  val_balanced_accuracy0.75 0.48173
wandb:          val_precision0.25 0.09091
wandb:           val_precision0.5 0.125
wandb:          val_precision0.75 0.14286
wandb:             val_recall0.25 0.03846
wandb:              val_recall0.5 0.03846
wandb:             val_recall0.75 0.03846
wandb: 
wandb: 🚀 View run resnet18_2d_87_2_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/4joakk4n
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_2/wandb/run-20250725_161940-4joakk4n/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_2/wandb/run-20250725_162931-z6l4g5r3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_2_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/z6l4g5r3
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: uploading history steps 344-344, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ███▁██▁██▁███▇▇██▆█▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           test_accuracy0.5 ▇▇▇▇▇▇▇▇▇▇▇▅▅▅▇▅▄▄▅▅▁█▂▂▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:          test_accuracy0.75 ▆▆▅▆▆▆▆▆▆▆▅▆▆▅▅▅▆▅▁█▁▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:                 test_auroc █▅▆▅▅▇▅▆▅▅▅▆▆▆▆▅▆▃▃▆▇▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.25 ▂▁▁▂▂▂▂▂▂▂▄▇▆▆▁▇▁▂▃▅█▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:  test_balanced_accuracy0.5 ▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▂▁▂▇█▆▇▅▅▇▆▇▅▆▅▅▅▅▅▅▅▅▅▅▅
wandb: test_balanced_accuracy0.75 ▂▂▂▂▂▂▂▂▂▂▂▁▁▁▂▁▁▅▆███▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:         test_precision0.25 ▆▁▄▄▄▄▁▁▄▁▁▅▇▆▆█▆▇▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▅▁▁▁▁▇▇█▆▇▆▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▆▁▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            test_recall0.25 █▄███▁▁▂█▁▃▁▁█▃▃▃▂▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▂▂▅▁▅█▇▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁▁▆▆███████████
wandb:                train_auroc ▂▃▃▃▄▂▂▂▂▂▂▂▂▂▃▁▂▄▃▂▄▅██████████████████
wandb:                 train_loss ████████████████████▇▇▇▅▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ██▁████▁▁██▁▇▇▁▇▇▇▇▇▇▇▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            val_accuracy0.5 ████████████▇▅▆▂▂▂▁▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▄▄▄▄▄
wandb:           val_accuracy0.75 ███████████████▇█▇▇▇█▂▁▄▄▄▄▄▄▄▅▅▅▅▅▅▅▅▅▅
wandb:                  val_auroc ▇▇▆▁▆▇▇▆▆▆█▃▅▃▅▆▁▃▂▁▄▆▃▄▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂▂▃▂▁▂▂▁▃▃▃▂█▄▄▄▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:   val_balanced_accuracy0.5 ▂▂▂▂▂▂▂▂▂▂▂▂▂▁▂▃▅▄▅█▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▇▇▇▇▇
wandb:  val_balanced_accuracy0.75 ▂▂▂▁▁▂▂▂▂▂▂▂▂▂▂▂▁▁▁▂▄▄▇▇▇███████████████
wandb:          val_precision0.25 ▁▁▅▁▁▁▅▅▁▄█▅▅█▅▆▆▅▄▅▅▇▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅██▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:             val_recall0.25 ▁▁██▁█▁▁▁▁▁▁▁█▁█▃▃▂▃▂▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▃▂▄▃▇▂▆█▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▁▄▄▄▇███████████████████
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.7125
wandb:           test_accuracy0.5 0.7125
wandb:          test_accuracy0.75 0.725
wandb:                 test_auroc 0.4825
wandb: test_balanced_accuracy0.25 0.55833
wandb:  test_balanced_accuracy0.5 0.54167
wandb: test_balanced_accuracy0.75 0.55
wandb:         test_precision0.25 0.38462
wandb:          test_precision0.5 0.36364
wandb:         test_precision0.75 0.4
wandb:            test_recall0.25 0.25
wandb:             test_recall0.5 0.2
wandb:            test_recall0.75 0.2
wandb:                train_auroc 1
wandb:                 train_loss 1e-05
wandb:           val_accuracy0.25 0.67925
wandb:            val_accuracy0.5 0.68868
wandb:           val_accuracy0.75 0.69811
wandb:                  val_auroc 0.5504
wandb:  val_balanced_accuracy0.25 0.55321
wandb:   val_balanced_accuracy0.5 0.55954
wandb:  val_balanced_accuracy0.75 0.56587
wandb:          val_precision0.25 0.34783
wandb:           val_precision0.5 0.36364
wandb:          val_precision0.75 0.38095
wandb:             val_recall0.25 0.2963
wandb:              val_recall0.5 0.2963
wandb:             val_recall0.75 0.2963
wandb: 
wandb: 🚀 View run resnet18_2d_87_2_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/z6l4g5r3
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_2/wandb/run-20250725_162931-z6l4g5r3/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_2/execution_datetimes.json

**************************************************  Experiment 87 | Version 3 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 212 samples
    Label distribution: {0: 159, 1: 53}
    Batch label distribution: {0.0: 46, 1.0: 18}
    Batch label distribution: {0.0: 47, 1.0: 17}
    Batch label distribution: {0.0: 51, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 5}
  - Fold 2: 213 samples
    Label distribution: {0: 159, 1: 54}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 45, 1.0: 19}
    Batch label distribution: {0.0: 14, 1.0: 7}
  - Fold 3: 213 samples
    Label distribution: {0: 160, 1: 53}
    Batch label distribution: {0.0: 45, 1.0: 19}
    Batch label distribution: {0.0: 47, 1.0: 17}
    Batch label distribution: {0.0: 51, 1.0: 13}
    Batch label distribution: {0.0: 17, 1.0: 4}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 107 samples
    Label distribution: {0: 80, 1: 27}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 30, 1.0: 13}
  - Fold 2: 106 samples
    Label distribution: {0: 80, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 31, 1.0: 11}
  - Fold 3: 106 samples
    Label distribution: {0: 79, 1: 27}
    Batch label distribution: {0.0: 51, 1.0: 13}
    Batch label distribution: {0.0: 28, 1.0: 14}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 2: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 3: 80 samples
    Label distribution: {0: 60, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_3/wandb/run-20250725_164328-yczyr31c
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_3_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/yczyr31c
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 10, 1.0: 6}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading config.yaml
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁█▁█▁▅▂▁▃█▇█▃▄▂█▅▅▄▇██▁▄▁██▁██████▁█▁███
wandb:           test_accuracy0.5 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆█▆▁▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▅▅▆▆▆▆▄▆▅▆▆▇▇▆▆▆▇▇▆█▁▇▆▇▆▆▆▆▆▆▆▆▆▆▇▆▄▄▄▅
wandb: test_balanced_accuracy0.25 ▂▃▃▃▅▅▄▆▃▅▃▆▅▅▄▆▂▆▆██▆▅▃▃▃▃▃▃▃▃▃▁▃▃▃▃▃▃▃
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▆▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▅▅▅▁▅▁▁▆▅▅▅▅▁▁█▇▅▁▁▁▅▁▁▁▁▁▁▅▁▁▁▅▅▆▇▁▅▅▅▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ██▁▁▆▅▇█▆▆▆▇▃▁▁▁█▁▁▁▁▁█▁▁▁███▁▅█▇▇███▁▁█
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁
wandb:                train_auroc ▃▃▁▂▄▄▃▄▂▃▄▇█▃▂▃▃▃▄▂▄▂▃▄▄▄▃▄▂▃▄▃▃▄▄▃▄▄▃▅
wandb:                 train_loss ▇▇▇▆█▇▆▆▆▅▅▄▅▅▆▃▆▅▄▇▇▇▇▇▇▇▇▇▇▇▆▇▆▇▁▇▇▇▇▆
wandb:           val_accuracy0.25 ▁▅████▃█▃▅▄▁▆█▇▁██▁███▁▂█▁▁▃▁▄▄█▄█▁▁▁▁██
wandb:            val_accuracy0.5 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃█▆▃▁▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▇▇▇▇▆▇▇▇▅▅▇▇▇▇▆█▇▃▂▁▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▃▄▃▃▄
wandb:  val_balanced_accuracy0.25 ▃▃▃▅▃▃▆▇▇▃▃▂▁▄▃▃▂▃█▃▃▃▃▃▃▃▃▃▃▃▃▆▃▃▇▇▃▃▃▃
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▃▁▃▁▃▁▁▃▅▄▁▁▄▄▁▄▆█▃▆▄▆▃▃▁▃▃▁▆▁▁▁▄▄▃▃▃▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅█▁▁▁▁▁▁▁▁▁▁▁▁▁▄▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 █▁█▁▅▄▄█▇▄▇▃▁█▆▅▄▃▇█▁▁▇█▁▁▁███▁▁▁▅▇▇▇▃█▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.75
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.55333
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.63866
wandb:                 train_loss 1.67931
wandb:           val_accuracy0.25 0.74766
wandb:            val_accuracy0.5 0.74766
wandb:           val_accuracy0.75 0.74766
wandb:                  val_auroc 0.52176
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_3_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/yczyr31c
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_3/wandb/run-20250725_164328-yczyr31c/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_3/wandb/run-20250725_165539-1qpjwtnq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_3_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/1qpjwtnq
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁███▁▁█▇█▆▃▁▅▇▇▇▄▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           test_accuracy0.5 ████████████████████▃█▃▄▂▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:          test_accuracy0.75 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▄▅▄▄▃▃▂▃▂▂▁█▁▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb: test_balanced_accuracy0.25 ▃▃▃▂▃▃▂▁▃▅▆▂▄▄▄█▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:  test_balanced_accuracy0.5 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▇▁▃█▇▅▄▄▄▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb: test_balanced_accuracy0.75 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂█▁▄▇▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:         test_precision0.25 ▇▇▇▆▁▆▇▇▇▇▇▆▇▇████▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▄█▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▄▆▄▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            test_recall0.25 ████▆▆▁▆▆▃▃▃▅▃▄▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▂▂▇▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:                train_auroc ▁▁▂▂▁▁▁▂▁▃▃▃▃▂▂▃▂▅▇█████████████████████
wandb:                 train_loss ████████████▇▇▄▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁█▂▆▇▂▂█▅███▂▂▂▆█▅▆▆▆▇▆▆▆▆▆▆▆▆▆▆▆▇▇▇▇▇
wandb:            val_accuracy0.5 █████████████████▇▁▅▅▆▆▆▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:           val_accuracy0.75 ███████████████▁▇▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:                  val_auroc █▇▇▇█▆▇▇▆█▆▇▇▆▇▅▄▃▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▅▆▄▇▄▃▆▅█▅▇▃▁▂▄▃▂▃▃▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂
wandb:   val_balanced_accuracy0.5 ████████████████████▃▃▁▁▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂
wandb:  val_balanced_accuracy0.75 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▂▃█▁▁▁▁▁▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:          val_precision0.25 ▁▄▄▁▄▄▄▄█▄▄▄▄▅▄▄▃▃▄▄▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅▇▄▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁█▁▁▁▁▁▁▁▁▁▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:             val_recall0.25 █▁▁▂█▄▇▇▂▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▆▅▅▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.675
wandb:           test_accuracy0.5 0.6875
wandb:          test_accuracy0.75 0.7
wandb:                 test_auroc 0.54083
wandb: test_balanced_accuracy0.25 0.51667
wandb:  test_balanced_accuracy0.5 0.525
wandb: test_balanced_accuracy0.75 0.51667
wandb:         test_precision0.25 0.28571
wandb:          test_precision0.5 0.30769
wandb:         test_precision0.75 0.3
wandb:            test_recall0.25 0.2
wandb:             test_recall0.5 0.2
wandb:            test_recall0.75 0.15
wandb:                train_auroc 1
wandb:                 train_loss 1e-05
wandb:           val_accuracy0.25 0.66038
wandb:            val_accuracy0.5 0.66038
wandb:           val_accuracy0.75 0.66981
wandb:                  val_auroc 0.42644
wandb:  val_balanced_accuracy0.25 0.45048
wandb:   val_balanced_accuracy0.5 0.45048
wandb:  val_balanced_accuracy0.75 0.45673
wandb:          val_precision0.25 0.08333
wandb:           val_precision0.5 0.08333
wandb:          val_precision0.75 0.09091
wandb:             val_recall0.25 0.03846
wandb:              val_recall0.5 0.03846
wandb:             val_recall0.75 0.03846
wandb: 
wandb: 🚀 View run resnet18_2d_87_3_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/1qpjwtnq
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_3/wandb/run-20250725_165539-1qpjwtnq/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_3/wandb/run-20250725_170701-o11z3m8k
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_3_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/o11z3m8k
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 █▁███████▁█▁▁████▁█▁▁▁██▁███▆▁▁██▁█▁▁▁▁█
wandb:           test_accuracy0.5 ▆▆▆▆▆▁▃█▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▃▆▆▆▆▆▆
wandb:          test_accuracy0.75 ██▁▁▁█████████████████████████████▁█████
wandb:                 test_auroc ▅▇▇▇▇▇▆▅▅▅▆▇▇▇▇▇▇▇▇▇▇▇▇█▆▅▅▆▇▇▄▁▆█▇▇▇▇▆▇
wandb: test_balanced_accuracy0.25 ▇▂▆▅▇▃▃▃▃▃▃▃▃▃▃▁▁▃▃▃▂▃▃▃▃▃▁▁▂▂▂▃▃█▃▃▃▃▂▃
wandb:  test_balanced_accuracy0.5 ▂▂▁▄▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁█▁▂▂▂▂▂▂
wandb: test_balanced_accuracy0.75 ██▁▁▁█████████████████████████▁█████████
wandb:         test_precision0.25 █▄█▅▇▁▁▄▄▁▁▁▄▁▁▄▁▁▁▁▄▄▄██▅▁▁▁▄▁▁▄▄▅▁▄▄▄▁
wandb:          test_precision0.5 ▁▇▅█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 █▁▁▁▁▄▃▁▁▁▇█▁▁█▁█▁▁▇█████▁▁▁▁▁▃██▁█▁███▁
wandb:             test_recall0.5 ▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▄▄▇▇▆██▇▄▆▂▄▄▅▆▄▄▄▆▄▅▆▇▆▇▁▅▄▅▅▇▆█▇▃▁▄▆▄▂
wandb:                 train_loss █▅▅▄▄▄▁▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▄▅▆▅▄▆▅▅▅▅▅▅▅▅
wandb:           val_accuracy0.25 ▁██▁███▁████▁███▁▁██▁▃▁██▇▇█▁█▅▆▁▁█▁█▁▁▁
wandb:            val_accuracy0.5 ████▆▁███████████████████▆▆████▆████████
wandb:           val_accuracy0.75 █████▁▁██████████████▁██████▁▁██████████
wandb:                  val_auroc ▇█▂▂▆▁▆▆▇▇▇▇▇▆▇▇████▁▂▂▄▅▆▆▆▆▆▄▁▂▃▆▇▇▇▃█
wandb:  val_balanced_accuracy0.25 ▂▁▁▅▆▂▂▂▂▂▂▂▂▂▂▂▁▂▂▂▁▁▂▂█▂▇▁▁▁▁▁▂▄▆▂▂▂▂▂
wandb:   val_balanced_accuracy0.5 ▃▃▃▁█▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▁▁▁█▃▃▃▃▃▃
wandb:  val_balanced_accuracy0.75 ████▁▁▅▅█████████████████████████▅▅█████
wandb:          val_precision0.25 ▆█▁▁▆▅▇▁▁▆▁▁▅▁▁▁▅▅▁▁▅▇▅▆▁▁▁▅▆▆▅▁▅▅▁▅▁▅▁▁
wandb:           val_precision0.5 ▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁█▅▂▁█▁▁▁▁▁█▁█▁████▁███▃▃▁▁███▄▂▂█▁█▁▁██
wandb:              val_recall0.5 ▁▁▁▁▁▁▁██▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.75
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.57333
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.46533
wandb:                 train_loss 1.67987
wandb:           val_accuracy0.25 0.74528
wandb:            val_accuracy0.5 0.74528
wandb:           val_accuracy0.75 0.74528
wandb:                  val_auroc 0.58978
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_3_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/o11z3m8k
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_3/wandb/run-20250725_170701-o11z3m8k/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_3/execution_datetimes.json

**************************************************  Experiment 87 | Version 4 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 212 samples
    Label distribution: {0: 159, 1: 53}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 16}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 3, 1.0: 1}
  - Fold 2: 213 samples
    Label distribution: {0: 159, 1: 54}
    Batch label distribution: {0.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 3, 1.0: 2}
  - Fold 3: 213 samples
    Label distribution: {0: 160, 1: 53}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 3, 1.0: 2}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 107 samples
    Label distribution: {0: 80, 1: 27}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 4}
  - Fold 2: 106 samples
    Label distribution: {0: 80, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 2}
  - Fold 3: 106 samples
    Label distribution: {0: 79, 1: 27}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 2: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 3: 80 samples
    Label distribution: {0: 60, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_4/wandb/run-20250725_171440-3o9wtyem
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_4_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/3o9wtyem
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 274-278, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 █▁▁▁█▄▇▅▅▄▇▅█▇▇▇▇▇▇▇▇▇▇█▇██▇▇█▇▇▇▇▇▇▇▇▇▇
wandb:           test_accuracy0.5 ████████████████████▆▃▃▃▃▃▃▃▃▃▃▃▁▃▃▃▁▃▃▁
wandb:          test_accuracy0.75 ██████████████████▆█▃▁▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:                 test_auroc █▅▆▆▆▅▅▆▅▆▆▅▃▁▂▃▃▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb: test_balanced_accuracy0.25 ▄▄▅▇▆▃▃▄▇█▄▇▇▂▂█▁▆▄▄▃▅▅▅▇▆▇▇▆▇▇▇▇▇▆▆▇▆▆▆
wandb:  test_balanced_accuracy0.5 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▃▂▁█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▃▃▇▇
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▃▁▁▁▁██████████████████
wandb:         test_precision0.25 ▅▄▁▅▃▅▅▅▅▅▅▅▅▅▅▄▆▄▄█▅▅▆▆▆▇▆▆▇▇▇▆▇▆▆▆▆▆▆▆
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅█▇▇▇▇▇▇▇▇▇▇▇▇▇▆▇▇▆▆
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅▅▅████████████████
wandb:            test_recall0.25 ▁█▁▃▆▇▃▆▆▄▅▂▁▄▁▇▃▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▃▃
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅▅█████████████████
wandb:                train_auroc ▃▃▁▂▁▂▂▃▃▂▃▃▃▃▃▄▄▃▅▅▄▇██████████████████
wandb:                 train_loss ███████████████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▃▁▃▅▄▄▅▄▆▆██▄▆▆▆▆▆▆▆▆▆▇▇▇▇▆▇▆▇▇▇▆▆▆▇▆▆
wandb:            val_accuracy0.5 ███████████████▃▁▃▂▂▂▃▂▃▂▃▃▂▂▂▃▃▃▃▃▃▃▃▃▃
wandb:           val_accuracy0.75 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▃▆█▁▄▄▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▆▇▇▇▇▇▆▇█▇▇███▇▄▂▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:  val_balanced_accuracy0.25 ▃▇▅▇▅▅▅▄▇▅█▆█▇▄▅▂▂▃▃▂▃▃▃▃▂▃▃▃▃▂▁▃▁▁▃▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆█▂▅▄▃▄▄▂▄▄▄▁▂▁▁▄▁▂▂▂▂▂▂▂▂
wandb:  val_balanced_accuracy0.75 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆█▄▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▅▁▅▁▅▅▅▆▆▅▅▅▅▅▆▅▅█▄▅▃▄▃▄▃▃▄▃▃▃▄▃▃▃▄▄▃▃▃▃
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:             val_recall0.25 █▁█▇▇▃▇▃▅▆▅▅▄▅▆▄▄▇▇▇▁▁▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅▅▅▃▃▃▃▃▃▃▃▅▃▃▃▃▃▃▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅█▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.7125
wandb:           test_accuracy0.5 0.725
wandb:          test_accuracy0.75 0.725
wandb:                 test_auroc 0.50083
wandb: test_balanced_accuracy0.25 0.525
wandb:  test_balanced_accuracy0.5 0.53333
wandb: test_balanced_accuracy0.75 0.51667
wandb:         test_precision0.25 0.33333
wandb:          test_precision0.5 0.375
wandb:         test_precision0.75 0.33333
wandb:            test_recall0.25 0.15
wandb:             test_recall0.5 0.15
wandb:            test_recall0.75 0.1
wandb:                train_auroc 1
wandb:                 train_loss 8e-05
wandb:           val_accuracy0.25 0.62617
wandb:            val_accuracy0.5 0.68224
wandb:           val_accuracy0.75 0.68224
wandb:                  val_auroc 0.50463
wandb:  val_balanced_accuracy0.25 0.44329
wandb:   val_balanced_accuracy0.5 0.46852
wandb:  val_balanced_accuracy0.75 0.46852
wandb:          val_precision0.25 0.11765
wandb:           val_precision0.5 0.11111
wandb:          val_precision0.75 0.11111
wandb:             val_recall0.25 0.07407
wandb:              val_recall0.5 0.03704
wandb:             val_recall0.75 0.03704
wandb: 
wandb: 🚀 View run resnet18_2d_87_4_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/3o9wtyem
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_4/wandb/run-20250725_171440-3o9wtyem/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_4/wandb/run-20250725_172620-ud6mg6s4
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_4_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/ud6mg6s4
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▃▃▁▅▃▃▃▅▇▃▇▇▅▃█▄▆▅███▇██████████████████
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅█▁██▁▅█████▅▅▅▅▁▅▅▅▅
wandb:          test_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁█▆█▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:                 test_auroc ▃▃▃▃▃▃▃▃▃▂▃▂▃▃▁▅▆█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█
wandb: test_balanced_accuracy0.25 ▅▅▃▅▇▂▃▆▅▁▅▂▄▅▅▅▃▂▁▃▇▇█▇█▇█▇▇▇██████████
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▇▇█▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆█████████████████████
wandb:         test_precision0.25 ▁▄▄▅▅▅▅▄▅▅▅▅▄▄▅▆▇█▆▇▇▇▇█▇█▇██▇██▇██████▇
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▆▁█▆▇▆▇▇▆▇▆▆▇▇▇▇▇▇▆▇▇▇▇▇▇
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:            test_recall0.25 █▁█▁▇▆▅▃▇▄▄▆▇▃▄▂▆▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▄▆█▇█▇██▇▇▇▇▇▇▇▇▇█▇▇▇▇▇▇▇▇▇
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█████████████████████████
wandb:                train_auroc ▁▁▂▁▂▁▂▂▂▃▃▄▃▃▄▅▆███████████████████████
wandb:                 train_loss ████████████▇▇▆▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▅▅▂█▂▂▄▅▇▅▁▄▃▂▄▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            val_accuracy0.5 ████████████████▅▄▅▃▃▂▁▄▄▃▃▃▃▃▃▃▃▃▃▂▃▃▃▂
wandb:           val_accuracy0.75 █████████████████▁█▁▁▁▁▃▁▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc █████▇▇█▇▇▇▇▆▆▆▄▁▁▂▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:  val_balanced_accuracy0.25 ▄▄▄▅██▄▃▁▅▇▆▄▆▄▅▂▃▆▂▂▃▂▃▂▃▃▃▃▃▃▃▃▃▃▃▃▂▃▂
wandb:   val_balanced_accuracy0.5 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄█▃▁▇▅▃▅▆▇▆▆▅▆▆▆▆▆▆▆▆▆▆▅▆
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▁████▆▆██▆▆▆▆▆▆▆▆▆▆
wandb:          val_precision0.25 ▁▃▄▄▄▄▄▃▃▃▄▄▄▄█▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▇▁▁▆█▆█▇█▇▇██▇▇▇▇▆▇▇▇▇▇▇▇▇▇
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▄▇█▆▆▇██████▇██▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:             val_recall0.25 ███▄█▄▄▄▄▃▄▄▆▃▃▄▄▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▅▅▂▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▆▆██████████████████
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.7375
wandb:           test_accuracy0.5 0.7625
wandb:          test_accuracy0.75 0.775
wandb:                 test_auroc 0.60917
wandb: test_balanced_accuracy0.25 0.60833
wandb:  test_balanced_accuracy0.5 0.60833
wandb: test_balanced_accuracy0.75 0.61667
wandb:         test_precision0.25 0.46667
wandb:          test_precision0.5 0.54545
wandb:         test_precision0.75 0.6
wandb:            test_recall0.25 0.35
wandb:             test_recall0.5 0.3
wandb:            test_recall0.75 0.3
wandb:                train_auroc 1
wandb:                 train_loss 7e-05
wandb:           val_accuracy0.25 0.64151
wandb:            val_accuracy0.5 0.70755
wandb:           val_accuracy0.75 0.72642
wandb:                  val_auroc 0.43462
wandb:  val_balanced_accuracy0.25 0.46394
wandb:   val_balanced_accuracy0.5 0.50769
wandb:  val_balanced_accuracy0.75 0.52019
wandb:          val_precision0.25 0.16667
wandb:           val_precision0.5 0.27273
wandb:          val_precision0.75 0.33333
wandb:             val_recall0.25 0.11538
wandb:              val_recall0.5 0.11538
wandb:             val_recall0.75 0.11538
wandb: 
wandb: 🚀 View run resnet18_2d_87_4_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/ud6mg6s4
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_4/wandb/run-20250725_172620-ud6mg6s4/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_4/wandb/run-20250725_173653-9877qsvs
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_4_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/9877qsvs
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁█▅█▆████████▆█▇▇█▇▆▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           test_accuracy0.5 █▇▇▇▇▇▇▇▇▇▇▇▇▇█▇▇█▇▆▄▃▃▁▁▃▁▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:          test_accuracy0.75 ███▇▇▇▇▇▇▇▇▇▇▆▆▄▃▃▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▂▁▁▁▂▁▂
wandb:                 test_auroc ▇██▇▇▇▇▆▇▇▇▇█▇▆▇▆▅▂▁▃▃▄▄▄▄▄▄▄▄▅▅▅▅▅▅▅▅▅▅
wandb: test_balanced_accuracy0.25 ▆▅▅▁▅█▁▆▄█▆█▇▅▆▆▁▆▂▅▃▁▄▂▁▁▁▁▁▃▃▁▃▁▁▁▁▁▁▂
wandb:  test_balanced_accuracy0.5 ▃▃▄▃▃▆▄▆▅▃▅▄▃▇▄█▄▇▄▄▁▄▃▁▃▄▄▃▄▁▃▁▃▄▃▃▃▃▃▃
wandb: test_balanced_accuracy0.75 ▅▅▅▅▅▄▄▄▄▄▄▄▄▄▄▄▄█▄▁▇▂▇▂▃▁▁▁▁▁▁▁▁▁▁▂▁▁▂▂
wandb:         test_precision0.25 ▅▇█▂▂▆▇█▃▁█▇██▇█▆▅▆▂▂▂▄▂▂▂▂▁▂▂▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁▇▁▇▅▇▆█▁█▇▆▁▅▅▅▄▅▆▅▄▅▄▄▃▄▅▃▄▃▄▄▄▃▄▄▄▄
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▇▁▇▁▅▄▅▃▃▁▃▃▃▃▃▃▃▃▃▃▃
wandb:            test_recall0.25 ▄█▆▂▄▂▃▄▂▁▅▃▃▃▂▃▂▃▃▃▃▁▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▄▇▁▇▂▅▂█▄▅█▄▄▅▅▅▅▂▄▅▂▅▅▂▄▅▂▄▄▄▄▄▄
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▅▃▅▁█▅▆▃▁▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:                train_auroc ▂▁▃▃▃▃▄▄▄▄▄▄▄▄▄▅▅▆▆▇▇███████████████████
wandb:                 train_loss █▆▆▆▆▆▆▆▆▆▆▅▅▅▅▅▅▄▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▅▄█▇▇▇▇█▇▇▇▇▇▇▆▆▆▃▄▆▆▆▆▆▆▆▆▆▆▆▇▆▆▇▆▇▆▆▆
wandb:            val_accuracy0.5 ████▇▇▇▇▇▇▆▇▇▆▆▆▆▇▄▄▇▅▄▁▄▃▁▄▃▄▄▄▄▃▃▃▄▄▄▄
wandb:           val_accuracy0.75 █████▇████▇█▇█▇▇██▁▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:                  val_auroc █████▇▇▇▇▇▅▆▆▆▅▅▅▃▃▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.25 ▄█▅██▆▇▅▅▆▅▆▄▇▃▅▂▄▁▄▁▁▁▁▁▁▁▂▁▁▁▂▂▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▆▆▅▅▅▄▅█▄▅▅▆▇▇█▂▂▄▄▄▇▁▄▅▂▅▂▃▃▃▅▅▃▃▄▄▄▄▃▄
wandb:  val_balanced_accuracy0.75 ▄▃▃▃▃▃▂▃▃▃▃▁▁▂▃█▇▄▄▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:          val_precision0.25 ▁▅▅▅▆▅█▆▅▅▅▅▅▅▅▅▅▅▃▃▄▃▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:           val_precision0.5 ▁▁▁▁▁▁▁█▁▅▅▅▅▆▅▄▄▅▅▄▅▅▄▃▄▅▅▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁█▅▄▃▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:             val_recall0.25 ▁▅▅▅▂▅▅▆▂▃▃▃▄▂▂█▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:              val_recall0.5 █▁▁▁▁▂▁▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▅█▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.675
wandb:           test_accuracy0.5 0.6875
wandb:          test_accuracy0.75 0.6875
wandb:                 test_auroc 0.56083
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.49167
wandb: test_balanced_accuracy0.75 0.475
wandb:         test_precision0.25 0.25
wandb:          test_precision0.5 0.22222
wandb:         test_precision0.75 0.14286
wandb:            test_recall0.25 0.15
wandb:             test_recall0.5 0.1
wandb:            test_recall0.75 0.05
wandb:                train_auroc 1
wandb:                 train_loss 0.0001
wandb:           val_accuracy0.25 0.63208
wandb:            val_accuracy0.5 0.67925
wandb:           val_accuracy0.75 0.69811
wandb:                  val_auroc 0.38209
wandb:  val_balanced_accuracy0.25 0.44843
wandb:   val_balanced_accuracy0.5 0.48008
wandb:  val_balanced_accuracy0.75 0.49273
wandb:          val_precision0.25 0.125
wandb:           val_precision0.5 0.18182
wandb:          val_precision0.75 0.22222
wandb:             val_recall0.25 0.07407
wandb:              val_recall0.5 0.07407
wandb:             val_recall0.75 0.07407
wandb: 
wandb: 🚀 View run resnet18_2d_87_4_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/9877qsvs
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_4/wandb/run-20250725_173653-9877qsvs/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_4/execution_datetimes.json

**************************************************  Experiment 87 | Version 5 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 212 samples
    Label distribution: {0: 159, 1: 53}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 29, 1.0: 3}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 15, 1.0: 5}
  - Fold 2: 213 samples
    Label distribution: {0: 159, 1: 54}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 14, 1.0: 7}
  - Fold 3: 213 samples
    Label distribution: {0: 160, 1: 53}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 17, 1.0: 4}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 107 samples
    Label distribution: {0: 80, 1: 27}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 7, 1.0: 4}
  - Fold 2: 106 samples
    Label distribution: {0: 80, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 2}
  - Fold 3: 106 samples
    Label distribution: {0: 79, 1: 27}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 9, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 28, 1.0: 4}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 2: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 28, 1.0: 4}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 3: 80 samples
    Label distribution: {0: 60, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_5/wandb/run-20250725_174902-zsswd6xz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_5_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/zsswd6xz
    Batch label distribution: {0.0: 28, 1.0: 4}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ██▁▂▇▄▇▄▇▅▅▅▇▄▆▂▆█▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           test_accuracy0.5 █████████████████████████▁▁▂▂▁▂▂▂▂▂▁▁▁▁▁
wandb:          test_accuracy0.75 ████████████████████▁▂▂▄▃▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:                 test_auroc ▆▅▆▆▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅▄▅▄▁▅▆▆▇█████████████
wandb: test_balanced_accuracy0.25 ▁▆▅▆▄▄▄▆▂▂▄▄▄█▄▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ███████████████████▄▅▅▅▄▂▅▅▅▅▅▅▁▅▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 █████████████████████▃▆▄▄▄▄▄▄▄▄▄▄▁▄▄▄▄▄▄
wandb:         test_precision0.25 ▆▆▇▇▇▆▇▆▇▇▆▇▆▇▇▇▇▇█▁▁▆▆▆▁▇▆▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▇██████████████▅███▅▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▇█▁▁▅▅▅▅▅▁▅▅▅▅▅▅
wandb:            test_recall0.25 ▁█▇▃▇▆▃▅▅▃▅▅▃▅▅▂▇▅▆▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             test_recall0.5 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▁▂▂▂▂▂▂▂▁▂▂▁▁▁▁▁▂▁▂▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁█▁▅▁▅▅▅▅▅▅▅▅▅
wandb:                train_auroc ▁▂▁▂▂▂▂▂▂▂▃▃▃▄▄▇████████████████████████
wandb:                 train_loss █▇▇▇▇▇▇▇▇▇▇▇▇▆▆▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 █▃▃▁█▅▇▄▆▄▄▅▃▇▄▄▆▃▃▆▃▆▄▅▆▆▆▇▆▆▆▆▇▆▆▆▆▆▆▇
wandb:            val_accuracy0.5 ██████████████████▆▁▄▃▂▄▄▃▃▄▄▃▄▄▃▄▄▄▄▄▄▄
wandb:           val_accuracy0.75 ████████████████████████▂▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ████▇██▇▇██▇▇██▄▂▂▃▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.25 ▃▃▃▄▂█▇▅▄█▄▅▅▆█▅▃▃▅▄▁▂▂▃▂▃▁▁▂▁▁▁▁▁▁▁▂▁▁▁
wandb:   val_balanced_accuracy0.5 █████████████████████▄▁▁▁▄▁▃▃▃▁▁▃▃▃▃▃▃▃▃
wandb:  val_balanced_accuracy0.75 ▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 █▁▄▅▄▄▄▄▄▄▄▄▄▄▄▅▄▁▄▄▄▃▃▃▄▃▄▃▄▄▃▃▃▃▃▃▃▃▃▃
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▃▃▃▃▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▇██▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:             val_recall0.25 ▅██▂▇▇▅▄▅▄▆▅▆█▆▅▆▂▃▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▃▆▆▆▃▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁███████████████████
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.65
wandb:           test_accuracy0.5 0.6625
wandb:          test_accuracy0.75 0.675
wandb:                 test_auroc 0.55333
wandb: test_balanced_accuracy0.25 0.46667
wandb:  test_balanced_accuracy0.5 0.45833
wandb: test_balanced_accuracy0.75 0.46667
wandb:         test_precision0.25 0.16667
wandb:          test_precision0.5 0.11111
wandb:         test_precision0.75 0.125
wandb:            test_recall0.25 0.1
wandb:             test_recall0.5 0.05
wandb:            test_recall0.75 0.05
wandb:                train_auroc 1
wandb:                 train_loss 0.00026
wandb:           val_accuracy0.25 0.65421
wandb:            val_accuracy0.5 0.68224
wandb:           val_accuracy0.75 0.70093
wandb:                  val_auroc 0.4662
wandb:  val_balanced_accuracy0.25 0.46204
wandb:   val_balanced_accuracy0.5 0.48079
wandb:  val_balanced_accuracy0.75 0.48102
wandb:          val_precision0.25 0.14286
wandb:           val_precision0.5 0.18182
wandb:          val_precision0.75 0.14286
wandb:             val_recall0.25 0.07407
wandb:              val_recall0.5 0.07407
wandb:             val_recall0.75 0.03704
wandb: 
wandb: 🚀 View run resnet18_2d_87_5_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/zsswd6xz
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_5/wandb/run-20250725_174902-zsswd6xz/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_5/wandb/run-20250725_180116-iqusah8b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_5_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/iqusah8b
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 292-293, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▃▃▄▃▇▇▄█▁▅▂▅▃▇▅▅▂▄▆▄▆▆▇▇▇▇█▇████████████
wandb:           test_accuracy0.5 ████████████████████▁▆▃▇▇█▇█▇▇██▇▇▇▇█▇▇▇
wandb:          test_accuracy0.75 █████████████████████▁██▆▆▆▆▃▃▃▃▃▃▃▃▃▃▃▃
wandb:                 test_auroc ▆▅▅▅▄▅▅▄▄▄▄▄▄▃▁▂▃▂▁▃▆▇██████████████████
wandb: test_balanced_accuracy0.25 ▆▄▂▁▁▃▅▄▃▅▆▅▃▃▆▂▂▅▂▄▃▃▁▁▆▆▇█████████████
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▅▇▃▇▆▄▆▇▆█▆█▅▄▆▇▅▇▇
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃█▆██▆▆▆▆▆▆█▆▆▆▆▆▆▆
wandb:         test_precision0.25 ▅▅▅▆▅▁▆▅▆▅▆▅▁▆▅▆▆▅▆▅▅▆███▇██████████████
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▁▅▆▇▇█▇▇▇█▇▇▇██▇▇█▇▇▇▇▇
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▄▆▆█▆▇▇▇▇▆▆▆▆▆▆▇▆▆▆
wandb:            test_recall0.25 ▁█▄█▄█▆██▄███▇▅▆▅▆▄▅▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂█▄▄▄▄▄▃▄▄▃▄▄▃▄▄▄
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:                train_auroc ▂▂▂▁▂▂▂▂▃▂▃▃▃▃▃▃▄▄▄▆████████████████████
wandb:                 train_loss █████████████▇▇▇▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁█▅▃▃▅▇▄▅▃▁▆▃▇▃▄▆▇▂▆▄▄▇▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇█
wandb:            val_accuracy0.5 █████████████████████▁▇█▆▅▇▅▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_accuracy0.75 ████████████████████▆▁▄▆▃▄▄▄▂▄▃▃▄▄▄▄▄▄▄▄
wandb:                  val_auroc █████▇▇▇▇▇▇▇▇▇▆▆▆▅▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.25 ▅▅▅█▆▄▅▇▆▃▃▆▅▆▄▄▆▅▅▄▂▁▅▃▃▄▃▃▃▃▃▄▄▃▄▃▄▄▄▄
wandb:   val_balanced_accuracy0.5 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆▁▃███████████████████
wandb:  val_balanced_accuracy0.75 ███████████████████▆▂▆▂▂▁▁▄▄█▄▁▇▇▇██▇▇██
wandb:          val_precision0.25 ▁▆█▆▆▆▆▆▆▆▆▆▆▆▆▅▆▆▅▆▅▅▄▅▅▄▅▅▅▄▄▅▄▄▅▅▄▅▅▅
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▆▄▄████████████████████▇█▇█
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁▁▁▁▁▁▁▅▁▅▅█▇█▇▇██▇█▇█▇▇▇▇
wandb:             val_recall0.25 ███▇█▆▆▆▇▆▄▄▄▆▄▄▄▃▄▂▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆█▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▃▁▁▁▁▁▁▁▃▁▁▅▅▅▅▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.725
wandb:           test_accuracy0.5 0.7125
wandb:          test_accuracy0.75 0.725
wandb:                 test_auroc 0.55917
wandb: test_balanced_accuracy0.25 0.58333
wandb:  test_balanced_accuracy0.5 0.54167
wandb: test_balanced_accuracy0.75 0.51667
wandb:         test_precision0.25 0.42857
wandb:          test_precision0.5 0.36364
wandb:         test_precision0.75 0.33333
wandb:            test_recall0.25 0.3
wandb:             test_recall0.5 0.2
wandb:            test_recall0.75 0.1
wandb:                train_auroc 1
wandb:                 train_loss 0.00022
wandb:           val_accuracy0.25 0.64151
wandb:            val_accuracy0.5 0.69811
wandb:           val_accuracy0.75 0.70755
wandb:                  val_auroc 0.42644
wandb:  val_balanced_accuracy0.25 0.46394
wandb:   val_balanced_accuracy0.5 0.50144
wandb:  val_balanced_accuracy0.75 0.49471
wandb:          val_precision0.25 0.16667
wandb:           val_precision0.5 0.25
wandb:          val_precision0.75 0.22222
wandb:             val_recall0.25 0.11538
wandb:              val_recall0.5 0.11538
wandb:             val_recall0.75 0.07692
wandb: 
wandb: 🚀 View run resnet18_2d_87_5_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/iqusah8b
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_5/wandb/run-20250725_180116-iqusah8b/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_5/wandb/run-20250725_181306-knn5ff9b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_5_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/knn5ff9b
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▅▅▇▄▅▆███████████▇█▇▇▇▇▇▇▇▇▆▆▇▆▆▆▆▆▇▇▆▆
wandb:           test_accuracy0.5 ▇▇▇▇▇▆▆▆▇▇▇▇▆▆▆█▆▄▄▄▃▄▂▂▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ████▇▇▇▇▇▇▇▇█▇▇▆█▆▄▄▇▂▂▂▂▁▂▁▁▁▁▁▁▁▂▂▁▁▁▂
wandb:                 test_auroc ▅▅▅▆▆▆▆▆▆▆▆▆▆▆▆▆█▆▅▅▄▁▃▆▂▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb: test_balanced_accuracy0.25 ▃▃▃▂▇▆▅██▆▆███▇▇█▅▆▇▂▃▆▁▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▄▄▄▄▄▅▄▄▅▆▆▆▄▅█▆▅▅▅▄▇▄▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▇▇▇▇▇▆▆▆▆▆▆▆▆▆▆▆▆██▄▄▃▂▁▁▂▁▂▁▁▁▁▁▁▁▂▁▁▁▂
wandb:         test_precision0.25 ▄▄▄▄▅▄▅█▇▇█▆▅█▇█▇█▅▄▅▁▆▃▃▄▂▄▂▂▂▃▂▂▂▂▂▂▂▂
wandb:          test_precision0.5 ▁▁▁▁▁██▁███▁▇▇▇█▁▅▁█▅▅▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁█▁▁▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 █▇▇▄▃▃▃▄▃▃▃▄▃▄▃▃▃▂▂▃▅▂▁▂▁▃▂▁▂▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▃▃▅▅█▅▆▅▆▅▃▁▃▁▆▅▁▁▃█▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▃▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▂▁▁▂▂▃▂▃▃▃▃▃▃▃▄▄▄▄▄▅▆▅██████████████████
wandb:                 train_loss █▆▆▆▆▆▆▆▆▆▆▆▆▆▆▅▅▃▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▂█▄▅▅▅▇▇▇█▇█▇▇▇▇▇▇█▇▅▆▃▃▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:            val_accuracy0.5 ███▇▇▇▆▇▆▆▆▆▆▆▅▆▆▆▄▆▇▃▄▂▄▂▃▁▃▂▂▂▁▂▂▂▂▂▂▂
wandb:           val_accuracy0.75 ██▇▇▇▇▇▇▇▇▇▆▇▇▇▆▇▇▆█▅██▇▆▅▁▅▄▄▄▄▄▄▄▃▄▄▄▃
wandb:                  val_auroc ██████▇▇▇▇▄▆▅▅▅▄▅▂▃▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.25 ▅▄▇█▆▇▇▇▇▇▆▆▅▆▆▆▅▅▇▆▅▅▆▇▃▁▅▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:   val_balanced_accuracy0.5 ▇▇▇▇▇▇▇▇▆▆▆▅▅▅▅▆▄▆▆▇▂▇▅▅█▅▃▃▂▁▂▃▂▂▃▃▃▃▂▂
wandb:  val_balanced_accuracy0.75 ▅▄▄▄▄▄▄▄▃▄▃▄▄▄▃▄▆▃▃▃▇█▆▃▃▃▃▃▃▃▃▃▁▃▃▃▃▂▃▂
wandb:          val_precision0.25 ▅▁▅▆▆▅▇█▆▆▆▆▅▆▅▅▅▅▅▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▃▃▄▃▄▅▅▅▄▄▇█▃▃▃▄▃▃▃▃▃▃▃▃▃▃▃▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▄▆████▄▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:             val_recall0.25 ▁▁███▅▂▃▃▄▄▄▄▃▃▃▃▄▃▅▂▂▂▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▃▁▃▃▃▃▃▁▅▃▃█▃▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅████▅█████████████████
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.6625
wandb:           test_accuracy0.5 0.6625
wandb:          test_accuracy0.75 0.675
wandb:                 test_auroc 0.57167
wandb: test_balanced_accuracy0.25 0.45833
wandb:  test_balanced_accuracy0.5 0.44167
wandb: test_balanced_accuracy0.75 0.45
wandb:         test_precision0.25 0.11111
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.05
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 1.0
wandb:                 train_loss 0.00052
wandb:           val_accuracy0.25 0.59434
wandb:            val_accuracy0.5 0.64151
wandb:           val_accuracy0.75 0.66981
wandb:                  val_auroc 0.32536
wandb:  val_balanced_accuracy0.25 0.42311
wandb:   val_balanced_accuracy0.5 0.45476
wandb:  val_balanced_accuracy0.75 0.47375
wandb:          val_precision0.25 0.1
wandb:           val_precision0.5 0.13333
wandb:          val_precision0.75 0.16667
wandb:             val_recall0.25 0.07407
wandb:              val_recall0.5 0.07407
wandb:             val_recall0.75 0.07407
wandb: 
wandb: 🚀 View run resnet18_2d_87_5_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/knn5ff9b
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_5/wandb/run-20250725_181306-knn5ff9b/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_5/execution_datetimes.json

**************************************************  Experiment 87 | Version 6 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 212 samples
    Label distribution: {0: 159, 1: 53}
    Batch label distribution: {0.0: 46, 1.0: 18}
    Batch label distribution: {0.0: 47, 1.0: 17}
    Batch label distribution: {0.0: 51, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 5}
  - Fold 2: 213 samples
    Label distribution: {0: 159, 1: 54}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 45, 1.0: 19}
    Batch label distribution: {0.0: 14, 1.0: 7}
  - Fold 3: 213 samples
    Label distribution: {0: 160, 1: 53}
    Batch label distribution: {0.0: 45, 1.0: 19}
    Batch label distribution: {0.0: 47, 1.0: 17}
    Batch label distribution: {0.0: 51, 1.0: 13}
    Batch label distribution: {0.0: 17, 1.0: 4}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 107 samples
    Label distribution: {0: 80, 1: 27}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 30, 1.0: 13}
  - Fold 2: 106 samples
    Label distribution: {0: 80, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 31, 1.0: 11}
  - Fold 3: 106 samples
    Label distribution: {0: 79, 1: 27}
    Batch label distribution: {0.0: 51, 1.0: 13}
    Batch label distribution: {0.0: 28, 1.0: 14}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 2: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 3: 80 samples
    Label distribution: {0: 60, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_6/wandb/run-20250725_182733-wq3ug4le
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_6_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/wq3ug4le
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 10, 1.0: 6}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 █▄▄▁▇▃▅▂▅▁▆▅▅▆▆▄▄▄▆▅▆▇▇▇▂▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           test_accuracy0.5 ███████████████████████▇▁▇▅▇▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          test_accuracy0.75 ████████████████████▅▅█▅█▅▅▅▁▅▅▅▅▅▅▅▅▅▅▅
wandb:                 test_auroc ██████████▇▆▆▅▅▅▅▆▅▂▁▃▁▁▁▂▂▂▂▂▂▂▂▃▂▂▂▃▂▃
wandb: test_balanced_accuracy0.25 ▅▄▅▆▇▅▆▆▇▅▄███▄█▁▂▃▄▂▄▃▃▄▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:  test_balanced_accuracy0.5 ██████████████████████████▁▇▅▇█▇█▇▇▇▇▇▇▇
wandb: test_balanced_accuracy0.75 ▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▁███████████
wandb:         test_precision0.25 ▁▆▁▇▄▇▇▇▆▇▇▇▆▆▇▇▇▄▆▆█▆▅▇▆▅▅▅▅▆▄▃▃▃▃▃▃▃▃▃
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▇▁█▅▃▆▅▅▅▅▅▅▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁███████████
wandb:            test_recall0.25 █▂▂█▁▁▅▅▅▆▇▄▃▅▄▁▄▁▆▄▂▃▃▃▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂█▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁████████████████████
wandb:                train_auroc ▁▂▂▁▁▂▂▂▂▂▁▂▂▂▂▃▃▃▃▃▃▅▆▅▆███████████████
wandb:                 train_loss █████████████████████████████▇▃▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 █▇█▅▅▂▄▄▁▃▃▂▁▃▂▃█▂▆▃▄▆▅▆▅▅▇▆▆▆▆▇▇▇▇▇▇▇▇▇
wandb:            val_accuracy0.5 █████████████████████▅█▇▆▁▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_accuracy0.75 █████████████████████████▃█▅▃▁▃▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ██▇▇▆▆▆▆▆▆▆▆▇▇▆▇▇█▇█▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.25 ▁▃▄▆▄▇█▆▆▆▆▅▇▇▅▇▅▇▅█▅▁▆▂▂▂▃▃▃▂▂▃▃▃▃▃▃▄▃▃
wandb:   val_balanced_accuracy0.5 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▃▆▁▃█▆██████████████
wandb:  val_balanced_accuracy0.75 █████████████████████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▆▆▁▆▇▇▇▆▇▇▇▇▇▇▇▇█▇▇▆▇▇▆▆▆▆▇▇▇▇▆▅▅▇▆▆▆▆▆▆
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▇▆█▇▇█▇█████████████
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█████████████████
wandb:             val_recall0.25 ██▁▁▁▇▇▁▁▁▄▇▅▅▇▃▇▂▂▃▄▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁███████████████
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅█▅▅▅▅▅▅▅▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.6625
wandb:           test_accuracy0.5 0.7125
wandb:          test_accuracy0.75 0.7375
wandb:                 test_auroc 0.47333
wandb: test_balanced_accuracy0.25 0.45833
wandb:  test_balanced_accuracy0.5 0.49167
wandb: test_balanced_accuracy0.75 0.50833
wandb:         test_precision0.25 0.11111
wandb:          test_precision0.5 0.2
wandb:         test_precision0.75 0.33333
wandb:            test_recall0.25 0.05
wandb:             test_recall0.5 0.05
wandb:            test_recall0.75 0.05
wandb:                train_auroc 1
wandb:                 train_loss 0.00088
wandb:           val_accuracy0.25 0.68224
wandb:            val_accuracy0.5 0.71963
wandb:           val_accuracy0.75 0.71028
wandb:                  val_auroc 0.50093
wandb:  val_balanced_accuracy0.25 0.49306
wandb:   val_balanced_accuracy0.5 0.50579
wandb:  val_balanced_accuracy0.75 0.48727
wandb:          val_precision0.25 0.23077
wandb:           val_precision0.5 0.28571
wandb:          val_precision0.75 0.16667
wandb:             val_recall0.25 0.11111
wandb:              val_recall0.5 0.07407
wandb:             val_recall0.75 0.03704
wandb: 
wandb: 🚀 View run resnet18_2d_87_6_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/wq3ug4le
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_6/wandb/run-20250725_182733-wq3ug4le/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_6/wandb/run-20250725_184402-y4qqhheq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_6_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/y4qqhheq
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▇▂▂▅▁▆▆▄▅▃▇▃▇▇▇█▇███▇███████████████
wandb:           test_accuracy0.5 ████████████████████▃▆█▅▁▆█▅▅▅▅▆▅▅▅█▅▅▅▅
wandb:          test_accuracy0.75 ████████████████████████▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▅▄▄▄▅▄▄▃▄▄▃▃▃▂▃▂▁▂▂▃▃▄▂▃▄▇██████████████
wandb: test_balanced_accuracy0.25 ▁▁▁▁▃▃▃▃▃▂▁▁▄▂▂▁▂▃▃▅▅▇▆▆█▆█▇█▇▇█▇████▇█▇
wandb:  test_balanced_accuracy0.5 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▁▂▅▄▂▃▃▂▃█▂▆▄▄▄▃▃▅▄▃▆▃▃
wandb: test_balanced_accuracy0.75 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆█▆█▃█▃▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▂▂▁▂▂▃▂▁▂▂▂▁▃▂▁▂▁▃▁▅▆▅▇▇▇██▆▆▆▆█▇█▆▆█
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▆▆▄▃▇▄█▇▆▇▆▇▄▆▇▄▇▄▄▄
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:            test_recall0.25 ▁██▂▁▂▃▃▇▇▆▄▆▄▄▁▆▃▇▅▆▅▂▁▃▄▄▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅█▃▃▃▇▃▅▅▅▃▃▅▃▃▅▃▃▃▃
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅▅█▅▅▅▅▅▅▅▅▅▅
wandb:                train_auroc ▁▂▁▂▂▂▂▂▃▃▂▃▃▃▃▄▄▅▅▆▆▆▆▇▇███████████████
wandb:                 train_loss ██████████████████▇▇▇▇▅▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁██▁▁▂█▇█▂▆▃▄▆▃▆▇▅█▅▅▃▇▂▄▆▆▆▆▆▇▆▆▆▆▆▆▆▆▇
wandb:            val_accuracy0.5 ██████████████████▅▂▂▂▃▁▃▂▃▃▃▃▃▃▂▃▃▃▄▄▃▄
wandb:           val_accuracy0.75 █████████████████████████▇█▁▅▁▁▂▂▂▁▂▂▁▁▁
wandb:                  val_auroc █████▇▇▆▆▆▆▆▆▆▅▅▅▄▁▁▁▁▂▃▂▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂
wandb:  val_balanced_accuracy0.25 ▆▆▆▆▆█▆▆▆█▆▆▇▇▄▇▆▃▁▅▄▂▄▁▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:   val_balanced_accuracy0.5 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆█▅▇▆▁▁▃▁▃▃▃▂▃▃▃▃▃▃▃▄▄▄▄▄▄▄
wandb:  val_balanced_accuracy0.75 █████████████████████████▂▁▄▁▅▅▅▅▅▅▅▅▅▅▅
wandb:          val_precision0.25 ▆▆▆▅▆█▆▇▅▆▇▆▆▆▆▆▄▅▃▂▁▂▁▁▂▁▁▁▁▁▂▂▂▂▁▂▂▂▂▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▄▁▃▃▃▂▃▂▃▂▃▃▃▃▂▃▃▃▃▃▃▃▃▃▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▇▇█▇████
wandb:             val_recall0.25 ▁█▇▂▁▄▄▃▅▄▇▇▅▄▃█▃▅▂▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▄▄▄▄▁▁▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁█▁▁███████████████
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.75
wandb:           test_accuracy0.5 0.7375
wandb:          test_accuracy0.75 0.7
wandb:                 test_auroc 0.58917
wandb: test_balanced_accuracy0.25 0.61667
wandb:  test_balanced_accuracy0.5 0.55833
wandb: test_balanced_accuracy0.75 0.48333
wandb:         test_precision0.25 0.5
wandb:          test_precision0.5 0.44444
wandb:         test_precision0.75 0.16667
wandb:            test_recall0.25 0.35
wandb:             test_recall0.5 0.2
wandb:            test_recall0.75 0.05
wandb:                train_auroc 1
wandb:                 train_loss 0.00057
wandb:           val_accuracy0.25 0.64151
wandb:            val_accuracy0.5 0.68868
wandb:           val_accuracy0.75 0.70755
wandb:                  val_auroc 0.40529
wandb:  val_balanced_accuracy0.25 0.45096
wandb:   val_balanced_accuracy0.5 0.48221
wandb:  val_balanced_accuracy0.75 0.48173
wandb:          val_precision0.25 0.125
wandb:           val_precision0.5 0.18182
wandb:          val_precision0.75 0.14286
wandb:             val_recall0.25 0.07692
wandb:              val_recall0.5 0.07692
wandb:             val_recall0.75 0.03846
wandb: 
wandb: 🚀 View run resnet18_2d_87_6_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/y4qqhheq
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_6/wandb/run-20250725_184402-y4qqhheq/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_6/wandb/run-20250725_185901-icvjrhye
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_6_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/icvjrhye
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▇▇▂▂█▃▄▇▇▇▇█▇▇███▇█▇▇███▇▇▇▁▅▅▅▅▅▅▅▅▅▅▅▅
wandb:           test_accuracy0.5 ▇▇▇▇▇▇▇▇▇▇▇▇█▇▇█▇▇█▇▇▇▇▇▇▄▁▁▄▂▃▂▂▃▃▃▃▃▄▃
wandb:          test_accuracy0.75 █████▇▇▇▇▇▇▇▇▇▇▇▇█▇█▇▇▆▆▆▆▇▅▁▃▄▃▃▄▃▃▃▃▃▃
wandb:                 test_auroc ▅▅▅▅▆▆▆▆▆▆▆▆▆▆▆▇█▃█▇█▅▄▁▃▁▃▄▂▃▃▃▃▃▃▃▃▃▃▃
wandb: test_balanced_accuracy0.25 ▃▆▅▆▅▇▆▆▆▅▆▆▇█▆▆▇▄▅▆▄▆▃▂▂▂▂▂▁▇▃▂▂▂▂▂▂▂▂▂
wandb:  test_balanced_accuracy0.5 ▄▄▄▄▄▄▄▄▄▄▅▆▅▅▅█▆█▆█▄▄▄▄▂▁▂▂▃▂▃▂▂▂▂▂▂▂▂▂
wandb: test_balanced_accuracy0.75 ▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅█▅▅▅▅▃▄▅▃▅▃▅▄▃▃▃▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▄▄▁▅▆▆▆▇▇▅▅▇▆█▇██▇▇▇█▇▇▅▄▆▃▄▄▂▃▃▃▃▃▃▃▃
wandb:          test_precision0.5 ▁▁▁▁▁▆▇█▅█▅▆▇▇▆▇▇▇▇▆▄▆▄▄▁▄▄▂▃▃▂▂▃▂▂▂▂▃▂▂
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▆▁▆▁▁▁▁▆▆▄▁▁▁▁▃▃▁▃▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▇█▆▆▆▆▅▇▇▅▅▄▄▅▄▄▄▅▅▄▂▄▄▁▄▇▂▆▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             test_recall0.5 ▁▁▁▁▁▁▂▂▂▃▄▃▃▅▄▄▃▃▄▄▅▂▃▅▂▂▅█▁▇▂▂▂▂▂▂▂▂▂▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▆▃▁▆▁▁▁███▃▁▃▁▁▃▃▁▁▃▁▁▁▁▁▃▁
wandb:                train_auroc ▁▃▃▃▃▃▃▃▃▄▄▄▄▄▄▄▄▅▅▅▅▅▆▇████████████████
wandb:                 train_loss ████████▇▇▇▇▇▇▇▅▆▅▅▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁█▆██▇▅▇█▆▇▇█▇▇▇▇▆▇▇▇▆▇▅▇▄▆▄▇▆▆▆▆▆▆▇▆▆▇▇
wandb:            val_accuracy0.5 ██████▇▇▇▇▇▇▇▆▇▆▇▇▅▇▇▆▇▁▅▃▃▄▅▅▆▅▆▅▆▅▅▅▅▅
wandb:           val_accuracy0.75 ████████▇█▇██▆▆▇▆██▆▅▇▆▁█▆▆▆▅▅▅▆▅▅▅▅▅▆▅▆
wandb:                  val_auroc █████████▆▇▇▇▆▅▆▅▇▄▃▄▄▂▃▃▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.25 ▅▆▆█▆▆▆▅▅▅▆▆▇▆▇▄▃▄▄▂▁▃▁▂▂▂▂▄▃▃▂▃▃▄▃▃▃▃▃▃
wandb:   val_balanced_accuracy0.5 ▇▇▇▇▇▆▆▅▆█▄▄▃▅▆▄▅▄▅▅▇▇▁█▆▁▅▄▅▅▅▅▄▄▄▄▃▄▅▄
wandb:  val_balanced_accuracy0.75 ▇▇▇▇▇▇▅▅▅▅▅▅▅▄▅▅▅▄▄▅▂▅▅▁▅▇▂█▇▇▅▅▄▄▄▅▅▄▄▅
wandb:          val_precision0.25 ▅▁█▇▁▅▆▆▆▆▆▆▆▅▆▆▆▅▆▅▄▃▄▃▅▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:           val_precision0.5 ▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▅▅▄▆▄▅▄▄▅▄▃▇▇▄▃▄▅▄▄▄▄▄▄▄▄
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▁▃▄▄▄█▄▄▄▃▃▅▄▄▄▄▄▄▄▄▄▄▄
wandb:             val_recall0.25 ▁▁█▃▅▃▅▄▃▃▄▄▄▂▂▂▃▃▂▂▂▆▂▂▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁▅▅▅█▅█▅██████████████████
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▃▅▃▅▃▃▃▅█▃▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.65
wandb:           test_accuracy0.5 0.675
wandb:          test_accuracy0.75 0.675
wandb:                 test_auroc 0.55833
wandb: test_balanced_accuracy0.25 0.46667
wandb:  test_balanced_accuracy0.5 0.46667
wandb: test_balanced_accuracy0.75 0.45
wandb:         test_precision0.25 0.16667
wandb:          test_precision0.5 0.125
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.1
wandb:             test_recall0.5 0.05
wandb:            test_recall0.75 0
wandb:                train_auroc 1.0
wandb:                 train_loss 0.0014
wandb:           val_accuracy0.25 0.63208
wandb:            val_accuracy0.5 0.66038
wandb:           val_accuracy0.75 0.69811
wandb:                  val_auroc 0.34787
wandb:  val_balanced_accuracy0.25 0.44843
wandb:   val_balanced_accuracy0.5 0.46742
wandb:  val_balanced_accuracy0.75 0.49273
wandb:          val_precision0.25 0.125
wandb:           val_precision0.5 0.15385
wandb:          val_precision0.75 0.22222
wandb:             val_recall0.25 0.07407
wandb:              val_recall0.5 0.07407
wandb:             val_recall0.75 0.07407
wandb: 
wandb: 🚀 View run resnet18_2d_87_6_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/icvjrhye
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_6/wandb/run-20250725_185901-icvjrhye/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_6/execution_datetimes.json

**************************************************  Experiment 87 | Version 7 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 212 samples
    Label distribution: {0: 159, 1: 53}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 16}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 3, 1.0: 1}
  - Fold 2: 213 samples
    Label distribution: {0: 159, 1: 54}
    Batch label distribution: {0.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 3, 1.0: 2}
  - Fold 3: 213 samples
    Label distribution: {0: 160, 1: 53}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 3, 1.0: 2}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 107 samples
    Label distribution: {0: 80, 1: 27}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 4}
  - Fold 2: 106 samples
    Label distribution: {0: 80, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 2}
  - Fold 3: 106 samples
    Label distribution: {0: 79, 1: 27}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 2: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 3: 80 samples
    Label distribution: {0: 60, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_7/wandb/run-20250725_191658-vpytissk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_7_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/vpytissk
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 █▅▂▄▆▇▆▄▆▅▄▄▆▄▄▄▄▄▄▄▄▄▃▆▂▃▃▄▃▃▆▆▄▆▁▆▃▄▇█
wandb:           test_accuracy0.5 ███████████████████████████████▅█▂▂▂▂▄▄▁
wandb:          test_accuracy0.75 ███████████████████████████████████▁▃▃▆▁
wandb:                 test_auroc █▇▇▇▇▆▆▆▆▆▆▆▅▅▆▅▅▄▄▄▄▄▃▃▃▃▃▃▃▁▂▂▂▂▃▅▆▆▇█
wandb: test_balanced_accuracy0.25 ▇▅█▄▅▆▅▇▇▇▅█▃▇▄▄▃▅▅▅▄▄▆▇▆▄▄▆▄▅▁▂▂▁▅▃▅▂▅▅
wandb:  test_balanced_accuracy0.5 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▁▄▄▁▁█▂▇▃
wandb: test_balanced_accuracy0.75 ███████████████████████████████▆▆██▃▁▃▃▃
wandb:         test_precision0.25 █▆▅▄▅▅▅▅▅▅▅▄▅▅▄▅▅▆▄▆▅▅▅▄▅▅▅▄▁▅▅▅▃▄▅▅▄▄▆▃
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▄▁▆▁▁██
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▃▃▃▇▄▄▄▃█▄▃▄▇▄▇▃▅▆▄▄▃▄▆▂▆▆▂▂▃▃▃▄▃▃▃▃▁▂▃▂
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▁▁▁▁▃▆█
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▁▁▁▂▂▂▂▂▂▂▃▃▃▃▃▃▃▃▃▅▅▆▆▆▇▇▇▇▇██████████
wandb:                 train_loss ████████████████████▇▇▇▇▇▇▇▆▆▆▅▄▄▄▃▂▂▂▁▁
wandb:           val_accuracy0.25 ▁█▅▃▃▇▅▅▆▆▆▅▅▅▅▅▅▅▆▆▆▇▅▄▆▆▆▆▅▅▅▃▇▅▆▆▇▄▇█
wandb:            val_accuracy0.5 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆█▆▆▆▆▆▆██▃▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▇█████▇▇▇███████████▇▇▇▇▇▇▆▅▄▄▃▃▂▂▂▂▁▁▁▁
wandb:  val_balanced_accuracy0.25 ▆▅▅▆▆▅▆▇▆▇▇▆▇▇▆▇█▇▆██▆▇▆▆▄▁▄▆▃▄▃▃▆▇▁▄▄▅▃
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁▄▇▇▇▅█▇
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▅▁
wandb:          val_precision0.25 ▃▃▅▃▃▄▄▃▄▅▄▄▄▄▄▄▄▄▄▄▄▄▅▄▅▄▄▅▅▃▃▃▄▄▃▂▂█▁▃
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁█▅▁▁▄▃▃▃█▄
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁
wandb:             val_recall0.25 ▆▄▆██▅▃▄▅▆▇▅▆▆▅▅▅▆▆▆▆▆▃▆▇▃▄█▅▂▄▁█▃▃▃▄▄▃▃
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁█▄▄
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.6
wandb:           test_accuracy0.5 0.7
wandb:          test_accuracy0.75 0.7125
wandb:                 test_auroc 0.53417
wandb: test_balanced_accuracy0.25 0.48333
wandb:  test_balanced_accuracy0.5 0.51667
wandb: test_balanced_accuracy0.75 0.475
wandb:         test_precision0.25 0.22727
wandb:          test_precision0.5 0.3
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.25
wandb:             test_recall0.5 0.15
wandb:            test_recall0.75 0
wandb:                train_auroc 1
wandb:                 train_loss 0.1143
wandb:           val_accuracy0.25 0.58879
wandb:            val_accuracy0.5 0.72897
wandb:           val_accuracy0.75 0.74766
wandb:                  val_auroc 0.45833
wandb:  val_balanced_accuracy0.25 0.47963
wandb:   val_balanced_accuracy0.5 0.53657
wandb:  val_balanced_accuracy0.75 0.51227
wandb:          val_precision0.25 0.22581
wandb:           val_precision0.5 0.4
wandb:          val_precision0.75 0.5
wandb:             val_recall0.25 0.25926
wandb:              val_recall0.5 0.14815
wandb:             val_recall0.75 0.03704
wandb: 
wandb: 🚀 View run resnet18_2d_87_7_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/vpytissk
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_7/wandb/run-20250725_191658-vpytissk/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_7/wandb/run-20250725_195609-kz0bpblc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_7_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/kz0bpblc
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▅▅▂▃▆▃▆▃▆▆▃▂▅▅▆▅▃▃▅▄▅▃▆▄▅▇▅▄▅▅█▅▅▇▇█▅▇█
wandb:           test_accuracy0.5 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▅▅▅▆▄▁▆▃▂▆▇█▃
wandb:          test_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▁▁▃▁▁▃▁▁█▁
wandb:                 test_auroc ▆▅▄▄▄▃▃▃▃▃▃▃▃▃▃▃▂▂▃▂▂▂▂▁▁▁▁▁▃▄▄▅▅▅▆███▇█
wandb: test_balanced_accuracy0.25 ▆▇█▄▄▃▇▇▇▅▄▄▅▅▅▆▅▃▅▃▃▃▄▂▁▆▄▄▂▅▂▂█▇▆▅█▇▅▆
wandb:  test_balanced_accuracy0.5 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▃▁▃▅▅▅▇▇█
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁█▁▁▁▁
wandb:         test_precision0.25 ▂▂▃▂▃▃▃▂▃▃▂▃▂▂▂▂▃▂▂▂▂▂▂▃▂▂▁▁▂▂▁▂▂▂▃▂▃▄▅█
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁▄▅▅██
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁█
wandb:            test_recall0.25 █▇▃█▇▇▆▇▂▄▅▄▅▆▄▃▅▃▃▄▃▄▄▃▅▄▄▁▄▄▄▄▄▂▄▄▂▂▃▂
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅▅▇████
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▄▅▁▄▁█▁▅▅
wandb:                train_auroc ▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂▃▃▃▂▃▃▄▄▄▄▅▅▆▆▇▇█▇██████
wandb:                 train_loss ███████████████████▇▇▇▇▇▆▆▆▅▅▅▄▄▃▃▃▂▂▂▁▁
wandb:           val_accuracy0.25 ▁▂▂▄▇▃▅▂▃▂▃▄▄▄▅▅▃▄▅▂▃▅▄▅▄▄▄▅▃▄▄▃▇▃▅▇█▄▆▅
wandb:            val_accuracy0.5 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇████▇█▄▇▁▇▅▆
wandb:           val_accuracy0.75 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆█▆█▆█▃▁▃▃
wandb:                  val_auroc █▇▇▇▇▇▇▇▆▆▆▆▆▆▆▅▅▅▅▅▅▄▄▄▄▄▄▃▃▂▁▁▂▃▃▄▄▄▄▄
wandb:  val_balanced_accuracy0.25 ▇▆▅▅▅█▄▄▄█▅▄▄▄▄▄▃▃▃▃▆▃▅▂▅▅▃▂▁▃▆▄▆▄▄▃▄▄▅▄
wandb:   val_balanced_accuracy0.5 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▇█▇▆▆▇▁▄▆▅▄▄
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁███▆
wandb:          val_precision0.25 ▆▆▆▆▆▆▆▅▇█▅▅▅▅▇▄▇▅▇▅▅▇▆▃▇▅▇▆▅▄▂▁▃▁▁▃▆▃▄▄
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆█▃▃▄▃▄▄▄▂
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁██▁▁▃▃▃▅▅▅
wandb:             val_recall0.25 █▄▂▄▄▄▄▄▄▄▄▅▄▅▄▄▄▄▄▄▄▄▄▄▃▃▂▂▁▃▃▃▂▂▁▁▂▁▂▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▄▄▄▅█▄▄▅▄▇▄▇▄▅▄▅
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▁▁▁█▅▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.65
wandb:           test_accuracy0.5 0.7625
wandb:          test_accuracy0.75 0.775
wandb:                 test_auroc 0.58333
wandb: test_balanced_accuracy0.25 0.55
wandb:  test_balanced_accuracy0.5 0.59167
wandb: test_balanced_accuracy0.75 0.56667
wandb:         test_precision0.25 0.31818
wandb:          test_precision0.5 0.55556
wandb:         test_precision0.75 0.75
wandb:            test_recall0.25 0.35
wandb:             test_recall0.5 0.25
wandb:            test_recall0.75 0.15
wandb:                train_auroc 1
wandb:                 train_loss 0.11481
wandb:           val_accuracy0.25 0.59434
wandb:            val_accuracy0.5 0.71698
wandb:           val_accuracy0.75 0.74528
wandb:                  val_auroc 0.48462
wandb:  val_balanced_accuracy0.25 0.44567
wandb:   val_balanced_accuracy0.5 0.51394
wandb:  val_balanced_accuracy0.75 0.51971
wandb:          val_precision0.25 0.16
wandb:           val_precision0.5 0.3
wandb:          val_precision0.75 0.4
wandb:             val_recall0.25 0.15385
wandb:              val_recall0.5 0.11538
wandb:             val_recall0.75 0.07692
wandb: 
wandb: 🚀 View run resnet18_2d_87_7_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/kz0bpblc
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_7/wandb/run-20250725_195609-kz0bpblc/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_7/wandb/run-20250725_203441-o5em9rnk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_7_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/o5em9rnk
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▅▂▆▆▅▆▆▇▆▇▇██▇▇▇███▇█▇▇█▇▆█▇▄▃█▇▇▇▆▇▇▅▆
wandb:           test_accuracy0.5 ▆▆▆▆▆▅▅▅▅▅▅▅▅▅▅▅▅▅▆▅▆▅▃▆▅▅▃▃█▃▃▁▃▅▁▃▃▁▃▁
wandb:          test_accuracy0.75 ████▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▁▁▁▅
wandb:                 test_auroc ▄▅▅▅▆▆▇▇▇▇▇▇▇▇▇▆▇█████▇▇▇▇▇▆▆▆▃▃▃▃▂▂▂▂▂▁
wandb: test_balanced_accuracy0.25 ▅▂▂▅▃▄▇▅▆▆█▇▇▇███▆▆▆█▇▆▅▇▅▆▅▅▄▄▅▄▁▃▂▁▂▃▄
wandb:  test_balanced_accuracy0.5 ▂▂▂▂▂▂▂▂▂▂▂▂▄▂▂▄▂▂▂▂▂▂▁▅▅▃▃▁▃▂▁▁▂▂▂▄▆▃█▄
wandb: test_balanced_accuracy0.75 ██████████▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▃▃▁
wandb:         test_precision0.25 ▂▂▂▂▂▃▅▂▃▅▅▃▆▄▅▆▄▇▅▆▄▇▅▆▇▂█▂▃▂▄▁▃▂▄▂▃▁▂▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁████▁█▅▁▇▁▅▅▅▅▅▅▁▇▅▅▇
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁
wandb:            test_recall0.25 ▇█▇▆▄▆▅▆▅▇▅▅▆▅▆▅▄▆▆▆▆▆▃▅▃▆▃▆▃▅▃▄▄▅▅▄▅▅▃▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▁▂▂▄▄▁▂▁▁▁█▁▂▂▂▂▂▂▇▄▄▁▄
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▁▁▂▂▂▂▂▂▂▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▄▅▅▅▆██████████
wandb:                 train_loss ███████████████▇▇▇▇▇▇▇▇▇▇▇▇▆▆▆▅▄▃▂▃▂▂▂▂▁
wandb:           val_accuracy0.25 ▁▅▅▅█▅▄▇▆▆▆▇▇▇▇█▆▇█▇▇▇▇▇▇▇▆▅▆▇▆▄▆▅▄▃▆▅▅▅
wandb:            val_accuracy0.5 ███▇▇▇▇▇▇▇▇▇▇▇▆▆▇▆▇▆▆▇▆▆▆▆▇▆▇▆▅▄▅▅▃▁▅▇▆▅
wandb:           val_accuracy0.75 ███▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆▇▇▇▇▇▇▆▅▇▆▇▁▃▃▆▇▇▇▇▇▅
wandb:                  val_auroc ▇█████▇▇▇▇███████▇▇▇▇▇▇▇▇▅▅▅▅▄▃▂▂▂▃▁▁▁▁▁
wandb:  val_balanced_accuracy0.25 █▆▇▄▄▇▅▆▆▇▆▅▅▅▄▄▄▅▅▄▄▄▇▅▅▄▅▂▄▂▃▁▃▂▄▁▃▃▃▃
wandb:   val_balanced_accuracy0.5 ▇▇▇▅▅▅▄▄▄▄▄▄▄▄▄▄▄▄▁▁▁▅▁▄▅▅▄▄▆▅▄▄▆▅█▂▆██▅
wandb:  val_balanced_accuracy0.75 ▆▆▆▆▆▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▁▁▁█▁█▁██████▆█
wandb:          val_precision0.25 ▅▅█▅▅▆▆▇▆▇▅▅▆▇▅▆▄▆▃▅▅▆▅▃▅▅▄▂▃▃▃▁▃▂▂▂▂▁▁▂
wandb:           val_precision0.5 ▇▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▁▅▁▁▆▅▆█▆▇▅▅▆▄▅▇▆▆▅
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁█▅█▅▆█
wandb:             val_recall0.25 ███▄▆▄▄▄▄▄▄▃▃▃▃▃▂▂▂▃▃▂▂▂▄▂▄▂▃▄▂▂▁▁▃▂▁▂▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▁▃▁▃▃▃▃▃▃█▆▆▆▆█▆
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁████
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.6875
wandb:           test_accuracy0.5 0.7125
wandb:          test_accuracy0.75 0.7375
wandb:                 test_auroc 0.52
wandb: test_balanced_accuracy0.25 0.50833
wandb:  test_balanced_accuracy0.5 0.475
wandb: test_balanced_accuracy0.75 0.49167
wandb:         test_precision0.25 0.27273
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.15
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.99988
wandb:                 train_loss 0.35737
wandb:           val_accuracy0.25 0.65094
wandb:            val_accuracy0.5 0.72642
wandb:           val_accuracy0.75 0.73585
wandb:                  val_auroc 0.41444
wandb:  val_balanced_accuracy0.25 0.46109
wandb:   val_balanced_accuracy0.5 0.51172
wandb:  val_balanced_accuracy0.75 0.50586
wandb:          val_precision0.25 0.14286
wandb:           val_precision0.5 0.33333
wandb:          val_precision0.75 0.33333
wandb:             val_recall0.25 0.07407
wandb:              val_recall0.5 0.07407
wandb:             val_recall0.75 0.03704
wandb: 
wandb: 🚀 View run resnet18_2d_87_7_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/o5em9rnk
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_7/wandb/run-20250725_203441-o5em9rnk/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_7/execution_datetimes.json

**************************************************  Experiment 87 | Version 8 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 212 samples
    Label distribution: {0: 159, 1: 53}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 29, 1.0: 3}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 15, 1.0: 5}
  - Fold 2: 213 samples
    Label distribution: {0: 159, 1: 54}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 14, 1.0: 7}
  - Fold 3: 213 samples
    Label distribution: {0: 160, 1: 53}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 17, 1.0: 4}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 107 samples
    Label distribution: {0: 80, 1: 27}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 7, 1.0: 4}
  - Fold 2: 106 samples
    Label distribution: {0: 80, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 2}
  - Fold 3: 106 samples
    Label distribution: {0: 79, 1: 27}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 9, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 28, 1.0: 4}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 2: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 28, 1.0: 4}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 3: 80 samples
    Label distribution: {0: 60, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_8/wandb/run-20250725_211345-1e9v9tvu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_8_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/1e9v9tvu
    Batch label distribution: {0.0: 28, 1.0: 4}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▄▅▆▆█▇▇█▇▆▆▇▆▇▇▆▇▆▆▇▆▆▆▆▆▇▆▆▇▆▆▅▆▇▇▆▅▇
wandb:           test_accuracy0.5 ▁███████████████████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▇▇▇▇████████████████████████▇███▇▇▇▇▇▇▇
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▃▃▄▃▅▄▃▃▂▁▆▆█▃▃▆▃▆▄▆▃▃▇██▁▄▃▃▃▆▃▁▃▃
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▄▂▃▂▃▃█▄▃▂▁▂▄▃▂▄▅▃▂▃▃▄▃▃▄▂▅▅▂▅▂▂▁▂▄
wandb:          test_precision0.5 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ███▆▅▃▂▂▁▄▁▂▂▂▂▂▃▂▄▅▃▅▆▅▄▂▃▅▃▅▅▅▃▃▂▃▃▂▂▅
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▆▁▃▆▁▅▇▅▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆▇▇▇▇▇▇▇▇▇▇█▇█▇█▇
wandb:                 train_loss █▅▃▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▅▆▅▆█▆▇▄▆▇▅▇▄▆▄▃▄▇▆▄▆▄▅▄▆▅▅▅▆▆▆▅▅▆▄▆
wandb:            val_accuracy0.5 ▁███████████████████████████████████████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁███████████████████████████████████████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▆▃▃▆▄▄█▆▆▃▅▅▇▃▅▄█▂▆▁▆▅▃▆▆▆▇▃▆▆▅▂▅▅▂
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▂▂▃▂▃▇▄█▄▄▃▄▄▄▄▂▄▃▃▃▄▃▃▄▃▃▃▄▄▃▃▃▄▃▃
wandb:           val_precision0.5 ██▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ██▄▃▅▁▄▁▃▃▃▁▃▄▂▃▃▅▄▅▆▅▃▃▆▄▄▃▄▄▅▄▄▄▃▅▃▃▃▄
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.4875
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.52833
wandb: test_balanced_accuracy0.25 0.55833
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.28571
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.7
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.57612
wandb:                 train_loss 1.66851
wandb:           val_accuracy0.25 0.45794
wandb:            val_accuracy0.5 0.74766
wandb:           val_accuracy0.75 0.74766
wandb:                  val_auroc 0.56204
wandb:  val_balanced_accuracy0.25 0.51481
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.26154
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.62963
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_8_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/1e9v9tvu
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_8/wandb/run-20250725_211345-1e9v9tvu/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_8/wandb/run-20250725_212009-wihbs1rv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_8_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/wihbs1rv
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▃▅▂▄▄▅▅▄▅▅▅▄▆▅▅▅▆▅▆▅▅▅▅▆▅▆▅▆▅▅▅▄▅▅█▅██
wandb:           test_accuracy0.5 ██████████████████████████████████████▆▁
wandb:          test_accuracy0.75 ███████████████████████████████████▁▁▁▁▁
wandb:                 test_auroc ██▇▆▅▅▅▅▅▅▅▄▄▄▄▃▃▃▃▃▃▃▃▃▂▂▂▂▂▂▁▂▁▁▁▁▂▃▃▃
wandb: test_balanced_accuracy0.25 ▄▇▇▆▇▆█▇▇▄▆▆▄▆█▇▆▆▅▄▅▇▆▆▆▆▄▄▁▃▆▂▄▃▃▇█▁▂▃
wandb:  test_balanced_accuracy0.5 █████████████████████████████████████▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▇▆█▆██▆▅█▅▇▆▄▆▇▄▅▇▄█▂▄▄▂▃▅▃▃▃▆▄▃▄▄▁▂▇▇▂▄
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▆▇██▇▆▆▆▆▆▃▃▄▆▄▄▃▃▃▃▂▃▃▃▃▁▁▂▂▂▂▃▃▁▃▁▃▄▃▂
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▂▂▂▂▂▂▂▂▂▂▂▃▃▃▃▃▃▃▃▃▃▃▃▄▄▄▄▄▄▄▄▄▅▆▆▇▇██
wandb:                 train_loss ██▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆▆▆▆▆▆▆▆▆▆▆▅▅▅▄▃▃▃▁
wandb:           val_accuracy0.25 ▁█▃▃▃▃▂▂▂▄▃▄▄▅▃▄▅▅▅▄▄▄▅▄▄▆▆▄▅▅▄▆▅▇▅▆▆▅▅▄
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▄█▁██
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ██████▇▇▇▇▆▇▆▆▆▆▆▆▅▅▆▆▅▅▅▅▅▅▅▅▅▅▄▄▃▃▂▂▂▁
wandb:  val_balanced_accuracy0.25 ▇▆▆▄▅▅▇▅▆▆▅▅▄▃▅▇▃█▃▄▇▅▆▄▄█▇█▆▅▇▃▇▅▃▃▆▇▁▂
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▁▁▁▁▁█
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▆█▅▅▆▄▄▅▅▅▄▅▅▅▅▄▅▅▄▄▃▃▄▃▆▃▆▄▆▃▄▅▆▄▅▄▅▆▄▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁██
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 █▅▆▅▆▄▅▃▄▃▄▄▃▂▂▃▂▂▃▃▃▂▃▂▂▃▂▂▂▃▃▂▃▂▁▁▂▃▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁█
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.4875
wandb:           test_accuracy0.5 0.7125
wandb:          test_accuracy0.75 0.7375
wandb:                 test_auroc 0.50083
wandb: test_balanced_accuracy0.25 0.475
wandb:  test_balanced_accuracy0.5 0.475
wandb: test_balanced_accuracy0.75 0.49167
wandb:         test_precision0.25 0.23077
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.45
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.93163
wandb:                 train_loss 1.17447
wandb:           val_accuracy0.25 0.39623
wandb:            val_accuracy0.5 0.77358
wandb:           val_accuracy0.75 0.75472
wandb:                  val_auroc 0.43654
wandb:  val_balanced_accuracy0.25 0.39231
wandb:   val_balanced_accuracy0.5 0.55144
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.17241
wandb:           val_precision0.5 0.75
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.38462
wandb:              val_recall0.5 0.11538
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_8_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/wihbs1rv
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_8/wandb/run-20250725_212009-wihbs1rv/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_8/wandb/run-20250725_215937-3i0u6j9n
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_8_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/3i0u6j9n
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▇██▆▆▇▆▅▆▆█▆▆▆▅▅▇▆▇▅▆▆▅▆▆▆▅▆▆▆▆▇▆▆▆
wandb:           test_accuracy0.5 ▁▁██████████████████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▅▅▆▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇███████████████████
wandb: test_balanced_accuracy0.25 ▂▂▂▅▁▄▆▆▆▅▄▄▆▅▆▅▅▆▇█▄▅▅▅▄▅▄▆▅▆▄▄▆▅▇▆▅▄▇▅
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▄▆▄▄▄▂▄▃▄▄▄▂▄▃▃▃▃▃▂▄▂▂▃▃▃▄▃▂█▃▃▂▂▃▃
wandb:          test_precision0.5 ██▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ████████▆▁▁▂▂▄▂▄▃▄▄▅▆▅▄▅▅▄▄▄▄▄▃▃▅▅▄▄▄▃▅▄
wandb:             test_recall0.5 ██▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▄▅▇▅█▆▇▇▆▇▇▇▇▇▇▇▇▇▇▇▇████████▇█████████
wandb:                 train_loss █▇▄▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▄▇█▇▇▇▇▇▇▅▇▇▇▄▅▅▅▇▅▅▆▆▅▅▆▆▅█▅▅▆▆▆▅▆▄
wandb:            val_accuracy0.5 ▁███████████████████████████████████████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc █▄▂▂▁▃▄▃▃▄▂▅▅▅▅▅▄▄▄▅▇▇▆▆▄▄▄▄▅▅▅▅▅▅▄▄▃▃▃▄
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂███▇▂▁▇▇▆▅▂▃▂▁▅▄▃▄▆▃▄▃▂▅▃▃▃▄▃▄▅▄▅▄
wandb:   val_balanced_accuracy0.5 ██████████████████████████████████████▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁█▆▃▄▃▄▂▃▃▄▂▂▂▂▂▂▂▂▂▂▄▃▂▁▂▂▂▂▂▂▂
wandb:           val_precision0.5 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ████▃▂▁▂▂▃▂▁▂▂▃▂▅▅▂▂▃▃▃▄▃▂▂▂▃▃▃▃▃▂▂▃▂▂▃▄
wandb:              val_recall0.5 ██▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.5625
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.60167
wandb: test_balanced_accuracy0.25 0.55833
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.2973
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.55
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.59835
wandb:                 train_loss 1.66226
wandb:           val_accuracy0.25 0.54717
wandb:            val_accuracy0.5 0.73585
wandb:           val_accuracy0.75 0.74528
wandb:                  val_auroc 0.58978
wandb:  val_balanced_accuracy0.25 0.52555
wandb:   val_balanced_accuracy0.5 0.49367
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.2766
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.48148
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_8_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/3i0u6j9n
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_8/wandb/run-20250725_215937-3i0u6j9n/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_8/execution_datetimes.json

**************************************************  Experiment 87 | Version 9 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 212 samples
    Label distribution: {0: 159, 1: 53}
    Batch label distribution: {0.0: 46, 1.0: 18}
    Batch label distribution: {0.0: 47, 1.0: 17}
    Batch label distribution: {0.0: 51, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 5}
  - Fold 2: 213 samples
    Label distribution: {0: 159, 1: 54}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 45, 1.0: 19}
    Batch label distribution: {0.0: 14, 1.0: 7}
  - Fold 3: 213 samples
    Label distribution: {0: 160, 1: 53}
    Batch label distribution: {0.0: 45, 1.0: 19}
    Batch label distribution: {0.0: 47, 1.0: 17}
    Batch label distribution: {0.0: 51, 1.0: 13}
    Batch label distribution: {0.0: 17, 1.0: 4}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 107 samples
    Label distribution: {0: 80, 1: 27}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 30, 1.0: 13}
  - Fold 2: 106 samples
    Label distribution: {0: 80, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 31, 1.0: 11}
  - Fold 3: 106 samples
    Label distribution: {0: 79, 1: 27}
    Batch label distribution: {0.0: 51, 1.0: 13}
    Batch label distribution: {0.0: 28, 1.0: 14}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 2: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 3: 80 samples
    Label distribution: {0: 60, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_9/wandb/run-20250725_220628-tx5p785s
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_9_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/tx5p785s
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 10, 1.0: 6}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▃▅▅▆██▇██▅▆▇▇▅▃▅▄▄▄▅▅▄▅▅▆▆▆▆
wandb:           test_accuracy0.5 ▁▁██████████████████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▇██▅▄▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▄█▃▆▇▇▆▂▃▅▂▁▅▃▆▃▇▄█▃▂▇▃▆▇▂▃
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▂▂▂▂▂▃▂▂▄▂▅▂▇▂▇▁▁▅▆▄▃▄▆▂▆▅▅▂█▂▂▆▅▆▃▂▆▆▄▂
wandb:          test_precision0.5 ▆█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ██████████▅▅▃▃▂▂▂▁▂▃▂▂▃▆▆▆▆▆▆▆▆▂▂▄▆▃▆▂▂▃
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▄▃▁█▅▃▄▄▄▄▄▄▄▅▄▅▅▅▅▄▅▅▄▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:                 train_loss █▅▄▄▄▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▂▆▆███▇▇██▇▇▅▆▆▄▃▄▄▄▄▄▄▄▅▄▅▆▆▆▅▄▄▇▆▆
wandb:            val_accuracy0.5 ▁███████████████████████████████████████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▇███████████▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▁▆▆▇▇▅▅▅▆█▅█▆▆▇▆▆▆▆▆▆▄█▆▇▄▆▇▇▄
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▃▃▄▅▃▆▆▆▃██▆▅▆▅▃▂▃▃▃▃▃▃▂▃▁▂▃▅▃▃▃▁▅
wandb:           val_precision0.5 ▅▅█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ██████████▅▅▄▁▁▂▂▂▅▂▅▅▅▅▆▇▆▅▇▇▅▅▆▅▃▅▅▅▃▅
wandb:              val_recall0.5 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.5375
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.52417
wandb: test_balanced_accuracy0.25 0.49167
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.24242
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.4
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.57173
wandb:                 train_loss 1.67204
wandb:           val_accuracy0.25 0.54206
wandb:            val_accuracy0.5 0.74766
wandb:           val_accuracy0.75 0.74766
wandb:                  val_auroc 0.55972
wandb:  val_balanced_accuracy0.25 0.54653
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.28846
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.55556
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_9_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/tx5p785s
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_9/wandb/run-20250725_220628-tx5p785s/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_9/wandb/run-20250725_221341-20mp8dz1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_9_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/20mp8dz1
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▃▃▃▄▄▃▂▂▁▄▆▇██▇▇▇▆▅▄▄▄▃▃▄▅▆▇▅
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▃▅▄▅▆▆▅▇▇▇▇▇████▇▇▅▅▅▅▅▅▅▆▆▆▄▄▄▄▄▄▃▃▃▃▂
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▂▃▄▄▄▂▃▁▂▃▅▅▆▆▅▅▃▃▄▃▅▃▄▆█
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▂▂▂▂▂▂▂▂▃▂▃▃▃▂▃▁▁▃▄▅▃▃▄▃▂▁▁▁█▆▇██▄▃▄▅▄▃▇
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ███████████▇███▇▆▅▆▆▆▆▇▇▆▅▃▃▂▁▁▂▂▅▅▆▅▅▅▃
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▄▃█▅█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:                 train_loss ▇█▆▃▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▂▂▂▂▃▃▂▁▂▂▂▂▄▆▆█▇▆▆▆▂▂▂▃▃▂▂▃▃▃
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▄█▅▆▅▆▄▄▃▃▃▂▁▁▂▁▂▂▂▂▂▂▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▅▄▅▄▁▁▄▄▅▄▁█▅██▅▅▃▄▃▁▂
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▅▅▃▄▅▅▄▄▅▄▆▇█▂▁▂▃▃▄▃▁▂
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ███████████████▄▆███▃▂▁▁▂▁▁▂▂▆▆▅▄▄▅▃▂▂▂▃
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.4875
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.53583
wandb: test_balanced_accuracy0.25 0.575
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.29412
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.75
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.58945
wandb:                 train_loss 1.68417
wandb:           val_accuracy0.25 0.40566
wandb:            val_accuracy0.5 0.75472
wandb:           val_accuracy0.75 0.75472
wandb:                  val_auroc 0.53894
wandb:  val_balanced_accuracy0.25 0.47644
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.23188
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.61538
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_9_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/20mp8dz1
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_9/wandb/run-20250725_221341-20mp8dz1/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_9/wandb/run-20250725_222118-69lf2kpd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_9_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/69lf2kpd
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▃▅▅█████▅▃▃▆█▅▆▅▄▅▆▅▅▆█▅▅▅▅▅
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▂▅▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇██████████
wandb: test_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▂▃▂▅▇▄▂▁▁▃▅▅██▅▆▅▅▅▇▇▅▅▃▃▇▇▇▇▅▅
wandb:  test_balanced_accuracy0.5 ▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▅▅▅▅▅▅▅▅▅▅▇▅▁▁▁▆▆▅▅▅▅▅▆▅▅▅▅▅▅▅▆▇▇█▆▅▆▅▅▅
wandb:          test_precision0.5 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 █████████▇▁▁▁▃▅▇▇▆▄▃▅▄▄▆▆▄▄▄▆▄▅▅▅▄▄▃▃▃▄▅
wandb:             test_recall0.5 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▄▁▁▆▃▆▅▆▅▆▅▅▆▆▆▆▆▆▆▆▇▆▇▇▇▇▇▇▇▇▇▇▆▇▇█████
wandb:                 train_loss █▄▄▄▃▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▄▆████▄▃▄▄▄▆▇▆▆████▆▅▄▅▆
wandb:            val_accuracy0.5 ▁▁▅█████████████████████████████████████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▇██▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆▆▆▆▆
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▆▄▆▅▁▁▆▄▇▆▄▆▃▇▁▂▄▆▅▄█▆▄▄▅
wandb:   val_balanced_accuracy0.5 ▂█▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▆▇█▁▁▆▅▆▅▅▅▆▅▆▆█▇█▇▅▅▅▆▆▅
wandb:           val_precision0.5 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ██████████▃▂▁▁▁▁▂▆▇▇▄▄▄▄▄▄▄▇▇▄▄▆▄▄▃▄▆▄▄▄
wandb:              val_recall0.5 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.5625
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.58917
wandb: test_balanced_accuracy0.25 0.54167
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.28571
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.5
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.58892
wandb:                 train_loss 1.66877
wandb:           val_accuracy0.25 0.54717
wandb:            val_accuracy0.5 0.74528
wandb:           val_accuracy0.75 0.74528
wandb:                  val_auroc 0.58697
wandb:  val_balanced_accuracy0.25 0.52555
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.2766
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.48148
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_9_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/69lf2kpd
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_9/wandb/run-20250725_222118-69lf2kpd/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_9/execution_datetimes.json

**************************************************  Experiment 87 | Version 10 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 212 samples
    Label distribution: {0: 159, 1: 53}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 16}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 3, 1.0: 1}
  - Fold 2: 213 samples
    Label distribution: {0: 159, 1: 54}
    Batch label distribution: {0.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 3, 1.0: 2}
  - Fold 3: 213 samples
    Label distribution: {0: 160, 1: 53}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 3, 1.0: 2}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 107 samples
    Label distribution: {0: 80, 1: 27}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 4}
  - Fold 2: 106 samples
    Label distribution: {0: 80, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 2}
  - Fold 3: 106 samples
    Label distribution: {0: 79, 1: 27}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 2: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 3: 80 samples
    Label distribution: {0: 60, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_10/wandb/run-20250725_222906-ojnpejuv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_10_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/ojnpejuv
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 15, 1.0: 1}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▃▃▃▄▄▄▄▄▅▆▅▅▄▅▄▅▅▅▅▆▆▆▆█
wandb:           test_accuracy0.5 ▁▁▁▁████████████████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▆▇▇██▆▆▅██▄▄▃▄▃▄▄▄▄▄▅▄▄▄▄▃▃▃▃▂▂▂▂▂▂▂▁▁▁▁
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▂▁▂▄▄▆▄▅▇█▅▆▆▆▆▄▅▆▇▆▂▂▆
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▂▂▃▄▄▄▆▅▄▆▆▅▆▆▆█▇▇▆▆▁▁▂▄▂
wandb:          test_precision0.5 ████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ██████████▇▆▆▆▅▅▅▅▅▃▄▅▅▅▄▅▅▅▅▅▅▄▄▃▄▂▁▂▁▁
wandb:             test_recall0.5 ███▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▇▃▂▃▂▅▂▁▇▅▆▇▇▇▇▇▇▇▇█▇▇▇█▇█▇▇██▇█████████
wandb:                 train_loss █▇▆▆▄▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▄▄▅▅▆▅▆▅▅▄▅▅▅▅▅▅▆▅▆▇▇████
wandb:            val_accuracy0.5 ▁▁▁▁████████████████████████████████████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▂▄▄▅▆▆▇▇▇▇▇▇▇▇█████████████████████████
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁██▆█▅▄▅█▅▅▄▄▅▄▅▆▆▅▆
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▁▃▃▃▆▆▆▆▆██▆▇▅▄▄▄▆▄▆▄▄▇▇
wandb:           val_precision0.5 ███▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 █████████████████▇▇▇▆▆▅▃▂▆▆▄▃▆▄▄▄▃▂▂▁▁▂▁
wandb:              val_recall0.5 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.525
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.535
wandb: test_balanced_accuracy0.25 0.48333
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.23529
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.4
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.56628
wandb:                 train_loss 1.67585
wandb:           val_accuracy0.25 0.54206
wandb:            val_accuracy0.5 0.74766
wandb:           val_accuracy0.75 0.74766
wandb:                  val_auroc 0.56991
wandb:  val_balanced_accuracy0.25 0.54653
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.28846
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.55556
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_10_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/ojnpejuv
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_10/wandb/run-20250725_222906-ojnpejuv/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_10/wandb/run-20250725_223612-zilxeh7v
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_10_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/zilxeh7v
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▅▆▆█▇▇█▇▆▇█▇▇▇▆
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▆▆▇██▆▆▆▆▆▆▄▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▁▃▃▂▂▁▂▆▅▆▆▆▅▅███▆▆
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▄▄▂▂▂▃▃▁▃▄▆▅▆▆▆▆▆▆█▆▅
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ████████████████████▇█▇▇▄▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▇▆▂█▆▇█▇▇▅▆▆▆▇▆▇▇▇▇▇▇▇▇▇███████████████
wandb:                 train_loss ▇█▇▇▅▄▃▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▄▄▄▇█▅▆▆▅▅▅▅▇▇▅
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▂▆▆██▇▅▅▄▄▄▄▃▃▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.25 ▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▆▆▇▇█▆▆▆█▃▅▃▅▄▆▃▂▁▅▆▅▃▅▅
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▇█▆▅█▄▄▄▄▄▂▅▆▆▄▆▄▁▆▅
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ██████████████████████▇▇▅▄▅▄▅▄▁▄▃▁▁▄▃▁▄▄
wandb:              val_recall0.5 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.425
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.54917
wandb: test_balanced_accuracy0.25 0.53333
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.26786
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.75
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.5785
wandb:                 train_loss 1.68822
wandb:           val_accuracy0.25 0.34906
wandb:            val_accuracy0.5 0.75472
wandb:           val_accuracy0.75 0.75472
wandb:                  val_auroc 0.56154
wandb:  val_balanced_accuracy0.25 0.50385
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24706
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.80769
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_10_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/zilxeh7v
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_10/wandb/run-20250725_223612-zilxeh7v/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_10/wandb/run-20250725_224355-ezze6313
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_10_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/ezze6313
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▅▇█▆▆▆▆▇▇▆▆▆▆▇▆▆▆▆▆▆▆▆▆▇▆▆▆▆▆▆▆▆▆▇▆
wandb:           test_accuracy0.5 ▁▁██████████████████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▃▃▄▄▄▄▄▅▅▅▅▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▇██
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▄▇▄▇▄▃▅▆▅▇▅▇▅▅▇▇▅▅▅▅▅▅▇▇▇▇▇▇█▅▆▅▇▇▆
wandb:  test_balanced_accuracy0.5 █▁█████████████████████████████████▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▃▂▂█▅▃▅▅▅▅▃▅▅▅▄▅▃▅▆▆▆▅▇▆▆▅▆▆▆▆▆▆▆
wandb:          test_precision0.5 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 █████▃▃▂▁▃▅▃▃▄▃▃▄▄▄▄▄▄▃▄▃▄▃▄▄▄▄▃▃▄▄▄▄▄▄▃
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▄▃▄▆▅▆▆▆▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇███████████████
wandb:                 train_loss █▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▆▇█▇▆▅▅▅▅▅▆▆▅▆▆▅▅▅▆▆▆▆▆▆▆▆▅▆▇▇▆▆▆▆▆
wandb:            val_accuracy0.5 ▁▁██████████████████████████████████████
wandb:           val_accuracy0.75 ███████████████████████████████████████▁
wandb:                  val_auroc ▁▅▄▇▆█▆▆▄▅▃▃▃▄▄▄▃▃▄▄▄▅▄▅▅▃▄▄▄▃▃▂▂▁▂▂▂▃▃▅
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▇▇█▇▆▇▆█▃▆▇▅▅▁▁▃▆▅▁▁▄▆▆▆▄▄▅▄▅▅▅▄▆▄▄▄
wandb:   val_balanced_accuracy0.5 ███████████████████████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 █████████████████████████████████████▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▃▇█▃▃▃▄▃▂▂▃▃▃▁▁▂▃▃▃▃▂▃▃▃▃▃▂▃▃▂▁▂▃▃▃
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 █████▆▆▆▃▃▁▁▂▃▃▃▃▂▃▃▃▃▃▄▂▃▂▂▂▃▃▃▂▂▃▂▃▂▃▂
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.575
wandb:           test_accuracy0.5 0.7375
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.60583
wandb: test_balanced_accuracy0.25 0.53333
wandb:  test_balanced_accuracy0.5 0.49167
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.28125
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.45
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.6138
wandb:                 train_loss 1.64775
wandb:           val_accuracy0.25 0.58491
wandb:            val_accuracy0.5 0.73585
wandb:           val_accuracy0.75 0.73585
wandb:                  val_auroc 0.59212
wandb:  val_balanced_accuracy0.25 0.53868
wandb:   val_balanced_accuracy0.5 0.49367
wandb:  val_balanced_accuracy0.75 0.49367
wandb:          val_precision0.25 0.29268
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.44444
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_10_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/ezze6313
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_10/wandb/run-20250725_224355-ezze6313/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_10/execution_datetimes.json

**************************************************  Experiment 87 | Version 11 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 212 samples
    Label distribution: {0: 159, 1: 53}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 29, 1.0: 3}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 15, 1.0: 5}
  - Fold 2: 213 samples
    Label distribution: {0: 159, 1: 54}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 14, 1.0: 7}
  - Fold 3: 213 samples
    Label distribution: {0: 160, 1: 53}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 17, 1.0: 4}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 107 samples
    Label distribution: {0: 80, 1: 27}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 7, 1.0: 4}
  - Fold 2: 106 samples
    Label distribution: {0: 80, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 2}
  - Fold 3: 106 samples
    Label distribution: {0: 79, 1: 27}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 27, 1.0: 5}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 9, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 28, 1.0: 4}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 2: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 28, 1.0: 4}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 3: 80 samples
    Label distribution: {0: 60, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_11/wandb/run-20250725_232326-3vif1477
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_11_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/3vif1477
    Batch label distribution: {0.0: 28, 1.0: 4}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▁▂█
wandb:           test_accuracy0.5 ▁▁▁█████████████████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▂▃▄▅▅▅▅▅▆▇▆▇▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█████████
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▄▄▁▂█▆▄
wandb:  test_balanced_accuracy0.5 ▆▆▆█▁▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▅▅▃▁▃▃█▆▅
wandb:          test_precision0.5 █████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ███████████████████████████████████▆▆▃▃▁
wandb:             test_recall0.5 ████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▄▁▆▇▇▇▇▇▇██▇▇▇▇█▆▆▇▇▇▇▇███▇████████████
wandb:                 train_loss ███▇▇▆▅▅▅▄▃▃▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▄█
wandb:            val_accuracy0.5 ▁▁▁▁████████████████████████████████████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▁▂▂▃▅▆▆▆▇█████████▇████████████████████
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▄▂▁▂▃▅█
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▅▃▁▂▄▅█
wandb:           val_precision0.5 █████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 █████████████████████████████████████▄▃▁
wandb:              val_recall0.5 ████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.3875
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.5275
wandb: test_balanced_accuracy0.25 0.50833
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25424
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.75
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.55571
wandb:                 train_loss 1.67864
wandb:           val_accuracy0.25 0.42056
wandb:            val_accuracy0.5 0.74766
wandb:           val_accuracy0.75 0.74766
wandb:                  val_auroc 0.56574
wandb:  val_balanced_accuracy0.25 0.55116
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.27848
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.81481
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_11_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/3vif1477
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_11/wandb/run-20250725_232326-3vif1477/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_11/wandb/run-20250725_233040-qpbn0uqq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_11_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/qpbn0uqq
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▃▁▃▃▃▅█
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▆█▇▆▃▃▃▃▂▂▂▂▂▂▃▂▂▁▁▁▁▁▂▁▁▁▂▁▁▂▂▃▃▃▃▃▃▃▃▂
wandb: test_balanced_accuracy0.25 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▅█▁▄
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇███▇▄▄▁▄
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ███████████████████████████████████▆▆▆▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc █▃▁▇▄▆███▆▇█▇▇▇▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇███
wandb:                 train_loss ██▇▇▆▅▅▅▄▄▃▃▃▃▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▆▆███▆▆
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▄▅▁▅▄▅▅▆▆▇▇█▇██▇▇▆▅▅▅▄▄▅▅▅▅▅▄▄▃▂▂▂▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▆▆█▃
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁██▃
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.3
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.55083
wandb: test_balanced_accuracy0.25 0.48333
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.24286
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.85
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.57873
wandb:                 train_loss 1.6898
wandb:           val_accuracy0.25 0.27358
wandb:            val_accuracy0.5 0.75472
wandb:           val_accuracy0.75 0.75472
wandb:                  val_auroc 0.54808
wandb:  val_balanced_accuracy0.25 0.50577
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24752
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.96154
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_11_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/qpbn0uqq
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_11/wandb/run-20250725_233040-qpbn0uqq/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_11/wandb/run-20250725_233900-5xvh1ue7
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_11_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/5xvh1ue7
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁▁▁▁▁███████████████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▁▁▁▂▃▃▄▄▅▅▆▆▇▇▇▇▇▇▇▇▇█▇████████████████
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ███████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ███████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▂▁▁▃▇▅▇▇▅▇▅█▆▆▆▇█▇▆▇▆▇▆▆▇▇▇▆▇▇▇▇▇▆▆▇▇▇▇
wandb:                 train_loss ██▇▇▆▅▄▄▄▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▆████████████████████████████████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▁▃▃▄█████▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 █████▁▅█████████████████████████████████
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ██████████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 █████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.56
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.56368
wandb:                 train_loss 1.67672
wandb:           val_accuracy0.25 0.25472
wandb:            val_accuracy0.5 0.74528
wandb:           val_accuracy0.75 0.74528
wandb:                  val_auroc 0.58697
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.25472
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_11_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/5xvh1ue7
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_11/wandb/run-20250725_233900-5xvh1ue7/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_11/execution_datetimes.json

**************************************************  Experiment 87 | Version 12 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset

Using regular DataLoader for train subset

Using regular DataLoader for train subset

✅ Set train dataloaders with 3 folds
  - Fold 1: 212 samples
    Label distribution: {0: 159, 1: 53}
    Batch label distribution: {0.0: 46, 1.0: 18}
    Batch label distribution: {0.0: 47, 1.0: 17}
    Batch label distribution: {0.0: 51, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 5}
  - Fold 2: 213 samples
    Label distribution: {0: 159, 1: 54}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 45, 1.0: 19}
    Batch label distribution: {0.0: 14, 1.0: 7}
  - Fold 3: 213 samples
    Label distribution: {0: 160, 1: 53}
    Batch label distribution: {0.0: 45, 1.0: 19}
    Batch label distribution: {0.0: 47, 1.0: 17}
    Batch label distribution: {0.0: 51, 1.0: 13}
    Batch label distribution: {0.0: 17, 1.0: 4}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 107 samples
    Label distribution: {0: 80, 1: 27}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 30, 1.0: 13}
  - Fold 2: 106 samples
    Label distribution: {0: 80, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 31, 1.0: 11}
  - Fold 3: 106 samples
    Label distribution: {0: 79, 1: 27}
    Batch label distribution: {0.0: 51, 1.0: 13}
    Batch label distribution: {0.0: 28, 1.0: 14}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 2: 80 samples
    Label distribution: {0: 60, 1: 20}
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 10, 1.0: 6}
  - Fold 3: 80 samples
    Label distribution: {0: 60, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_12/wandb/run-20250725_234616-chruoe34
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_12_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/chruoe34
    Batch label distribution: {0.0: 50, 1.0: 14}
    Batch label distribution: {0.0: 10, 1.0: 6}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁▁▁▁▁███████████████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▄▆▆█▆▆▆▆▆▅▆▅▅▄▄▃▃▃▃▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▂▂▂▂▂▂▂▄█▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 █████▅▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▁▂▆█▆▆▇▆▇█▆▆▆▆█▆▇▇▇▇▆▆▇▇▅▇▇▆▆▇▇▇▇▇▇▇▇▇▇
wandb:                 train_loss ███▇▇▇▇▆▆▆▆▅▅▅▅▄▄▄▄▄▃▃▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁▁▁▁███████████████████████████████████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▁▁▂▃▄▄▄▅▅▆▇▇▇▇▇▇▇▇▇▇▇████████▇▇▇▇▇▇▇▇▇▇
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ████████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ███▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.52583
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.55726
wandb:                 train_loss 1.69437
wandb:           val_accuracy0.25 0.25234
wandb:            val_accuracy0.5 0.74766
wandb:           val_accuracy0.75 0.74766
wandb:                  val_auroc 0.56528
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.25234
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_12_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/chruoe34
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_12/wandb/run-20250725_234616-chruoe34/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_12/wandb/run-20250725_235602-321yo64b
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_12_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/321yo64b
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▄▄▄▅▄▅▆▆▅▇▇█▇█▇▇██▇▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▆▆▆▇
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▃▆▁▁▆▇▇▆▆▇█▇██▇▇▇█▆▇▇▇▇▇▆▇▇▇▇▇▇▆▇▇▇▆▇▇█▇
wandb:                 train_loss ███▇▇▆▆▆▆▆▆▅▅▅▅▅▄▄▃▃▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▅▆█▇▇██▇▇▆▆▅▅▄▅▅▅▅▄▄▄▄▄▄▄▄▃▃▃▃▃▃▃▃▂▂▂▁▁▁
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.5425
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.57081
wandb:                 train_loss 1.74261
wandb:           val_accuracy0.25 0.24528
wandb:            val_accuracy0.5 0.75472
wandb:           val_accuracy0.75 0.75472
wandb:                  val_auroc 0.53702
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24528
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_12_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/321yo64b
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_12/wandb/run-20250725_235602-321yo64b/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_12/wandb/run-20250726_000357-bav811p9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_87_12_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/bav811p9
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err', 'dicom_slice_count', 'original_slice_thickness_mm', 'sct_slice_new_1', 'reversed', 'sct_slice_final_mapped']
Label weights: tensor([2.9900], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▂█████████████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▂▃▂▃▄▃▄▄▄▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇███████
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▃▃▃▃▃▃▃▃▃▃▃▃▃█▁▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▆▆▆▆▆▆▆▆▆▆▇█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ████████████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▁▄▂▄▅▅▇▆▇█▇▇▇▇▆▇▇▇▇▇█▇█▇█▇▇█▇▇█▇▇▇██▇▇▇
wandb:                 train_loss ████▇▇▇▆▆▆▆▆▆▆▅▅▄▄▄▄▄▄▄▃▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁██████████████████████████████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▂▂▄▇▇▇███▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆▇▇▇
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▃▃▃▃▃▃▃▃▃▃▃▃▃█▁▁▁▁▁▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ██████████████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ██████████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25
wandb:           test_accuracy0.5 0.75
wandb:          test_accuracy0.75 0.75
wandb:                 test_auroc 0.565
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.5658
wandb:                 train_loss 1.7328
wandb:           val_accuracy0.25 0.25472
wandb:            val_accuracy0.5 0.74528
wandb:           val_accuracy0.75 0.74528
wandb:                  val_auroc 0.59306
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.25472
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_87_12_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18/runs/bav811p9
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_masked_resnet18
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_12/wandb/run-20250726_000357-bav811p9/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_87/version_12/execution_datetimes.json
Finish time: 2025-07-26 00:14:14
