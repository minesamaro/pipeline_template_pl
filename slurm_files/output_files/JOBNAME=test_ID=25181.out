
**************************************************  Experiment 19 | Version 1 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days']

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days']
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/132227/01-02-1999-NLST-LSS-39522/2.000000-0OPAGELSQXD3302.5120.00000064.00.11.5-18341
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/100012/01-02-2000-NLST-LSS-60484/3.000000-1OPASEVZOOMB50f2802.012070.040.0null-22196
Got here to 2D
Dicom image shape: (136, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/130467/01-02-1999-NLST-LSS-38457/2.000000-0OPASEVZOOMB50f3402.012060.030.0null-32568
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/100147/01-02-2000-NLST-LSS-78677/2.000000-1OPAGELSPLUSD3302.514040.00.0null-95145
Got here to 2D
Dicom image shape: (155, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/208801/01-02-2000-NLST-ACRIN-91855/2.000000-1OPAGELSPR16BONE3101.21204834.91.4-70544
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/100158/01-02-2001-NLST-LSS-89087/2.000000-2OPAGELS16D3502.5120650.0nullnull-09470
Got here to 2D
Dicom image shape: (245, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/131156/01-02-2001-NLST-LSS-87498/3.000000-2OPATOAQUL4FC51273.42-34235
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/100242/01-02-1999-NLST-LSS-96746/3.000000-0OPAGEHSQXB2902.512056.00.11.5-07179
Got here to 2D
Dicom image shape: (146, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/106753/01-02-1999-NLST-LSS-13846/2.000000-0OPAGELSQXD2902.5120.00000048.00.01.5-59093
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/100280/01-02-2000-NLST-LSS-98495/2.000000-1OPASESEN16B50f2822.012045.030.0null-87490
Got here to 2D
Dicom image shape: (170, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/130315/01-02-1999-NLST-LSS-70411/2.000000-0OPAGELSPLUSD2902.514040.00.01.5-59408
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/100697/01-02-2001-NLST-LSS-54535/2.000000-2OPAGELS16B3502.512060.00.11.375-17632
Got here to 2D
Dicom image shape: (123, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/121999/01-02-2000-NLST-LSS-68853/2.000000-1OPASESEN16B50f290212045.030.0null-11993
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/100703/01-02-1999-NLST-LSS-53772/3.000000-0OPAGELSQXB3672.512048.00.01.5-47768
Got here to 2D
Dicom image shape: (157, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/125450/01-02-2001-NLST-LSS-62630/3.000000-2OPASEVZOOMB50f376212075.040.0null-57683
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/100913/01-02-2000-NLST-LSS-47439/1.000000-1OPAGELSPLUSLUNG3602.512080.00.11.5-06917
Got here to 2D
Dicom image shape: (180, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/205591/01-02-1999-NLST-ACRIN-24384/2.000000-0OPAGELSQXSTANDARD3702.51204026.71.5-45884
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/101066/01-02-1999-NLST-LSS-46687/2.000000-0OPASEVZOOMB50f2762.012080.040.0null-03102
Got here to 2D
Dicom image shape: (282, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/211328/01-02-1999-NLST-ACRIN-20758/7067.000000-0OPAPHMX8000D3231.312060401.5-65805
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/101068/01-02-2000-NLST-LSS-45367/2.000000-1OPAGELS16B3402.512060.00.11.375-87679
Got here to 2D
Dicom image shape: (248, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/130624/01-02-2000-NLST-LSS-12681/1.000000-1OPAGELSPLUSLUNG3202.512080.00.11.5-82705
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/101192/01-02-2001-NLST-LSS-69321/2.000000-2OPAGELSQXD2802.514048.00.01.5-95103
Got here to 2D
Dicom image shape: (120, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/129553/01-02-2000-NLST-LSS-48626/2.000000-1OPAGELSQXD3702.512048.00.01.5-62477
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/101287/01-02-1999-NLST-LSS-69722/3.000000-0OPATOAQUL4FC51276.62-52642
Got here to 2D
Dicom image shape: (157, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/212202/01-02-2001-NLST-ACRIN-20204/4.000000-2OPAGELSQXBONE3602.51208053.31.5-96044
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/101387/01-02-1999-NLST-LSS-10854/2.000000-0OPAGELSQXD3202.514040.00.01.5-63002
Got here to 2D
Dicom image shape: (155, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/116137/01-02-2001-NLST-LSS-29433/3.000000-2OPATOAQUL4FC51323.42-77572
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/101428/01-02-2001-NLST-LSS-26003/3.000000-2OPASEVZOOMB50f362212060.030.0null-90445
Got here to 2D
Dicom image shape: (153, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/104999/01-02-2001-NLST-LSS-60078/1.000000-2OPAGELSPLUSLUNG3602.512080.00.11.5-55668
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/101692/01-02-2001-NLST-LSS-92202/2.000000-2OPAGELS16D3202.514040.00.01.375-87587
Got here to 2D
Dicom image shape: (120, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/211570/01-02-2001-NLST-ACRIN-44193/3.000000-2OPAGELSPR16STANDARD3601.21208058.21.4-38766
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/101834/01-02-1999-NLST-LSS-26156/2.000000-0OPAGELSQXD3202.514040.00.01.5-52093
Got here to 2D
Dicom image shape: (545, 512, 512)
Slice image shape: (512, 512)
2
Data type of config.dimension: <class 'int'>
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/113623/01-02-1999-NLST-LSS-87257/4.000000-0OPATOAQUL4FC51304.72-02173
Error executing job with overrides: []
Traceback (most recent call last):
  File "/nas-ctm01/homes/mipaiva/pipeline_template_pl/slurm_files/shell_script_files/../../src/scripts/run_experiment_pipeline.py", line 52, in run_hyperparameter_grid_based_execution_pipeline
    run_experiment_pipeline(config)
  File "/nas-ctm01/homes/mipaiva/pipeline_template_pl/slurm_files/shell_script_files/../../src/scripts/run_experiment_pipeline.py", line 127, in run_experiment_pipeline
    model_pipeline.train_model()
  File "/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/model/model_pipeline.py", line 67, in train_model
    self.pytorch_lightning_trainer.fit(
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 532, in fit
    call._call_and_handle_interrupt(
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/pytorch_lightning/trainer/call.py", line 43, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 571, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 980, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1021, in _run_stage
    self._run_sanity_check()
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/pytorch_lightning/trainer/trainer.py", line 1050, in _run_sanity_check
    val_loop.run()
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/pytorch_lightning/loops/utilities.py", line 181, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 108, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
                                       ^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/pytorch_lightning/loops/fetchers.py", line 126, in __next__
    batch = super().__next__()
            ^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/pytorch_lightning/loops/fetchers.py", line 58, in __next__
    batch = next(self.iterator)
            ^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/pytorch_lightning/utilities/combined_loader.py", line 285, in __next__
    out = next(self._iterator)
          ^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/pytorch_lightning/utilities/combined_loader.py", line 123, in __next__
    out = next(self.iterators[0])
          ^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 633, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1345, in _next_data
    return self._process_data(data)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1371, in _process_data
    data.reraise()
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/torch/_utils.py", line 644, in reraise
    raise exception
ValueError: Caught ValueError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
           ^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
            ~~~~~~~~~~~~^^^^^
  File "/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/dataloader/preprocessed_dataloaders/nlst_preprocessed_dataloader.py", line 228, in __getitem__
    data = self._get_data(data_index)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/dataloader/preprocessed_dataloaders/nlst_preprocessed_dataloader.py", line 253, in _get_data
    raise ValueError(f"[ERROR] Image is None at index {data_index}. File info: {self.lung_metadataframe.iloc[data_index]}")
ValueError: [ERROR] Image is None at index 23. File info: pid                                                         102746
study_yr                                                         0
path             /nas-ctm01/datasets/public/medical_datasets/lu...
key                                                       102746_0
label                                                            0
sct_slice_num                                                   86
Name: 23, dtype: object


Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
/nas-ctm01/datasets/public/medical_datasets/lung_ct_datasets/nlst/raw_data/manifest-1741808882472/NLST/102136/01-02-2001-NLST-LSS-54921/6.000000-2OPASESEN16B50f351212045.030.0null-24162srun: error: 01.ctm-deep-03: task 0: Exited with exit code 1
