Initialization time: 2025-06-18 07:44:50
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)

**************************************************  Experiment 64 | Version 1 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 5}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 6}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 7}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Currently logged in as: maria-i-paiva (maria-i-paiva-inesc-tec) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: WARNING Using a boolean value for 'reinit' is deprecated. Use 'return_previous' or 'finish_previous' instead.
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_1/wandb/run-20250618_074508-6a211o39
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_1_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/6a211o39
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ████▄█████████████████████████████████▁█
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▂█▅▅▆▆▄▅▅▃▃▆▆▂▆▆▅▅▅▅▅▅▄▄▄▄▄▄▄▄▄▄▅▅▄▄▅█▄
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▃▃█▅▃▃▃▁▃▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▂▃▃▃
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▇▁██▁▁▁▆▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 █▁▅█▁▁▁▁▁▇█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▃▅▇█▄▃▂▃▃▂▃▅▂▁▂▆▇▂▂▃▁▃▂▃▂▂▁▂▃▂▃▄▃▄▃▅▆▅▁▂
wandb:                 train_loss ▆█▃▁█▆▆▆▆▆▆▄▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▇█▆▆
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▄▆█████▂█▆█████████████████████████▃▁██
wandb:           val_accuracy0.75 ▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▅▅▅▅▄▅▆▆▆▅▅▆▆▅▆▁▁▂▂▃▄█▇▆█▃▃▄▄▇▅▅▃▇▅▆▅▆▇▆
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▄█▁█▄▄▄▄▄▄▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:  val_balanced_accuracy0.75 ██████████████████████████████████████▁█
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▃▁▃█▁▁▁▃▁▁▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▁▁▁▃▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ██▄▁▁▁▁▁▁▁▁▁█▄▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▅▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.48729
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.45898
wandb:                 train_loss 2.09374
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.52897
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_64_1_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/6a211o39
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_1/wandb/run-20250618_074508-6a211o39/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_1/wandb/run-20250618_075335-4wl60m5o
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_1_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/4wl60m5o
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁██▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 █▁▁▇██▄▂▃████████████▁▁█▁█▁▁█▁▁█▁▁▁▁▁▁██
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▃▂▁▃▃▄█▄▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▄▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▄▄▁▄▄▁█▅▁▄▁▁▁▁▁▁▁▁▁▁▄▁▁▁▁▄▁▁▁▄▄▄▁▁▁▄▄▁▄▄
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ███████████▁█▃██████████████████████████
wandb:             test_recall0.5 ████▇▃▁█▁▁▁▁█▁█▁▁▁▁▁▁▁▁▁██▁██▁█████▁▁███
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▃▃▄▂▄▃▃▇▆█▃▂▂▂▂▂▂▂▂▂▁▁▄▂▂▂▃▂▂▃▂▂▁▂▂▁▂▁▁▂
wandb:                 train_loss ▇▇▇▇█▇▇▄▄█▅▁▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_accuracy0.25 ▇▁▁▁▁▁▁▁▁▁▁▁█▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 █▁▁█▁██▄▇▂██████▁██▁▁█▁▁▁█▁█▁▁▁▁▁▁█▁▁▁▁▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▄▇█▁█▇▇▇▇▆▆▇▂▂▂▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▆▆▆▆▆▆█▇▆▇▆▁▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▆▆▆▁▆▆▁▁▆▆▁██▃▁▁▁▁▁▁▆▆▁▆▁▁▁▆▆▆▁▆▆▆▆▁▆▆▆▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁█▁█▃▁▁▁▂▁▁▁▁▁█▁▁██▁▁█▁█▁█▁▁█▁██▁▁████▁█
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.25316
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.5
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.25316
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 1
wandb:            test_recall0.75 0
wandb:                train_auroc 0.44921
wandb:                 train_loss 2.09362
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.24762
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.5
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.24762
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 1
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_64_1_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/4wl60m5o
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_1/wandb/run-20250618_075335-4wl60m5o/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_1/wandb/run-20250618_080517-slwn5xxr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_1_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/slwn5xxr
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▂▂▅█▆█▇▇▄▄▅▆▇▇▅▇▆▄▆▆▇▆▇▆▇▆▇▇▅▇▆▇▇
wandb:           test_accuracy0.5 ▁▁███▇█▅▇▆█▆█▆█▅▅▅▇▆▇▇▇▅▆▆▇▇▇▆▆▇▇▇▇▆█▆█▇
wandb:          test_accuracy0.75 ▇▇▇▇▇▅▇▇█▇▅▅▁▅▄▅▆▆▅█▆▅▆▅▆▇▅▅▇▅▆▆▅▅▅▅▅▇▇█
wandb:                 test_auroc ▁▂▂▃▃▃▂▄▄▁▆▂▇▇▄▆▆▅▅▄▆▇▇▇▇▅█▆▆█▆▅▄▅▆▅▅▅▆▇
wandb: test_balanced_accuracy0.25 ▂▂▂▂▂▄▂▆▂▂▄▂▄▆▄▂▃▄▆▅▇▄▅▆▆▆▅▆▅▄▅▅▅▆▅▆▄▁██
wandb:  test_balanced_accuracy0.5 ▂▃▅▄▁▃▅▃▃▅▄▅▄▃▅▇▆▇▇▇▆▅▅▅▅▅▆▆▅▅▆▃▅▅▆▅▄▂▇█
wandb: test_balanced_accuracy0.75 ▁▁▁▂▆▆▂▂▄▃▂▇▆▂▆▃▆▅▄▆▇▆▇▅▅▄▆▅▆▅▅▅▃█▆▂▃▁▄▇
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▄▅▁▂▃▄▂▂▁▅▄▄▆▄▇▇▆▄▃▁▅▆▆▇▄▄▆▆█
wandb:          test_precision0.5 ▂█▆▂▄▄▁▅▂▃█▄▄▄▆▆▄▆▄▄▇▆▃▆▆▅▆▄▅▄▆▆▆▅▅▆▅▅▄▅
wandb:         test_precision0.75 ▁▁▇▁▁▃▆▆▇▄▆▇▅▆▄▅▅▆▅▆▆▄▅▅▅▅▆▆▆▆▆▄▅▅█▇▅▄▆▇
wandb:            test_recall0.25 ▆██████▅▃▇▄▄▅▃▆▃▆▇▆▆▅▅▄▆▃▃▃▄▄▄▄▃▆▅▆▃▄▆▁▅
wandb:             test_recall0.5 █▁▇▁▁▂▂▆▁▄▃▄▇▃▅▂▅▅▃▅▅▅▅▅▅▅▄▄▄▅▄▃▃▄▄▅▄▄▄▅
wandb:            test_recall0.75 ▁▁▁▁▂▃▁▂▂▄▄▄▅▅▇█▃▆▆▇▆▇▆▅▅▇▅▅▅▆▃▅▆▇▇▅▄▇▅▇
wandb:                train_auroc ▂▁▃▂▃▃▃▄▃▇███▇████████████████████████▇█
wandb:                 train_loss ██▇▇█▇▆▇▂▃▃▄▃▂▂▁▁▃▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▂▁▁
wandb:           val_accuracy0.25 ▁▁▁▄▁▁▃▂█▇▄▆█▄▇▇▇▆▆▆▅▅▆▄▅▃▅▆▆▅▇▇▇▅▅▆▆▅█▆
wandb:            val_accuracy0.5 ▇▆▇█▆▃▆▇▇▆▅▃▅▄▄▁▁▅▅▅▄▃▃▅▅▅▅▆▅▆▆▆▅▅▅▆▅▃▅▄
wandb:           val_accuracy0.75 ████████▇▁▆▅▆▄▇▆▅▆▆▆▅▆▅▆▅▆▆▆▆▅▇▇▇▇▆▅▆▆▅▆
wandb:                  val_auroc ▇▃█▇▆▇▆▆▂▅█▆▄▇▇▅▆▇▅▆▅▅▅▄▄▅▃▃▄▃▅▄▃▂▁▂▂▃▃▁
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▃▃▆▃▁▆▅▇▂▄▄▅▂▁▆▄▇▅▅▄▃█▅▁▅▃▆▄▅▇▇▄▄▄▃▄
wandb:   val_balanced_accuracy0.5 ▃▃█▅▄▁▃▄▄▆▃▅▄▇▄▇▇▄▃▄▆▂▄▅▄▅▅▇▆▆▅▂▁▅▂▂▁▁▃▄
wandb:  val_balanced_accuracy0.75 ▆▃▃▃▃▇▃▅▇▇▁▄▃▂▇█▄▅▅▅▆█▄▄▄▅▁▆▅▅▅▄▄▅▆▄▄▁▃▄
wandb:          val_precision0.25 ▃▃▃▃▃▃▃▃▃▄▅█▄▇▃▄▅▄▅▅▃▃▄▆▅▃▄▅▄▄▄▄▄▅▅▃▃▄▄▁
wandb:           val_precision0.5 ▁▅█▆▆▇▄▅▄▅▅▆▆▆▄▆▅▅▅▆▅▅▅▅▆▆▅▅▅▅▆▆▆▆▃▆▅▄▄▄
wandb:          val_precision0.75 ▃▁▁▁▅▃▂█▅▃▃▂▃▃▃▃▄▃▄▃▃▃▃▃▃▁▃▃▃▃▃▄▃▃▁▃▃▁▃▃
wandb:             val_recall0.25 ███▅███▇██▃▃▁▆▃▅▅▆▃▅▃▃▃▅▆▄▄▃▃▃▄▄▄▄▂▃▃▁▂▃
wandb:              val_recall0.5 ▃█▁▅▅▃▃▇▄▄▅▃▃██▄▄▆▅▇▆▆▄██▄▅▅▆▆▆▆▄▆▃▅▅▇▂▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▂█▄▄▅▅▅█▃▅▄▄█▅▇▆▄▁▃▅▄▄▄▄▆▆▆▄▆▃▅▅▃▂
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.60759
wandb:           test_accuracy0.5 0.67089
wandb:          test_accuracy0.75 0.68354
wandb:                 test_auroc 0.70636
wandb: test_balanced_accuracy0.25 0.63814
wandb:  test_balanced_accuracy0.5 0.63093
wandb: test_balanced_accuracy0.75 0.63941
wandb:         test_precision0.25 0.35897
wandb:          test_precision0.5 0.39286
wandb:         test_precision0.75 0.40741
wandb:            test_recall0.25 0.7
wandb:             test_recall0.5 0.55
wandb:            test_recall0.75 0.55
wandb:                train_auroc 0.99984
wandb:                 train_loss 0.05729
wandb:           val_accuracy0.25 0.5619
wandb:            val_accuracy0.5 0.61905
wandb:           val_accuracy0.75 0.6
wandb:                  val_auroc 0.54382
wandb:  val_balanced_accuracy0.25 0.55404
wandb:   val_balanced_accuracy0.5 0.57911
wandb:  val_balanced_accuracy0.75 0.52775
wandb:          val_precision0.25 0.29167
wandb:           val_precision0.5 0.325
wandb:          val_precision0.75 0.27778
wandb:             val_recall0.25 0.53846
wandb:              val_recall0.5 0.5
wandb:             val_recall0.75 0.38462
wandb: 
wandb: 🚀 View run resnet18_2d_64_1_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/slwn5xxr
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_1/wandb/run-20250618_080517-slwn5xxr/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_1/execution_datetimes.json

**************************************************  Experiment 64 | Version 2 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 19, 1.0: 9}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 16, 1.0: 12}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 13, 1.0: 19}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 11, 1.0: 17}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_2/wandb/run-20250618_082035-vnkq08h6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_2_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/vnkq08h6
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▆█▁▁▅▃▄▅▃▃▅▆▇▇▆▇▆▆▆▇▅█▆▆▅▆▆█▇▇▇▆▇▆▆
wandb:           test_accuracy0.5 █▁▅▅███▇▅▇▄▃▄▄▅▇▇▅▅▆▆▅▄▄▇▅▃▄▄▇▄▅▇▇▇▅▅▄▄▅
wandb:          test_accuracy0.75 █████████▄▅█▆▇▇▇▁▅▅▅▃▅▅▅▅▄▅█▄▅▇▆▇▆█▄█▇▁▃
wandb:                 test_auroc ▂▃▃▃▆▄▅▂▁▁▂▅▄▇▅▆▅██▅▅▃▃▄▄▄▅▃▂▃▅▅▅▄▄▆▆▆▄▄
wandb: test_balanced_accuracy0.25 ▁▂▂▆▅▃▂▁▅▅▂▂▁▂▁▆▅▅▅▄▆▅▅▂▂▇▆▄▄▅▅▆▆▆█▆▄▅▅▆
wandb:  test_balanced_accuracy0.5 ▂▂▄▂▂▂▃▂▃▂▂▆▃▁▅▁▃▄▄▄▂▂▇▄▅▂▅▅▄▄▇█▆▆▅▃▄▆▄▆
wandb: test_balanced_accuracy0.75 ▄▄▄▃▃▃▃▄▂▁▂▁▃▂▃▄▄▅▆▅▃▃▃▄▇▇▄▄▅▆▇▇▇▆▆▂▃▇█▆
wandb:         test_precision0.25 ▃▃▃▃▃▅▅▄▃▂▃▂▁▅▆█▄▅▅▃▆▄▅▅▅▅▆▇▆▆▇▇█▇▄▅█▅▅▆
wandb:          test_precision0.5 ▄▁▇▅▇▇▇▄▃▁▄▃▆▄▆▄▃▄▄▃▅▅▄▃▅▆▄▆▆▇█▅▅▅▅▄▆▄▆▅
wandb:         test_precision0.75 ▁▁▃▁▄█▁▁▁▁▄▂▂▁▃▂▃▁▃▃▂▄▃▃▃▄▂▃▂▃▄▄▄▄▄▄▃▃▂▃
wandb:            test_recall0.25 ▇█▇█▄▅▁█▆▁▄▅▅▃▃▃▅▄▄▃▃▅▅▅▃▃▄▃▄▄▃▅▅▅▅▃▅▅▂▄
wandb:             test_recall0.5 ▅█▂▁▁▃▁▂▃▃▂▃▇▅▄▇▆▄▂▄▂▄▆▅▄▇▇██▆▅▄▅▇▇▂▄▄▅▇
wandb:            test_recall0.75 ▁▁▁▁▁█▁▁▁▁▁▂▁▁▂▂▃▂▁▃▃▃▃▃▂▅▃▄▂▁▂▃▂▃▅▁▄▃▂▄
wandb:                train_auroc ▁▄▅▅▆▆▇████████████████████████▇████████
wandb:                 train_loss █▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▃▁▆▂▃▇▆█▆▇▇█▄▆▄▇▇▅▆▆▅▇▆█▇▇▇▆▆▅▇▆▆▆▇▆▇▆
wandb:            val_accuracy0.5 ▁▆▅▇█████▇▇▇▇▇▇▇▇▇▆█▇▆▇▆▇▇▇█▆▆▆▆▇▇▇▆▅▇▄▆
wandb:           val_accuracy0.75 ▅████████▇▇▇▁▆▇▃▁▅▃▄▄▄▃▇▆▅▅▇▄▄▄▄▄█▆▄▇▆▅▆
wandb:                  val_auroc ▆▆▇▇███▇▆▆▇▅▄▇▃▄▃▃▅▆▆▅▆▁▂▅▆▃▃▃▄▅▂▃▂▃▂▆▃▅
wandb:  val_balanced_accuracy0.25 ▅▅▅▅▇█▅█▄▅▂▆▆▅▅▃█▆▅▁▁▆█▆▆▄▁▂▂▂▂▂▄▃▄▅▆▇▅▅
wandb:   val_balanced_accuracy0.5 ▃▄▆▄▅▄▄▄▃▃▃▅▃▃▇▂▆▃▁▃▄▆▃▅▄▃▂▃▅▇▂▁▂▃▂▅█▆█▅
wandb:  val_balanced_accuracy0.75 ▃▄▄▆▆▄▄▄▄▄▅▃▄▃▄▁▆▅▅▁▄▁▆▅█▅▄▆▂▅▅▄▁▂▅▃▆▇█▇
wandb:          val_precision0.25 ▅▆▅▅▅▆█▆▅▅▆▅▆▆▂▄▅▄▃▂▃▇▇▄▅▅▁▄█▆▅▆▆▃▃▃▆█▅▅
wandb:           val_precision0.5 ▃▆▁▃▁█▃▃▂▃▃▂▃▂▃▂▂▂▃▃▃▃▃▂▃▃▄▃▃▃▂▂▃▂▂▃▂▃▃▃
wandb:          val_precision0.75 ▁▁▁▆▁▄█▃█▆▁▁▁▁▂▃▃▃▃▃▂▃▄▃▃▃▂▃▃▂▃▃▂▂▂▂▃▄▄▃
wandb:             val_recall0.25 ▇█▅▅▃▇▁▃▄▄▃▃▃▂▃▃▂▄▃▂▂▃▂▃▄▅▃▃▂▃▃▂▃▁▂▄▃▄▄▄
wandb:              val_recall0.5 ▅▄█▂▃▁▁▁▁▁▃▃▂▂▃▃▃▃▅▄▃▂▂▄▂▄▄▃▂▄▃▃▃▂▂▁▃▃▅▄
wandb:             val_recall0.75 ▃▁▁▁▁▃▂▆▃▆▅▃▃▄▄▃▃▄▃▃▂▅█▅▃▆▇▄▆▆▄▃▃▃▃▃▂▂▆▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.63291
wandb:           test_accuracy0.5 0.65823
wandb:          test_accuracy0.75 0.65823
wandb:                 test_auroc 0.62627
wandb: test_balanced_accuracy0.25 0.63856
wandb:  test_balanced_accuracy0.5 0.58941
wandb: test_balanced_accuracy0.75 0.53983
wandb:         test_precision0.25 0.37143
wandb:          test_precision0.5 0.36
wandb:         test_precision0.75 0.31579
wandb:            test_recall0.25 0.65
wandb:             test_recall0.5 0.45
wandb:            test_recall0.75 0.3
wandb:                train_auroc 0.99968
wandb:                 train_loss 0.0411
wandb:           val_accuracy0.25 0.55238
wandb:            val_accuracy0.5 0.6381
wandb:           val_accuracy0.75 0.66667
wandb:                  val_auroc 0.50268
wandb:  val_balanced_accuracy0.25 0.49611
wandb:   val_balanced_accuracy0.5 0.52726
wandb:  val_balanced_accuracy0.75 0.54625
wandb:          val_precision0.25 0.2439
wandb:           val_precision0.5 0.28571
wandb:          val_precision0.75 0.32
wandb:             val_recall0.25 0.38462
wandb:              val_recall0.5 0.30769
wandb:             val_recall0.75 0.30769
wandb: 
wandb: 🚀 View run resnet18_2d_64_2_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/vnkq08h6
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_2/wandb/run-20250618_082035-vnkq08h6/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_2/wandb/run-20250618_083732-rwg3pfcj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_2_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/rwg3pfcj
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 149-150, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁█▁▁█▁▁▁▁█▁▁▁▁███████████████████▁▁████▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▆▂▆▆█▇▇▇▆▆▄▆▆▆▃▃▁▄▄▆▆▆▇▆▇▇▇▇▇▆█▆▇▆▇▇▆█▇▇
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▄▄▄▄▄▄▄▄▄▁▅▄▄▄▄▂█▂▄▄▄▄▄▄▄▄▅▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 █▁█▁▁▁████▁▁█▁▁▁██▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁█▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁███████████████████████████████████████
wandb:             test_recall0.5 ▁▁▁█▁█▁▇▇██▁█▁█▁▇▁▁█▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁█▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▂▄▄▃▃▅▄▄▄▄█▃▄▅▄▂▄▆▄▂▃▃▂▃▅▄▄▄▃▄▂▁▄▅▅▄▅▇▃▄
wandb:                 train_loss ▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ██▁▁▁▃▅▁▁▁█▁█▁▁██▁▁██████████▁████████▂▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▇█▇███▇▆███████▇▁▁▅▇██████████▇▇▆▇█▇██▇▇
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▇▁▁▁▁▁▁▁▁▁▁█▂▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▃▁▁▃▃▃█▃▃▃▃▁▁▃▃▃▃▁▃█▅█▃▁▁▁▁▃▁▁▁▁▁▁▁▁▁▁▃▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁███████████████████████████████████████
wandb:              val_recall0.5 █▁▁██████████▁██▂▂▁▁▂▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁██▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.53475
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.55324
wandb:                 train_loss 2.09322
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.66991
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_64_2_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/rwg3pfcj
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_2/wandb/run-20250618_083732-rwg3pfcj/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_2/wandb/run-20250618_084552-jejxyep1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_2_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/jejxyep1
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▂▁█▇▂▃▂▄▃▁▅▅▄▅▄▄▄▂▅▅▃▄▄▄▄▅▄▃▆▄▅
wandb:           test_accuracy0.5 ▁████▇█████▆▆█▂▇▆▅▆▅▄█▆▅▄▅▅▅▅▅▄▅▂▆▆▅▅▅▄▃
wandb:          test_accuracy0.75 █████████████▇▇▆▇▃▅▅▄▃▃▅▁▅▃▄▄▆▂▂▂▂▃▄▃▅▃▄
wandb:                 test_auroc ▇▇▇█▆▆▄▅▇▆▇▇▅▆▅▃▄▃▃▆▃▂▂▄▃▃▂▃▂▂▃▁▃▂▃▂▂▂▃▂
wandb: test_balanced_accuracy0.25 ▇▇▇▇▇▃▇█▇▇▇▇▇▅▄▃▂▄▁▄▆▃▅▄▄▅▅▆▄▃▄▅▅▄▆▂▃▂▂▅
wandb:  test_balanced_accuracy0.5 ▆█▆▆▆▆▆▆▇▆█▇▇▇▇▆▅▆▇▅▅▃▆▃▃▃▂▃▄▃▁▃▄▃▄▄▂▄▂▃
wandb: test_balanced_accuracy0.75 ▇▇▇▇▇▇▇▇█▇██▇▇▆▇▅▄▅▅▄▅▃▂▅▁▃▂▄▃▂▂▃▂▄▄▄▂▄▄
wandb:         test_precision0.25 ▆▆▆▆▅▅█▄▆▅█▇▅▄▄▂▄▃▃▁▅▄▃▃▃▅▅▃▅▁▃▃▃▃▄▅▂▁▄▄
wandb:          test_precision0.5 ▁▁▆▁▅▁▁▁▁▁▆█▅▇▇▅▁▂▂▂▃▃▃▄▃▃▃▃▄▃▃▃▃▄▄▅▃█▃▃
wandb:         test_precision0.75 ▁▆▁▁▁▁▁▁▁▇██▁▃▁▅▆▁▃▅▃▃▄▄▄▃▃▃▂▃▂▄▃▂▃▃▂▄▄▃
wandb:            test_recall0.25 ███▇▁█▇▃▆██▆▆▄▃▃▄▄▄▂▃▃▂▃▃▃▂▃▃▃▂▃▂▃▃▂▃▂▃▂
wandb:             test_recall0.5 █▅▄▅▄▃▁▁▁▃▂▂▂▃▂▁▂▂▂▂▂▂▁▃▃▂▂▃▂▂▂▂▁▂▂▂▃▃▂▂
wandb:            test_recall0.75 ▂▂▁▁▁▁▃▁▃▁▃▃▁▁▅▁▁▂▁▁▆▅▆▂█▅▇▃▇▂▃▃▆▅▅█▆▆▃▅
wandb:                train_auroc ▁▂▁▄▄▅▅▅▅▅▅▅▅▅▄▅▅▆▆▆▇███████████████████
wandb:                 train_loss █▅▄▄▄▃▃▄▃▄▃▃▃▃▃▃▂▃▃▃▂▃▃▂▁▂▁▃▂▁▁▁▂▂▁▁▁▁▂▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▂▁▁█▆▁▇▄▄▃▅▆▄▅▆▆▆▇▅█▇█▇█▇▇▄█▇▆▇▇█▆
wandb:            val_accuracy0.5 ▁▄███▇▇▆▆▃▇██▅▇▇▆▇▅▆▆▆▆▇▆▆▆▆▇▆▆▅▆▆▅▆▆▆▆▆
wandb:           val_accuracy0.75 ▇▇██▇▇▇▇▇▇▇▆▇▆█▇▇▇▃▅▁▃▂▆▄▄▅▃▆▅▅▆▄▃▃▄▄▄▆▄
wandb:                  val_auroc ▇▇█▁▁▄▂▃▂▅▂▁▄▄▃▃▅▃▂▄▅▄▂█▄▇▇▇▅▅▅▃▄▄▄▇▅▄▅▅
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂▂▃▂▂▃▃▁▂▄▆▆▄▂▁▅▅█▆▆▅▇▅▇▃▇▅▅▅▆▅▆█▆▃
wandb:   val_balanced_accuracy0.5 ▄█▇▆▄▃▁▂▃▂▄▄▂▄▄▄▇▅▃▆▄▆▄▄▇▆▆▆█▅▆▅▄▆▆▇▆▆▆▇
wandb:  val_balanced_accuracy0.75 ▅▄▂▁▂▂▂▂▂▂▂▂▂▂▂▂▂▄▂▁▂▂▄▂▅▁█▅▄▂▃▃▃▄▂▅▆▃▁▃
wandb:          val_precision0.25 ▄▄▄▄▄▃▄▃▄▄▃▂▅▄▁▄▅▄▃▆▄▆▆▄▃▂▆▆▆▇▆▇▅▆▅█▆▆▅▆
wandb:           val_precision0.5 ▁█▅▆▁▁▁▁▅▁▄▃▃▄▄▄▆▅▁▆▅▅▅▅▅▆▅▆▆▅▆▆▅▅▄▅▆▅▅▅
wandb:          val_precision0.75 ▄▁▇█▁▄▃▃▄▄▁▁▁▁▃▁▂▁▁▆▄▄▄▅▅▄▄▄▅▅▄▅▄▄▄▅▅▅▄▄
wandb:             val_recall0.25 █▇████▂▇▁█▃█▇█▃▆▄▄▄▆▂▄▃▄▃▄▁▄▄▅▄▂▄▂▃▂▃▄▃▄
wandb:              val_recall0.5 █▅▃▃▁▁▁▃▂▃▁▄▁▃▃▅▃▂▁▁▅▄▄▃▃▅▄▅▆▄▅▄▆▄▄▄▃▄▄▅
wandb:             val_recall0.75 ▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▂▅▃▁▄▅▅█▆▃▅▆▅▄▅▅▅▃▅▅▄▅▆▂
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.50633
wandb:           test_accuracy0.5 0.51899
wandb:          test_accuracy0.75 0.55696
wandb:                 test_auroc 0.35847
wandb: test_balanced_accuracy0.25 0.42161
wandb:  test_balanced_accuracy0.5 0.39703
wandb: test_balanced_accuracy0.75 0.42246
wandb:         test_precision0.25 0.17241
wandb:          test_precision0.5 0.125
wandb:         test_precision0.75 0.14286
wandb:            test_recall0.25 0.25
wandb:             test_recall0.5 0.15
wandb:            test_recall0.75 0.15
wandb:                train_auroc 1
wandb:                 train_loss 0.02834
wandb:           val_accuracy0.25 0.61905
wandb:            val_accuracy0.5 0.61905
wandb:           val_accuracy0.75 0.60952
wandb:                  val_auroc 0.51728
wandb:  val_balanced_accuracy0.25 0.55331
wandb:   val_balanced_accuracy0.5 0.5017
wandb:  val_balanced_accuracy0.75 0.46957
wandb:          val_precision0.25 0.30556
wandb:           val_precision0.5 0.25
wandb:          val_precision0.75 0.2
wandb:             val_recall0.25 0.42308
wandb:              val_recall0.5 0.26923
wandb:             val_recall0.75 0.19231
wandb: 
wandb: 🚀 View run resnet18_2d_64_2_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/jejxyep1
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_2/wandb/run-20250618_084552-jejxyep1/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_2/execution_datetimes.json

**************************************************  Experiment 64 | Version 3 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 36, 1.0: 28}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 32, 1.0: 32}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 27, 1.0: 37}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 26, 1.0: 34}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_3/wandb/run-20250618_090426-m87h0qjx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_3_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/m87h0qjx
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▁▁▁▁▂█▁▃██▆▃▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁▃█▃▅█▆██▇█████▇████████▆█▆██▆▅█████████
wandb:          test_accuracy0.75 ██████████▁█████████████▆▆▆█▃███████████
wandb:                 test_auroc ▅▅▅▅▅▅▃▂▂█▇▄▃▃▃▁▄▅▄▂▇▆▇▆▆▄▆▂▁▃▂▂▂▂▂▂▂▂▂▂
wandb: test_balanced_accuracy0.25 ▅▅▅▅▅▅▅▅▅▆▅▅▅▇▄██▇▇▄▃▅▅▂▃▁▃▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:  test_balanced_accuracy0.5 ▃▃▃█▃▅▃▃▃▆▃▃▃▃▃▂▃▃▃▃▄▃▃▂▂▂▂▁▂▁▃▃▅▃▃▃▃▃▃▃
wandb: test_balanced_accuracy0.75 ▄▄▄▄▇▄▄▄▄▄▄▄▄▂▄▄▄▄▁▄▂▂▂█▄▄▇▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁█▁▄▂▁▁▁▁▂▂▅▂▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▄▆▁▅▄▇█▁▇█▅▁▁▁▇▅▁▁▁▁▁▁▁▁▁▁▅▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁█▁▁▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ████████████▅████▆█████▅██▇▇▃▆▁█████████
wandb:             test_recall0.5 ██▁▅▅▁▅▁▁▁▁▁▃▁▂▁▃▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▄▃▅▅▅▅▅▂▆▆▃▃▄▅▅▇▆▆▃▆▆▆▇▇▇▇▇▇██▂▂▂▁▁▁▁▁▂▁
wandb:                 train_loss ▆▅▆▅▅▅▄▅▅▆▅▅▄▆▅█▅▅▃▃▂▂▂▂▂▁▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:           val_accuracy0.25 ▁▁▁▁▂▁▁▁▁▅▃▃▄▁█▄▃▁▂▆▂▁▅▁▄▇▅▂▄▄▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁████▇▅█▅██▁▁▇████▇█▇██████████████████
wandb:           val_accuracy0.75 ████▄███▇█████████▅█▇▇▁█████████████████
wandb:                  val_auroc ▃▅▄▄▄▄▄▃▃█▂▄▁▂▃▆▂▃▂▅▃▃▄▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▁▁▄▄▄▆▇▃▃█▇▅▇▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:   val_balanced_accuracy0.5 ▄▄▄█▃▄▅▁▄▃▆▄▄▄▄▄▄▄▄▄▄▃▆▄▅▄▆▃▄▄▅▄▄▃▄▄▄▄▄▄
wandb:  val_balanced_accuracy0.75 ▄▄▄▄▄█▄▄▄▃▄▄▄▄▃▄▄▃▄▄▅▄▃▃▁▃▄▅▄▄▄▄▄▄▄▄▄▄▄▄
wandb:          val_precision0.25 ▄▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▆▅▆▄▁▂▅█▅▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:           val_precision0.5 ▁█▃▁▂▃▂▃▁▁▁▃▁▂▁▁▁▂▁▁▁▆▁▂▄▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁█▁▆▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 █████████▇███▆███▆█▇▃▇▂▃▆▂▁▄████████████
wandb:              val_recall0.5 ███▁▂▁▂▃▁▁▅▃▁▁▁▂▁▁▁█▂▂▁▁▁▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▅▁▁▁▁▁▁▁▁█▅▁▁▁▃▁▁▁▁▃▁▃▁▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.5
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.40418
wandb:                 train_loss 2.0936
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.5
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_64_3_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/m87h0qjx
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_3/wandb/run-20250618_090426-m87h0qjx/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_3/wandb/run-20250618_093037-xpl30fr5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_3_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/xpl30fr5
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading config.yaml
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▅▂▆▆▁█▃█▆▅▇▆▄▅▇▆▆▇▆▆▇▆▆▆▆▆▅▆▇
wandb:           test_accuracy0.5 ▁███▇█▇█████▇█████████▇██▇▇▆▇▅▆▇▆▆▇▆▅▅▆▆
wandb:          test_accuracy0.75 █▇███████▇██████████▂███▆▁█▆▄▅▂▆▃▄▄▆▆▁▆▃
wandb:                 test_auroc ▅▆▆▅▆▇▅▇▆▇▇▇█▆▄▆███▇▆▂▅▃▂▅▅▄▁▂▆▄▄▄▄▄▅▄▃▅
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▆▅▄▃▅▆▆█▃▅▃▇▂▃▂▁▅▆▅▄▃▂▄▂▄▄▄▃▄▄▅
wandb:  test_balanced_accuracy0.5 ▃▄▄█▄▅▇▄▄▆▆▆▄▄▄▇▃▄▄▄▄█▄▄▂▆▅▄▄▃▄▂▆▃▅▄▄▃▁▂
wandb: test_balanced_accuracy0.75 ▅▅▅▅▅▅▅▅▅▅▅▅▅▄▅▄▅▅▅▃▅▅▃▆▃▅▂▂▁█▄▅▃▃▄▄▄▅▄▆
wandb:         test_precision0.25 ▁▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▅▅█▆▅▆▇▆▆▆▅▅▇▆▅▆▅▆▆▆▇▇▆▆
wandb:          test_precision0.5 ▃▅▅▃▅▅▆▄▃█▅▅▅▁▅▁▅▅▁▂▄▅▄▃▃▃▃▂▂▃▃▃▃▃▃▂▃▃▂▃
wandb:         test_precision0.75 ▁▁▁█▁█▁▁▇▁▁▁▁▁▁▁▁▁▁▁▄▃▆▃▇▃▄▄▃▅▅▆▅▄▄▅▄▃▄▄
wandb:            test_recall0.25 ████████████▂█▇▂▆▆▇▅▄▃▃▂▄▅▃▂▃▂▃▄▄▃▃▁▄▃▃▃
wandb:             test_recall0.5 ▁▂▄▅▅▂▂▃▂▁▁▃▁▁▁▄▂▄▄▃▅▅▃▇▆▄█▆▅▅▅▅▇▅▅▆▅▇█▇
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▅▂▂▂▃▄▁▅▇▇▄▇██▁▄▅▅▆
wandb:                train_auroc ▁▁▁▂▂▃▄▃▄▅▄▅▆▅▅▆▇▇█████▇████████████████
wandb:                 train_loss █▇▇▇▇█▆▅▅▇▅▅▄▄▃▃▃▄▄▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▄▁▁▁▇▄▆▆▆▇▇▇▆▇▇▇██▆▇▇▆▇▇▇███▇▆▆
wandb:            val_accuracy0.5 ▃▅▇▆███▁█▇▅████▆████▄▆▃▃▄▄▃▄▄▂▄▄▂▄▅▄▃▃▅▃
wandb:           val_accuracy0.75 ▇████▇▇▆██▇▇▇█▇▇▇▆▆▄▃▃▄▃▃▃▂▃▃▃▃▃▃▁▃▃▃▁▃▂
wandb:                  val_auroc ▄████▄▇▇▂▂▂▁▅▂▁▂▂▁▁▂▂▄▃▃▄▂▃▃▃▄▂▃▃▃▄▂▃▂▂▃
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃█▃▃▃▃▄▄▃▃▄▄▂▃▃▄▃▃▃▃▃▄▄▂▄▁▂▁▂▂▄▃▃
wandb:   val_balanced_accuracy0.5 ▃█▃█▇█▆▃▃▃▁▃▂▁▃▃▃▂▃▄▃▄▂▄▁▄▅▁▁▃▄▅▁▆▃▂▃▂▃▂
wandb:  val_balanced_accuracy0.75 ▄▄▄█▆▅▅▄▄▄▄▅▅▂▄▄▄▄▄▄▄▄▃▃▄▃▂▃▃▄▅▃▄▄▃▄▁▆▄▃
wandb:          val_precision0.25 ▅▅▅▅█▅█▆▅▄▅▄▅▅▄▄▃▃▅▆▅▆▅▅▄▄▆▁▁▄▅▆▅▄▃▃▂▃▇▆
wandb:           val_precision0.5 ▃▄▄▄▅▃▁▁█▁▁▂▁▂▁▂▂▃▃▃▃▃▃▃▃▂▃▃▃▃▃▂▂▃▃▃▃▃▃▃
wandb:          val_precision0.75 ▁▁█▅▅▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▅▂▃▁▁▃▃▃▃▃▃▃▃▃▃▃▂▃▃▃
wandb:             val_recall0.25 ██████████▂█▂█▁▅▆▃▂▅▁▂▄▃▄▄▂▂▃▃▅▃▃▃▂▃▁▂▃▄
wandb:              val_recall0.5 █▃▂▆▃▂▅▂▃▁▁▁▁▁▁▁▁▂▃▄▃▃▃▄▄▃▃▄▃▄▃▃▃▃▃▂▄▄▃▄
wandb:             val_recall0.75 ▁▂▂▂▃▄▁▂▂▁▁▁▁▁▁▁▂▄▃▂▅▅▅▅▅█▇▅▄▆▆▃▃▃▅▆▄▅▆▄
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.5443
wandb:           test_accuracy0.5 0.56962
wandb:          test_accuracy0.75 0.60759
wandb:                 test_auroc 0.51949
wandb: test_balanced_accuracy0.25 0.52966
wandb:  test_balanced_accuracy0.5 0.48051
wandb: test_balanced_accuracy0.75 0.48941
wandb:         test_precision0.25 0.27778
wandb:          test_precision0.5 0.23077
wandb:         test_precision0.75 0.2381
wandb:            test_recall0.25 0.5
wandb:             test_recall0.5 0.3
wandb:            test_recall0.75 0.25
wandb:                train_auroc 0.9995
wandb:                 train_loss 0.07473
wandb:           val_accuracy0.25 0.50476
wandb:            val_accuracy0.5 0.57143
wandb:           val_accuracy0.75 0.61905
wandb:                  val_auroc 0.48734
wandb:  val_balanced_accuracy0.25 0.46446
wandb:   val_balanced_accuracy0.5 0.50876
wandb:  val_balanced_accuracy0.75 0.54041
wandb:          val_precision0.25 0.21739
wandb:           val_precision0.5 0.25641
wandb:          val_precision0.75 0.29412
wandb:             val_recall0.25 0.38462
wandb:              val_recall0.5 0.38462
wandb:             val_recall0.75 0.38462
wandb: 
wandb: 🚀 View run resnet18_2d_64_3_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/xpl30fr5
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_3/wandb/run-20250618_093037-xpl30fr5/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_3/wandb/run-20250618_101005-j0w1ulms
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_3_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/j0w1ulms
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: uploading wandb-summary.json; uploading config.yaml
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▂▂▂▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▆▆█▄▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:           test_accuracy0.5 ▁█▃████████████████▇█████████▅██████████
wandb:          test_accuracy0.75 ██████████████████████▁█████████████████
wandb:                 test_auroc █▅▇▇▇▇▆▅▆█▆▂▂▇▇▆▆▆▅▆▅▂▃▁▁▄▄▅▆▆▆▆▇▆▆▆▆▆▆▆
wandb: test_balanced_accuracy0.25 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▃▁█▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:  test_balanced_accuracy0.5 ▅▂▂█▃▄▄▄▄▄▄▄▅▄▁▄▄▄▄▄▄▄▄▄▄▂▃▄▆▄▄▄▄▄▄▄▄▄▄▄
wandb: test_balanced_accuracy0.75 ████████████████▆██▁█████████▆██████████
wandb:         test_precision0.25 ▅▅▅▅▅▅█▅▅▅▅▅▅▅▅▅▅▅▅▅▅▁▃▂▂▃▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:          test_precision0.5 ▆▇▆▅▁▇▁▁▁▁▁▁▁▁▁▁▄▁▁▁▁▁▁▁▆▅▁▁█▁▁▁▅▅▁▁▁▁▁▁
wandb:         test_precision0.75 ▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ████▅█████████████▁▇▅▇▇▃▅▆██████████████
wandb:             test_recall0.5 ▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▅▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁
wandb:                train_auroc ▂▅▄▅▄▄▅▅▇▅▆▅▆▆▆▇▆▇▆▇█▇▆▇▇██▅▅▆▆▄▅▅▆▆▂▁▁▁
wandb:                 train_loss ▃█▂▂▂▁▂▂▂▁▁▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂
wandb:           val_accuracy0.25 ▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁██████████▇█▇▇███████████████▆████████
wandb:           val_accuracy0.75 ▅▅▅▅▅▅▁▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅██▅▁▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:                  val_auroc ▇█▇▇▇██▇▄▄▆▅▆▅▅▅▄▄▂▁▂▃▁▂▆██▃▅▅▅▄▄▄▄▄▄▄▄▄
wandb:  val_balanced_accuracy0.25 ▆▆▆▆█▆▆▆▆▆▆▆▆▆▆▆▆▆▅▅▂▂▁▃▆▆▆▇▆▆▆▆▆▆▆▆▆▆▆▆
wandb:   val_balanced_accuracy0.5 ▃▃▁▃▃▃▃▃▃▃▃▃▃▄▂▄▅▃▃▇▁▇▆▄▃▃█▃▃▆▃▃▃▃▃▃▃▃▃▃
wandb:  val_balanced_accuracy0.75 ██████████▁███████████████▁█████████████
wandb:          val_precision0.25 ██████████████████▁█▄▂▅█████████████████
wandb:           val_precision0.5 ▄▁▃▁▁▁▄▄▁▁▁▁▁▁▁▃▁▁█▁▅▅▄▆▁▅▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ██▄█████████████████▆▃▆█▁█▁█████████████
wandb:              val_recall0.5 ██▁▆▃▁▁▁▁▂▂▁▁▁▁▁▁▂▂▁▁▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.5
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.51546
wandb:                 train_loss 2.09545
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.5
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_64_3_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/j0w1ulms
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_3/wandb/run-20250618_101005-j0w1ulms/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_3/execution_datetimes.json

**************************************************  Experiment 64 | Version 4 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 5}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 6}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 7}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_4/wandb/run-20250618_103221-bpt44ixh
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_4_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/bpt44ixh
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▂▁▁▁▁▇▇▅▅▇▅▆▅▆▆▆▅▆▇▆▇▆▆▆▆▅▇▇▅▆█▆▅▇▆▆
wandb:           test_accuracy0.5 ▁▅███▆█▅▆▇▆▆██▇▇▇▇▇▇▇▅▆▄▇▇▆▆▇▇▇▇▇▆▅▆▆▆▇▇
wandb:          test_accuracy0.75 ████▁█▇█▇▇█▆▅█▅▇▆▇▇▇▇▆▇▇▆▆▆▅▆▇▅▇▇▆▅█▇▆▆▇
wandb:                 test_auroc ▁▂▅▂█▄▇▆▆▅█▇▇▆▆▄▆▇▇▇█▆▇▆▆▆█▇████▇▇▆▆▆▆▇▅
wandb: test_balanced_accuracy0.25 ▃▃▂▃▁▃▂▃▃▃▃▇▄▄▄▄▅▆▄▇█▆▆▄▆▅▆▆▅▆▆▆▅▄▃▄▃▆▄▃
wandb:  test_balanced_accuracy0.5 ▂▂▂▄▂▂▅▃▂▃▄▄▄▄▆▅▂▁▆▆▅▃▆▆█▅▅▅▄▆▄▇▆▃▆▁▃▄▄▃
wandb: test_balanced_accuracy0.75 ▂▂▂▂▂▂▂▃▂▂▄▁▅▄▃▅▅▄▆▅▆▆█▄▅▇▇▅█▄▂▃▅▃▃▃▃▄▄▅
wandb:         test_precision0.25 ▁▁▁▁▁▂▅█▃▃▇▄▃▂▃▂▄▂▄▅▆▆▄▄▃▃▂▂▃▆▆▁▁▂▂▄▄▃▂▂
wandb:          test_precision0.5 ▅█▆▁▆█▆▇▁▆▇▆▆▇▆▇▆▅▆█▆▇▇▇▇▆▆▅▆▇▇▇▇█▄▅▅▆▅▆
wandb:         test_precision0.75 ▁▁▁▃█▁▃▁█▁▄▃▄▄▃▃▄▄▄▄▄▄▃▃▃▃▃▄▃▄▄▄▄▅▃▃▃▃▃▃
wandb:            test_recall0.25 ███▅▇▆▄▄▁▂▃▂▅▃▄▁▅▃▃▃▄▆▆▅▆▄▅▅▄▄▅▅▃▅▅▃▄▃▄▃
wandb:             test_recall0.5 █▆▃▁▃▄▂▃▃▃▄▃▅▁▄▃▃▃▃▃▃▃▅▃▅▄▃▃▃▄▃▃▅▄▃▃▅▃▃▃
wandb:            test_recall0.75 █▁▁▁▁▁▂▁▁▁▃▅▃▃▃▃▃▃▃▃▃▃▄▃▃▃▄▃▂▃▃▃▂▃▃▃▃▃▂▃
wandb:                train_auroc ▁▂▃▄▅▃▄▅▄▅▆█████████████████████████████
wandb:                 train_loss ██▇▆▇▇▅▃▅▄▁▁▁▂▁▅▂▂▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▄▃██▅▇█▃▄▅▄▇█▇▆▇▇▄▆▆▅▆▆▆▆▆▆▅▅▇▆▆▇▇▇▇▆▆
wandb:            val_accuracy0.5 ▁▁█▇█▅▆█▇▇▄▇▆▅▆█▆▇▇▇▇▇▆▆▆▅▅▅▅▆▆▆▆▆▅▆▇▇▅▆
wandb:           val_accuracy0.75 ██████▆▇▄▄▅▅▅▃▄▃▅▆▆▆▄▅▅▆▆▆▅▁▄▅▂▄▅▄▅▃▄▅▄▅
wandb:                  val_auroc █▅▆▅▅▄▃▃▄▃▃▄▃▄▄▂▄▄▅▁▃▄▄▅▅▅▄▅▅▄▄▄▄▂▃▆▅▄▃▆
wandb:  val_balanced_accuracy0.25 ▇▇▇▇█▇▃▆▅▂▁▅▅▆▆▄▆▇▆█▅▇▇▇▇▇▇▇▆▅▅▆▅▆▅▅▆▆██
wandb:   val_balanced_accuracy0.5 ▅▅▄▆▄▆▄██▅▄▆▃▂▃▄▃▄▃▄▄▁▅▃▆▅▅▁▃▂▄▃▂▃▆▆▄▄▆▆
wandb:  val_balanced_accuracy0.75 ▆█▇▃▇▇▇█▇▇▅▅▁▄▂▇▄▄▅▄▇▇▇▇▇▇▃▂▅▇█▅▄▆▅█▄▆▃▆
wandb:          val_precision0.25 ▆▆▆▆▆▆▆▆▆▅▃▁▄▄▃▅▄█▁▅█▆▄▂▃▅▃▄▃▆▅▅▆▅▅▅▇▅▆▇
wandb:           val_precision0.5 ▁▅▅█▁▇▅█▅▅▇▇▃▄▅▁▅▆▄▃▄▅▄▄▅▅▄▅▄▄▅▆▅▅▅▅▅▅▅▅
wandb:          val_precision0.75 ▃▁▁▁█▃▆▁▄▅▁▂▃▂▂▃▃▃▅▃▃▃▂▂▂▂▃▂▂▂▂▂▃▃▂▂▃▃▃▃
wandb:             val_recall0.25 ██████▆██▅▄▂▄▂▂▂▄▁▂▁▂▃▂▃▂▂▂▂▂▁▄▃▃▂▂▁▃▂▂▂
wandb:              val_recall0.5 █▂▂▃▂▂▁▂▃▂▂▂▁▅▃▃▁▂▂▂▃▂▃▂▂▃▂▂▂▃▂▃▂▃▂▂▂▂▃▂
wandb:             val_recall0.75 ▁▁▃▂▁▂▃▅▃▂▄▂▂▄▅▅▁▃▂▄▃▄▅▃▃▄▃▃▇▅▄▃█▄▅▅▃▃▄▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.63291
wandb:           test_accuracy0.5 0.65823
wandb:          test_accuracy0.75 0.67089
wandb:                 test_auroc 0.59068
wandb: test_balanced_accuracy0.25 0.52288
wandb:  test_balanced_accuracy0.5 0.53983
wandb: test_balanced_accuracy0.75 0.53178
wandb:         test_precision0.25 0.28571
wandb:          test_precision0.5 0.31579
wandb:         test_precision0.75 0.3125
wandb:            test_recall0.25 0.3
wandb:             test_recall0.5 0.3
wandb:            test_recall0.75 0.25
wandb:                train_auroc 0.9998
wandb:                 train_loss 0.02912
wandb:           val_accuracy0.25 0.62857
wandb:            val_accuracy0.5 0.65714
wandb:           val_accuracy0.75 0.66667
wandb:                  val_auroc 0.51461
wandb:  val_balanced_accuracy0.25 0.52093
wandb:   val_balanced_accuracy0.5 0.51412
wandb:  val_balanced_accuracy0.75 0.50755
wandb:          val_precision0.25 0.27586
wandb:           val_precision0.5 0.27273
wandb:          val_precision0.75 0.26316
wandb:             val_recall0.25 0.30769
wandb:              val_recall0.5 0.23077
wandb:             val_recall0.75 0.19231
wandb: 
wandb: 🚀 View run resnet18_2d_64_4_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/bpt44ixh
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_4/wandb/run-20250618_103221-bpt44ixh/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_4/wandb/run-20250618_104607-ggwp9ijw
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_4_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/ggwp9ijw
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁█▁▁▂▆█▆▆▆▇▆▆▇▇▆▆▆▇▆▆▆▆█▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:           test_accuracy0.5 ▆█▇█▇▇▃▇▅▆▆▄▅▅▂▄▇▅▂▃▅▅▂▃▃▃▁▂▂▂▂▃▃▃▂▂▂▂▁▂
wandb:          test_accuracy0.75 ██████████▇▁▆▇▅▄▃▄▅▄▅▅▄▆▅▄▄▄▄▃▂▃▄▁▁▅▄▃▂▂
wandb:                 test_auroc ▅▅█▅▆▄▆▃▅▂▃▄▃▄▃▄▃▂▂▁▆▂▅▅▄▄▂▁▁▁▁▂▂▂▅▂▃▃▂▃
wandb: test_balanced_accuracy0.25 ▄▄▄▄▄▇▄▆▅▆▄▄▅▄▆▅▄▆▄▅▅▅▁█▅▅▅▇▇█▃▅▇▄▄▄▂▅▂█
wandb:  test_balanced_accuracy0.5 ▄▅▇█▅▅▄▆▃▃▂▃▃▆▄▄▆▄▄▆▄▄▃▄▂▃▅▆▆▂▆▄▄▄▄▂▁▁▄▄
wandb: test_balanced_accuracy0.75 ▅▅▅▃▆▅▃▄▃▃▅▃▆▂▅▅▅▄▄▆▂▄▂▃█▆▄▁▃▇▄▆▆▆▆▄▄▃▂▄
wandb:         test_precision0.25 ▃▃▃▃▃▄▃▂▃▅▅▂▅▄▅▁▃▅▆▃▃▅▅▄▅▆▇█▅▃▃▄▄▄▄▃▃▄▄▂
wandb:          test_precision0.5 ▄▁▅█▁▁▁▁▅▅▅▅▃▂▄▅▄▅▄▅▄▅▆▆▅▅▅▅▅▅▅▅▅▃▄▄▄▄▅▅
wandb:         test_precision0.75 ▁▁▁▁▁▁█▁▁▁▄▁▅▅▇▆▆▆▃▇▆▆▄▅▆▇▅▇▃▅▆▇▇▇█▆▆▆▅▆
wandb:            test_recall0.25 █████▁▅▃▅▂▆▃▂▄▃▄▄▃▂▄▄▄▄▄▄▄▁▃▆▄▅▅▄▃▅▄▃▄▅▅
wandb:             test_recall0.5 ▇▃█▇▃▂▇▁▁▁▃▂▂▃▂▃▃▃▃▄▄▁▆▃▃▅▄▅▃▃▅▅▅▅▅▃▁▄▄▄
wandb:            test_recall0.75 ▁▁▁▂▁▁▁▃▁█▆▃▃▇▆▄▅▆▃▁▁▃▆▆▆▃▆█▇▆██▅▆▅▆▆▆▅▆
wandb:                train_auroc ▅▂▁▄▅▅▆▅▆▇▇█████████████████████████████
wandb:                 train_loss ██▇█▆▅▄▄▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▂▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▂▁▅▅▆███▇█▆▆▅▇▇▄▇▇▆▆▇▇▇▆▇▆▅▆▆▆▄▄
wandb:            val_accuracy0.5 ▁██▇▇▅▆▇▄▄▆▆▄▇▆▅▆▅▆▇▆▄▆▄▆▆▆▆▆▅▅▅▄▅▅▅▆▃▄▃
wandb:           val_accuracy0.75 ████████▄▇▁▆▆▆▅▇▅▅▄▆▅▆▆▄▂▄▆▅▆▅▄▅▃▂▃▄▃▄▄▃
wandb:                  val_auroc █▆▆▆▁▂▄▄▄▃▃▄▃▅▅▅▆▇▃▄▄▅▃▃▄▄▄▅▄▅▅▅▅▅▅▅▄▄▃▄
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▅▅▅▄▆▇▇▅▄▅▅▅▅▄█▆▅▆▆█▆▆▅▆▁▄▄▃▅▃▄▂
wandb:   val_balanced_accuracy0.5 ▃▄▄▁▃▃▄▄▃▆▅▅▅▆█▄▄▅▃▃▂▄▄▂▄▅▆▆▅▅▅▅▅▅▅▆▆▄▃▃
wandb:  val_balanced_accuracy0.75 ▅▃▂▅▃▃▃▃▃▃▂▃▅▅▃▅▆▅▇█▅▄▅▃▃▅▄▄▅▄▆▅▄▅▆▄▃▃▁▃
wandb:          val_precision0.25 ▄▄▄▄▄▁▄▄▅▄▄▇▄▅█▆▆▆▆▃▅▅▄▆▅▅▃▄▂▅▆▆▆▆▆▄▆▄▄▄
wandb:           val_precision0.5 ▃█▁▃▅▆▅▁▃▄▃▃▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▄▃▃▃▃▃▃▃
wandb:          val_precision0.75 ▁▁▁▇▁▄▇▅▅▃▄▆▇▇███▇▄▇▅▄▇▅▆▇▇▇▇▆▇▇▇▆▆▆▅▅▅▅
wandb:             val_recall0.25 █████▇▆▆▅▄▅▃▄▅▄▄▄▅▁▂▄▂▃▂▄▅▄▄▄▄▅▅▅▅▅▅▅▄▄▅
wandb:              val_recall0.5 █▃▁▁▂▁▂▂▁▁▂▂▄▂▃▄▃▂▃▃▃▃▂▄▂▁▃▄▄▃▅▅▅▅▃▂▄▄▄▅
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▂▄▁▄▆▁▄▃▅▂▂▅▃▅▄▃▃▄▅█▆▆▆▄▇▇█▂▅▅▅▅▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.5443
wandb:           test_accuracy0.5 0.5443
wandb:          test_accuracy0.75 0.51899
wandb:                 test_auroc 0.51525
wandb: test_balanced_accuracy0.25 0.59576
wandb:  test_balanced_accuracy0.5 0.54619
wandb: test_balanced_accuracy0.75 0.46314
wandb:         test_precision0.25 0.31818
wandb:          test_precision0.5 0.28947
wandb:         test_precision0.75 0.21875
wandb:            test_recall0.25 0.7
wandb:             test_recall0.5 0.55
wandb:            test_recall0.75 0.35
wandb:                train_auroc 0.99948
wandb:                 train_loss 0.04907
wandb:           val_accuracy0.25 0.4
wandb:            val_accuracy0.5 0.48571
wandb:           val_accuracy0.75 0.48571
wandb:                  val_auroc 0.49951
wandb:  val_balanced_accuracy0.25 0.43354
wandb:   val_balanced_accuracy0.5 0.49051
wandb:  val_balanced_accuracy0.75 0.49051
wandb:          val_precision0.25 0.20635
wandb:           val_precision0.5 0.24074
wandb:          val_precision0.75 0.24074
wandb:             val_recall0.25 0.5
wandb:              val_recall0.5 0.5
wandb:             val_recall0.75 0.5
wandb: 
wandb: 🚀 View run resnet18_2d_64_4_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/ggwp9ijw
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_4/wandb/run-20250618_104607-ggwp9ijw/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_4/wandb/run-20250618_110442-b65pviko
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_4_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/b65pviko
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▂▃█▇▆▆▂▆▆▃▅▃▆▅▇▇▆▅▂▆▃▆▇▅▅▆▄▄▆▆▅▅▆▅▅▅▇
wandb:           test_accuracy0.5 ██▁██▅██▇▇▇▆▆▅▅▃▆▆▆▇▄▆▆▇▆▅▇▆▅▅▆▄▅▅▆▅▅▅▅▆
wandb:          test_accuracy0.75 █████████▇▃▆▇▆▃▃▅▅▅▃▄▃▃▄▁▃▁▁▁▅▃▂▄▂▅▃▃▃▃▅
wandb:                 test_auroc ▆▇█▆▄▇▄▂▂▁▂▂▄▄▁▁▃▃▃▃▁▂▂▃▂▃▃▃▃▂▄▃▄▃▃▂▂▂▂▃
wandb: test_balanced_accuracy0.25 ▆▆▆▇█▇▆▆▃▄▃▄▂▅▇▄▆▆▅▄▃▄▄▅▇▁▃▂▃▃▄▄▁▅▇▅▁▃▃▆
wandb:  test_balanced_accuracy0.5 █▃▇▆▆▆▆▄▆▄▄▄▆▃▅▅▆▅▅▃▂▇▁▃▄▂▅▆▄▆▂▅▄▃▄▄▅▅▅▅
wandb: test_balanced_accuracy0.75 █▇▇█▇▇▇▇▇▆▇▇▆▂▅▅▇▄▅▅▅▄▃▅▅▅▁▁▁▁▃▅▄▃▃▄▄▃▄▇
wandb:         test_precision0.25 ▆▆▆▆▆▆▆▅▅▅▁▆▅▃▅▅▅▅▅▅▄▃▄▅▅▄▃▅▄▄▄▅█▄▅▃▄▅▅▅
wandb:          test_precision0.5 ▁▄▆█▆▁▇▁▁▁▂▁▁▃▃▃▄▃▃▃▄▄▄▄▃▃▃▃▃▄▄▄▄▃▃▄▄▄▄▄
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▃▁▅▄▁▇▇▆▅▆█▆▅▆▇▄▆▇▇▅▆▆█▅▇▆▅▆▇█
wandb:            test_recall0.25 ██████▇▂▂▂▁▁▁▃▂▂▁▂▂▂▂▂▂▃▃▂▃▂▂▂▂▂▂▂▂▂▃▂▃▂
wandb:             test_recall0.5 ▁█▁▃▁▁▂▁▁▁▂▁▁▂▁▁▂▃▂▃▃▃▄▃▃▂▂▃▄▃▂▄▃▃▃▃▃▃▄▃
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▂▂▁▁▂▂▃▅▅▃▃▆▅▆▆▅▆▃▃▅▅▇▂▇▇▆▆▂█▆▅▅▆
wandb:                train_auroc ▁▂▁▂▂▂▃▅▆▆▇▇▇███████████████████████████
wandb:                 train_loss ▇██▇▇▅▄▅▄▄▂▂▄▂▂▂▁▁▁▁▁▁▁▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▂▁█▃▆▄▅▇█▁▅█▇▇█▇█▆▇█▆▇▇▇▇██▇▆▆▆▆▇▇▇▇▇
wandb:            val_accuracy0.5 █▁▅▂█▅▆▇██▆▇▅█▆▆▆▅▅▆▆▆▆▅▆▇▅▆▆▆▆▆▅▆▅▆▆▆▆▇
wandb:           val_accuracy0.75 █▇██████▇█▇▆▅▆▇▆▆▅▄▆▅▅▅▃▇▅▅▅▄▁▄▂▄▅▅▄▅▅▅▅
wandb:                  val_auroc ██▇▇█▆▆▅▂▂▃▂▂▆▃▂▁▂▂▃▃▄▃▃▁▃▃▂▂▂▂▃▃▄▄▅▅▅▃▄
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▄▄▅▇▃▄▆▇▄▄▄▆▄▇█▂▅▂▃▃▄▅▂▃▁▅▇▃▄▅▅▃▆▅▆▅
wandb:   val_balanced_accuracy0.5 ▅▆█▄▇▃▆▅▆▇▃▄▃▆▄▁▅▁▅▃▅▃▁▂▃▃▃▁▁▃▂▆▃▅▁▄▄▅▄▄
wandb:  val_balanced_accuracy0.75 ▄▇▄▃▅▄▄▄█▄▇▅▆▄▄▃▆▅▆▅▄▄▁▄▃▂▂▄▃▄▄▄▃▃▅▆▅▄▅▄
wandb:          val_precision0.25 ▅▅▅▅▅▅▅█▄▅▆█▄▁▅▄▆▅▆▇▆▆▃▄▄▅▇▃▆▃▄▆▄▆▆▄▆▆▆▆
wandb:           val_precision0.5 ▄▄▁▅▆▄█▅▇▁█▁▄▅▃▆▃▄▄▄▄▅▄▃▃▄▃▃▃▃▅▄▃▃▃▄▄▃▄▄
wandb:          val_precision0.75 ▆█▁██▁▅▅▂▃▂▂▄▄▃▄▃▄▄▃▃▄▅▄▃▄▄▄▄▅▄▄▄▄▃▄▄▄▄▄
wandb:             val_recall0.25 ████████▃▇▁▅▃█▅▃▄▃▇▄▄▂▄▃▃▃▃▄▅▃▂▃▁▃▄▂▄▃▃▄
wandb:              val_recall0.5 ▁▁█▂▃▃▁▃▃▃▂▃▃▃▃▃▂▂▂▃▄▄▂▃▃▃▃▃▄▂▃▃▄▃▃▃▃▃▃▃
wandb:             val_recall0.75 ▂▁▂▂▂▂▂▂▂▂▁▃▂▃▁▃▂▃▅▅▃▅▄▆▅█▇▅▅▇▄▆▇▅▄▃▅▆▅▃
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.62025
wandb:           test_accuracy0.5 0.63291
wandb:          test_accuracy0.75 0.63291
wandb:                 test_auroc 0.35212
wandb: test_balanced_accuracy0.25 0.49788
wandb:  test_balanced_accuracy0.5 0.50636
wandb: test_balanced_accuracy0.75 0.50636
wandb:         test_precision0.25 0.25
wandb:          test_precision0.5 0.26316
wandb:         test_precision0.75 0.26316
wandb:            test_recall0.25 0.25
wandb:             test_recall0.5 0.25
wandb:            test_recall0.75 0.25
wandb:                train_auroc 1
wandb:                 train_loss 0.00068
wandb:           val_accuracy0.25 0.6
wandb:            val_accuracy0.5 0.61905
wandb:           val_accuracy0.75 0.60952
wandb:                  val_auroc 0.51582
wandb:  val_balanced_accuracy0.25 0.51485
wandb:   val_balanced_accuracy0.5 0.51461
wandb:  val_balanced_accuracy0.75 0.49537
wandb:          val_precision0.25 0.26471
wandb:           val_precision0.5 0.26667
wandb:          val_precision0.75 0.24138
wandb:             val_recall0.25 0.34615
wandb:              val_recall0.5 0.30769
wandb:             val_recall0.75 0.26923
wandb: 
wandb: 🚀 View run resnet18_2d_64_4_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/b65pviko
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_4/wandb/run-20250618_110442-b65pviko/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_4/execution_datetimes.json

**************************************************  Experiment 64 | Version 5 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 19, 1.0: 9}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 16, 1.0: 12}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 13, 1.0: 19}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 11, 1.0: 17}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_5/wandb/run-20250618_111759-mzeaznob
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_5_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/mzeaznob
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▂▁▁▁▁▁▁▂▅█▇▆▆▇▆▇██▆█▄▅▇▆▆▁▂▄▁▃▆▄▅▇▄▆▅▆▆▅
wandb:           test_accuracy0.5 ▁▇▇██▆▇▇▆▆▅▆▆▆▇▆▆▇▆▆▇▇▅▇▄▅▅▁▇▇▆▇▅▆▅▅▅▅▅▇
wandb:          test_accuracy0.75 ▁████████████▇▇▇▆▄▇▇▆▅▇▆████▇▆▇▆▇▇▅▇▅▅▅▇
wandb:                 test_auroc ▂▂▁▂▃▆▆▇▆▆█▅▃▃▆▄▄▇▅▄▄▄▄▃▄▄▄▄▇▄▄▃▄▄▂▇▅▅▅▂
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▅▃▃▄▄▂▆▂▂▄▃▁▇▇▅▅▃▃▃▃▃▆▅▆▄▅▅█▄▆▇▅▂
wandb:  test_balanced_accuracy0.5 ▁▃▅▃▃▃▇▃▅▂▂▃▃▂▆▁▂▃▁▃▅▆▄▄▄▃▃▄▄▃▆▃▅█▄▅▄▃▃▂
wandb: test_balanced_accuracy0.75 ▄▄▄▄▄▄▄▃▅▂▅▄▆▄▁▃▃▃▄▄▆▄▅▆▄▄▅▅▄▄▅▅▅▄█▆▇▇▆▇
wandb:         test_precision0.25 ▄▄▄▄▄▄▄▄▄▅▂▅▁▂▃▅▂▃▇▆▆▅█▄▄▄▄▆▆▆▄▇▄█▆▇▇▅▅▄
wandb:          test_precision0.5 ▅▆█▅▇▆▇▆▆▇▁▄▅▅▁█▅▅▄▆▄▆▅▅▅▅▄▄▅▄▅▆▅▅▅▅▅▆▅▅
wandb:         test_precision0.75 ▃▁▁▁▁▂█▁▁▁▁▃▂▃▁▃▂▂▃▃▃▃▃▃▃▃▃▁▁█▄▃▃▃▂▃▃▃▃▃
wandb:            test_recall0.25 █████▆▇▇▆▇▁██▄▃▅▃▂▅▄▅▅▆▄▄▁██▇▅▅▃▅▅▆▅▇▅▅▄
wandb:             test_recall0.5 █▅▂▂▃▁▂▄▁▁▂▂▁▂▂▄▂▂▂▃▃▄▃▃▄▃▃▂▂▂▃▂▇▃▂▄▅▅▄▄
wandb:            test_recall0.75 ▁▁▁▁▁▁▂▁▂▁▃▂▄▄▄▂▅▅▆▃▃█▇▁▃▁▂▃▆▆▃▃▇▇▅█▇▆▄▅
wandb:                train_auroc ▂▂▂▃▂▄▄▅▆▆█████▇███████████▁▂▃▅▆▆▇▇▅████
wandb:                 train_loss ███▇▇▇▇▇▇▇▅▆▅▃▃▂▂▂▂▁▁▂▁▁▁▁▁▁▁█▇▃▃▂▂▁▁▁▂▁
wandb:           val_accuracy0.25 ▁▁▂▁▁▇▅█▇▇▅▆▅▆▆▆▅▆▆▇▆▁▁▁▁▃▅▅▅▅▅▅▆▅▆▅▄▆▇▇
wandb:            val_accuracy0.5 ▁▂█▆▇▇▅▆▇█▇▆█▇▅▅▇▆▅▆▆▅▆▆▇▆▅▅█▇▆▅▆▆▅▆▅▅▆▇
wandb:           val_accuracy0.75 ███████▆█▇▇█▆█▄█▄▁▄▄▄▄▂▃▅▅▁▇▃██▇▅▅▁▅▂▄▄▁
wandb:                  val_auroc ▆▄▅▅▅▅▅▄▃▄▄▄▄▄▄▄▄▃▄▁▄▃▅▃▃▃▄▅▅▆▅▅▅▄▄█▇▆▇▆
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▄▆▇█▄▆▄▃▄▂▄▁█▃▄▅▃▄▁▆▄▄▄▄▆▄▄▅█▅▇█▆▆█▅
wandb:   val_balanced_accuracy0.5 ▅▅▅▅▄▅▅▄▁▆▇▆▇▄▅▂▄▅▅▅▂▇▆▃▄▆▃▅▅▂▄▄▆▅█▆▆▄▆▇
wandb:  val_balanced_accuracy0.75 ▄▄▄▄▇▄▅▅▄▄▃▅▁▆▄▄▅▂▄▂▄▂▅▁▃▃▃▆▅▆▄▄▃▃▄█▆▆▆▄
wandb:          val_precision0.25 ▆▆▆▆▆▇▆▆▆▆▆▆▅▆▆▆▇█▆▇▅▆▆▇▆▅▅▆▆▁▆▆▇▆▆▆▇▆▇▇
wandb:           val_precision0.5 ▃▃▄▃▃▃▃▃▃▄▃▃█▃▃▁▃▂▃▃▃▃▃▃▄▃▃▂▁▃▃▃▃▃▃▃▃▃▃▃
wandb:          val_precision0.75 ▁▁▁▆▁▁▁▄▆▄█▂█▄▅▂▃▂▃▃▃▂▂▃▃█▁▃▃▃▄▃▃▃▃▃▃▃▃▃
wandb:             val_recall0.25 ███▄█▄▅▃▁▂▃▁▄▄▃▂▃▃▅▃▄▄▂▄▂▄▂▅▅▅▅▅▃▅▇▅▄▄▃▆
wandb:              val_recall0.5 ██▁▁▁▂▂▃▁▂▁▂▄▂▃▃▃▄▂▂▃▃▃▅▁▅▃▅▃▃▄▅▂▅▃▄▅▆▄▃
wandb:             val_recall0.75 ▁▁▂▂▁▁▂▃▄▂▄▂▅▄▅▇▂▄▅▂▄▄█▂▅▃▁▃▃▃▇▆▆▆▆█▆▆▇▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.37975
wandb:           test_accuracy0.5 0.40506
wandb:          test_accuracy0.75 0.43038
wandb:                 test_auroc 0.54195
wandb: test_balanced_accuracy0.25 0.48559
wandb:  test_balanced_accuracy0.5 0.46949
wandb: test_balanced_accuracy0.75 0.46992
wandb:         test_precision0.25 0.24561
wandb:          test_precision0.5 0.23529
wandb:         test_precision0.75 0.23404
wandb:            test_recall0.25 0.7
wandb:             test_recall0.5 0.6
wandb:            test_recall0.75 0.55
wandb:                train_auroc 0.99828
wandb:                 train_loss 0.14705
wandb:           val_accuracy0.25 0.44762
wandb:            val_accuracy0.5 0.50476
wandb:           val_accuracy0.75 0.53333
wandb:                  val_auroc 0.55891
wandb:  val_balanced_accuracy0.25 0.5555
wandb:   val_balanced_accuracy0.5 0.54187
wandb:  val_balanced_accuracy0.75 0.54796
wandb:          val_precision0.25 0.27778
wandb:           val_precision0.5 0.27586
wandb:          val_precision0.75 0.28302
wandb:             val_recall0.25 0.76923
wandb:              val_recall0.5 0.61538
wandb:             val_recall0.75 0.57692
wandb: 
wandb: 🚀 View run resnet18_2d_64_5_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/mzeaznob
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_5/wandb/run-20250618_111759-mzeaznob/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_5/wandb/run-20250618_113019-9qgsy7s2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_5_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/9qgsy7s2
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 434-436, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▃▃▅▄▃▃▇▁▁▁▁▅▆▇▇█▆▇▅▇▆▅█▇▆▇▆▅▅█▇▇▆▆▃▅
wandb:           test_accuracy0.5 █▅█▂████▇▇▇▁██▇▇▅▆▇▆▅▅▆▅▆▇▆▆▇▆▆▅▆█▇▃▇▅█▇
wandb:          test_accuracy0.75 ▇▇▇▇▇▆▆▅▇▇▇▇▇▇▇▇█▃▆▆▇▅▇▆▆▆▃▅▁▆▁▂▄▃▄▄▇▇▇▆
wandb:                 test_auroc ▁▃▃▅▄▅▇▆▆▁▇█▆█▇▆▅▅▅▇▃▅▆▅▆▄▅▃▃▃▄▃▆▆▆▃▄▁▂▇
wandb: test_balanced_accuracy0.25 ▂▂▁▇▂▂▃▂▂▂▂▂▅▄▄▂▃▃▅▂█▆▂▁▃▅▄▂▃▃▄▄▅▁▂▄▂▃▄▇
wandb:  test_balanced_accuracy0.5 ▅▅▅▅▅▃▅▅▇▅█▅▁▃▆▃▅▅▅▅▆▄▅▆▅▆▇▆▅▄▅▅▆▄▅▅▃▅▆▇
wandb: test_balanced_accuracy0.75 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▆▄▆▆▄▁▄▄▆▅▃▂▁▇▄▄▄▄▄▄▄▅▅█▃▆
wandb:         test_precision0.25 ▃▃▃▃▃▄▃▃▃▃▃▄▄▃▄▃█▄▁▃▄▄▃▄▄▄▄▂▃▃▃▃▃▅▃▃▃▃▃▅
wandb:          test_precision0.5 ▃▃▁▃▃▁█▅▃▃▁▁▄▃▁▇▁▅▁▄▃▃▃▂▃▄▃▃▂▃▃▃▃▃▁▃▄▅▄▄
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▆▄▅▆▄▃▁▃▃▄▃▂▃▂▂▂█▄▃▁▁▃▅▃
wandb:            test_recall0.25 ███████▅▃█████▆▅▂▄▃▃▂▅▁▂▂▂▄▅▄▃▁▄▂▄▄██▇▅▅
wandb:             test_recall0.5 ▁▅▅██▁▅▁▂▁▂▂▁▄▁▂▂▂▂▃▄▁▃▂▂▂▁▃▂▂▁▃▃▃▂▂▂▆▂▃
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▃▂▁▁▁▁▂▁▂▁▅▆▄▂▄▅▃▃▂▃▃▄▃▅▄▅▅▃▂▃▅▃█
wandb:                train_auroc ▂▁▂▁▂▂▂▆▇▂▃▂▅▇▇▆▇████████████████████▄▇█
wandb:                 train_loss ▂▂▂▂▂▂▂▂▂▁▁█▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▁
wandb:           val_accuracy0.25 ▁▇▃▆▄█▁▁▁▁▁▄▁▄▄▅▆▆▅▅▆▆▆▆▇▆▆▆▅▆▇▆▇▆▆▇▇▁▅▆
wandb:            val_accuracy0.5 ▁█▄▁████▇▇▇▇██▇▇██▆▇▇▇▆▆▇▆▇▅▆▆▆▆▆▇▆▇▇▇▇▆
wandb:           val_accuracy0.75 ▇▇▇▇▇▇▇▇▇▆▅▃▇▇▇█▇█▇█▆▅▅▆▄▅▅▆▃▃█▇▄▅▁▄▅▅▇▇
wandb:                  val_auroc ██▆▆▅▁▁▃▅▃▆▅▄▂▂▄▁▅▅▃▃▄▅▄▃▄▄▃▄▅▄▄▄▅▅▁▅▃▃▃
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▄▇▆▅▄▄▄▄▄▅▃▅█▄▅▅▆▇▄▅▆█▄▅▆█▇▇▃▄█▅▄▃▆▁
wandb:   val_balanced_accuracy0.5 ▂▇▂▂▁▂▅▅▃▃▃▂▇▂▃▆▄▄▇▆▅▃▃▆▅▅▄▄▄▅▇▁▃▄█▄▅▂▃▄
wandb:  val_balanced_accuracy0.75 ▃▃▃▃▃▄▄▄▄▃▃▄▆▆▃▅▆▃▂█▁▅█▅█▄▇▅▄▆▅▄▄▄▅▄▅▇▃▅
wandb:          val_precision0.25 ▂▂▂▂▂▂▃▆▂▂▂▂▂▃▁▂▁▅▃▃▅▃▅▅▄▄▇▅▃▄▅▄▅▂▇▅█▇▇▂
wandb:           val_precision0.5 ▁▁▃▃▃▃▃▂▆▃▁▁▁▃▃▂█▆▅▅▅▄▃▃▄▃▃▃▃▃▃▃▂▃▃▃▃▄▃▃
wandb:          val_precision0.75 ▁▁▁▂▅▆▂▃▁▁▁█▃▁▆▃▃▄▃▄▃▃▄▃▄▄▄▄▄▃▃▃▃▃▃▃▁▃▅▃
wandb:             val_recall0.25 ███████▄▇▅█████▂▅▃▃▂▁▃▅▄▄▃▁▂▄▄▄▂▄▄▃▃▃▄█▃
wandb:              val_recall0.5 ▆██▂▁▂▂▂▁▂▁▃▁▂▁▃▂▂▆▅▃▅▄▃▅▃▂▄▃▃▄▄▃▅▄▄▅▃▂▄
wandb:             val_recall0.75 ▁▁▁▁▃▂▁▂▃▂▄▄▁▁▁▄▃▃▃▃▇▅█▄▆▆▅▇█▇█▃▅▇▆▂▃▆▆▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.56962
wandb:           test_accuracy0.5 0.56962
wandb:          test_accuracy0.75 0.62025
wandb:                 test_auroc 0.59576
wandb: test_balanced_accuracy0.25 0.56314
wandb:  test_balanced_accuracy0.5 0.53008
wandb: test_balanced_accuracy0.75 0.49788
wandb:         test_precision0.25 0.30556
wandb:          test_precision0.5 0.28125
wandb:         test_precision0.75 0.25
wandb:            test_recall0.25 0.55
wandb:             test_recall0.5 0.45
wandb:            test_recall0.75 0.25
wandb:                train_auroc 0.99629
wandb:                 train_loss 0.23611
wandb:           val_accuracy0.25 0.54286
wandb:            val_accuracy0.5 0.6
wandb:           val_accuracy0.75 0.67619
wandb:                  val_auroc 0.52653
wandb:  val_balanced_accuracy0.25 0.50268
wandb:   val_balanced_accuracy0.5 0.54065
wandb:  val_balanced_accuracy0.75 0.59129
wandb:          val_precision0.25 0.25
wandb:           val_precision0.5 0.28947
wandb:          val_precision0.75 0.36667
wandb:             val_recall0.25 0.42308
wandb:              val_recall0.5 0.42308
wandb:             val_recall0.75 0.42308
wandb: 
wandb: 🚀 View run resnet18_2d_64_5_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/9qgsy7s2
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_5/wandb/run-20250618_113019-9qgsy7s2/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_5/wandb/run-20250618_115343-yuqldh6l
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_5_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/yuqldh6l
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: uploading history steps 273-275, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▅▅▆▃▇▇▃▇▄▅▇█▇▇▇▇▅██▆▇▆▇█▇▆▆▇█▇▅▆▇▇
wandb:           test_accuracy0.5 ▇██▂█▇█▇█▅▆▆▅▅▅▄▅▆▅▆▇▆▄▅▄▆▁▅▄▄▇▅▅▅▅▅▅▆▇▄
wandb:          test_accuracy0.75 ██▇████████▇▅█▇▄▆█▅▄▃▅▅█▅▂▃▃▁▂▂▅▁▄▃▇▅▂▃▄
wandb:                 test_auroc ▇▇▆██▂▂▁▁▃▅▄▃▃▅▄▃▅▅▅▄▅▅▅▄▄▄▄▄▆▅▅▄▅▅▆▆▆▄▅
wandb: test_balanced_accuracy0.25 ▅▃▅▅▅█▂▂▂▁▃▄▁▃▂▅▃▅▅▃▆▅▆▇▆▅▅▅▅▇▅▆█▅▄▆▃▆▆▅
wandb:  test_balanced_accuracy0.5 ▆▆▆▅▇█▄▄▄▃▄▄▄▃▁▂▅▂▅▃▄▃▆▂▃▅▅▃▅▅▄▆▄▄▆▅▇▅▅█
wandb: test_balanced_accuracy0.75 ▄▄▆▄▅▅▄▄▃▄▃▆▅▄▄▃▁▄▃▆▁█▅▃▃▃▂▃▃▃▄▆▄█▅▄▄▅▆▇
wandb:         test_precision0.25 ▄▄▄▄▄▃▁▃▄▃▃▂▂▃▄▄▄▅▅▄▄▅▂▃▄▅▄▅▅█▄▄▄▅▅▅▄▅▄▃
wandb:          test_precision0.5 ▃▃▄▅▃▅▅█▁▁▁▃▃▃▂▃▃▄▅▃▃▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▃▁▁▅█▅▆▅▄▅▆▄▄▅▅▄▅▅▅▆▆▅▅▄▆▅▇▅▆▄
wandb:            test_recall0.25 █████▅▆▄▃▂▆█▆▄▅▂▂▃▂▂▁▂▂▁▄▃▃▃▄▃▁▃▃▃▃▂▃▃▃▃
wandb:             test_recall0.5 ▁▅▅▁▃█▁▁▁▁▁▁▁▁▁▂▂▂▃▁▂▂▃▂▂▂▂▂▂▃▄▂▃▃▂▄▃▄▃▂
wandb:            test_recall0.75 ▁▁▁▁█▁▁▁▁▁▁▁▃▂▁▁▁▁▂▃▁▂▃▃▄▂▃▃▃▂▃▃▂▂▂▃▃▃▄▃
wandb:                train_auroc ▂▂▂▁▅▅▆▇▇███▅█████▇█████████████████████
wandb:                 train_loss █▇▇▇▇█▇▆▆▆▅▅▅▅▄▄▄▃▃▂▂▁▂▆▂▁▂▁▁▁▁▂▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▅▂▅▇▅▇▄▇█▆▁▄▆█▇█▇▆▇▅▇▇█▇▇▇▇▇█▇▆▇▇▇▄▆
wandb:            val_accuracy0.5 ▅███▁████▇██▇▇▆▆▇▆▇▇▇▇▇█▆▅▇▆▇▇▆▇▆▇▆▇▇▆▆▆
wandb:           val_accuracy0.75 ███▇████▇█▇▆██▇▇▇▇▇▆▇▄▆▆▆▆▄▅▅▆▁▆▆▆▅▁▆▃▃▄
wandb:                  val_auroc ▇▇██▇██▄▄▄▅▅▅▄▂▂▄▂▁▁▁▁▁▂▂▂▄▂▁▂▂▂▃▂▃▂▃▁▂▃
wandb:  val_balanced_accuracy0.25 ▄█▃▃▃▃▃▃▃▄▃▃▄▆▂▆▄▄▅▄▂▂▂▂▄▂▅▅▃▇▅▆█▄▁▃▃▅▂▇
wandb:   val_balanced_accuracy0.5 █▆▇▇▄▄▄▄▄▄▃▅▄▂▁▄▄▄▃▄▂▄▄▃▃▅▃▂▅▃▃▄▃▂▅▅▂▃▃▃
wandb:  val_balanced_accuracy0.75 ▄▄▄█▄▇▇▄▄▅▅▅▅▅▆▆▄▄█▆█▄▅▄▅▅▄▅▇▆▁▅▅▄▄▄▄▄▃▃
wandb:          val_precision0.25 ▄▄▄▄▄▄▄▅█▅▃▄▅▃▃▂▄▃▄▆▂▄▆▄▁▆▄▅▆▅▅▅▄▇▇▅▅▅▅▇
wandb:           val_precision0.5 ▄▅█▃▆███▆▇█▁▄▆▄▃▆▆▅▄▄▃▆▃▃▄▃▄▄▄▄▅▅▄▄▄▃▃▄▃
wandb:          val_precision0.75 ▁█▇▇▅▇▁▁▁▁▆▁▆▃▆▅▆▅▄▄▃▃▅▄▄▄▃▂▃▄▄▄▄▄▄▃▃▃▂▄
wandb:             val_recall0.25 █████▆▃▄▂▄▂▁▂█▅▃▃▂▂▄▁▁▃▂▄▂▅▁▃▄▄▄▂▂▃▃▃▁▄▂
wandb:              val_recall0.5 ▂▃▂▅█▁▁▂▂▂▂▂▂▅▂▄▂▂▂▃▂▃▂▃▂▁▄▁▃▂▃▃▃▃▃▂▃▂▃▃
wandb:             val_recall0.75 ▁▄▃▁▁▁▁▄▂▂▁▂▂▂▁▄▂▄▃▂▄▂▂▃▅▇▅▅█▇▅▅▂▂▅▄▅▇▄▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.59494
wandb:           test_accuracy0.5 0.63291
wandb:          test_accuracy0.75 0.67089
wandb:                 test_auroc 0.51441
wandb: test_balanced_accuracy0.25 0.53051
wandb:  test_balanced_accuracy0.5 0.55593
wandb: test_balanced_accuracy0.75 0.54831
wandb:         test_precision0.25 0.28571
wandb:          test_precision0.5 0.32
wandb:         test_precision0.75 0.33333
wandb:            test_recall0.25 0.4
wandb:             test_recall0.5 0.4
wandb:            test_recall0.75 0.3
wandb:                train_auroc 0.9994
wandb:                 train_loss 0.06755
wandb:           val_accuracy0.25 0.59048
wandb:            val_accuracy0.5 0.64762
wandb:           val_accuracy0.75 0.68571
wandb:                  val_auroc 0.45253
wandb:  val_balanced_accuracy0.25 0.52142
wandb:   val_balanced_accuracy0.5 0.5594
wandb:  val_balanced_accuracy0.75 0.57181
wandb:          val_precision0.25 0.27027
wandb:           val_precision0.5 0.32258
wandb:          val_precision0.75 0.36
wandb:             val_recall0.25 0.38462
wandb:              val_recall0.5 0.38462
wandb:             val_recall0.75 0.34615
wandb: 
wandb: 🚀 View run resnet18_2d_64_5_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/yuqldh6l
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_5/wandb/run-20250618_115343-yuqldh6l/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_5/execution_datetimes.json

**************************************************  Experiment 64 | Version 6 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 36, 1.0: 28}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 32, 1.0: 32}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 27, 1.0: 37}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 26, 1.0: 34}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_6/wandb/run-20250618_120920-46cqeyp8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_6_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/46cqeyp8
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▂▂▁▁██▆█▄▅▆▇▄▇▆▅▆▆▆▄▅▅▆▆▆▅▄▆▅▅▅▅▄▅▅▅▅▅▅
wandb:           test_accuracy0.5 ▁████▇▇██▆▇▆▆█▇▅▅▇▅▅▆▅▅▆▆▆▆▆▆▆▅▇▆▆▅▆▅▅▆▅
wandb:          test_accuracy0.75 ███████▇▇██████▃▅▇▆▅▅▆▄▄▅▃▆▄▅▄▅▄▆▅▇▁▃▃▃▃
wandb:                 test_auroc ▃▅▅▄▄▄█▇▄█▄▆▁▁▁▄▆▆▆▅▅▅▅▄▄▄▄▄▃▄▄▅▅▄▄▄▄▄▄▄
wandb: test_balanced_accuracy0.25 ▂▃▃▁▃▄█▃▅▆▅▅▅▂▄▃▃▂▁▂▂▂▃▅▄▃▃▃▄▅▃▄▄▃▄▄▄▂▃▃
wandb:  test_balanced_accuracy0.5 ▄▇▆█▄▇▇▅██▅▂▂▆▅▅▂▂▂▅▅▄▅█▄▄▅▅▅▅▅▄▆▁▇▄▃▄▃▄
wandb: test_balanced_accuracy0.75 ▄▄▆▄▄▄▆▅▄▄▅▆▄▆▅▃▃█▃▁▃▅▇▁▅▃▂▅▆▅▃▄▃▇▇▅▆▅▃▂
wandb:         test_precision0.25 ▂▂▁▂▂▂▅▆▄▄▄▅▃█▃▄▁▃▂▂▁▃▃▂▅▂▂▃▃▃▃▂▃▃▃▃▂▃▂▂
wandb:          test_precision0.5 ▂▅▄▃▄▅█▃▁▃▂▃▂▅▁▁▂▂▆▂▃▂▂▁▁▂▂▂▁▂▁▂▂▂▃▂▂▂▂▂
wandb:         test_precision0.75 ▁▁▅▃▁▃▃▁▁▁▃▅▅█▄▂▁▅▃▂▂▃▂▃▄▃▃▂▄▃▃▃▃▄▃▄▃▃▃▃
wandb:            test_recall0.25 ▇█▃▅▁▆█▂▂▅▃▃▄▁▄▅▃▃▂▂▃▆▆▄▃▅▄▃▃▅▄▄▂▃▃▄▃▃▄▃
wandb:             test_recall0.5 ▂▇▂▂▂▂▁▂▂▅▅▄▄▄▅▄▃▄▄▂▄▄▇▇▅▇▇█▂▄▅▄▆▄▅▆▅▅▅▆
wandb:            test_recall0.75 ▁▁▂▂▁▂▄▃▃▄▃▄▃▇█▄▄█▅▄▇▅▄▆▆█▇▇▇▅▆▆▆▆▅▆█▆▆▆
wandb:                train_auroc ▁▁▃▃▁▃▅▅▃▇█▆▆▅██▆████████▇██████████████
wandb:                 train_loss ▇█▆▆▆▅▅▅▆▄▄▄▃▃▁▁▁▁▁▃▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▃▃▆▅▅▆▆▅▆█▆▅▇▆▅▇▅▇▆▇▆▆▅▄▆▄▆▄▄▅▆▃▆▅▅▅▅▅
wandb:            val_accuracy0.5 ▁▅▆▆▇▇▇██▆▇▇▆▅▇▅▇▆▇▆▆▇▅▅▄▇▆▃▆▄▄▄▂▅▄▆▅▅▄▄
wandb:           val_accuracy0.75 ███▇███▇██▇▇▅▄▆▆▆▅▅▅▅▆▅▄▂▄▁▃▄▂▅▅▅▇▄▅▅▅▄▃
wandb:                  val_auroc █▅▄▅▅▆▆▆█▇▇▇▃▃▄▄▃▃▂▂▄▃▃▂▂▆▂▂▁▂▃▃▃▂▃▁▂▂▂▃
wandb:  val_balanced_accuracy0.25 ▄▅▄▄▄█▅▄▄▄▄▄▄▁▃▃▄▃▄▂▃▃▁▂▃▂▂▁▃▃▂▄▂▂▃▁▁▂▂▂
wandb:   val_balanced_accuracy0.5 ▁▅▅█▇▅█▆▆▇▅▆▅▇▆▄▇▃▄▅▃▄▁▄▅▃▃▁▄▂▄▂▃▅▃▃▃▄▃▃
wandb:  val_balanced_accuracy0.75 ▅▆▅▇██▇▆▆▆▇▆▇▇▄▆▆▅▆▂▄▅▆▆▂▄▆▆▁▁▃▄▄▅▄▆▅▄▅▄
wandb:          val_precision0.25 ▆▆▆▇▆▄██▆▆▅▁▄▂▆▄▄▅▃▂▄▃▅▃▂▁▄▂▂▄▄▂▃▄▄▂▄▄▄▄
wandb:           val_precision0.5 ▃▁█▅▄▆▃▃▂▃▄▃▄▃▃▃▃▃▃▂▃▂▂▂▂▂▂▃▂▃▂▄▂▂▂▂▃▂▂▃
wandb:          val_precision0.75 ▁█▅▃▅█▆▅▅▅▅▃▃▄▄▃▃▃▁▁▃▃▃▂▃▃▃▂▂▂▃▂▃▃▂▂▃▂▃▃
wandb:             val_recall0.25 ███▇█▂▃▅▄▂▂▁▃▃▃▄▁▄▂▂▂▂▂▂▂▃▃▃▃▄▃▂▁▂▃▂▂▃▃▃
wandb:              val_recall0.5 ▁▃▃▃▇█▂▃▅▃▄▁▂▁▂▃▆▅▅▃▅▃▃▃▃▅▅▄▁▃▄▅▅▄▄▆▆▆▆▆
wandb:             val_recall0.75 ▁▂▁▂▂▃▂▂▂▂▄▂▂▂▇▄▄▃▂▄▄▂▄▂▇▆▄▇▆▄▇▃█▃▅▇▄▅▇▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.55696
wandb:           test_accuracy0.5 0.55696
wandb:          test_accuracy0.75 0.56962
wandb:                 test_auroc 0.56059
wandb: test_balanced_accuracy0.25 0.53814
wandb:  test_balanced_accuracy0.5 0.50508
wandb: test_balanced_accuracy0.75 0.51356
wandb:         test_precision0.25 0.28571
wandb:          test_precision0.5 0.25806
wandb:         test_precision0.75 0.26667
wandb:            test_recall0.25 0.5
wandb:             test_recall0.5 0.4
wandb:            test_recall0.75 0.4
wandb:                train_auroc 0.99952
wandb:                 train_loss 0.0514
wandb:           val_accuracy0.25 0.46667
wandb:            val_accuracy0.5 0.53333
wandb:           val_accuracy0.75 0.54286
wandb:                  val_auroc 0.40798
wandb:  val_balanced_accuracy0.25 0.43914
wandb:   val_balanced_accuracy0.5 0.45764
wandb:  val_balanced_accuracy0.75 0.43817
wandb:          val_precision0.25 0.2
wandb:           val_precision0.5 0.20513
wandb:          val_precision0.75 0.17647
wandb:             val_recall0.25 0.38462
wandb:              val_recall0.5 0.30769
wandb:             val_recall0.75 0.23077
wandb: 
wandb: 🚀 View run resnet18_2d_64_6_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/46cqeyp8
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_6/wandb/run-20250618_120920-46cqeyp8/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_6/wandb/run-20250618_123438-4ht1v5j2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_6_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/4ht1v5j2
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▃▂▁██▇▇▇█▇▆▆▆▇▅▆▅▆▆▆▆▅▅▅▅▅▅▆▆▇▇▆▆▇▇▆▅▅█▆
wandb:           test_accuracy0.5 █▁▇█▇▆█▇▇▇▆▇▇█▆▆▅▇▆▅▆▅▅▅▅▅▅▅▆▇▆▆▆▆▇▆▅█▆▆
wandb:          test_accuracy0.75 ██████▆█▇▆███▅▃▅▃▆▃▃▅▆▁▃▄▃▂▂▃▃▅▅▆▇▄▆▄▄▃▄
wandb:                 test_auroc ▃▁▁▄▃▂▄▇▅▂▆█▇▇▆▆▅▆▅▄▂▃▃▃▃▃▃▃▃▃▃▃▆▄▂▂▂▄▇▄
wandb: test_balanced_accuracy0.25 ▂▂▄▄▂▇▆█▅▅▃▅▄█▅▆▇▇▆▅▅▂▃▃▂▁▃▂▃▃▂▂▁▃▄▄▃▄▄▁
wandb:  test_balanced_accuracy0.5 ▂▄█▆▄██▅▅▄▅▅▅▅▇▇▅▇▅▅▁▃▂▂▁▃▂▃▃▄▃▄▃▁▅▄▅▄▃▅
wandb: test_balanced_accuracy0.75 ▃▅▆▆▇▄▄▅▅▅█▃▆▆▄▇▆▇▄▅▅▃▃▃▃▄▃▃▅▄▄▄▃▃▃▆▅▂▁▆
wandb:         test_precision0.25 ▁▁█▁▂▃▃▄▄▂▂▃▃▂▃▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▁▁▂▂
wandb:          test_precision0.5 ▃▃▄▅▁▄█▄▄▄▃▁▃▃▄▅▄▄▃▃▃▄▄▃▃▃▃▃▃▃▃▃▃▃▃▃▄▃▃▃
wandb:         test_precision0.75 ▁▁█▁▁▁▁▅▄▄▅▃▄▅▅▄▃▄▄▃▃▃▃▃▃▃▃▃▄▄▄▄▃▃▃▃▃▂▃▃
wandb:            test_recall0.25 ██████▅▄▃▄▃▃▄▂▃▄▄▅▅▄▅▃▂▃▂▃▃▄▄▃▁▃▂▄▂▂▄▂▂▂
wandb:             test_recall0.5 ▁▁█▁▁▁▁▂▂▃▆▄▅▄▅▆▆▇▆▅▅▄▄▄▅▄▅▆▅▄▃▅▅▅▄▄▄▄▄▄
wandb:            test_recall0.75 ▁▃▁▂▂▁▂▅▅▅▅▄▄▅▆▇▇▅▅▅▅▅▅▆▆▆█▅▇▆▅▅▅█▆▅▅▅▅▄
wandb:                train_auroc ▁▂▃▃▄▆▇▇█████▇██████████████████████████
wandb:                 train_loss ██▇▇▇▄▄▅▃▂▂▁▁▂▂▁▁▂▁▁▁▁▁▂▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁█▆▇▆▆▇▇▇▆▇▅▅▇▆▆▅▆▄▆▆▆▆▅▅▅▄▄▅▅▅▆▆▅▃▅▆▅
wandb:            val_accuracy0.5 ▁██▇▇▄▆▃▆▅▄▆▃▆▃▅▄▄▄▂▁▃▄▃▁▃▃▂▁▂▂▂▂▂▇▅▄▃▃▃
wandb:           val_accuracy0.75 █████▇█▆▅▃▆▅▇▇▅▆▅▄▄▁▅▃▃▁▂▂▂▂▂▂▆▄▆▅▅▄▂▅▅▅
wandb:                  val_auroc ▆█▆▄▄▅▁▄▆▆█▆▇▄▄▃▃▄▄▄▃▄▄▅▄▅▅▆▆▆▄█▂▇▅▆▅▆▂▄
wandb:  val_balanced_accuracy0.25 ▁▂▂▂▂▅▄█▅▅▁▅▅▅▆▇▃▁▃▁▂▃▃▄▅▃▃▂▃▂▃▃▅▆▃▆▂▅▂▂
wandb:   val_balanced_accuracy0.5 ▅▅█▆▄▆▅▆▇▄▃█▄▅▅▂▃▅▅▆▃▂▄▄▄▄▅▂▃▃▁▇▇▅▅▆▃▃▃▄
wandb:  val_balanced_accuracy0.75 ▂▂▂▄▄▄▂▅▅▃▇▅▂▆▄█▄▄▃▄▂▃▁▅▄▄▂▃▂▃▅▅▆▅▂▃▃▆▃▁
wandb:          val_precision0.25 ▄▄▄▄▄▆▆▆▆█▅▆▁▅▄▅▅▄▅▅▅▅▄▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:           val_precision0.5 ▃▃▇█▅▄▃▃▄▃▄▄▄▃▃▁▃▂▂▃▄▂▃▃▂▂▂▂▂▂▂▃▃▃▃▃▃▃▃▃
wandb:          val_precision0.75 ▁▁▁▁▅█▇▅▅▅▃▃▄▄▄▄▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▅▄▄▄▄▄▃▄
wandb:             val_recall0.25 ████▄▅▄▅▅▃▁▄▆▄▁▆▄▄▃▃▄▄▄▄▄▄▄▄▃▄▄▄▅▄▄▅▃▄▅▅
wandb:              val_recall0.5 ▁▅▂▇▃▅▆▅▇▁▄▄▂▇▆▆▅▆█▅▅▆▅▆▆▆▆▇▇▆▆▆▆▆▂▁▇█▅▅
wandb:             val_recall0.75 ▁▃▂▃▃▇▆▅▅▆█▅▄▄▃▅▆▄▆▆▇█▆▇▆▆▇▆▆▇▇▇▇▆▄▆▅▆▄▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.60759
wandb:           test_accuracy0.5 0.63291
wandb:          test_accuracy0.75 0.64557
wandb:                 test_auroc 0.61992
wandb: test_balanced_accuracy0.25 0.53898
wandb:  test_balanced_accuracy0.5 0.55593
wandb: test_balanced_accuracy0.75 0.56441
wandb:         test_precision0.25 0.2963
wandb:          test_precision0.5 0.32
wandb:         test_precision0.75 0.33333
wandb:            test_recall0.25 0.4
wandb:             test_recall0.5 0.4
wandb:            test_recall0.75 0.4
wandb:                train_auroc 0.99972
wandb:                 train_loss 0.05158
wandb:           val_accuracy0.25 0.55238
wandb:            val_accuracy0.5 0.5619
wandb:           val_accuracy0.75 0.6
wandb:                  val_auroc 0.5224
wandb:  val_balanced_accuracy0.25 0.54771
wandb:   val_balanced_accuracy0.5 0.52824
wandb:  val_balanced_accuracy0.75 0.55355
wandb:          val_precision0.25 0.28571
wandb:           val_precision0.5 0.27273
wandb:          val_precision0.75 0.3
wandb:             val_recall0.25 0.53846
wandb:              val_recall0.5 0.46154
wandb:             val_recall0.75 0.46154
wandb: 
wandb: 🚀 View run resnet18_2d_64_6_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/4ht1v5j2
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_6/wandb/run-20250618_123438-4ht1v5j2/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_6/wandb/run-20250618_131337-5og9ug1j
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_6_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/5og9ug1j
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: uploading history steps 363-365, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▄▇▇▆▆▆▇▅▅▆█▆▆▆▆▇▅▇▅▆▅▆▅
wandb:           test_accuracy0.5 ██▁███████████▇█▇▇█▆▆▅▅▆▅▅▇▆▆▆▆▆▆▆▅█▇▇▇▆
wandb:          test_accuracy0.75 ████▇█████▆▇▇▇▇▄▃▅▂▅▃▅▅▅▄▂▅▅▅▄▇▅▅▅▅▃▁▅▂▂
wandb:                 test_auroc ▄▄▄▄▃▃▂▂▂▂▅▇▅▅▄▄▄█▄▂▄▂▄▃▄▄▃▅▅▆▅▆▁▁▂▂▃▂▃▃
wandb: test_balanced_accuracy0.25 ▄▄▂▄▁▄▄▂▄▅▇▂▇▆▃▆▇▃▃▄▃▄▄▂▂▅█▆▂▄▁▃▅▆▆▄▆▅▄▃
wandb:  test_balanced_accuracy0.5 ▆▆▅▄▆▅▆▄▅▆▂▄▂▃▃▃█▆▇▅▁▃▃▄▃▃▅▃█▄▃▃▂▂▄▄▃▃▄▆
wandb: test_balanced_accuracy0.75 ▄▃▄▃▃▃▅▅▂▃▃▃▃▆▁▂▁▁▃▆▇▆▄▄▁█▆▄▃▃▄▃▁▃▃▅▅▄▃▃
wandb:         test_precision0.25 ▄▄▄▄▄▄▃▄▃▄▄▄▄▄▄█▇▂▆█▄▅▅▃▇▅▄▁▅▅▆▆▆▄▄▅█▅▄▂
wandb:          test_precision0.5 ▆▅▆▅▁▆█▁▁▆▆▆▅▁▃▅▅▄▄▄▃▃▄▃▃▃▄▄▃▃▅▃▃▃▄▃▄▄▃▄
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▄▁▁▁▁▁█▇▇▅▅▆▅▄▆▇▆▇▅▅▆▆▅▅▅▆▅▆▅▆▅▅
wandb:            test_recall0.25 ▅████▇███▁▁█▁▄▃█▃▂▂▃▁▄▃▄▃▂▃▂▁▂▅▃▁▁▂▃▂▁▂▃
wandb:             test_recall0.5 █▆▆▂▂▂▂▁▂▂▁▆▁▆▂▄▆▅▃▃▃▃▆▆▁▃▃▃▅▃▃▄▆▄▄▅▃▇▄▄
wandb:            test_recall0.75 ▁▂▁▁▂▁▁▁▁▁▁▁▂▁▂█▅▅▅▅▃▄▅█▃▄▅▄▆▄▇▆▅▅▇▆▆▃▃▆
wandb:                train_auroc ▄▄▄▂▄▆▆▇▇▇▇▃▁▆▇██████████████████▇██████
wandb:                 train_loss ▇▇█▇▇▆▆▇▇▇▆▆▆▆▅█▅▃▂▂▁▁▁▁▁▁▂▁▁▁▁▁▄▂▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▂▁▁▁▁▁▁▇▇▇▇▃█▆▆▆▆▇▆▅▇▆▆▇▆▇▅▆█▇▇▇▆▇▇
wandb:            val_accuracy0.5 ▆▇▄▇▇█▆▆▇▇█▅█▇▇▆▆▁▅▄▃▃▂▆▄▅▅▄▄▅▆▅▅▃▆▆▅▅▅▅
wandb:           val_accuracy0.75 ▇▇█▇█▇▇█▇▇█▇██▇▇▅▆▅▄▆▄▅▃▁▄▆▆▇▅▂▅▄▃▆▄▄▅▅▅
wandb:                  val_auroc ▇▆█▇▇▁▆▇▃▇▇▄▆▆▆▅▃▄▂▅▄▄▆▆▅▅▅▂▅▅▆▄▅▄▄▆▇▆▇█
wandb:  val_balanced_accuracy0.25 ▂▂▃▃▂▂▂▂▂▁▇▄▅▁▂▂▅▃▃▂▃▃▄▅▅▅▆▃▅▅▅▆▆▅▅█▇▅▇▆
wandb:   val_balanced_accuracy0.5 ██▂▆█▆▂█▆▅▇▇▆▅▂▅▂▃▃▂▄▄▄▆▆▆▄▆▁▃▅▅▆█▅▅▆▆▅█
wandb:  val_balanced_accuracy0.75 ▆▆▇▃▇▄▃▅▅▃▆▁▄▂▄▁▁▅▅▃▅▄▅▆▅▇▃▇▅▆▄▃▅▄▃▇▄▄▇█
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▅▃▄▄▄▄▃▃▄▃▂▁▄▃▅▃▄▅▄▃▃▆▄▂█▅▅▄
wandb:           val_precision0.5 ▅▃▁▃▆▆█▆▇▅▃▅▆▅█▁▄▅▃▄▅▄▄▄▄▄▄▄▄▄▄▄▄▄▃▄▅▄▄▄
wandb:          val_precision0.75 ▁█▆▁███▇███▅▃▁▄▄▄▄▃▄▄▄▄▄▄▃▄▄▄▄▃▄▄▅▄▃▅▄▄▄
wandb:             val_recall0.25 ▇████████▇▂███▃▂▃▄▂▁▂▂▄▃▂▁▄▃▂▃▃▂▃▃▂▃▂▄▃▃
wandb:              val_recall0.5 ▁█▂▄▅▃▃▁▃▂▃▂▂▆▁▄▄▅▆▆▅▅▅▃▆▆▅▄▃▄▆▅▆▄▆▅▇▄▇▆
wandb:             val_recall0.75 ▁▃▄▁▁▂▂▂▃▂▁▁▄▅▁▄▆▇▆▆▅▆█▇▅▅▃▆▇▆▄▃▂▆▆▇▅▅▇▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.60759
wandb:           test_accuracy0.5 0.62025
wandb:          test_accuracy0.75 0.64557
wandb:                 test_auroc 0.50847
wandb: test_balanced_accuracy0.25 0.50593
wandb:  test_balanced_accuracy0.5 0.51441
wandb: test_balanced_accuracy0.75 0.53136
wandb:         test_precision0.25 0.26087
wandb:          test_precision0.5 0.27273
wandb:         test_precision0.75 0.3
wandb:            test_recall0.25 0.3
wandb:             test_recall0.5 0.3
wandb:            test_recall0.75 0.3
wandb:                train_auroc 0.99976
wandb:                 train_loss 0.03166
wandb:           val_accuracy0.25 0.64762
wandb:            val_accuracy0.5 0.68571
wandb:           val_accuracy0.75 0.69524
wandb:                  val_auroc 0.63973
wandb:  val_balanced_accuracy0.25 0.5852
wandb:   val_balanced_accuracy0.5 0.61052
wandb:  val_balanced_accuracy0.75 0.61685
wandb:          val_precision0.25 0.34286
wandb:           val_precision0.5 0.3871
wandb:          val_precision0.75 0.4
wandb:             val_recall0.25 0.46154
wandb:              val_recall0.5 0.46154
wandb:             val_recall0.75 0.46154
wandb: 
wandb: 🚀 View run resnet18_2d_64_6_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/5og9ug1j
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_6/wandb/run-20250618_131337-5og9ug1j/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_6/execution_datetimes.json

**************************************************  Experiment 64 | Version 7 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 5}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 6}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 7}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_7/wandb/run-20250618_133926-h24jea6j
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_7_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/h24jea6j
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▂▁▄█▆▆▅▆▇▅▅▆▇█▆▇▆▇▆▇▆▆▆▆▆▆▆▆▄▅▆▆▆▆▆▇▆▆▆
wandb:           test_accuracy0.5 ▇▇▁▆██▂▆▇▆▆▆▆▇▅▇▄▆▅▆▆▄▅▄▅▄▃▄▁▃▅▄▇▅▄▄▄▅▃▄
wandb:          test_accuracy0.75 ▇▇▇▇▇▇▆▇▇▄▆▄▆█▆▄▅▇▆▆▅▃▄▄▄▁▄▁▅▃▇▃▂▃▃▄▇▇▆▄
wandb:                 test_auroc ▁▃▄██▅█▇▇▅▄▅▅▅▄▅▄▃▃▁▄▄▄▃▄▄▃▄▁▅▃▄▂▆▅▆▆▄▃▄
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▂▁▂▃▇▆▅▃▆█▅▄▅▅▄▇▆▅▄▆▃▄▅▃▄▂▂▂▄▅▇▇▆▇▄
wandb:  test_balanced_accuracy0.5 ▂▆▇▇▅▆▄▅▄█▆▃▂▃▂▅▂▂▃▃▁▂▂▃▁▁▃▇▄▂▂▄▆▄▄▅▃▄▄▄
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃▃▄▃▃▄▂▂▄▃▄▃▄▄▃▃▃▆▅▆▂▁▂▃▁▃█▄▅▂▂▅▃▆▄
wandb:         test_precision0.25 ▂▂▃▂▇▄▅▆▁▄▆█▅▅▄▄▅▄▅▅█▅▃▄▅▅▄▄▃▄▅▅▂▂▁▇▇▇▅▄
wandb:          test_precision0.5 ▁▅▆▅▆█▆▅▇▅▄▅▄▇▄▄▄▄▅▅▄▃▅▅▅▄▄▄▅▄▅▄▄▄▄▅▅▄▅▄
wandb:         test_precision0.75 ▁▁▁▁▁█▅▅▁▁▁▅▃▃▂▂▃▂▃▃▃▃▃▃▄▄▄▃▂▃▃▃▃▃▃▃▃▃▄▃
wandb:            test_recall0.25 ▇▇▇▇███▁▅▄▆▁▇▅▁▅▃▂▂▅▃▅▃▆▄▅▃▃▃▃▄▄▅▅▅▃▄▄▄▄
wandb:             test_recall0.5 █▅▂▁▁▆▆▁▄▄▂▄▂█▁▂▂▂▄▄▃▃▃▃▂▄▄▄▄▄▄▃▁▄▅▅▆▆▃▄
wandb:            test_recall0.75 ▁▁▂▁▂▁▁▁▂▃▁▂▂▂▁▃▃▂▂▂█▃▃▃▃▄▆▃▃▂▃▃▃▄▃▅▅▇▆▅
wandb:                train_auroc ▁▁▃▄▄▆▆▆▇▇████████▇█████████████████████
wandb:                 train_loss ███▇▆▅▅▅▅▄▃▃▃▁▁▁▁▁▁▄▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▄▄▄▇▇▄▆▇▆▄▅▆▆▅▆▅▆▅▅▅▅▅▅▅▅▅▅▄▄▅▃▅▄▅█▅▄
wandb:            val_accuracy0.5 ▆▄▇▇▄▇▆▆▆▆██▅▆▇▇▅▅▆▅▄▅▅▄▆▅▅▅▃▅▄▄▄▁▅▆▅▅▅▄
wandb:           val_accuracy0.75 ████▇▆▇███████▅▆██▃█▇▆▇▆▅▅▆▁▅▅▅▅▄▄▇▅▃▄▄▅
wandb:                  val_auroc ▁▅▇█▇▇▇▅▅▆▃▅▄▄▂▃▂▃▂▂▃▃▃▃▃▂▃▃▃▂▂▂▁▂▂▃▄▂▂▃
wandb:  val_balanced_accuracy0.25 ▅▅▆▆█▇▆▇▄▄▆▅▅▄▆▇▆▁▄▆▃▅▄▅▄▄▂▅▃▃▅▅▆▆▄█▄▃▃▂
wandb:   val_balanced_accuracy0.5 ▃▄▅▅▆▇▅█▄▇▇▃▃▅▅▇▅▆▆▄▄▃▃▄▄▅▆▃▅▃▃▄▂▃▄▄▁▂▄▅
wandb:  val_balanced_accuracy0.75 ▂▂▂▃▂▃▂█▆▁▄▄▇▃▅▄▁▄▅▁▅▁▄▄▃▃▅▂▆▃▆▃▂▁▅▂▁▃▂▃
wandb:          val_precision0.25 ▄▅▇▄▅▆▄▅▄▇▇▇▂▄▃▇▅▅▄▄▃▂▂▂█▃▃▂▁▂▃▆▃▂▂▃▃▄▂▁
wandb:           val_precision0.5 ▁▁▂▁▁▂▃▃█▂▂▃▅▃▂▄▁▁▂▁▁▂▂▂▁▂▂▁▁▅▆▁▂▁▂▁▂▁▂▁
wandb:          val_precision0.75 ▁▁▃▅▃▅▅█▆▅▄▇▄▃▅▃▃▄▇▃▄▃▃▃▃▃▃▃▃▃▃▂▃▃▃▃▃▃▅▃
wandb:             val_recall0.25 ██▇███▄▅▄▁▃▃▃▂▂▂▃▂▄▁▃▂▃▃▃▂▃▃▂▂▃▂▃▃▃▃▃▂▃▃
wandb:              val_recall0.5 ▄▄▂▆▃▃█▁▄▄▄▃▃▃▂▃▃▂▃▂▄▃▂▂▂▃▃▄▃▃▂▄▄▃▃█▃▄▃▃
wandb:             val_recall0.75 ▁▁▁▁▂▅▂▂▂▂▂▂▅▅▃▅▄▅▅▄▄▄█▅▅▅▄▄▄▄▄▄▅▄▃▆▅▆▅▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.59494
wandb:           test_accuracy0.5 0.62025
wandb:          test_accuracy0.75 0.65823
wandb:                 test_auroc 0.60339
wandb: test_balanced_accuracy0.25 0.56356
wandb:  test_balanced_accuracy0.5 0.53093
wandb: test_balanced_accuracy0.75 0.52331
wandb:         test_precision0.25 0.3125
wandb:          test_precision0.5 0.29167
wandb:         test_precision0.75 0.29412
wandb:            test_recall0.25 0.5
wandb:             test_recall0.5 0.35
wandb:            test_recall0.75 0.25
wandb:                train_auroc 0.9995
wandb:                 train_loss 0.05783
wandb:           val_accuracy0.25 0.49524
wandb:            val_accuracy0.5 0.58095
wandb:           val_accuracy0.75 0.6381
wandb:                  val_auroc 0.50487
wandb:  val_balanced_accuracy0.25 0.43233
wandb:   val_balanced_accuracy0.5 0.48929
wandb:  val_balanced_accuracy0.75 0.51436
wandb:          val_precision0.25 0.18605
wandb:           val_precision0.5 0.23529
wandb:          val_precision0.75 0.26923
wandb:             val_recall0.25 0.30769
wandb:              val_recall0.5 0.30769
wandb:             val_recall0.75 0.26923
wandb: 
wandb: 🚀 View run resnet18_2d_64_7_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/h24jea6j
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_7/wandb/run-20250618_133926-h24jea6j/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_7/wandb/run-20250618_135758-3ohn3cck
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_7_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/3ohn3cck
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 369-372, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▇▂█▆█▆▅▆▇▇▇█▇█▆▆▆▅▄▅▅▆▇▇▆▆▅▇▆▆▆▅▅▂▆▆▆▅▆
wandb:           test_accuracy0.5 ▁▂██▇█▇▇▆▇▅▅▇▅▇▆▆▇▆▆▆▆▇▇▆▅▅▇▅▄▆▄▅▆▅▆▆▆▅▆
wandb:          test_accuracy0.75 ███▇█████▇█▇█▅▆▆▄▇▇▆▆▆▄▇▄▇▄▆▆▄▄▄▃▅▁▄▄▅▅▄
wandb:                 test_auroc ▁▃▂▆▆▆▆▄▅▅▆▆▅▆██▆▂▇█▇▆▆▇▆▅▅▅▆▆▄▅▅▅▆▅▆▅▄▇
wandb: test_balanced_accuracy0.25 ▁▄▅▄▂▄▄▄▃▆▄▄▇▆▆▇▃█▄█▃▃▄▄▅▇▃▅▅▄▆▅▆▄▁▅▄▄▅▇
wandb:  test_balanced_accuracy0.5 ▁▃▄▃▅▁▃▃▂▂▅▃▅▃▂█▂▁▂▄▃▆▆▇▄▅▆▄▇▆▆▁▆▅▅▄▃▄▂█
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▃▁▁▁▄▃▂▂▄▂▄▄▂▂▄▄▄█▃▁▁▃▆▄▆▅▅▆▇▇▆▃▅▃
wandb:         test_precision0.25 ▁▃▅▁▇▃▅▄▅▃█▅▇▆▄▂▆▅▆▅▃▄▅▃▁▃▄▅▄▃▅▅▄▄▆▅▇▅▃▆
wandb:          test_precision0.5 ▁▄▇▆▂█▆▅▅▆▅▅▄█▆▄▆▄▃▆▂█▃▅▄▅▃▃▄▅▃▅▄▅▅▄▄▄▄▆
wandb:         test_precision0.75 ▁▁▇▁▁▁▅▆▇▅▇▇▇█▇▅▅▆▇▅▆▆▅▆▅▆▆▇▆▆▅▆▇▇▆▆▆▆▆▆
wandb:            test_recall0.25 █▂▁█▁▃▃▅▅▃▅▃▇▃▄▇▅▇▄▁▁▄▅▅▁▇▆▅▅▅▇▂▆▆▆▂▆▃▇▆
wandb:             test_recall0.5 ▁▇▇▃▃▃▃▂▅▂▂▂▅▂▄▅▃▂▇▇▅▇▆▅▃▂▅▅▄▆▅▄▄▅█▆▆▆▄▆
wandb:            test_recall0.75 ▁▁▁▁▂▁▅▃▂▃▃▃▃▃▅▄▂▄▇▅▃▅▅▃▇█▅▄▂▅▇▅▅▄▃▅▇▇▇▇
wandb:                train_auroc ▁▂▅▅▄▆▆▆████████████████████████████████
wandb:                 train_loss ██▇▆▆▄▄▄▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▅▆█▄▄▅▅▇▅█▇▅▇▆▄▄▄▅▇▅▅▇▄▅▅▆▅▄▁▆▆▆▆▇▆▆
wandb:            val_accuracy0.5 ▁▆▄█▇▇▇▇███▄▇▃▇▅▇▄▇▇▇▅█▄▄▅▅▇▃▅▆▄▅▄▆▄▅▄▅▅
wandb:           val_accuracy0.75 ██▇▇█▇██▇▇█▇▅▆▇▆▇▃▂▆█▅▆▅▅▃▆▆▅▆▅▄▆▃▄▄▆▂▁▅
wandb:                  val_auroc █▇▅▃▁▁▄▂▂▂▂▄▃▅▄▆▅▅▆▆▄▅▆▆▆▃▄▆▇▇▇▇██▇▆▆▆▆▄
wandb:  val_balanced_accuracy0.25 ▄▄▆▃▁▄▄▃▃▂▅▅▃▂▅▅▅▃▆▅▅▆▄▆▅▅▆▇▅▅▄▅▇██▆▆▆▄▇
wandb:   val_balanced_accuracy0.5 ▃▁▃▂▂▃▄▅▅▃▃▃▂▆▂▄▅▇▃▃▆▅▄▄▂▅▄▅▂▃▆▆▅▅▂▆▇▆█▂
wandb:  val_balanced_accuracy0.75 ▁▁▂▃▃▂▃▂▅▁▂▄▃▂▃▄▃▄▅▅▂▄▅▃▅▄▅▅▅▆▆▅▆▆▆█▆▂▆▆
wandb:          val_precision0.25 ▃▃▁▁▃▁▂█▁▂▃▂▂▂▅▂▃▃▃▂▃▃▅▄▄▃▃▃▂▅▅▅▅▅▅▆▄▅▄▅
wandb:           val_precision0.5 ▅▄▁▄▆▆▅▄▄▄█▆▄▅▅▆▄▄▄▄▄▄▃▃▅▄▅▄▄▃▅▅▅▅▄▅▄▃▄▄
wandb:          val_precision0.75 ▁█▃█▅▃█▃▄▄▃▃▄▃▃▄▃▃▄▃▄▄▃▃▃▃▃▄▃▃▃▄▃▃▃▃▃▃▃▃
wandb:             val_recall0.25 █████▅▄▂▁▁▁▂▄▅▁▂▁▅▃▂▃▁▄▄▃▃▄▄▄▆▄▇▅▅▅▅▅▃▅▄
wandb:              val_recall0.5 █▇▁▅▄▂▁▂▂▂▃▂▃▃▃▄▅▃▄▆▄▄▅▄▄▄▄▃▅▄▅▅▅▅▅▃▅▄▄▄
wandb:             val_recall0.75 ▁▁▂▂▂▃▂▂▄▂▁▁▂▃▄▃▂▄▄▄▄▅▄▅▅▅▂▄▄▄▃█▆▆▅▇▅▆▄▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.62025
wandb:           test_accuracy0.5 0.62025
wandb:          test_accuracy0.75 0.63291
wandb:                 test_auroc 0.67203
wandb: test_balanced_accuracy0.25 0.67966
wandb:  test_balanced_accuracy0.5 0.64661
wandb: test_balanced_accuracy0.75 0.63856
wandb:         test_precision0.25 0.38095
wandb:          test_precision0.5 0.36842
wandb:         test_precision0.75 0.37143
wandb:            test_recall0.25 0.8
wandb:             test_recall0.5 0.7
wandb:            test_recall0.75 0.65
wandb:                train_auroc 0.99976
wandb:                 train_loss 0.05695
wandb:           val_accuracy0.25 0.5619
wandb:            val_accuracy0.5 0.6
wandb:           val_accuracy0.75 0.61905
wandb:                  val_auroc 0.60906
wandb:  val_balanced_accuracy0.25 0.57984
wandb:   val_balanced_accuracy0.5 0.59226
wandb:  val_balanced_accuracy0.75 0.59202
wandb:          val_precision0.25 0.30769
wandb:           val_precision0.5 0.32609
wandb:          val_precision0.75 0.33333
wandb:             val_recall0.25 0.61538
wandb:              val_recall0.5 0.57692
wandb:             val_recall0.75 0.53846
wandb: 
wandb: 🚀 View run resnet18_2d_64_7_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/3ohn3cck
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_7/wandb/run-20250618_135758-3ohn3cck/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_7/wandb/run-20250618_141709-sqjc5mie
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_7_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/sqjc5mie
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▂▆▇▄▇▂▁▆▅█▆▅▅▆▃▅▄▇▆▆▆▆▃█▆▆▆▆▆▆▆▆▆▆▆▅▅
wandb:           test_accuracy0.5 ▁█▄███▇█▆█▇▇▆▆▇▅▆▅▇▅▇▇▅▅▆▅▃▇▆▆▇▇▆▆▄▅▅▇▆▆
wandb:          test_accuracy0.75 ████████████▇▇█▇▆▆▄▂▇▇▄▇▄▄▆▇▂▆▁▇▇▃▆▃▄▄▄▇
wandb:                 test_auroc ▂▁▃▄▃▂▁▂▁▂▃▄▅▃▄▇▆▅▅▄▅▅▃▃▆▇▆▅▆▅▆▆▄▆█▅▆▅▄▄
wandb: test_balanced_accuracy0.25 ▃▃▃▃▄▄▄▄▄▂▆▁▂▅▅▃▄▃▃▃▃▅▆▆▅▃▄▂▃▆▆▃▄▆█▅▆▄▃▇
wandb:  test_balanced_accuracy0.5 ▃▆▁▁▅▃▃▅▅▃▃▄▅▅▃█▄▃▇▅█▄▅▃▃▅▄▇▆▇▅▄▇▇▆▃▆▆▅▄
wandb: test_balanced_accuracy0.75 ▃▃▄▂▄▂▄▂▃▂▃▂▂▂▅▁▃▄▄▄▅▂▄▃▂▄▅▃▇▅█▅▆▄▆▄▁▄▄█
wandb:         test_precision0.25 ▄▄▄▇▃▄▃▄▄▄▃▅▁▆▅▃▅▄▇▃▇▇██▆▅▅▆▆▅▆▆▅▇█▆▅▆▄▇
wandb:          test_precision0.5 ▅▁▄▄▄▆█▆█▄▃▆▅▆▅▆▄▅▅▄▅▅▄▅▄▅▆█▆▅▆▆▅▆▅▅▄▅▅▅
wandb:         test_precision0.75 ▁▁▁█▁▁▁▁▁▄▁▁▁▁▁▃▃▃▂▁▃▄▃▁▃▄▃▃▃▃▄▄▃▃▄▃▃▂▃▃
wandb:            test_recall0.25 ██████▃▅▇█▇▅▂▂▂▄▂▂▁▃▂▆▄██▅█▄▂▃▇▄▄█▅▄▄▃▃▅
wandb:             test_recall0.5 █▅▆█▆▁▁▂▃▃▃▆▃▁▂▆▄▃▅▃▂▄▃▄▃▄▆▄▄▄▄▃▇█▃▄▄▅▄▅
wandb:            test_recall0.75 ▁▁▁▁▁▂▁▂▁▂▁▂▁▂▁▁▂▁▃▁▃▄█▅▁▆▄▄▄█▃▄▄▄▂▃▄▇▃▃
wandb:                train_auroc ▁▃▅▅▆▇▆▇▇▇▇███████████▇█████████████████
wandb:                 train_loss ████▆▅▅▅▅▃▂▁▂▂▁▁▁▁▁▁▄▂▁▁▁▁▁▁▁▄▁▁▂▂▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▃▁▃▆▃█▇█▅▅▇█▄▆▅▆▅▆▆▆▅▅▇▃▆▂▅▄▅▆▂▅▄▅▄▃▄
wandb:            val_accuracy0.5 ▁▇█▆▇▇▇▇▅▆█▇▇▇▆▅▆▃▅▅▄▃▃▆▆▃▆▃▄▃▄▅▅▄▅▅▆▄▅▇
wandb:           val_accuracy0.75 ▇▇█▇█▇▇█▇▇▇▇▇▇██▆█▇▆▄▇▇▆▁▅▅▂▇▄▅▂▄▄▅▅▃▃▄▇
wandb:                  val_auroc ▆▇█▆▆▆▅▅▅▄▄▃▃▃▃▄▃▃▄▄▃▆▅▄▄▄▃▄▅▄▁▂▂▂▂▂▂▂▁▂
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▃▇▃▄█▃▇▃▇▂▇▂▅▅▅▁▅▆▅▅▆▅▅▅▇▅▄▆▃▂▁▄▄▅▅▅
wandb:   val_balanced_accuracy0.5 ▆▇▃▅▂▃█▇▆▄▇▆▅▅▄▃▄▅▅▃▇▂▆▂▃▄▄▃▂▃▃▃▅▃▅▁▂▄▃▅
wandb:  val_balanced_accuracy0.75 ▁▁▁▃▂▄▆▄█▅▆▅▅▅▆▆▄▄▅█▄▄▄▃▅▁▂▄▃▁▂▁▃▃▃▃▃▂▂▄
wandb:          val_precision0.25 ▂▂▂▂▂▂▂▂▂▂▂▃▁▂▆█▅▃▃▁▆▂▁▃▃█▃▂▃▃▂▂▁▁▁▂▃▃▃▂
wandb:           val_precision0.5 ▅▁▄▄▂▂▄▂▃▆▄▃▃▃█▂▂▄▁▂▃▁▂▁▂▂▂▂▃▂▂▁▂▂▁▁▂▂▂▃
wandb:          val_precision0.75 ▁▇▅▅▅▇▇█▅▅▅█▅▇▅▅▅█▄▄▅▄▃▃▄▃▄▄▃▃▄▃▃▃▃▄▃▃▄▄
wandb:             val_recall0.25 ███▄▄▆▃▄▄▄▃▃▄▄▁▃▂▃▄▆▃▆▆▄▆▂▄▄▂▆▄▂▄▄▆▃▅▄▃▃
wandb:              val_recall0.5 ▃▆▂▄▁▁▆▄▆▅▅▄▇▃▅▂█▄▄▆▄▄▇▃▅█▅█▅▄▅▅▃▆▆▇▄▄▃▆
wandb:             val_recall0.75 ▁▁▂▃▃▄▃▂▄▂▄▃▃▃▅▄▃▅▆▅▅▄██▃▇▆▃▆▅▆▄█▅▅▅▅▅▄▄
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.5443
wandb:           test_accuracy0.5 0.59494
wandb:          test_accuracy0.75 0.64557
wandb:                 test_auroc 0.65254
wandb: test_balanced_accuracy0.25 0.56271
wandb:  test_balanced_accuracy0.5 0.54703
wandb: test_balanced_accuracy0.75 0.53136
wandb:         test_precision0.25 0.3
wandb:          test_precision0.5 0.3
wandb:         test_precision0.75 0.3
wandb:            test_recall0.25 0.6
wandb:             test_recall0.5 0.45
wandb:            test_recall0.75 0.3
wandb:                train_auroc 0.9996
wandb:                 train_loss 0.11229
wandb:           val_accuracy0.25 0.45714
wandb:            val_accuracy0.5 0.6
wandb:           val_accuracy0.75 0.62857
wandb:                  val_auroc 0.52045
wandb:  val_balanced_accuracy0.25 0.52313
wandb:   val_balanced_accuracy0.5 0.56646
wandb:  val_balanced_accuracy0.75 0.52093
wandb:          val_precision0.25 0.26154
wandb:           val_precision0.5 0.30952
wandb:          val_precision0.75 0.27586
wandb:             val_recall0.25 0.65385
wandb:              val_recall0.5 0.5
wandb:             val_recall0.75 0.30769
wandb: 
wandb: 🚀 View run resnet18_2d_64_7_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/sqjc5mie
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_7/wandb/run-20250618_141709-sqjc5mie/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_7/execution_datetimes.json

**************************************************  Experiment 64 | Version 8 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 19, 1.0: 9}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 16, 1.0: 12}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 13, 1.0: 19}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 11, 1.0: 17}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_8/wandb/run-20250618_143441-fhdhoos0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_8_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/fhdhoos0
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▃▅▇▁█▅█▅▅▆▆▇▅▅▂▇▇▆▆▆▇▆▅▆▆▆▆▇▇▆▆▇▆▆▆▆▇▆▆
wandb:           test_accuracy0.5 ▃▄▁███▅▇▇▇▇▇▆▅▅▅▅▅▅▆▅▆▅▄▅▅▅▅▅▅▅▅▄▅▅▅▅▅▅▄
wandb:          test_accuracy0.75 ▇▇▇█▇▇▇▄▇▄▇▅▇▅▇▅▇▄▃▆▅▄▃▄▂▄▂▁▅▄▃▃▃▁▇▅▆▅▂▂
wandb:                 test_auroc ▁▃▄▇▅██▆▄▅▃▃▃▃▄▃▄▃▃▃▃▃▃▃▃▂▂▃▃▃▂▃▃▃▂▃▃▃▃▃
wandb: test_balanced_accuracy0.25 █▇▅▄▄▇▆▅▃▂▅▃▆▂▄▁▄▁▄▇▃▄▃▄▇▄▃▄▄▇▄▃▇▁▃▃▇▃▃▅
wandb:  test_balanced_accuracy0.5 ▅█▆▅▇▅▅▆▅▇▄▃▄▄▅▁▃▂▃▄▁▄▅█▄▃▄▃▃▂▆▂▄▅▂▂▂▃▄▂
wandb: test_balanced_accuracy0.75 ▄▄▄█▄▄▄▄▇▄▆▄▆▆▆▆▆▂▁▄▄▃█▂▄▃▂▃▄▃▄▃▃▃▃▅▆▅▄▁
wandb:         test_precision0.25 ▂▂▂▂▂▂█▆▄▄▄▂▄▄▂▄▃▃▂▂▁▂▃▄▃▃▃▆▄▄▃▄▃▃▅▅▅▃▃▄
wandb:          test_precision0.5 ▃▂▃▆▄█▄▂▃▅▃▃▂▂▁▂▂▁▁▂▂▂▂▂▁▂▂▃▂▂▂▂▃▂▂▃▂▂▃▂
wandb:         test_precision0.75 ▁▁█▁██▁▅▅▃▃▂▂▂▃▃▃▃▅▃▂▂▃▂▃▃▃▂▃▃▃▃▃▃▃▂▃▃▃▃
wandb:            test_recall0.25 ▇▆▆▃▄▅██▁█▂▁▄▁▄▄▂▃▁▄▃▂▂▆▂▂▃▇▂▄▃▅▃▅▁▅▃▃▅▄
wandb:             test_recall0.5 ▆▆▂▂▁▂▂▁▅▂▃▄▂▃▂▃▂▃▃▇▃▂▂▂▆▄▄▃▃▂▃▄▄▃▄▄█▃▃▄
wandb:            test_recall0.75 ▁▁▂▃▂▁▁▂▄▂▂▂▂▂▃▂▃▃▃▂▃▂▂▃▃▆▃▅▃▆█▅▆▂▅▅▃▆▅▅
wandb:                train_auroc ▁▁▃▅▆▆▇▇████████████████████████████████
wandb:                 train_loss ███▇▆▅▆▅▅▅▄▄▄▃▂▁▁▁▁▂▁▁▁▄▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▂▁▁▂▂▆▃▆▅▅▅▅▅▅▆█▇▆▆▆▆▆▄▃▇▅▆▆▆▆▅▅▃▅▅▅▅▆▅▄
wandb:            val_accuracy0.5 ▅▄▇▆▇▇▅▄▇▇▅▅▇▁▅▅█▇▆▆▆▅▂▆▆▁▇▅▄▅▆▅▅▆▄▄▆▅▅▅
wandb:           val_accuracy0.75 ██▇█▅███▅███▇█▇▅▅▆▇▁▆▆▇▆▆▆▆▇▅▇▇▆▅▆▆▅▅▅▆▅
wandb:                  val_auroc ▁▁▄▇▆█▆▇▇▆▇▆▅▆▆▅▅▅▅▅▅▅▄▄▅▄▄▄▄▄▄▄▄▄▅▄▄▃▃▄
wandb:  val_balanced_accuracy0.25 ▃▄▄▃▅▄█▃▆▄▄▆▄▄▃▆▄▃▅▇▄▄▂▄▂▄▄▃▂▄▄▂▄▄▄▁▂▂▃▂
wandb:   val_balanced_accuracy0.5 ▄▂▂▁▄▆▃▄▃▅▇▅█▅▃▅▆▅▄▅▃▅▃▄▅▄▅▅▄▃▄▃▅▅▃▃▃▃▂▃
wandb:  val_balanced_accuracy0.75 ▂▂▁▁▂▃▃▃▂▃█▆▃▄▆▅▅▃▅▃▄▃▄▂▄▃▃▄▄▄▄▂▆▆▂▂▁▁▂▄
wandb:          val_precision0.25 ▂▂▃▂▃▃▃▃▃▃▅▂▅█▃▃▂▄▂▃▁▁▂▅▁▃▃▃▃▃▂▃▂▂▂▂▂▂▁▁
wandb:           val_precision0.5 ▂▁▂▂▂▃▅▄█▂▂▂▂▂▂▂▂▂█▃▂▂▂▂▂▂▂▂▂▁▂▂▂▂▂▂▂▂▂▂
wandb:          val_precision0.75 ▁▁▅▄▃█▃▃█▄▇▅▅▃▃▅▄▃▄▃▃▄▃▅▃▃▃▃▄▃▂▃▃▃▃▃▃▃▃▃
wandb:             val_recall0.25 ███▇▇██▆█▅█▃▅▇▇▄▃▃▂▂▁▄▃▃▄▄▄▄▂▂▅▃▅▃▃▃▂▄▃▅
wandb:              val_recall0.5 ▁▃▂▃▁▂▂▂▅▂▃▃▄▁▂▃█▁▃▂▂▄▂▂▄▂▂▄▃▆▂▂▃▂▂▂▃▂▂▂
wandb:             val_recall0.75 ▁▁▁▁▁▃▂▂▆▅▃▂▃▅▅▅▅▅▄▅▅▅▅▅▆▅▅▅▃▆▆█▅▅▆▅▅▆▅▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.5443
wandb:           test_accuracy0.5 0.56962
wandb:          test_accuracy0.75 0.56962
wandb:                 test_auroc 0.58347
wandb: test_balanced_accuracy0.25 0.57924
wandb:  test_balanced_accuracy0.5 0.51356
wandb: test_balanced_accuracy0.75 0.49703
wandb:         test_precision0.25 0.30952
wandb:          test_precision0.5 0.26667
wandb:         test_precision0.75 0.25
wandb:            test_recall0.25 0.65
wandb:             test_recall0.5 0.4
wandb:            test_recall0.75 0.35
wandb:                train_auroc 0.9997
wandb:                 train_loss 0.04796
wandb:           val_accuracy0.25 0.48571
wandb:            val_accuracy0.5 0.58095
wandb:           val_accuracy0.75 0.58095
wandb:                  val_auroc 0.51947
wandb:  val_balanced_accuracy0.25 0.51631
wandb:   val_balanced_accuracy0.5 0.5409
wandb:  val_balanced_accuracy0.75 0.51509
wandb:          val_precision0.25 0.25862
wandb:           val_precision0.5 0.28571
wandb:          val_precision0.75 0.26316
wandb:             val_recall0.25 0.57692
wandb:              val_recall0.5 0.46154
wandb:             val_recall0.75 0.38462
wandb: 
wandb: 🚀 View run resnet18_2d_64_8_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/fhdhoos0
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_8/wandb/run-20250618_143441-fhdhoos0/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_8/wandb/run-20250618_150513-ngrv02tk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_8_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/ngrv02tk
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 365-365, summary
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▂▃▁▄▂▂▇▂▅▆▆▄▆█▆▆█▇█▇▇█▆▆▆▇▇▇▆▇▇▆█▆█
wandb:           test_accuracy0.5 ▇▆▁▂██▆▆▇▄▅▇▆██▇▅▅▆▆▅▅▆▄▄▆▆▅▄▅▄▃▄▅▄▂▄▂▄▄
wandb:          test_accuracy0.75 █████████▇████▇▆▄▆▆▇▅▄▄▂▅▆▂▃▄▄▂▂▅▅▂▆▂▂▄▁
wandb:                 test_auroc ▁▁▃▃▇█▇▇▇▇▆▇▅▅▅▅▄▅▆▅▆▆▆▆▆▆▆▆▆▆▆▆▅▆▆▆▇▆▆▆
wandb: test_balanced_accuracy0.25 ▂▂▂▁▂▃▃▂▄▃█▇▆▇▃▁▄▅▃▅▁▅█▄▅▅▆▃▄▄▆▄▄▅▅▅▅▅▅▆
wandb:  test_balanced_accuracy0.5 ▄▄▅▇▆▃▃▂▅▃▃▃▁▂▁▄▄▅▃▃▄▄▅▄▅▇▄▄▄▆▄▄▅▆▃▃▃▄█▄
wandb: test_balanced_accuracy0.75 ▄▄▄▄▄▄▆▄▄▄▃▃▃▃▃▄▁▄▂▅▃▂▂▆▆▂▆▅▇▅▆▅▄▆▆█▆▅█▄
wandb:         test_precision0.25 ▁▁▁▁▆▄▂▁▃▃▄▄▂▃▅▄▅▅▄▅▅▃▄▄▃▆▆▄▃▄▄▄▄▂▄▇▄█▄▄
wandb:          test_precision0.5 █▅▅▄▃▁▃▃▃▃▂▃▂▂▂▃▃▃▃▃▃▃▃▃▃▃▃▃▁▃▃▃▃▃▃▃▃▃▃▃
wandb:         test_precision0.75 ▁▁▁▁▁██▁▇▁▁▁█▅█▄▃▄▄▄▅▅▃▃▅▃▅▆▅▅▅▆▇▅▆▅▆▆▅▅
wandb:            test_recall0.25 █████▇▇▂▅▇▆▃▆▆▁▂▅▅▄▅▆▅▅▄▇▄▆▄▅▆▄▄▆▆▃▆▄▆▄▅
wandb:             test_recall0.5 ▁▅▄▄▂▁▁▁▅▆▃▂▂▇▅▂▃▃▄▇▆▄▅▃▃▅▄▇▇███▇▆▃▅█▇█▆
wandb:            test_recall0.75 ▁▁▁▁▁▂▂▁▁▂▂▂▁▁▁▂▂▂▂▃▂▃▂▄▃▃▆▄▇▅▄▂▄▄▅▅▇█▅▆
wandb:                train_auroc ▁▂▆▆▆▆▇▆▇▇▇▇████████████████████████████
wandb:                 train_loss █████▆▆▅▅▄▄▃▃▂▂▄▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁█▄▅▆▅█▇█▆█▅▇▄▇▆▆▇▅▇▅▅▃▅▆▅▇▆▄▇▄▄█▅
wandb:            val_accuracy0.5 ▅▁▆▄▅▇▇█▇▇▆██████▆▅▇▇█████▅▅▆█▅▆▆▆▅▆█▇▅▅
wandb:           val_accuracy0.75 ███▇▇▇█▇▅▆▇▆▇▇▇▇▇▅▇▅▆▃▇▇▇▁▅▁▆▇▅▇▇▆▄▂▇▇▆▆
wandb:                  val_auroc █▇▇▇▄▃▁▅▃▂▂▂▂▃▃▃▃▄▄▃▂▄▄▃▅▄▃▅▃▆▅▄▆▄▆▃▄▅▅▅
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▄▆▁▂▃▅▄▂▂▄▅▇▄▅▇▅▄▄▃▅▆▇▅▇▅▄▃▆█▆▄▃▆▆▄▇
wandb:   val_balanced_accuracy0.5 ▅▃▂▄▄▂▄▃▆▅▄▂▄▂▃▆▇██▇▆▇▆▆▆▅█▇▁▆██▁▆▆▇█▅▆▃
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▂▃▃▃▁▁▃▆▁▁▃▃▆▆▇▆▄▆▆▆▂▃▆▇▄▂▆▅▆█▆▆▆▆▅
wandb:          val_precision0.25 ▃▃▃▂▄▄▁▅▄▂▄▄▄▄▄▆▃▅▃▅▄▆▇▃▂▄▆▂▅▄▅▅▄▄█▆▅█▆▅
wandb:           val_precision0.5 ▅▁▅▅▅▆▅▅▆▅▆▆▆▆▇▆█▆▆▆▅▇▅▆▆▇▅▆▆▇▆▅▅▆▆▆▅▆▅▅
wandb:          val_precision0.75 ▁▁▁██▃▃▆▄▄▃▄▃▄▄▃▂▄▄▃▄▄▄▄▄▃▄▄▄▄▃▄▄▃▄▄▄▄▃▄
wandb:             val_recall0.25 ███████▆▅█▃▅▄▃▃▃▄▅▄▄▄▃▃▇▁▃▂▃▃▇▆▄▄▃▄▃▃▆▂▅
wandb:              val_recall0.5 ▆▄█▃▁▃▁▃▁▂▂▃▂▂▄▃▄▂▄▁▃▄▃▃▃▃▄▆▃▅▃▃▄▄▃▅▆▃▃▃
wandb:             val_recall0.75 ▁▂▂▂▂▂▂▂▂▂▁▄▄▄▄▄▃▅▄▄▅▅▄▆█▄▆▄▅▄▅▅▆█▅▅▆▅▅▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.58228
wandb:           test_accuracy0.5 0.58228
wandb:          test_accuracy0.75 0.56962
wandb:                 test_auroc 0.60932
wandb: test_balanced_accuracy0.25 0.65424
wandb:  test_balanced_accuracy0.5 0.58814
wandb: test_balanced_accuracy0.75 0.54661
wandb:         test_precision0.25 0.35556
wandb:          test_precision0.5 0.32432
wandb:         test_precision0.75 0.29412
wandb:            test_recall0.25 0.8
wandb:             test_recall0.5 0.6
wandb:            test_recall0.75 0.5
wandb:                train_auroc 0.99952
wandb:                 train_loss 0.07342
wandb:           val_accuracy0.25 0.49524
wandb:            val_accuracy0.5 0.54286
wandb:           val_accuracy0.75 0.6
wandb:                  val_auroc 0.58569
wandb:  val_balanced_accuracy0.25 0.53554
wandb:   val_balanced_accuracy0.5 0.52848
wandb:  val_balanced_accuracy0.75 0.54065
wandb:          val_precision0.25 0.27119
wandb:           val_precision0.5 0.27083
wandb:          val_precision0.75 0.28947
wandb:             val_recall0.25 0.61538
wandb:              val_recall0.5 0.5
wandb:             val_recall0.75 0.42308
wandb: 
wandb: 🚀 View run resnet18_2d_64_8_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/ngrv02tk
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_8/wandb/run-20250618_150513-ngrv02tk/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_8/wandb/run-20250618_152345-5dgc329v
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_8_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/5dgc329v
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: uploading wandb-summary.json
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▄▄█▇▆▇▇▇▇█▇▃▇▇▆▇▇▇▇▇▇▇▇▇▅▇▇▇▇▇▇▇▇▇▇▇▇▅█
wandb:           test_accuracy0.5 ▇▁▇██▇▆▇▇▇▆▆▅▅▆▅▃▅▅▆▅▅▅▁▅▅▇▅▄▄▅▅▄▅▆▃▅▅▅▄
wandb:          test_accuracy0.75 ████▇██▇█▇▆▇▆▅▅▆▆▅▅▅▇▆▆▆▇▇▅▇▆▁▄▆▆▃▆▆▆▆▆▆
wandb:                 test_auroc ▁▁▅▅▅▆▃▃▃▁▂▁▄▄▅▆▃▆▇▃▅▅▄▇▇▆▅▇▅▆▃▃▇█▇▆▆▆▆▃
wandb: test_balanced_accuracy0.25 ▃▃▂▂▁█▆▆▆▆▄▃▆▅▄▅▄▄▃▄▆▂▄▅▃▃▅▄▅▄▄▆▇▆▆▃▄▇▃▃
wandb:  test_balanced_accuracy0.5 ▆▇▅▄▅▅▇▆▄▄▃▅▂▆▂▅▄█▄▆▂▆▇▅▃▆▃▄▃▇█▄▆▆▅▃▄▂▁▄
wandb: test_balanced_accuracy0.75 ▃▃▅▃▃▃▃▇▄▃▂▃▂▂▄▁▃▃▄█▁▅▄▃▃▃▃▇▃▂▅▃▅▃▄▄▄▄▂▁
wandb:         test_precision0.25 ▆▅▅▆▆▆▇▆▆▇▆▆▄▆▃▆▅▆█▇▅▇▆▇▇▆▇▆▇▇▆▆▅▇▅▇▆▁█▆
wandb:          test_precision0.5 █▇█▄▄█▆▅▄▅▂▃▄▃▄▄▅▄▃▁▄▄▂▃▅▄▄▃▄▂▅▄▃▄▃▅▂▄▄▆
wandb:         test_precision0.75 ▁██▁▁▆▃▂▃▃▁▁▂▃▃▂▃▃▃▃▁▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:            test_recall0.25 █▇▇▆█▇▆▁▂▆▅▁▂▆▂▂▃▄▂▆▄▃▁▃▄▆▄▃▃▄▃▃▇▂▃▃▃▁▅▂
wandb:             test_recall0.5 ▅▁▆▂▄▃▁▂▁▁▂▂▃▁▂▄▂▃▂▂▅▄▃▆▃▇▄▅▅▅█▄▂▆▅▅▇▂▂▂
wandb:            test_recall0.75 ▂▂▂▁▁▁▁▁▁▁▄▂▂▅▅▂▂▆▃▃▂▄▅▃▃▄▅█▄▃▇▃▅▆▄█▄▂▆▃
wandb:                train_auroc ▁▅▅▄▄▅▅▅▆▆███████████████████▆██████████
wandb:                 train_loss ▇▆▆▆▆▅▄▃▂▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁█▄▃▁▁
wandb:           val_accuracy0.25 ▁▁▂▂▄▄▇▅▄█▆▆▆▇▄▅▅▃▆▇▅▇▅▇▇▇▇▅▇▇▅▄▇▅▅▇▅▇▇▇
wandb:            val_accuracy0.5 ▇█▇▅█▅▇▄█▇▁▇▂▇▇█▇▃▆▁▆▇▃▇▅▃▃▅▂▆▆▂▅▇▇▃▇▆▇▆
wandb:           val_accuracy0.75 ▇▇▇▇▇▇▇█▇▇▆▆▅█▅▅▆▇▅▄▅▅▄▃▆▁▆▅▅▆▃▄▆▆▅▂▆▄▄▂
wandb:                  val_auroc ▆▆█▇▇▇▆▆▆▇▆▆▄▄▄▅▂▄▄▃▃▄▃▃▃▃▃▃▃▃▄▁▂▄▅▃▄▄▃▅
wandb:  val_balanced_accuracy0.25 ▂▂▄▇▁█▆▄▇▆▅▄▅▄▅▄▃▄▄▃▄▅▄▃▃▃▄▂▁▃▃▃▅▆▅▄▃▄▅▁
wandb:   val_balanced_accuracy0.5 ▁▇▆▇▃▆▅▆█▄▆▄▄▅▅▅▅▅▅▄▃▅▃▄▄▄▅▆▅▅▂▅▅▅▄▅▅▃▅▁
wandb:  val_balanced_accuracy0.75 ▁▄▄▃▃▃█▆█▃▃▄▆▅▅▅▆▃▂▃▄▅▅▂▄▆▆▆▅▁▅▃▅▄▃▄▄▄▄▅
wandb:          val_precision0.25 ▂▁▁▄▂█▂▃▅▇▅▂▆▇█▃▄▂▇▃▃▃▃▃▂▆▁▆▆▅▁▃▂▂▂▅▅▃▃▃
wandb:           val_precision0.5 ▂▄▃█▂▄▇▄▃▆▃▇▃▂▃▄▄▁▃▂▁▁▃▃▁▃▃▂▃▄▂▁▃▁▃▃▁▂▂▁
wandb:          val_precision0.75 ▁█▅▄▇▅▄▅▅███▄▅█▄▄▄▅▄▄▆▄▅▄▅▃▄▃▄▃▆▄▄▄▄▃▄▄▆
wandb:             val_recall0.25 █▆▅▂█▅▆▃▂▃▂▃▄▁▂▃▃▂▆▂▂▁▁▃▁▃▃▁▂▂▂▃▄▃▃▃▆▃▃▂
wandb:              val_recall0.5 ▅▂▂▃▃▆▃▃▂▃▃▃▃▆▄▃▇▁▅▆▄▅▄▃▅▃▆▃▄▄▄▆▆▅█▅▄▆▆▄
wandb:             val_recall0.75 ▂▃▂▂▂▂▂▂▁▃▂█▂▄▄▇▄▅▄▄▅▄▇▄▇▅▅▆▆▆▆▅▇▅▇██▅▄▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.5443
wandb:           test_accuracy0.5 0.60759
wandb:          test_accuracy0.75 0.67089
wandb:                 test_auroc 0.62839
wandb: test_balanced_accuracy0.25 0.57924
wandb:  test_balanced_accuracy0.5 0.62161
wandb: test_balanced_accuracy0.75 0.63093
wandb:         test_precision0.25 0.30952
wandb:          test_precision0.5 0.35135
wandb:         test_precision0.75 0.39286
wandb:            test_recall0.25 0.65
wandb:             test_recall0.5 0.65
wandb:            test_recall0.75 0.55
wandb:                train_auroc 1
wandb:                 train_loss 0.05043
wandb:           val_accuracy0.25 0.47619
wandb:            val_accuracy0.5 0.48571
wandb:           val_accuracy0.75 0.49524
wandb:                  val_auroc 0.57327
wandb:  val_balanced_accuracy0.25 0.50998
wandb:   val_balanced_accuracy0.5 0.4776
wandb:  val_balanced_accuracy0.75 0.45813
wandb:          val_precision0.25 0.25424
wandb:           val_precision0.5 0.23077
wandb:          val_precision0.75 0.21277
wandb:             val_recall0.25 0.57692
wandb:              val_recall0.5 0.46154
wandb:             val_recall0.75 0.38462
wandb: 
wandb: 🚀 View run resnet18_2d_64_8_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/5dgc329v
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_8/wandb/run-20250618_152345-5dgc329v/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_8/execution_datetimes.json

**************************************************  Experiment 64 | Version 9 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 36, 1.0: 28}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 32, 1.0: 32}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 27, 1.0: 37}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 26, 1.0: 34}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_9/wandb/run-20250618_155601-w6vh1nh6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_9_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/w6vh1nh6
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▄▃▄▆▆█▅▇▆▆▆▅▆▅▆▃▄▅█▇█▇▇▇▇▇▆███▇█▇▇▆▇▇▆
wandb:           test_accuracy0.5 ▂▃▆██████▄▇▇██▅▆▅▇▇▃▅▄▃▃▅▆▄▃▂▂▄▇▅▃▂▃▄▃▁▄
wandb:          test_accuracy0.75 ██████████████▇▇▇▆▇▆▄▅▇▅▅█▄▆▅▅▂▇▆▅▃▁▄▁▃▂
wandb:                 test_auroc ▂▇█▇▇▆▅▆▅▆▄▄▃▅▄▄▄▄▁▄▄▄▄▄▄▅▅▅▅▅▅▅▅▄▅▄▅▅▅▅
wandb: test_balanced_accuracy0.25 ▂▁▂▅▅▅▄▆▇▄▃▇▃▄▃▃▇▆▅▇▄▄▄▇▄▃▅▇▄▄█▄▅▄▆█▆▄█▄
wandb:  test_balanced_accuracy0.5 ▅▅▇▃▃▅▃▃▃▂▆▂▃▃▃▂▃▅▂▃▂▁▂▁▃▁▅▇▄█▁▃▅▄▂▅▂▄▄▂
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃█▃▃▄▄▄▄▃▄▄▃▂▄▂▃▄▄▃▃▂▄▂▂▂▃▄▂▁▃▂▁▂▁▃▅
wandb:         test_precision0.25 ▂▂▂▂▂▄▅▇▄▆▁▅▃▅▇▁▅▃▄▅▇▆▅▄▆▄▆▇▆▆▆▇▆▇█▆▄▇▆▆
wandb:          test_precision0.5 ▄▆█▇▇▆███▅▅▅▅▅▄▄▄▁▅▅▄▅▅▅▄▄▅▇▅▄▅▆▄▄▅▄▅▆▄▆
wandb:         test_precision0.75 ▁▁▁██▅▁▅▁▁▁▁▄▃▁▃▃▂▃▂▄▃▃▂▃▃▂▃▃▃▃▅▃▃▂▂▃▂▃▃
wandb:            test_recall0.25 █▇▆▇▇██▂▂▆▆▁▇▅▅▅▅▅▄▄▄█▃▆▅▆▆▇▆▃▄▆▅▅▃▅▇▇▆▄
wandb:             test_recall0.5 █▄▃▂▄▅▂▂▁▂▂▅▃▂▂▃▃▃▂▃▂▄▅▆▃▂▃▅▄▄▄▆▅▇▃▅▃▂▅▃
wandb:            test_recall0.75 ▁▅▁▆▂▇▂▂▁▃▃▂▂▃▃▅▃▂▇▃▃▃▅▂▃▇▅▅▃▅▇▇▅▅▆█▆▅▇▆
wandb:                train_auroc ▁▄▅▅▅▆▆▅▆▆▇▇▇▇▇█████████████████████████
wandb:                 train_loss ▄▄▄▃▃▃▃▃▃▃▃▃▃▂▂▂▂▂▂▂▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▄▆▅▃▃▅▄▅▃▆▅▆▅▆█▆▅▄█▆▆▆▅▆▄▇▄▅▇▇▆▅▅▆▇▆▇█
wandb:            val_accuracy0.5 ▃▃▄▇▅▅█▇▆██▆▂▃▅▆▆▄█▄▅▄▅▄▁▅▅▅▆▅▅▆▅▇▆▇▅▅▅▅
wandb:           val_accuracy0.75 ▇▅▇▇▇▇▇▇▇▇▇▇▆▇▇▇█▆▁▅▅▅▃▄▅▅▅▅▂▃▃▂▃▁▃▁▅▁▁▅
wandb:                  val_auroc ▁▃▆▆▆▆▇██▇▇▇▇▇▇▄▆▆▆▆▆▆▆▅▅▆▄▆▅▆▆▅▅▅▅▄▅▅▅▅
wandb:  val_balanced_accuracy0.25 ▂▂█▁▄▆▃▄▃▇▆▄▅▃▆▅▂▅█▅█▇▇▆▅▅██▄▃▃▄▂▃▇▂▃▄▅▄
wandb:   val_balanced_accuracy0.5 ▇▃▄▆▁▂▅▅▆▆▅▆▅▆▅▅▃▅▄▄▄▄▄▅▆▄▇▆▇▄▇▆▅▆▄▇▇▅▇█
wandb:  val_balanced_accuracy0.75 ▃▂▂▂▃▄▃▄▃▄▄▄▆▆▄▅▆▇▇▆▆▇▆▇▅▆▆▆▅▅▁▆▆▇██▆▇▆▅
wandb:          val_precision0.25 ▂▂▃▃▃▃▁▂▄▄▃▃▅▄▅▅▃▂▆▃▃█▃▂▂▂▁▄▅▁▇▁▃▂▂▅▄▅▂▁
wandb:           val_precision0.5 ▃▃▁▃▃▃█▅▃▃▃▅▅█▃▃▅▃▃▃▃▄▃▃▃▃▃▃▄▄▃▄▃▃▃▃▃▃▃▄
wandb:          val_precision0.75 ▁▁▁▁▁▅▅▆██▄▆▅▆▅█▃▃▃▃▃▆▃▃▅▄▃▄▅▃▃▃▃▃▄▃▄▃▄▃
wandb:             val_recall0.25 █▇▆▇▄▄▁▆▄▆▄▃▃▇▅▄▄▄▄▂▄▄▂▂▂▄▂▄▄▄▄▄▄▂▅▄▄▃▄▅
wandb:              val_recall0.5 ▅█▂▃▁▃▁▂▅▅▄▃▃▄▄▄▃▅▅▃▇▃▃▃▄▅▃▆▃▆▃▆▅▆▃▆▅▅▅▆
wandb:             val_recall0.75 ▁▂▂▂▁▆▃▃▄▃▅▆▆▅▅▅▃▅▇▅▂▃▃▅▅▆▇▅▅▅▇█▃▆▇▅▆▅▅▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.55696
wandb:           test_accuracy0.5 0.58228
wandb:          test_accuracy0.75 0.56962
wandb:                 test_auroc 0.63178
wandb: test_balanced_accuracy0.25 0.63729
wandb:  test_balanced_accuracy0.5 0.60466
wandb: test_balanced_accuracy0.75 0.57966
wandb:         test_precision0.25 0.34043
wandb:          test_precision0.5 0.33333
wandb:         test_precision0.75 0.31579
wandb:            test_recall0.25 0.8
wandb:             test_recall0.5 0.65
wandb:            test_recall0.75 0.6
wandb:                train_auroc 0.99962
wandb:                 train_loss 0.06145
wandb:           val_accuracy0.25 0.42857
wandb:            val_accuracy0.5 0.47619
wandb:           val_accuracy0.75 0.55238
wandb:                  val_auroc 0.53944
wandb:  val_balanced_accuracy0.25 0.47833
wandb:   val_balanced_accuracy0.5 0.48418
wandb:  val_balanced_accuracy0.75 0.53481
wandb:          val_precision0.25 0.23438
wandb:           val_precision0.5 0.23636
wandb:          val_precision0.75 0.2766
wandb:             val_recall0.25 0.57692
wandb:              val_recall0.5 0.5
wandb:             val_recall0.75 0.5
wandb: 
wandb: 🚀 View run resnet18_2d_64_9_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/w6vh1nh6
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_9/wandb/run-20250618_155601-w6vh1nh6/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_9/wandb/run-20250618_163959-nt0p0s2f
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_9_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/nt0p0s2f
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading output.log; uploading config.yaml
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▄▃▃▇▆▃▃▅▅▆█▆▅▆▇▇▇▆▆▆▅▆▇▆▇▇▆▆▆▆▆▆▆▅▆▇▃
wandb:           test_accuracy0.5 █▁▇▇▂█▆██▆██▇▇█▇▇▇▇▆▆▅▂▇▇▆▆▆▇▆▅▇▇▅▅▆▆▅▅▅
wandb:          test_accuracy0.75 ██████▇███▇▇▆██▅▅▆▇▇▅▄▆▅▁▆▄▄▆▁▄▃▄█▃▇▇▄▅▆
wandb:                 test_auroc ▁▃▅█▇██▇▆▅▅▅▄▅▅▆▅▆▆▆▆▆▆▆▆▆▅▅▇▇▆▅▇▇▇▆▆▆▆▆
wandb: test_balanced_accuracy0.25 ▁▂▂▃▆▆▇█▄▃▄▆▄▄▄▅█▄▅▄▆▅▅▅▆▅▅▆▄▄▅▄▄▇▅▂▅▃▃▄
wandb:  test_balanced_accuracy0.5 ▃▃█▁▄▃█▄▂█▃▃▆▃▃▃▃▅▄▃▃▆▃▄▃▅█▂▅▅▂▅▄▅▅▄▅▅▄▄
wandb: test_balanced_accuracy0.75 ▂▂▂▂▂▂▁▁▅▁▂▃▁▄▃▂▃▃▂▁▂▃▅▅▄█▄▆▅▁▆▆▇█▂▅▇▇▇▅
wandb:         test_precision0.25 ▁▁▃▄▂█▆▃▄▄▅▄▃▃▃▅▆▃▆▃▄▃▄▄▃▄▄▃▄▃▄▄▅▄▄▅▄▄▂▃
wandb:          test_precision0.5 ▅▄█▅▅▅▁▁▄▄▄▄▄▆▄▃▄▄▄▄▄▄▄▄▄▅▄▄▃▄▄▃▄▄▄▄▃▄▄▄
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▇▁▁█▆▅▁▃▅▅▆▄▅▁▅▆▅▅▅▅▅▅▅▆▅▆▅▇▅▅▆▆▆
wandb:            test_recall0.25 ████▅▆▂▂▅▆▁▂▂▅▆▅▅▅▆▇▄▇▄▄▂▄▅▆▆▄▄▄▄▄▆▅▅▅▅▇
wandb:             test_recall0.5 ▇▆▂▂▄▁▁▄▁▁▁▂▂▂▃▃▂▄▄▂▂▃▄▄▃▂▅▄▄▄▃▄▄▄▄█▄▄▄▄
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▂▁▂▁▁▂▁▃▂▂▃▂▂▅▅▁▅▄▅▄▇▅▅▄█▅▇▅▆▆▆▆█
wandb:                train_auroc ▁▃▂▄▄▅▆▆▆▇▇▇████████████████████████████
wandb:                 train_loss ███▅▅▅▅▄▆▃▃▃▄▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▃▅▅▂█▆▇▃▅▆▅▅▆▅▅▆▄▄▆▆█▅▆▆█▆▃▅▅▆▅▅▆▆▆▆▆
wandb:            val_accuracy0.5 █▆▇▄▇▆▅▇█▇▆▆▇▅▆▃▁▅█▅▇█▅█▇▅▇▅▅▆▅▄▅▇▄▅▅▅▄▄
wandb:           val_accuracy0.75 ▇▇▇█▇▇▇▇▇▇▇▃▅▇▂▅▁▅█▅▇▅▃▄▅▇▅▆▅▄▆▇▇▆▆▂▇▂▆▂
wandb:                  val_auroc ██▇▄▄▅▃▅▅▅▁▇▃▅▄▆▅▆▅▆▅▅█▇▇▃▆▇▆▅▆▆▆▆▇▆▇▅▆▇
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▆▆▁▃▆▆▁▄▇▅▄▅▅▇▆▄▇▅█▇▅▆▆▆██▅▄▆▅▅▆▃▆▆▇
wandb:   val_balanced_accuracy0.5 ▁▆▇▂▁▃▅▄▄▄▃▃▅▃▄▆▅▃▄▇▅██▅▇▇▆▅▅▄▆▆▅▄▅▄▆▆▆▆
wandb:  val_balanced_accuracy0.75 ▂▂▃▄▄▄▅▃▃▆▄▁▂▇▄▆█▆▆▆█▆▇▄▇█▆▇▂▅▆▆▇▅▅▆▇▆▆▆
wandb:          val_precision0.25 ▂▂▂▂▅▃▂▂▃▂▃▇▄▃▃▂▁█▂▅▂▃▄▂▄▂▅▃▃▃▄▄▄▃▃▄▃▃▃▃
wandb:           val_precision0.5 ▂▂▃▂▃▃▃█▂▅██▃▂▂▂▁▇▂▂▆▂▄▂▃▃▂▂▁▄▃▅▃▂▅▃▃▃▇▁
wandb:          val_precision0.75 ▁▁▁█▆▃▆▅█▄▄▃▄▄▄▄▃▄▄▄▄▃▃▄▄▄▄▃▃▄▄▄▃▃▃▄▃▄▃▃
wandb:             val_recall0.25 ███████▂▂▃▃▅▁▃▅▃▅▃▅▃▄▄▄▄▆▃▄▄▆▅▄▃▄▄▄▃▃▄▇▄
wandb:              val_recall0.5 ▁█▃▅▁▂▃▄▃▂▃▃▄▇▃▄▃▄▄▄▅▅▃▄▇▅▄▅▄▄▆▇▅▅▄▄▄▄▅▄
wandb:             val_recall0.75 ▁▁▁▁▁▂▂▂▂▃▂▂▂▂▂▄▅▄▄▄▇▄▄▅▃▅▅▅▄▄▅▅▄▅▄█▄▄▅▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.51899
wandb:           test_accuracy0.5 0.55696
wandb:          test_accuracy0.75 0.55696
wandb:                 test_auroc 0.59915
wandb: test_balanced_accuracy0.25 0.61186
wandb:  test_balanced_accuracy0.5 0.60424
wandb: test_balanced_accuracy0.75 0.52161
wandb:         test_precision0.25 0.32
wandb:          test_precision0.5 0.32558
wandb:         test_precision0.75 0.27273
wandb:            test_recall0.25 0.8
wandb:             test_recall0.5 0.7
wandb:            test_recall0.75 0.45
wandb:                train_auroc 0.99906
wandb:                 train_loss 0.10507
wandb:           val_accuracy0.25 0.46667
wandb:            val_accuracy0.5 0.49524
wandb:           val_accuracy0.75 0.57143
wandb:                  val_auroc 0.58325
wandb:  val_balanced_accuracy0.25 0.54236
wandb:   val_balanced_accuracy0.5 0.52264
wandb:  val_balanced_accuracy0.75 0.57327
wandb:          val_precision0.25 0.27273
wandb:           val_precision0.5 0.26316
wandb:          val_precision0.75 0.30612
wandb:             val_recall0.25 0.69231
wandb:              val_recall0.5 0.57692
wandb:             val_recall0.75 0.57692
wandb: 
wandb: 🚀 View run resnet18_2d_64_9_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/nt0p0s2f
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_9/wandb/run-20250618_163959-nt0p0s2f/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_9/wandb/run-20250618_171853-tcuv9rqx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_9_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/tcuv9rqx
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▆▁▂▆▄▃█▅▆▆▇▆▆▇▅▇▇▇▆▆▇█▇▇█▆▇█▇▇▇▇▇▇▆▇▇▇▇
wandb:           test_accuracy0.5 ▁▅█▆█████▇███▇▇▇▆▆▇▆▇▅▆▆▆▇▅▄▆▇▆▆▆▇▇▇▆▆▆▆
wandb:          test_accuracy0.75 ▇▇▇█▇▇█▇▇▇▇▆▇▇▆▄▅▅▆▄▆▂▃▃▆▃▂▄▂▇▃▃▁▁▄▃▃▅▂▂
wandb:                 test_auroc ▁▅▄▅▆▇▇▇▇████▇▅▅▂▃▃▄▂▄▄▄▅▄▆▅▄▅▆▆▆▆█▇▆▇▆▆
wandb: test_balanced_accuracy0.25 ▂▂▂▃▃▇▇▇▄▂▂▃▃▂▅▂▄▂▄▆█▁▃▁▆▁▆▇▁▆▄▅▄▂▆█▂▄▁▇
wandb:  test_balanced_accuracy0.5 ▇▇▄█▆▅▆▄▇▃▆▃▃▃▁▄▁▁▂▂▃▃▆▂▄▄█▁▃▃▅█▆▂▇▇▃▆█▅
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▆▃▅▃▄▄▄▃▃▃▃▃▃▂▃▆▁▃▃▄▃▁▁▃▃▂▄▃▂▄▆▇▂▂█
wandb:         test_precision0.25 ▅▅▆▅▅▆▆▆▆▆▆▇█▅▄▅▄▅▃▆▆▃▆▅▅▆▇▅▆▅▆▅▆▅▅▁▆▆▅▅
wandb:          test_precision0.5 ▄▅█▇▇▇▆▆▄▅▄▅▅▃▄▁▃▄▃▃▂▃▃▃▄▄▁▄▃▁▁▄▁▄▃▄▂▃▂▄
wandb:         test_precision0.75 ▁▁▁▁▁██▁█▆▅▆▁▅▄▃▃▅▆▆▆▆▅▆▁▅▅▅▅▃▆▇▅▅▆▅▅▅▅▅
wandb:            test_recall0.25 ███▆▃▆▆▆▆▄▅▃▁▁▂▁▅▂▅▅▁▆▂▄▂▂▂▅▅▂▅▄▅▄▆▅▆▅▃▄
wandb:             test_recall0.5 █▁▃▅▂▁▁▂▁▁▁▂▁▁▁▁▂▅▂▂▂▁▁▅▁▄▂▅▅▅▂▄▄▄▁▂▄▁▅▅
wandb:            test_recall0.75 ▁▁▁▂▆▁▁▁▁▁▁▂▂▂▂▆▁▂▂▃▂▄▃▂▂▃▂▇▂▄▂▅▂▇▃▂▇▃▂█
wandb:                train_auroc ▁▃▅▅▆▆▇▇▇███████████████████████████████
wandb:                 train_loss ███▇▇▆▆▆▆▅▄▃▃▃▃▂▂▂▂▂▃▂▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▇▂▂▂▅▆▅█▇▅▆▄█▃██▆█▇▆▇▆▅▇█▅▇▆▆▄▇▇▆▅▆▇▄
wandb:            val_accuracy0.5 ▁█▇██▇▆▇▇▇██▇▄▇█▇▇▅█▇█▅▇▇▇▇▇█▇█▇▇▇▇█▇▇▇▇
wandb:           val_accuracy0.75 ▇▇▇▇▇█████▇▅██▇▅▅▅▅▃▇▄▅▅▅▅▁▅▆▃▃▅█▂▅▃▅▅▄▂
wandb:                  val_auroc ████▇▇▇▆▆▇▆▆▆▄▆▆▇▅▇▆▆▅▆▆▇▆▆▆▅▆▆▆▆▆▆▁▆▇▇▇
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▇▄▅▆▅▄▇▅▇▆▇▇▆▆█▅▇▅█▆▄█▅▇▆▅▅▆▅▁▆▇▅▅▇▆
wandb:   val_balanced_accuracy0.5 ▄█▆▆▁▄▄▄▂▁▆▃▃▄▄▇▄▁▆▆▇▇▅▇▅▄▅█▅▅▇▅▅▅▃▅▆▅▇▃
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▁▁▂▃▃▃▂▃▃▄▃▃▆▂▃▃▆▅▅▄▃▅▆▅▄▅▅▄▄▅▇▃█▆▆▆
wandb:          val_precision0.25 ▁▁▁▁▂▂▂▃▃▃▂▂█▄▇▆▄▆▅█▇▄▅▂▆▅▄▃▂▅▄▅▅▂▃▃▄▄▅▄
wandb:           val_precision0.5 ▂▄▄▃▃▃▁▄▄▃▄▃▄▅▂▃▃▄█▄▄▃▅▃▄▄▃▃▃▄▄▄▅▄▃▃▃▄▄▃
wandb:          val_precision0.75 ▁▁▁▅▃▅██▅▅▆█▆▅█▅▅▄▅▅▆▅▅▅▅▅▅█▅▅▄▅▅▅▄▆▅▅▅▅
wandb:             val_recall0.25 ███▇▆▆▅▄▃▆▅▂▄▄▃▃▃▅▄▄▆▄▄▃▄▆▃▄▂▄▄▄▄▁▆▃▃▄▄▄
wandb:              val_recall0.5 █▆▂▄▄▄▂▄▂▃▂▃▃▃▁▂█▃▆▄▄▅▆▃▆▇▆▃▆▅▇▇▅▃▄▅▆█▅▄
wandb:             val_recall0.75 ▁▁▁▁▁▂▁▂▂▂▅▂▂▂▄▂▃▄▄▆▃▆▄▆▅▅▅▅▇█▆▇▄▃▅▅▅▇▅▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.67089
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.67089
wandb:                 test_auroc 0.6322
wandb: test_balanced_accuracy0.25 0.61441
wandb:  test_balanced_accuracy0.5 0.55678
wandb: test_balanced_accuracy0.75 0.49873
wandb:         test_precision0.25 0.38462
wandb:          test_precision0.5 0.35294
wandb:         test_precision0.75 0.25
wandb:            test_recall0.25 0.5
wandb:             test_recall0.5 0.3
wandb:            test_recall0.75 0.15
wandb:                train_auroc 1
wandb:                 train_loss 0.04676
wandb:           val_accuracy0.25 0.65714
wandb:            val_accuracy0.5 0.67619
wandb:           val_accuracy0.75 0.67619
wandb:                  val_auroc 0.59299
wandb:  val_balanced_accuracy0.25 0.60443
wandb:   val_balanced_accuracy0.5 0.60419
wandb:  val_balanced_accuracy0.75 0.55258
wandb:          val_precision0.25 0.36111
wandb:           val_precision0.5 0.375
wandb:          val_precision0.75 0.33333
wandb:             val_recall0.25 0.5
wandb:              val_recall0.5 0.46154
wandb:             val_recall0.75 0.30769
wandb: 
wandb: 🚀 View run resnet18_2d_64_9_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/tcuv9rqx
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_9/wandb/run-20250618_171853-tcuv9rqx/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_9/execution_datetimes.json

**************************************************  Experiment 64 | Version 10 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 5}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 6}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 7}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_10/wandb/run-20250618_175956-5ei1z8t9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_10_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/5ei1z8t9
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▅▇▅▅▄▄▇█▃▅▅▇█▇█▅▇▇█▇██▇██▇▇▅▆███▇▆▇█
wandb:           test_accuracy0.5 ▁▅▁▇▇▂█▆▄▇▃▃▃▃▃▃▅▅▃▆▅▁▅▅▃▆▃▃▃▃▅▅▃▅▄▃▃▃▃▃
wandb:          test_accuracy0.75 ██████████████████▅▅▇▇▇▅█▅▄▅▄▄▄▁▅▂▄▄▄▁▁▂
wandb:                 test_auroc ▁▁▃▃▃▃▃▅▅▅▄▅▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇█████████▇█
wandb: test_balanced_accuracy0.25 ▂▁▂▅▆▅▅▅▄▆▄▆▅▇▄▅▇▆▇▆█▆▂▄▃▅▃▇▇▆▆▇▆█▆▇▅▂▂▆
wandb:  test_balanced_accuracy0.5 ▃▅▄▄▆▃▃▃▃▄▂▂▂▁▁▂▂▂▁▇▅▃▇█▂▃▃▂█▅▂▃▃▁▂▄▃▃▂▂
wandb: test_balanced_accuracy0.75 ▆▆▆█▆▆▆▆▆███▆▆▇▇▆▅▆▆▆█▇▆▅█▂▆▆▅█▁▄▃▄▁▃▅█▄
wandb:         test_precision0.25 ▃▃▃▄▄▄▃▇▆▄▅▅▆▅▄▅▆▆▆▅▆▇▅▆█▆▇▅█▇▆▅▆▆▆▆▆▆▅▁
wandb:          test_precision0.5 ▃▃█▃▄▃▃▃▅▂▂▅▃▃▂▂▃▄▁▂▃▃▃▃▃▄▃▃▃▃▃▃▂▃▃▃▄▄▃▂
wandb:         test_precision0.75 ▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▅▁▁▁▁▁▁▃▁▃▃▃▁▁▁▁▂▁▃▃▁▁▁
wandb:            test_recall0.25 ███▇▆▆▇▆▅▅▄█▅▅▃▃█▄▃▃▅▅▇▄▅▇▄▁▆▆▅▄▆▅▄▆▃▇▅▄
wandb:             test_recall0.5 ▅▁▄▁▁▁▁▁▁▁▁▆▁▁▁▁▂▂▁▁▂▁▁▂▂▂▂▂█▃▁▂▂▃▃▃▂▄▄▂
wandb:            test_recall0.75 ▁▁▁▁▂▁▁▁▁▂▁▂▂▁▁▁▂▁▁▁▂▂▁▁▁▁▁▁▁▂▂▁▅▁▁▂▁▅█▂
wandb:                train_auroc ▁▁▁▃▃▄▄▅▅▅▅▅▅▆▅▆▆▆▆▇▇▇▇▆▇▇██▇███████████
wandb:                 train_loss █▇▇▇▆▆▆▅▅▅▅▅▅▅▅▅▅▄▄▄▄▄▄▄▄▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▃█▃▂▇▆▅▇▆▇▇▂▇█▆▆▆█▇▃▃▇▅▅▆▂█▇▅▂▅▇▇▇▅▅
wandb:            val_accuracy0.5 ▁▁▄▂▆▂▆▇▇▇▇▅▄▆▆▆▇▆▇█▇▆▇▃█▇▅▅▆▂▅▆▆▇▅▆▆▆▆▇
wandb:           val_accuracy0.75 ▇▇▇▇▆▇▂▇▇▇▇▇█▆███▆█▅▅█▇█▅▆▆▅▆▁▇▇▇▅▇▅▆▆▅▄
wandb:                  val_auroc ▄▁▄▄▅▅▆▆▆▆▇▇▇▇████████▇█▇██▇██▇█▇██▇█▇██
wandb:  val_balanced_accuracy0.25 ▂▂▃▃▄▁▃▂▃▄▂▃▃▄▃▃▃▄▃▃▄▄▄▄▄▄▃▅▄▆▅▆▅▆▄█▆▄▅▁
wandb:   val_balanced_accuracy0.5 ▁▃▃▅▃▄▄▄▄▄▄▅▄▄▅▅▄▆▅▅▅▅▅▆▅▅▆▇▅▅▄▇▇▆▅▅▄▄▅█
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▂▂▁▁▂▂▂▃▂▃▃▃▃▄▄▅▄▄▄▄▅▃▅▄▆▆▆▅▆▅█▇▄▄▄▃
wandb:          val_precision0.25 ▁▁▁▂▄▂▃▂▂▁▃▃▂▂▂▃▃▃▃▃▃▂▃▃▄▄▃▄▂▂▇▃▄▁▅▆▅▇▁█
wandb:           val_precision0.5 ▂▂▁▁▂▁▁▁▂▂▂▃▃▃▂▃▃▂▂█▃▃▃▃▃▄▃▄▃▃▃▃▃▃▃▃▃▄▃▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▃▁▅█▅██████▄▆▅▄▄▄▅▅▃▄▄▅▄▄▄▃▄▄
wandb:             val_recall0.25 ████▇▇▅▁▅▂▆▁▁▇▁▃▂█▃▁▂█▁▃▃▅▃▁▃▃▅▃▃▄▃▆▂▃▄▃
wandb:              val_recall0.5 ▄▅▄▁▃▃▁▃▂▃▃▄▃▄▃▃▃▃▃▇▄▂▅▅▂▄▃▃▄▆▄▃▃▃▃▃▅██▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▃▁▃▃▃▃▃▃▃▃▃▄▆▃▄▃█▃▅▃▃▆▃▃▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.63291
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.67089
wandb:                 test_auroc 0.68814
wandb: test_balanced_accuracy0.25 0.60551
wandb:  test_balanced_accuracy0.5 0.60636
wandb: test_balanced_accuracy0.75 0.46568
wandb:         test_precision0.25 0.35484
wandb:          test_precision0.5 0.3913
wandb:         test_precision0.75 0.125
wandb:            test_recall0.25 0.55
wandb:             test_recall0.5 0.45
wandb:            test_recall0.75 0.05
wandb:                train_auroc 0.99684
wandb:                 train_loss 0.21201
wandb:           val_accuracy0.25 0.62857
wandb:            val_accuracy0.5 0.68571
wandb:           val_accuracy0.75 0.72381
wandb:                  val_auroc 0.59591
wandb:  val_balanced_accuracy0.25 0.63705
wandb:   val_balanced_accuracy0.5 0.58471
wandb:  val_balanced_accuracy0.75 0.57132
wandb:          val_precision0.25 0.3617
wandb:           val_precision0.5 0.37037
wandb:          val_precision0.75 0.41176
wandb:             val_recall0.25 0.65385
wandb:              val_recall0.5 0.38462
wandb:             val_recall0.75 0.26923
wandb: 
wandb: 🚀 View run resnet18_2d_64_10_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/5ei1z8t9
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_10/wandb/run-20250618_175956-5ei1z8t9/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_10/wandb/run-20250618_184856-csgytv14
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_10_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/csgytv14
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▂▂▃▃█▃▆▇▅▂▄▅▇▅▅▇▅▅▇▆▇▆▅▄▅█▅▆█▇▅▇█▇█▇
wandb:           test_accuracy0.5 ▂▁▅▇█▇█▇▇█▆▆▇▇▇▇▇▇▅▇▇▇▇▇▇▆▇▆▇▇▇▆▆▆▅▇▅▇▇▆
wandb:          test_accuracy0.75 ▆▆█▆▆█▆▅▅▅▅▅█▅▅▅▅▆▅▅▆▆▅▆▅▆▆▆▆▆▅▅▅▆▆▁▅▆▃▁
wandb:                 test_auroc ▁▁▂▄▆▇█▇██▇▇▇▇▇▇▇▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▇▇▇▆▆▆
wandb: test_balanced_accuracy0.25 ▁▁▁▁▂▂▁▅▄▅▅▃█▆▇▂▅▅▄▅▅▅▄▅▄▆▅▅▄▅▅▆▅▃▄▅▂▃▃▇
wandb:  test_balanced_accuracy0.5 ▁▄▄▃▅▃▄▁▁▄█▃▄▄▃▄▂▇▆▄▅▂▆▇▂▁▆▆▂▅▃▅▃▄▆▅▂▄▄▃
wandb: test_balanced_accuracy0.75 ▂▂▂▄▂▁▁▁▁▁▁▁▁▁▁▁▃▁▆▃▃▃▃▃▃▃▃▃▃▆▃▃▆▃▂▆▅▃█▃
wandb:         test_precision0.25 ▁▁▁▁▂▆▃▄▇▆▂▃▅▃▅▂▂▃▄▂▇█▂▄▆▆▂█▄▆▃▃▆█▅▆▅▄▆▅
wandb:          test_precision0.5 ▁▁▃▂▅▇▅▄██▃▃▂▄▄▃▄▅▂▄▅▃▄▃▂▃▃▄▂▄▃▂▃▃▃▁▂▂▂▂
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▆▁▅▆▁▆▆▅▅▆▆▅▆▅▆▆▅▆▅▆
wandb:            test_recall0.25 █████▆▅▇▃▇▅▆▆▅▆▅▆▅▆▆▅▅▅▆▁▆▅▆▆▄▅▄▂▄▄▄▄▄▇▃
wandb:             test_recall0.5 ▇▆▇▂▅▅▂▂▃▃▁▃▆▂▁▅▂▂▂▅▂▃▇▃▃▂▃▆▃▆▃█▂▂▃█▄▃▅▇
wandb:            test_recall0.75 ▁▁▁▁▁▄▁▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▅▂▂▅▄▂▂▄▅▂▂█▂▂
wandb:                train_auroc ▁▂▃▅▅▅▅▅▅▆▆▅▆▆▆▆▇▇▇▇█▇██████████████████
wandb:                 train_loss ██▇▆▆▅▅▅▅▅▄▄▄▄▄▄▄▄▃▃▃▃▃▃▃▂▂▃▂▂▂▁▁▂▂▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▂▅▅▆▆▆▇▆▆▇▄▆▅▇▆▆▅▆▇▇█▅▇▇▅▇▇▇▆██▄▅
wandb:            val_accuracy0.5 ▂▁▂▄▆▆▆▅▆▆▇▆▇▇▅▇█▇▆▆▇▇▇█▇█▇▆▅▇▇██▅▇▇▇▆█▇
wandb:           val_accuracy0.75 ▇▇▇▇▇▆▆▆█▆▆▆▇▇▆▇▆▆▅▆▆▅▃▆▄▆▆▆▃▆▁▅▄▃▅▆▆▄▃▄
wandb:                  val_auroc █▆▆▆▄▃▄▅▆▅▄▃▂▃▃▂▂▂▁▁▂▃▁▂▁▂▂▃▄▁▂▂▂▂▅▂▂▂▃▂
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▅▄▅▇█▃▅▁▆▄▁▁▁▃▅▄▂▃▅▅▄▂▆▄▅▃▄▄▇▃▅▅▆█▆
wandb:   val_balanced_accuracy0.5 ▃▆▅▆▆▅▆▂▂▁▆▆▆▄▇▅▇▅▅▇▇▇▆▆▅▅▆▇▇▅▇▇▇▇█▇██▇▇
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▂▂▁▂▄▄▄▄▄▅▄▄▄▄▄▆▇▄▅▆▆▅▅▄▅▄▇▄▆▅▅▅█▇▄▆
wandb:          val_precision0.25 ▂▂▂▂▆▄▃▃▃▂▃▁▃▁▃▃▃▂▃▃▂▂▄▄▆▂▂▄▅▂▇▄█▃▄▅▅▃█▆
wandb:           val_precision0.5 ▅▅▅▁▄▂▃▆▂▅▆▆▆█▇▇▇▇▆▆█▅▅▆▅▅▆▇▇▆▅▅▅▆▇▆▇▆▆▇
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▅▅▅▄█▄█▄▅▅▄▄▄▄▄▄▅▄▅▄▄▃▄▄▄▄▃▄▄▃▄▄
wandb:             val_recall0.25 ████▇▃▂▅▃▃▄▄▄▂▁▁▁▅▂▂▃▃▁▃▃▁▁▁▂▂▁▂▂▂▁▁▂▂▁▂
wandb:              val_recall0.5 █▆▆▃▄▁▄▁▁▂▁▂▄▂▃▃▃▃▂▃▃▄▃▃▃▄▂▃▃▃▄▂▆▄▄▆▃▄▆▄
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂▃▂▂▂▂▄▃▃▂▂▄▅▃▃▄▅▅▅▅▃█▆▃▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.6962
wandb:           test_accuracy0.5 0.70886
wandb:          test_accuracy0.75 0.70886
wandb:                 test_auroc 0.64407
wandb: test_balanced_accuracy0.25 0.58178
wandb:  test_balanced_accuracy0.5 0.5572
wandb: test_balanced_accuracy0.75 0.4911
wandb:         test_precision0.25 0.38889
wandb:          test_precision0.5 0.38462
wandb:         test_precision0.75 0.2
wandb:            test_recall0.25 0.35
wandb:             test_recall0.5 0.25
wandb:            test_recall0.75 0.05
wandb:                train_auroc 0.99924
wandb:                 train_loss 0.1207
wandb:           val_accuracy0.25 0.67619
wandb:            val_accuracy0.5 0.71429
wandb:           val_accuracy0.75 0.72381
wandb:                  val_auroc 0.53603
wandb:  val_balanced_accuracy0.25 0.57838
wandb:   val_balanced_accuracy0.5 0.5779
wandb:  val_balanced_accuracy0.75 0.58423
wandb:          val_precision0.25 0.35714
wandb:           val_precision0.5 0.4
wandb:          val_precision0.75 0.42105
wandb:             val_recall0.25 0.38462
wandb:              val_recall0.5 0.30769
wandb:             val_recall0.75 0.30769
wandb: 
wandb: 🚀 View run resnet18_2d_64_10_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/csgytv14
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_10/wandb/run-20250618_184856-csgytv14/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_10/wandb/run-20250618_193952-fkjtgyzv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_10_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/fkjtgyzv
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▄▅▆▇▇▆▆▆▅█▅█▅▅▆▇▆▆▇▆▄▇▇▅█▇▇▆▇█▆▇▇▅▇▇█▆▇
wandb:           test_accuracy0.5 ▂▇▃▆█▇▆██▇▇▇▅▄█▇▅▇▇▇▇▇▄▇▄▇▆▄▇▆▄▄▄▄▄▄▁▄▄▅
wandb:          test_accuracy0.75 ██████▇▇▇▇▇▇▇▇▇▇▇▇█▇█▅▇▇▅▅▅▇▅▇▇▅▆▅▇▁▇▁▅▂
wandb:                 test_auroc ▁▂▂▃▄███▇█▇▇█▆▆▃▄▄▄▃▄▄▃▂▂▃▃▂▃▃▃▄▄▄▄▄▄▄▄▃
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▇▆█▇▇▆▇▆█▆▅▃▄▅▃▄▅▂▄▅▃▂▁█▂▅▂▃▆▆▁▅▆▅▅
wandb:  test_balanced_accuracy0.5 ▄▅▇█▅▅▅▄▂▃▂▁▃▂▂▃▃▁▁▁▂▁▆▄▂▁▁▁▁▃▂▂▂▁▁▆▃▄▃▄
wandb: test_balanced_accuracy0.75 ▆▆█▆▇▅▆▅▅▅▅▅▅▅▅▅▇▅▇▇▅▆▇▇▇▅▆▇▄▅▄▅▄▆▆▅▅▄▄▁
wandb:         test_precision0.25 ▄▄▄▄▄▅▅▇▆▅▇▇██▇▆█▇▇▄▅▅▆█▃▆▄▆▄▆▆▆▆▁▆▇▇▇▆▆
wandb:          test_precision0.5 ▂▂▃▂▇▅▅▅▆▅▅█▇▃▃▇▇▄▅▃▂▂▂▃▂▂▁▂▁▃▂▃▁▂▂▂▂▃▃▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▆█▁▁▁▁▅▆▆▁▁▅▄▅▃▁▅▅▃▅▃▅▄▁▁▅▃▄▃▃▃
wandb:            test_recall0.25 ██▇▇▆▇▆▇▇▇▇▆▄▁▅▆▇▆▃▅▄▄▅▃▇▁▃▅▂▅▆▁▄▃▅▂▄▅▅▆
wandb:             test_recall0.5 █▅▄▁▃▅▁▂▃▁▂▁▃▃▂▂▅▃▁▁▁▅▁▁▂▃▅▁▂▁▂▂▅▆▅▂▅▅▅▇
wandb:            test_recall0.75 ▁▁▁▁▁▁█▃▁▁▁▁▁▁▆▃▁▁▃▁▃▁▁▆▃▃▁▆▃▃▃▃▃▆▆▁▆▆▆▃
wandb:                train_auroc ▁▅▅▅▅▆▆▆▆▆▆▇▆▆▇▇▇▇▇▇▇▇██████████████████
wandb:                 train_loss ████▇▆▅▅▅▅▄▄▄▄▄▄▄▄▄▄▃▃▃▃▂▂▂▂▂▂▂▁▂▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▃▅▃▅▅▆▆▃▅▄▄▇▆▇▄▅▇▆▅▂▆▇▆▇▇▅▅▆▇▆██▅▄▆
wandb:            val_accuracy0.5 ▆▇▇▇▆▆▅▆█▂▆▆▃▂█▆▅▇▇█▅▇▇▃▄█▄▇█▆▅▂▅▇▄▅▁█▅▇
wandb:           val_accuracy0.75 ▇▆▆▄▆▆▆██▆█▇▆▆█▇▇▇█▇▇▃▇▇▆▇▆▇▆▆▆▆▇▆▁▆▇▆▂▁
wandb:                  val_auroc ▂▃▆█▇▆▅▃▄▃▃▄▄▃▃▁▂▁▁▂▁▁▁▁▂▁▁▂▁▂▃▃▂▃▂▂▂▂▂▂
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▄▃▅▄▄▅▅▅▆▅▄▄▄▄▄▄▄▆▄▃▇█▆▇▃▆▆▆▅█▇▃▅▅█
wandb:   val_balanced_accuracy0.5 ▄▅▁▃▂▃▂▂▂▃▂▄▃▃▄▄▃▄▄▃▃▄▃▃▄▃▃▃▆▇▅▂▅█▆▃█▇▆▄
wandb:  val_balanced_accuracy0.75 ▂▂▁▁▁▃▃▃▄▄▄▃▄▇▄▄▄▆▄▆▇▄▆▆▅▆▆▆▅▇▆▅▇▆▅▅▄█▆▇
wandb:          val_precision0.25 ▁▁▁▁▁▃▄▃▄▃▃▃▄▃▂▂▂▆▂▄▄▄▁▄▂▂▆▆▆▇█▆▂▃█▅▄▂▃▆
wandb:           val_precision0.5 ▆▆▄▅▃▄▁▅▄▂▄▄▃▃▇▅█▅▆▃▄▆▆▂█▃▅▆▅▅▅▆▅▆▅▅▄▇▃▇
wandb:          val_precision0.75 ▁▁▁▁▆▅▅▆▅▆██▅▆▅▅█▆▅▅▆▅▅▅▆▅▆▅▆▇▆▅▆▅▆▅▅▄▆▆
wandb:             val_recall0.25 █████▇▇▆█▇▂▆▅▅▅▄▄▇▆▆▁▄▄▃▃▄▄▄▄▄▁▄▄▅▃▄▃▄▄▄
wandb:              val_recall0.5 ▁██▆▄▃▄▂▄▄▄▅▄▄▄▄▅▄▄▄▃▇▃▇▇▇▇▃▅▃▆▄█▇▆▃▂▄██
wandb:             val_recall0.75 ▁▁▁▁▁▄▃▁▄▃▂▂▃▃▃▃▆▄▄▄▄▄▅▅▆▄▄▄▇▇▄▆▅▄▄▃▅█▆▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.63291
wandb:           test_accuracy0.5 0.64557
wandb:          test_accuracy0.75 0.72152
wandb:                 test_auroc 0.58559
wandb: test_balanced_accuracy0.25 0.52288
wandb:  test_balanced_accuracy0.5 0.46525
wandb: test_balanced_accuracy0.75 0.49958
wandb:         test_precision0.25 0.28571
wandb:          test_precision0.5 0.16667
wandb:         test_precision0.75 0.25
wandb:            test_recall0.25 0.3
wandb:             test_recall0.5 0.1
wandb:            test_recall0.75 0.05
wandb:                train_auroc 0.99976
wandb:                 train_loss 0.09181
wandb:           val_accuracy0.25 0.72381
wandb:            val_accuracy0.5 0.73333
wandb:           val_accuracy0.75 0.7619
wandb:                  val_auroc 0.59177
wandb:  val_balanced_accuracy0.25 0.63583
wandb:   val_balanced_accuracy0.5 0.55185
wandb:  val_balanced_accuracy0.75 0.57084
wandb:          val_precision0.25 0.44444
wandb:           val_precision0.5 0.41667
wandb:          val_precision0.75 0.55556
wandb:             val_recall0.25 0.46154
wandb:              val_recall0.5 0.19231
wandb:             val_recall0.75 0.19231
wandb: 
wandb: 🚀 View run resnet18_2d_64_10_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/fkjtgyzv
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_10/wandb/run-20250618_193952-fkjtgyzv/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_10/execution_datetimes.json

**************************************************  Experiment 64 | Version 11 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 19, 1.0: 9}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 16, 1.0: 12}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 13, 1.0: 19}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 11, 1.0: 17}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_11/wandb/run-20250618_203337-38pk8f26
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_11_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/38pk8f26
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▂▃▂▂▄█▄▄▃▅▄▇▅▇▆█▅█▇▇▄▆▇▄▄▅▄▇▇▇█▇█
wandb:           test_accuracy0.5 ▃▇▃▇▅▇▇▇█▁▇▇▆▇▅▄▆▅▆▅▄▆▃▅▄▅▄▅▃▅▄▅▅▅▅▄▃▅▅▃
wandb:          test_accuracy0.75 ▇▇▇▇▇█▇▇█▇███▇█▇█▇█▇███▇▇▇▇▇▇▇▇▇▅▁▇▇▅▄▇▆
wandb:                 test_auroc ▁▁▁▂▅▅▅▅▅▅▇▇█▇▇▇█▇▇▇▇▇▇▇▇▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb: test_balanced_accuracy0.25 ▃▃▃▂▁▁▂▂▂▃▃▄▄▃▄▅▄▆▄▅▇▇▇▄▅▄▇▄▆▂▆▁▂█▁▂██▇▇
wandb:  test_balanced_accuracy0.5 ▂▃▄▇▇▇▇█▆█▇▆▆▆▇▄▄▅▄▄▄▄▄▃▃▃▄▃▃▃▃▃▁▃▁▃▃▃▂▂
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃█▃███▃█████▃▆▃▃█▃▆▆▆▃▁▃▃▆▅▃▆▆▆▅▁▃▁
wandb:         test_precision0.25 ▄▄▃▃▄▄▄▄▅▅▆▅█▅▄▅▅▇▇▄█▇▆▅▆▆▆▅▂▄▅▆▂▇█▇█▇▁▂
wandb:          test_precision0.5 ▂▂▂▄▃▄▅▄▄▄▃█▃▃▃▂▃▃▃▃▂▃▂▄▂▂▂▂▁▂▂▄▂▂▂▂▁▁▂▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁██▁▁▅▅▁▅▅▅▅▅▃▁▅▅▁▂▂▁▃▁▁▁▃▃▅▃▃▃
wandb:            test_recall0.25 ████▇▇▆▆▆▇▇▅▆▇▆▇▇▇▆▅▃▇█▇▆▃▄▄▇▆██▃▃▇▅▁▆▆▂
wandb:             test_recall0.5 ██▇▅▆▄▇▆▆▆▃▇▂▅▃▃▃▁▃▆▃▂▅▅▂▁▃▂▁▂▂▂▂▁▁▄▂▂▂▁
wandb:            test_recall0.75 ▁▁▁▁▃▁▃▆▁▁▃▃▃▃▁▃▃▁▃▃▁▁▃▁▁▃▃▃▃▁▁▁█▃▁▃▆▁▃▃
wandb:                train_auroc ▁▄▄▅▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▇▇████████████
wandb:                 train_loss ███▇▆▆▆▅▅▄▅▄▄▄▄▄▄▄▃▃▃▃▃▃▃▃▂▂▂▃▂▂▂▂▂▂▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▂▃▃▄▅▄▄▄▆▄▄▆▄▆▅▇▄█▄█▅█▅▆▅▃█▆▆▇▆▆▄▆▅▄
wandb:            val_accuracy0.5 ▁▄▃▂▃▄▄▄▄▄▆▆▄▅▅▆▇▆▆▆▆▆█▇▆▅▆▇█▇▇▇▇▇█▇▇▆▇▄
wandb:           val_accuracy0.75 ▆▆▆▆▅▅▁▅▅▃▄▅▅▅▆▆▆▆▄▆▅▅▆▆▆▇▆▅▆█▅▆▆▆▆▆▆▇▂▄
wandb:                  val_auroc ▁▁▂▄▆▆▆▆▆▆▆▆▆▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇█▇██▇█████
wandb:  val_balanced_accuracy0.25 ▁▁▂▂▂▃▅▅▅▅▅▅▅▄█▅▃▃▂▅▅▆▃▅▄▄▃▃▂▄▂▂▃▂▂▄▅▂▃▇
wandb:   val_balanced_accuracy0.5 ▂▁▂▆▃▆▃▃▃▃▅▄▄▅▅▅▆▆▆▆▅▇▆▆█▆▇▇█▆▇▆▇▆▆█▇▇█▇
wandb:  val_balanced_accuracy0.75 ▂▂▁▂▂▂▁▂▂▃▃▃▂▂▃▂▂▃▃▅▂▃▃▃▂▃▄▄▇▅▇▇▅▄▄▄▄▅▅█
wandb:          val_precision0.25 ▁▁▁▂▂▁▂▁▃▄▅▅▃▄▄▁▄▄▃▅▃▅▄▅▃▄▆▃▄▅▃▁▅█▅▄▇▆▄▇
wandb:           val_precision0.5 ▃▂▁▂▂▃▃▃▃▃▄▃▅▃▄▄▄▅▅▅█▅▅▇▆▅▆▅▇▇▄▅▄▆▅▆▄▆▆▄
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▂▃▃▃▂▃█▃▅▅▄▄▅▄▄▅█▄▄▄█▅▄▅
wandb:             val_recall0.25 ████▇▇▆▆▆▆▄██▆▆█▄▄▄▃▂▃▄▆▂▃▃▃▅▁▄▅▁▄▆▄▄▁▆▅
wandb:              val_recall0.5 █▁▂▃▃▃▁▂▃▃▂▂▂▂▂▁▂▃▃▃▂▂▂▃▃▃▃▂▂▃▂▃▂▂▂▃▂▃▃▂
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▂▂▂▂▄▂▁▄▄▂▂▂▂▂▂█▇▄▄█▄█▄▇█▇▅▄▇▄
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.44304
wandb:           test_accuracy0.5 0.58228
wandb:          test_accuracy0.75 0.68354
wandb:                 test_auroc 0.59576
wandb: test_balanced_accuracy0.25 0.57754
wandb:  test_balanced_accuracy0.5 0.50551
wandb: test_balanced_accuracy0.75 0.49068
wandb:         test_precision0.25 0.2931
wandb:          test_precision0.5 0.25926
wandb:         test_precision0.75 0.22222
wandb:            test_recall0.25 0.85
wandb:             test_recall0.5 0.35
wandb:            test_recall0.75 0.1
wandb:                train_auroc 0.96707
wandb:                 train_loss 0.74876
wandb:           val_accuracy0.25 0.4
wandb:            val_accuracy0.5 0.59048
wandb:           val_accuracy0.75 0.72381
wandb:                  val_auroc 0.57011
wandb:  val_balanced_accuracy0.25 0.53676
wandb:   val_balanced_accuracy0.5 0.52142
wandb:  val_balanced_accuracy0.75 0.57132
wandb:          val_precision0.25 0.26582
wandb:           val_precision0.5 0.27027
wandb:          val_precision0.75 0.41176
wandb:             val_recall0.25 0.80769
wandb:              val_recall0.5 0.38462
wandb:             val_recall0.75 0.26923
wandb: 
wandb: 🚀 View run resnet18_2d_64_11_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/38pk8f26
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_11/wandb/run-20250618_203337-38pk8f26/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_11/wandb/run-20250618_212527-yxm0idc2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_11_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/yxm0idc2
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▃▂▂▂▂▆▆▃▇▇▇▅▅▆▅▄▇█▇▄▆▄▆▇▃▆▆▅▄▇▆█▆▇▇
wandb:           test_accuracy0.5 █▃▁▄▃▃▄▄█▆█▆▇██▇████▆▇▇█▇▇▇█▇▇▇▆▇▆▅██▇█▇
wandb:          test_accuracy0.75 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▃▃▃▃▃█▃▆▃▃▁▃▃▃▃▃▆▃▆▆▆▆▃▆▆▆
wandb:                 test_auroc ▁▁▁▂▂▃▃▃▃▄▆▆▆▆██████▇█▇▇▇▇▇▇▇▇▆▆▇▆▇▆▆▆▆▆
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▂▆▂▂▅▆▃▆▇▂▇▅▆▄█▇█▇█▃▄▃▇▅▆▅▆▁▂▄▄▅▂
wandb:  test_balanced_accuracy0.5 ▁▁▁▄▂▁▆▅▇▆▆█▁▆▁▅▇▅▄▅█▆▄▂▂▂▂▂▅▂▁▄▂▁▂▂▂▅▄▂
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▁▁▃▁▁▁▁▁▁▁▁▃▁▁▁▁▆▆▆█▆▆▆▆▆▆▆▆▆▅
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▂▁▂▅▅▃▅▂▃▇▇▄▃▄█▂█▄▄▅▅▄▃▃▆▄▄▅▃▅
wandb:          test_precision0.5 ▁▃▄▃▃▆▄▅▅▅▄▅▅▆█▅▆▆▆▆▆▅▅▅▄▆▄▄▆▃▃▄▄▆▄▃▃▄▄▄
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁██▁████▁█▅█▆▆██▅
wandb:            test_recall0.25 █████████▇▇█▅▆▆▆▄▃▇▄▇▇▇▃▅▇▆▇▂▅▃▅▃▁▄▃▃▃▅▃
wandb:             test_recall0.5 █▆▆▆▆▆▆▅▄▃▃▅▅▄▁▄▃▃▂▅▂▂▃▃▄▄▂▇▂▂▃▆▂▄▃▃▂▄▃▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▃▃▁▁▁▁▃▃▁▁▃▃▃▃▃▃▃▃▃▃▃▃
wandb:                train_auroc ▁▁▁▁▂▄▄▅▄▅▆▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇███████████
wandb:                 train_loss ███▇█▇▅▅▅▅▄▄▄▄▄▄▄▄▄▃▄▃▃▃▃▃▃▃▃▃▂▃▂▂▂▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▄▁▃▃▄█▇▄▅▃▆▄▆▃▅█▄█▇▄▄▄▆▇▇▆▆▅▆▇▄▆▅
wandb:            val_accuracy0.5 █▇▁▃▄▆▆▇█▆▇▇▇▇▇▆▇▇▇▇▅▇▇▇▇▇▇█▆▆▇▇▆▇▇█▅▆▆▅
wandb:           val_accuracy0.75 ▆▆▆▆▆▇▇▇▇▇█▅██▅▃▇█▄▅▄▅▅▄▃▄▄▃▄▆▂▃▄▂▁▃▃▃▄▄
wandb:                  val_auroc ██▇▇▇▆▆▇▆▆▅▆▃▂▃▁▂▂▁▂▂▂▂▂▂▂▂▁▂▂▂▂▂▂▂▂▂▃▃▂
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▂▂▅█▇▇▃▂▇▇▇▅▅▆▁▆▃▄▆▁▅▅▄▄▆▅█▄▇▇▆
wandb:   val_balanced_accuracy0.5 ▄▇▅▆▇▆▃▁▅▆▃▄▃▆▄▆▄▅▅▅▆▃▅▅▄▃▆▅▅▅▅▅▅▅▅▆▅▇▅█
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▂▁▁▃▃▄▄▃▂▄▄▂▃▃▂▄▃▄▄▂▅▄▃▂▃▄▅▅▄▄▂▃▄█▂
wandb:          val_precision0.25 ▂▂▂▂▂▂▂▂▂▂▂▃▂▂▃▄▂▁▄▁▄▃▂▃▄▃▂▁▄▃▃▃▄▃█▂▅▃▃▄
wandb:           val_precision0.5 ▃▃▃▃▄▄▁▂▄▃▄▄▆▄▃▃▅▅▃▆▄▄▄▄▄▄▄▆▅▃▅▅▄▅▆▆▆▆▅█
wandb:          val_precision0.75 ▁▁▁▁▁██▅▅█▄▄██▃██▄▄▃▃▆▆▃▄▄▄▄▄▄▃▄▄▄▄▄▄▄▄▃
wandb:             val_recall0.25 █████████▇▄▅▄▂▄▇▆▃▃▃▄▁▄▄▄▄▄▅▄▃▂▃▄▂▄▃▂▄▃▃
wandb:              val_recall0.5 █▆▇▆▆▅▁▃▁▃▂▁▅▁▂▁▃▂▃▁▁▃▁▂▃▁▂▂▂▃▅▁▅▂▂▄▂▃▃▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▂▂▃▂▃▃▅▃▃▅▅▅▅▅▅▅▅▅▅▅▅▆█▃▆▅▆▃▃▆▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.64557
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.61186
wandb: test_balanced_accuracy0.25 0.59746
wandb:  test_balanced_accuracy0.5 0.47415
wandb: test_balanced_accuracy0.75 0.51653
wandb:         test_precision0.25 0.35714
wandb:          test_precision0.5 0.14286
wandb:         test_precision0.75 0.5
wandb:            test_recall0.25 0.5
wandb:             test_recall0.5 0.05
wandb:            test_recall0.75 0.05
wandb:                train_auroc 0.99419
wandb:                 train_loss 0.39567
wandb:           val_accuracy0.25 0.6381
wandb:            val_accuracy0.5 0.73333
wandb:           val_accuracy0.75 0.73333
wandb:                  val_auroc 0.5594
wandb:  val_balanced_accuracy0.25 0.59177
wandb:   val_balanced_accuracy0.5 0.60346
wandb:  val_balanced_accuracy0.75 0.53895
wandb:          val_precision0.25 0.34211
wandb:           val_precision0.5 0.45
wandb:          val_precision0.75 0.4
wandb:             val_recall0.25 0.5
wandb:              val_recall0.5 0.34615
wandb:             val_recall0.75 0.15385
wandb: 
wandb: 🚀 View run resnet18_2d_64_11_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/yxm0idc2
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_11/wandb/run-20250618_212527-yxm0idc2/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_11/wandb/run-20250618_222146-gtyj0ikg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_11_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/gtyj0ikg
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▄▄▃▅▅▅▇▆▆▆▆▇▃▇▇▇▇█▇▆▅▆▆▇▆██▇▆▇▇▇▇
wandb:           test_accuracy0.5 ▆▁▆▅▆▇███████▇████▇█▇▆█▇█▇▇▇▇▇▆▆▆▅▇▇▅▆▇▇
wandb:          test_accuracy0.75 ▅▅▅▅█▅▅▅▅▅▅▅▅▁▁▁▁▅▅▁▁▁▅▅▁▅▅▁▅▁▁▅▁▅▁▅▁▅▅▅
wandb:                 test_auroc ▁▃▃▃▃▅▅▅▅▇▇▇▇▇▇█▇▇████▇▇▇█▇█▇▇▆▆▆▆▆▆▆▆▆▅
wandb: test_balanced_accuracy0.25 ▂▂▂▂▁▁▂▃▂▃▅▄▃▆▆▅▃▄▇▆▆▅▄▄▆▄▅█▇▇▇█▇▇▇▅▅▂▅▄
wandb:  test_balanced_accuracy0.5 ▁▂▁▄▆▇▆▅▆▅▅▅█▅▅▆▆▇▇▅▅▅▄▆▆▃▅▃▄▅▂▅▃▄▅▃▄▃▄▄
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▃█▁▁▁▁█▃▁▁█▁▁▃█▁▁█▁██████
wandb:         test_precision0.25 ▂▂▂▂▁▁▁▂▃▃▂▂▄▄▃▄▅█▃▅▅▇▂▄▅▅▃▅▄▃▃▅▅▄▃▄▃▅▃▅
wandb:          test_precision0.5 ▄▄▄▄▄█▅▅▆▆▇▇▇▆███▆▅▆▇▄▆█▆▅▅▁▆▆▅▆▅▅▅▆▄▆▆▄
wandb:         test_precision0.75 ▁▁▁▁▁█▁▅▁▁▁▁▁▁▁▁▆▁▁▁▁▁▆▁▁▁▁▅▅▅▅▅▁▅▁▅▅▅▅▅
wandb:            test_recall0.25 ███▇▇█▅▇▅▇▆▆▅▆▃▅▆▅▅▃▇▅▅▅▆▃▃▆▅▃▁▂▃▃▆▆▃▆▄▅
wandb:             test_recall0.5 ██▆██▅▅█▅▅▄▄▆▃▃▃▄▄▃▄▇▂▂▂▃▃▃▁▁▃▃▃▄▂▂▄▁▅▃▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▅▁▁▁█▁▁▁▁▁▁▁▅▁▅▁▅▅▁▅▁▅▅▅▅▅▅▅▅
wandb:                train_auroc ▁▄▄▄▅▅▅▅▅▅▅▆▆▆▅▆▆▆▆▆▆▆▆▆▆▆▇▇▇▇▇▇▇▇██████
wandb:                 train_loss ███▇▆▆▅▆▆▅▅▅▅▅▅▅▅▄▄▄▄▄▄▄▃▃▃▃▃▃▃▂▂▂▂▂▂▂▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▂▁▃▄▄▄▆▆▆▆▇▆▇▆▆▇▅▄▇▆█▅▆▅▅▇▅█▆█▇▆
wandb:            val_accuracy0.5 ▁▆▆▆▇████▇▆▇█▇▇▇▆▇▇▇▇▇█▇▇▇▇█▇▇█▇▇▇▇▇▇▆▇▇
wandb:           val_accuracy0.75 ▇▇▇▇▇▆▆▅▅▅▅▅▆▆▆▆▆▆█▇▁█▇▆▆▇█████▆█▇▅▅▂▇▇▇
wandb:                  val_auroc ▆▅▆▇▇██▇▇▆▆▆▆▅▅▅▆▅▄▄▃▃▂▂▂▃▃▄▃▃▂▂▃▂▂▂▂▂▂▁
wandb:  val_balanced_accuracy0.25 ▂▂▂▁▁▂▂▄▇▆██▇▆▇▅▆▅█▆▇▃▆▆▂▅▃▅▅▅▄▄▂▃▄▆▅▃▆▄
wandb:   val_balanced_accuracy0.5 ▁▇▇█▆██▅▆▄▂▂▁▃▃▁▃▄▃▂▃▂▃▅▄▂▃▂▃▄▄▂▅▃▂▃▂▄▄▃
wandb:  val_balanced_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▃▂▁▁▆▁▆▇▅▅▅▆▅▆▇▇▅▇▇▇▇▇▆▇▇▅▅██▇
wandb:          val_precision0.25 ▁▁▁▁▁▅▅▅▄▅▆▃▆▇█▃▆▆▅▅▃▄▄▂▃▄▄▄▅▅▅▇▄▃▅▇▇▄▅█
wandb:           val_precision0.5 ▃▂▃▃▃▄▄▄▂▂▂▂▂▁▂▁▂▂▂▂▃▂▄▂▇▅▂▂▂█▃▂▂▃▃▃▂▂▃▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▆▅▁▅▁▁▅▅█▆██▆▆█▅▅████▅█▆█▅█▅▅▅
wandb:             val_recall0.25 █████▇▇▇██▆▇▇▇▆▅▇▅▆▄▆▆▄▃▃▁▅▅▁▃▂▁▅▃▂▃▃▃▅▄
wandb:              val_recall0.5 ▆█▇▆▆▅▅▄▄▃▅▄▃▂▄▂▃▃▃▂▂▂▄▂▂▂▂▃▃▄▃▄▁▄▄▃▄▃▃▄
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▄▄▄▁▁▄▄▂▄▄▄▅▄▅▂▄▂▄▄▄▂▄█▄▄▂▄▂▄▂▄▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.67089
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.73418
wandb:                 test_auroc 0.59746
wandb: test_balanced_accuracy0.25 0.56483
wandb:  test_balanced_accuracy0.5 0.51653
wandb: test_balanced_accuracy0.75 0.49153
wandb:         test_precision0.25 0.35
wandb:          test_precision0.5 0.5
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.35
wandb:             test_recall0.5 0.05
wandb:            test_recall0.75 0
wandb:                train_auroc 0.99419
wandb:                 train_loss 0.46991
wandb:           val_accuracy0.25 0.67619
wandb:            val_accuracy0.5 0.68571
wandb:           val_accuracy0.75 0.7619
wandb:                  val_auroc 0.57863
wandb:  val_balanced_accuracy0.25 0.55258
wandb:   val_balanced_accuracy0.5 0.4944
wandb:  val_balanced_accuracy0.75 0.53213
wandb:          val_precision0.25 0.33333
wandb:           val_precision0.5 0.23077
wandb:          val_precision0.75 0.66667
wandb:             val_recall0.25 0.30769
wandb:              val_recall0.5 0.11538
wandb:             val_recall0.75 0.07692
wandb: 
wandb: 🚀 View run resnet18_2d_64_11_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/gtyj0ikg
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_11/wandb/run-20250618_222146-gtyj0ikg/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_11/execution_datetimes.json

**************************************************  Experiment 64 | Version 12 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 36, 1.0: 28}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 32, 1.0: 32}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 27, 1.0: 37}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 26, 1.0: 34}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_12/wandb/run-20250618_230804-fnjb4ri2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_12_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/fnjb4ri2
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▃▁▁▂▂▇▂▆▆▆█▇▇▇▇▇▇██▇▇▇▆█▇██▇██▆█
wandb:           test_accuracy0.5 ▁▆▇▅▅▅▄▆▆▆▇▇█▇▇█▇█▇▇▇▇▇▇▇▇▇▇▇█▇▇▇▇▇▇█▇▆█
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁█████▁█▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▂▁▁▁▃▃▄▄▆▆▆▇█▇██▇█▇█████▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆
wandb: test_balanced_accuracy0.25 ▂▂▂▂▂▁▂▂▂▁▁▂▅▅▇▅▆▅▅▆█▆▇▇▃▇▃▆▆▆▆▄▆▆▅▅▆▅▇▇
wandb:  test_balanced_accuracy0.5 ▃▃▄▇█▆▇▅▆▄▅▅▄▄▆▄▄▄▄▅▃▄▃▆▄▃▃▄▃▃▃▃▄▂▄▂▄▂▄▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁█▆█▁█▆▆▆█▆▆▆▆██▆▆▆▆▆
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▅▂▄▂▃▅▃▆▅▄▆▅▇▃▅▆▆▆▆▆▆▆▆▆▇▆▆▆▄▆▃█
wandb:          test_precision0.5 ▄▄▃▄▃▄▅▆▆▆▅▄▄█▇▅▅▂▂▂▂▂▂▅▂▂▁▂▅▂▂▂▂▄▂▅▂▅▂▂
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅███▅▁█▅▁▁██▅▅▅▅▅██▅▅█
wandb:            test_recall0.25 █████▇▇▆▆▆▆▅▆▇▇▅▅▃▄▆▄▄▆▅▄▆▄▃▄▃▂▅▃▂▂▂▂▁▄▅
wandb:             test_recall0.5 █▄▄▄▄▄▄▄▄▄▄▄▄▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁█▁▁█▁███▁█▁███████████
wandb:                train_auroc ▁▄▄▄▅▅▅▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▇▇████████████
wandb:                 train_loss █████▇▇▇▇▆▅▅▄▄▄▄▄▄▄▃▃▃▃▃▃▃▃▃▂▂▂▂▂▁▂▂▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▂▂▂▂▂▂▄▂▇▅▆▆▆▆▆▃▅▆▆▇█▇▆▄▅▆▄▆█▆▇██▆█
wandb:            val_accuracy0.5 ▁▂▂▃▄▅▄▄▄▄▅▆▆▆▇▆▆▆▇▆▇▆▆▆▆▆▆▇▅█▇▇▅▇▅▆▅▆▇▆
wandb:           val_accuracy0.75 ▅▅▅▅▅▅▅▃▃▃▃▃▃▃▅▅▃▅▃▅▁▅▅▁▅▃▆▃▅▅▆▆▆▆▅▆▆▆█▆
wandb:                  val_auroc ▁▁▂▂▃▆▆▆▆▆▆▇▆▇▇▇▇▇▇▇▇▇▇▇▇███████████▇███
wandb:  val_balanced_accuracy0.25 ▁▁▁▂▃▂▆▄▇▄▅▄▄▄▇▅▅▅▃▅▅▅▅▆▆▄▅▄▅▇▆▇▇█▆▇▇▆▅▆
wandb:   val_balanced_accuracy0.5 ▁▁▄▄▂▃▃▂▅▃▅▃▅▆▆▆▆▆▆▆▆▆▆▇▆▇▆▆▆█▆▆▇▆▇▇█▆▇▇
wandb:  val_balanced_accuracy0.75 ▂▁▁▁▁▁▁▃▁▃▁▃▃▃▃▃▃▃▂▇▃▃▃▂▃▆▅▅▆▅▇▆▆▆▇▆▆▆▇█
wandb:          val_precision0.25 ▁▁▁▁▁▂▁▁▁▁▂▂▄▄▄▅▄▄▄▂▄▅▇▃▃▅▆▆▆▃▅▃▇█▅▄▆▅█▄
wandb:           val_precision0.5 ▂▃▄▄▄▃▃▃▃▂▃▂▄▁▅▇▅▆▅█▅▅▅█▅▆▇▇▅▅▅▆▅▅▅▅▅▅▆▆
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▆▆▅▄▆▆▅▇▇▇▇▇▇▇█▇█▇
wandb:             val_recall0.25 ████████▇█▇▇▆▇▇▄██▄▆▂▁▆▃▄▂▁▂▅▁▂▁▁▅▂▄▅▅▁▄
wandb:              val_recall0.5 ▇█▆█▅▃▂▄▄▄▁▄▃▄▄▄▄▄▅▄▄▄▅▅▄▅▄▄▄▄▅▄▅▅▅▅▅▄▅▄
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▂▂▂▂▄▅▂▅▄▅▅█▄▅█▅█▅██▅▅▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.60759
wandb:           test_accuracy0.5 0.64557
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.61271
wandb: test_balanced_accuracy0.25 0.62161
wandb:  test_balanced_accuracy0.5 0.46525
wandb: test_balanced_accuracy0.75 0.51653
wandb:         test_precision0.25 0.35135
wandb:          test_precision0.5 0.16667
wandb:         test_precision0.75 0.5
wandb:            test_recall0.25 0.65
wandb:             test_recall0.5 0.1
wandb:            test_recall0.75 0.05
wandb:                train_auroc 0.9725
wandb:                 train_loss 0.7747
wandb:           val_accuracy0.25 0.55238
wandb:            val_accuracy0.5 0.68571
wandb:           val_accuracy0.75 0.77143
wandb:                  val_auroc 0.61733
wandb:  val_balanced_accuracy0.25 0.59932
wandb:   val_balanced_accuracy0.5 0.54601
wandb:  val_balanced_accuracy0.75 0.56426
wandb:          val_precision0.25 0.31579
wandb:           val_precision0.5 0.33333
wandb:          val_precision0.75 0.66667
wandb:             val_recall0.25 0.69231
wandb:              val_recall0.5 0.26923
wandb:             val_recall0.75 0.15385
wandb: 
wandb: 🚀 View run resnet18_2d_64_12_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/fnjb4ri2
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_12/wandb/run-20250618_230804-fnjb4ri2/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_12/wandb/run-20250619_001011-waywyznv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_12_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/waywyznv
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▂▄▄▇▄▄▅▃▅▅▅█▅███▆▆▇▇▆▇▇▆▆▇█▆▇██▆
wandb:           test_accuracy0.5 ▄▁▂▃▃▂▆▃▇▇▇▆█▆▇▇▆█▆▇▇▇█▇▆▆▆▆▆▆▆▇▆▆▇▆▆▆▆▇
wandb:          test_accuracy0.75 ▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅█▅▅▅▁▁▁▁▅▅▁▁▅▅▅▅▅▅▅▅▅▅
wandb:                 test_auroc ▁▁▁▁▂▂▂▃▃▆████████▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▃▃▄▃▃▃▇▃█▃▅▆▆▇▆▇▇▇▄▆▆▆▅▅▆▄▄▄▄▅▅
wandb:  test_balanced_accuracy0.5 ▄▆▆▇▆█▆▇▇▆▄▃▃▃▆▃▅▆▆▄▃▂▃▃▃▂▃▂▃▂▂▁▂▃▁▁▃▁▃▃
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃█▁▃██▁▁██▁▁████████████▆
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▂▃▁▄▇▂▄▇▃█▅▆▆▆▄▆▅▆▅▄▄▃▅▄▅▄▄▅▆▅▅█
wandb:          test_precision0.5 ▃▂▄▃▃▄▃▃▄▅▄▄█▆▆▅▄▄▅▄▃▃▄▃▄▃▃▃▄▃▂▃▃▂▂▄▁▁▂▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁██▁▁▁██████████████▆
wandb:            test_recall0.25 ██████▇▆▇▆▇▆▆▆▆▇▆▆▆▆▆▆▆▇▆▆▆▅▄▆▄▃▄▄▁▃▄▄▃▄
wandb:             test_recall0.5 ▁████▇▆▆▄▃▄▄▃▃▃▃▃▃▃▃▃▃▃▃▃▂▅▃▂▅▃▆▂▂▂▂▃▅▃▃
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁██▁▁██▁▁█▁████████████
wandb:                train_auroc ▁▁▁▁▂▃▄▄▅▄▅▅▅▆▅▆▆▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇█▇████
wandb:                 train_loss ███▇▇▇▆▆▅▅▅▅▅▅▅▄▄▄▄▃▃▄▃▃▃▃▃▂▂▂▂▂▂▂▂▂▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▅▃▄▃▅▄▆▇▆▆▄▅▇▅▆▇▆▇▆▆▇▇▇▇█▇▇▇█▇██▇▆▇
wandb:            val_accuracy0.5 ▂▂▃▁▂▃▄▄▅█▆▄▅▆▅▄▃▇▇█▆▆▇▆▇▆▇▆▆▆▆▆▇▆▆▆▆▆▆▆
wandb:           val_accuracy0.75 ████████▆▆▆▆▆▁▁▃▁▃▆▃▆▆▆█▃▃▃▃▃▆▁▆▃▃▃▃▆▃▃▃
wandb:                  val_auroc ██▆▆▅▃▁▁▁▁▁▂▁▃▃▃▃▃▂▃▃▃▂▃▂▃▃▃▃▂▂▂▃▂▃▂▂▃▂▃
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▂▁▅▅▃▅█▅▅▄▆▄▆▅▁▃▅▄▅▅▇▇▄▅▅▄▆▅█▄▇▆▅▅▅
wandb:   val_balanced_accuracy0.5 ▇█▇▇█▆▆▅▆▂▂▁▁▂▄▅▄▅▅▅▆▅▆▆▅▅▇▆▅▅▆▆▆▅▅▅▆▆▇▆
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▂▂▂▄▃▃▄▃▃▃▃▃▂▁▁▂▃▆▅▆▄▅▅▅▆▅▆▄▅█▅▇█▇▆▇
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▂▂▂▂▂▃▄▂▃▂▁▂▂▂▁▄▃▄▂▄▃▄▃▄▄▆▅▃▅█▃▃
wandb:           val_precision0.5 ▆▆▆▆▆▆▃▆▁▁▃▁▂▂▃▇█▇▇█▇▇▇▆▆▇█▆▆█▇▇▇▇▇▆▇▇█▇
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▅▅█▅▃▃█▂▃▂▂▃▃▅▄▃▄▄▄▄▄▄▄▄▄▅▄▄▄▄
wandb:             val_recall0.25 ██████████▇▇▇▆▅▅▃▆▄▄▁▃▂▄▄▃▂▃▃▂▃▃▃▂▂▂▂▂▂▁
wandb:              val_recall0.5 ▁▁███▇▅▂▂▂▂▂▄▃▄▅▃▃▃▃▃▃▃▃▅▄▅▅▃▆▅▃▄▅▅▄▄▄▅▄
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▄▄▄▄▅▅▅▅█▅▅▅▅▇▇▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.55696
wandb:           test_accuracy0.5 0.6962
wandb:          test_accuracy0.75 0.73418
wandb:                 test_auroc 0.65339
wandb: test_balanced_accuracy0.25 0.62076
wandb:  test_balanced_accuracy0.5 0.51568
wandb: test_balanced_accuracy0.75 0.50805
wandb:         test_precision0.25 0.33333
wandb:          test_precision0.5 0.3
wandb:         test_precision0.75 0.33333
wandb:            test_recall0.25 0.75
wandb:             test_recall0.5 0.15
wandb:            test_recall0.75 0.05
wandb:                train_auroc 0.95674
wandb:                 train_loss 0.85697
wandb:           val_accuracy0.25 0.51429
wandb:            val_accuracy0.5 0.65714
wandb:           val_accuracy0.75 0.71429
wandb:                  val_auroc 0.56475
wandb:  val_balanced_accuracy0.25 0.5611
wandb:   val_balanced_accuracy0.5 0.55282
wandb:  val_balanced_accuracy0.75 0.53919
wandb:          val_precision0.25 0.28814
wandb:           val_precision0.5 0.32143
wandb:          val_precision0.75 0.35714
wandb:             val_recall0.25 0.65385
wandb:              val_recall0.5 0.34615
wandb:             val_recall0.75 0.19231
wandb: 
wandb: 🚀 View run resnet18_2d_64_12_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/waywyznv
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_12/wandb/run-20250619_001011-waywyznv/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_12/wandb/run-20250619_011012-sjrkyxvc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_12_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/sjrkyxvc
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▂▂▄▅▅▄▅▆▅▅▅▆█▆▆▇▇██▇▆▆▆▆█▇▇▇▇█▇▇▆
wandb:           test_accuracy0.5 ▁▃▄▅▆▆▅█▇▆▇█▆▇████▇█▇▇▇▇▇▇█▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          test_accuracy0.75 ██████████▁█▁▁▁█▁▁█▁▁▁▁▁▁▁▁▁▁▁▁█▁███▁▁██
wandb:                 test_auroc ▁▂▂▂▂▄▆▆▇▆▇█████▇█████▇▇▇▇▇▆▆▆▆▆▅▅▅▅▅▅▄▄
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▂▃▄▆▄▆▃▆▆▆▆▆█▆▆█▂▂▇▇▄▅▅▄▃▄▃▄▄▃▄▄▄▄▄
wandb:  test_balanced_accuracy0.5 ▃▃▇▇▅▆▅▅▆▅▆█▄▇▇▁▅▇▄▇▅▂▂▂▂▂█▂▂▂▂▂▂▂▂▂▂▂▂▁
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▃▃▁▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁███▁██▁███
wandb:         test_precision0.25 ▁▁▁▁▁▄▅▅▅▅▅▄▅▆▅▅▇▅▄▅▅▂▅▅▇▆▄▅▄▄▄█▄▆▅▆▄▆▃▆
wandb:          test_precision0.5 ▁▁▁▁▂▂▂▄▃▆▄▅▄▄▇█▄█▆▆▄▆▄▆▄▄▅▄▄▄▃▄▁▄▂▄▄▂▂▂
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁█▁▁█▁████▁██
wandb:            test_recall0.25 █████▇▇▇▇▅▆▇▇▇▄▄▁▆▆▅▅▅▆▆▅▄▄▂▁▅▂▂▂▁▄▁▅▃▂▄
wandb:             test_recall0.5 █▄▄▄▄▄▄▄▃▃▃▃▂▂▃▃▃▂▃▃▃▁▁▃▃▁▁▁▁▁▃▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁█▁▁▁████▁███
wandb:                train_auroc ▁▂▃▃▃▃▃▃▃▄▅▆▆▆▆▇▆▇▆▇▇▇▇▇▇▇▇▇▇▇▇█████████
wandb:                 train_loss █████▇▇▇▇▇▆▅▅▄▄▄▄▄▄▃▃▃▃▃▃▃▃▃▃▃▃▂▂▂▁▁▁▂▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▂▅▆▆▆▆▆▆▆▆▆▆▆▅▇▆▅▆▆▆▇▇▅▆▇▆▅▅▇█▆▄
wandb:            val_accuracy0.5 ▁▃▂▅▅▇▇█▇▆▆▇▆▇▇█▆▇▇█▇▆▆▅█▇▇▇█▇█▇▇▇▇█▇▇▇▇
wandb:           val_accuracy0.75 ▆▆▆▆▆▃▃▃▆▃▃▆▃▃▃▆▆█▆▆▆▃▆▆▆▆▆▆▆▆▆▆▁▆▃▃▁▃▃▃
wandb:                  val_auroc ▂▂▂▂▂▄▄▄▇▇██▇▇▇▅▅▅▅▅▅▅▄▄▃▅▄▂▃▃▂▃▂▂▁▂▁▁▁▁
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁█▅▇▆▅█▇▆▅▅▆▅▆▅▅▅▅▃▅▄▄▄▄▄▄▄▅▄▃
wandb:   val_balanced_accuracy0.5 ▇▇▇▇█▅▄▄▄▃▃▂▂▂▂▂▃▃▁▂▂▃▄▂▃▂▂▃▄▂▃▂▂▃▃▃▂▅▃▃
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▅▁▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▄█▄█▄▄▄
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▃▅▄▇▄▅▆▅▄▄▄▅▅▃▃▃▅▄▅▄▆▃▅▇▅▆▆▆▇█▃▆
wandb:           val_precision0.5 ▃▅▆▆▅▇▆▅▇▃▅▅▂▅▂▂▄▅▂▁▃▃▆█▃▇█▅▂▆█▆█▄▅▆▅▃▅▅
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▆▆▆▆█▆▆▆▆▆▆▆▆▆▆▆▅▆▆▆▆▆▅▅▅
wandb:             val_recall0.25 ██████████▇▇▆▃▆▅▅▆▄▃▃▁▅▄▃▃▄▅▄▁▄▃▃▁▄▂▂▁▂▂
wandb:              val_recall0.5 █▅▄▄▃▂▃▂▂▂▂▃▂▁▁▁▁▁▁▁▁▁▁▂▁▁▁▂▁▁▂▁▂▁▁▁▁▂▂▂
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅▅▅▅▅█▅▅▅▅▅▅▅██▅▅█▅▅███
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.60759
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.55847
wandb: test_balanced_accuracy0.25 0.55551
wandb:  test_balanced_accuracy0.5 0.51653
wandb: test_balanced_accuracy0.75 0.51653
wandb:         test_precision0.25 0.31034
wandb:          test_precision0.5 0.5
wandb:         test_precision0.75 0.5
wandb:            test_recall0.25 0.45
wandb:             test_recall0.5 0.05
wandb:            test_recall0.75 0.05
wandb:                train_auroc 0.97765
wandb:                 train_loss 0.69334
wandb:           val_accuracy0.25 0.64762
wandb:            val_accuracy0.5 0.69524
wandb:           val_accuracy0.75 0.74286
wandb:                  val_auroc 0.58057
wandb:  val_balanced_accuracy0.25 0.5852
wandb:   val_balanced_accuracy0.5 0.51363
wandb:  val_balanced_accuracy0.75 0.50657
wandb:          val_precision0.25 0.34286
wandb:           val_precision0.5 0.28571
wandb:          val_precision0.75 0.33333
wandb:             val_recall0.25 0.46154
wandb:              val_recall0.5 0.15385
wandb:             val_recall0.75 0.03846
wandb: 
wandb: 🚀 View run resnet18_2d_64_12_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/sjrkyxvc
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_12/wandb/run-20250619_011012-sjrkyxvc/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_12/execution_datetimes.json

**************************************************  Experiment 64 | Version 13 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 5}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 6}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 7}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_13/wandb/run-20250619_021052-zsvrjjwv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_13_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/zsvrjjwv
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▂▂▂▂▅▂▃▅▃▅▃▃▃▃▃▂▂▅▅▃▆▅▅▅▅▅▆▆█▇
wandb:           test_accuracy0.5 ▃▃▃▂▂▁▁▁▁▁▁▂▂▂▂▂▄▄▅▅▄▄▅▆▄▄▅▇▅▆▆▆▇▆▇█▆▆▇█
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▁▂▂▂▂▂▂▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▇▇▇█
wandb: test_balanced_accuracy0.25 ██████████████▄▄▅▄▅▅▅▆▇▄▆▄▁▁▁▃▃▄▃▄▃▅▃▄▄▄
wandb:  test_balanced_accuracy0.5 ▂▂▃▃▂▂▂▁▁▂▂▂▂▂▂▃▂▃▃▄▄▄▄▆▆▇▆▆▃▄▇▆▆▅▅▇█▇▇█
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ██████████▄▄▄▄▄▅▅▅▇▇▆▆▄▄▆▁▁▁▃▃▃▃▂▃▃▃▃▃▃▃
wandb:          test_precision0.5 ▁▃▃▂▂▁▂▂▁▁▁▁▂▁▁▂▁▂▂▂▂▃▃▄▃▅▄▄▄▄▂▆▆▅▆▅▇▇██
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ██████████▄▄▄▄▄▄▄▄▄▄▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ██▂▂▂▂▂▂▂▂▃▂▃▃▃▃▃▃▃▃▃▃▂▂▂▁▂▁▁▂▁▁▂▁▁▁▁▂▂▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▂▁▂▃▂▃▃▃▃▃▃▄▄▄▄▅▆▆▆▆▆▆▆▆▆▆▇▆▆▆▇▇▇▇▇▇▇█▇█
wandb:                 train_loss ███▇▇▇▇▇▆▆▆▆▆▅▅▅▅▅▅▅▅▄▄▄▄▄▄▄▃▃▃▃▃▂▂▂▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▃▂▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▄▃▄▄▄▆▅▅▆▆▅▆██
wandb:            val_accuracy0.5 ▁▄▅▄▅▅▅▅▅▅▆▆▆▇▇▇▇▇▇▆▇▆▆▆▇▆▇▇▇▇▆▇▇▇▇█▆▇▆▇
wandb:           val_accuracy0.75 ████████████████████████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▄▄▄▄▄▄▄▄▄▅▅▅▅▅▅▅▅▅▆▆▆▆▆▆▆▆▆▆▇▇▇▇▇▇▇████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▄▂▃▃▃▂▄▂▂▂▂▂▂▂▃▄▃▄▄▄▄▅▅▃▃▅▅▅▇█
wandb:   val_balanced_accuracy0.5 ▁▂▄▄▅▆▅▅▆▅▅▅▅▆▆▇▇▇▇██▅█▇▆▅▄▅▄▅▅▆▆▆▅▆▆▄▅▆
wandb:  val_balanced_accuracy0.75 █████████████████████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▃▃▂▂▂▂▂▂▂▃▂▃▄▃▄▄▄▄▄▅▅█
wandb:           val_precision0.5 ▃▅▄▅▅▇▇▆▇▇▇▆▆██▃▇▁▂▄▄▄▄▄▄▄▄▅▄▄▅▅▂▃▃▃▄▂▄▂
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ███████████▆▆▆▆▆▆▆▆▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▁▁▁▁▁▁
wandb:              val_recall0.5 █▆▂▃▃▃▃▃▄▄▃▃▃▃▃▃▃▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.32911
wandb:           test_accuracy0.5 0.72152
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.59322
wandb: test_balanced_accuracy0.25 0.48475
wandb:  test_balanced_accuracy0.5 0.59873
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.24615
wandb:          test_precision0.5 0.4375
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.8
wandb:             test_recall0.5 0.35
wandb:            test_recall0.75 0
wandb:                train_auroc 0.83685
wandb:                 train_loss 1.52274
wandb:           val_accuracy0.25 0.41905
wandb:            val_accuracy0.5 0.60952
wandb:           val_accuracy0.75 0.74286
wandb:                  val_auroc 0.54869
wandb:  val_balanced_accuracy0.25 0.57522
wandb:   val_balanced_accuracy0.5 0.48247
wandb:  val_balanced_accuracy0.75 0.49367
wandb:          val_precision0.25 0.28395
wandb:           val_precision0.5 0.22222
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.88462
wandb:              val_recall0.5 0.23077
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_64_13_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/zsvrjjwv
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_13/wandb/run-20250619_021052-zsvrjjwv/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_13/wandb/run-20250619_030145-djhkqrjs
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_13_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/djhkqrjs
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading config.yaml
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▃▁▁▁▁▁▁▃▆██
wandb:           test_accuracy0.5 ▃▃▃▁▂▂▁▁▂▁▃▁▂▁▃▂▂▃▃▄▅▄▅▅▄▆▅▆▆▅▆▇▆██▇▇▇██
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▂▃▃▃▃▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▅▅▅▄▅▅▆▆▆▆▇████
wandb: test_balanced_accuracy0.25 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▁▁▁▁▃▃▃▄█
wandb:  test_balanced_accuracy0.5 ▁▅▅▄▅▄▄▅▄▄▄▄▄▆▅▅▆▆▅▅▆▇▇▇▇▇▇██████▇▇▆▆▆▇▇
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▁▁▁▃██
wandb:          test_precision0.5 ▃▁▅▃▃▃▂▃▃▃▃▄▄▄▄▃▄▄▄▅▅▅▅▅▆▆█▆▇▇▇▇█▇█▇▇█▇▇
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ████████████████████████████████▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 █▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▂▂▃▃▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▁▂▁▁▂▂▂▂▂▁▂▂▂▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▅▆▇█▇▇▇████
wandb:                 train_loss ██████▇▇▇▇▇▇▇▇▇▇▆▆▆▆▆▆▆▆▅▅▅▅▅▅▄▄▄▃▃▂▂▂▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▄▄▄▁▂▂▄█
wandb:            val_accuracy0.5 ▃▂▃▂▁▂▂▁▂▁▁▃▃▂▂▃▅▅▆▅▄▅▆▆▆▆▆▆▆▇█▇▇▇█▆████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▄▅▇▇▇▇████████▇▇▇▇▇▆▆▆▆▆▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb:  val_balanced_accuracy0.25 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆██▄▁▂▄
wandb:   val_balanced_accuracy0.5 ▅▅▆█▅▇▆▇▇▆▇█▅▇▆▃▄▃▃▄▆▆▆▇▇▇█▇▆▄▃▁▂▂▂▁▁▁▃▂
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆█▅▁▁▂
wandb:           val_precision0.5 ▆▇▆▆▇▆▆▆▆▆▅▄▅▅▅▅▇▇▆█▆█▇█▇▇▆▆█▆▃▅▁▂▂▂▁▁▃▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ██████████████████████████████████████▄▁
wandb:              val_recall0.5 █▇███▇██▇▆▆▇▆▆▆▆▆▆▆▆▆▆▆▆▆▅▅▄▄▄▃▃▂▁▁▁▁▁▂▂
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.29114
wandb:           test_accuracy0.5 0.72152
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.60424
wandb: test_balanced_accuracy0.25 0.5089
wandb:  test_balanced_accuracy0.5 0.5822
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25676
wandb:          test_precision0.5 0.42857
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.95
wandb:             test_recall0.5 0.3
wandb:            test_recall0.75 0
wandb:                train_auroc 0.83727
wandb:                 train_loss 1.56818
wandb:           val_accuracy0.25 0.28571
wandb:            val_accuracy0.5 0.67619
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.56378
wandb:  val_balanced_accuracy0.25 0.49951
wandb:   val_balanced_accuracy0.5 0.50097
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24742
wandb:           val_precision0.5 0.25
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.92308
wandb:              val_recall0.5 0.15385
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_64_13_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/djhkqrjs
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_13/wandb/run-20250619_030145-djhkqrjs/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_13/wandb/run-20250619_035417-qe5vavze
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_13_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/qe5vavze
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▃▂▂▂▂▂▄▅▅▅▅▆▆▇█▇
wandb:           test_accuracy0.5 ▁▃▄▅▅▅▅▅▅▅▆▆▇██▇▇▇██▇███▇█▇█████▇▇██████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁
wandb:                 test_auroc ▁▂▂▂▂▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇█████████
wandb: test_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▄▄▄▂▃▁▁▁▂▂▂▂▂▂▂▂▄▄▄▄▄▄▆▅▇▆▆▇▆▆█▇
wandb:  test_balanced_accuracy0.5 ▂▁▃▅▆▅▅▆▆▅▆▇█▅▇▆▅▆▄▅▅▄▆▅▅▅▅▅▅▅▅▅▅▆▆▅▆▆▆▇
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁█▁██▁▁▁█▁█
wandb:         test_precision0.25 ▄▄▄▄▄▄▄▄▄▂▂▂▁▁▁▁▂▁▂▂▂▂▂▂▂▄▄▄▄▃▄▃▆▆▇██▆██
wandb:          test_precision0.5 ▁▁▁▁▁▂▂▂▃▂▃▃▂▃▅▃▅▄▇█▅▇▅█▅▇▇▇▇▇▇▇▇▇▇██▆▇▆
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁█▁█▁█▁█
wandb:            test_recall0.25 █████████▃▃▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▆▆█▃▃▃▃▁
wandb:             test_recall0.5 █████▃▃▃▃▃▃▃▃▃▃▂▁▁▂▁▁▁▂▁▁▁▁▂▁▁▁▁▂▁▂▁▂▁▂▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁██▁▁█▁██▁▁
wandb:                train_auroc ▁▅▅▅▅▅▅▆▅▆▆▆▆▆▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇███████████
wandb:                 train_loss ███▇▇▆▆▆▆▆▅▅▅▅▄▄▄▃▃▃▃▃▃▂▃▂▂▂▃▂▂▁▂▂▂▂▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂▂▃▃▃▃▄▄▃▄▄▄▃▅▄▅▆▆▆▆▇▇▇▇▇█
wandb:            val_accuracy0.5 ▁▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▇█████████████████▇
wandb:           val_accuracy0.75 ██████████████████████▁▁▁▁▁▁▁▁██▁███████
wandb:                  val_auroc ▂▂▁▂▂▃▃▃▃▂▃▄▄▅▅▅▆▆▆▆▇▇▇▇▇▇▇▇▇▇█▆▆▆▆▅▅▅▄▄
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▃▅▅▆▆▆▆▆▆▇▆█▆▅▇▇
wandb:   val_balanced_accuracy0.5 ▁▄▆▆▇▇▆▆▆▆▇▇▇▇▇█████▇▇▆▅▅▆▅▅▅▅▆▆▅▄▄▄▃▂▂▂
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▆▆▅▅▅▅▅▅▅▅▃▃▃▃▃▃▃▃▃█████
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▁▂▂▂▂▃▅▅▅▆▆▇▆█▇▇▆▇
wandb:           val_precision0.5 ▁▃▃▃▃▄▄▅▅▅▅▅▅▅▄▆▆▇▆▆▆▆▇▇▆▇▇▇▅▅▇▅▆█▆▅▅▄▃▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█████████▆▆▆▆▆▆▆▆██████
wandb:             val_recall0.25 ███████▆▆▃▃▃▃▃▃▃▃▃▆▆▆██▆▆█████▆▆▃▃▃▃▃▃▁▁
wandb:              val_recall0.5 █▄▄▄▄▃▃▃▃▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅█▅██
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.39241
wandb:           test_accuracy0.5 0.77215
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.65254
wandb: test_balanced_accuracy0.25 0.54364
wandb:  test_balanced_accuracy0.5 0.59958
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.27419
wandb:          test_precision0.5 0.625
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.85
wandb:             test_recall0.5 0.25
wandb:            test_recall0.75 0
wandb:                train_auroc 0.85183
wandb:                 train_loss 1.4188
wandb:           val_accuracy0.25 0.4381
wandb:            val_accuracy0.5 0.68571
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.61027
wandb:  val_balanced_accuracy0.25 0.57498
wandb:   val_balanced_accuracy0.5 0.5202
wandb:  val_balanced_accuracy0.75 0.5258
wandb:          val_precision0.25 0.28571
wandb:           val_precision0.5 0.29412
wandb:          val_precision0.75 0.5
wandb:             val_recall0.25 0.84615
wandb:              val_recall0.5 0.19231
wandb:             val_recall0.75 0.07692
wandb: 
wandb: 🚀 View run resnet18_2d_64_13_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/qe5vavze
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_13/wandb/run-20250619_035417-qe5vavze/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_13/execution_datetimes.json

**************************************************  Experiment 64 | Version 14 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 19, 1.0: 9}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 16, 1.0: 12}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 13, 1.0: 19}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 11, 1.0: 17}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_14/wandb/run-20250619_044835-ra17l2xc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_14_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/ra17l2xc
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▁▅▆▇▇▆████████████▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▅▆▆██▅▃▃▂▂▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▃▃▂▂▂
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▂▂▂▂▂▂▂▁▂█▁▃▄▃▃▄▄▄▃▄▄▄▃▄▄▃▃▃▃▃▃▄▃▂▂▂▂▂▂▂
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▂▂▂▂▂▂▂▁▃▄▃█▁▃▃▃▃▁▂▄▃▃▃▄▄▄▅▃▃▃▃▂▃▃▃▂▃▂▂▁
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ██████▆▄▄▄▄▂▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▁▃▄▅▇█▇▇▇██▇▇█▇▇▇▇█▇▇██▇██▇▇██▇███████▇
wandb:                 train_loss █▇▆▆▆▆▆▅▅▅▅▅▅▅▅▄▄▄▄▄▄▄▄▃▃▄▃▃▃▃▃▂▂▂▂▂▁▂▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▅▅▆▇▇▇▆▇██▇███▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▅▄▁▂▃▄▄▅▅▅▅▆▆▆▆▆▆▆▇▇▇▇▇▇▇███████████████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▇▇▇▇▇██▆▆▃▃▁▁▄▄▃▄▄▄▄▄▄▄▄▄▃▃▄▄▄▃▄▄▄▃▅▅▅▅▅
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ████████▇▇▇▂▁▃▃▂▃▂▃▃▃▂▃▃▄▃▃▅▃▅▃▆▆▆▆▆▆▆▆▆
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 █████▆▆▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.53165
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.51441
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.50466
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.25714
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.45
wandb:            test_recall0.75 0
wandb:                train_auroc 0.66584
wandb:                 train_loss 2.01997
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.51429
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.46397
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.45789
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.2093
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.34615
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_64_14_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/ra17l2xc
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_14/wandb/run-20250619_044835-ra17l2xc/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_14/wandb/run-20250619_050142-76ma7g40
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_14_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/76ma7g40
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 █▄▄▂▃▃▁▂▁▁▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▂▂
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▁▁▂▂▃▄▄▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▆▆▆▆▆▇▇▇▇▇▇██████
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▄▁▃▇▃█▇▇▆▆▅▆▅▆▆▅▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▆████▇▇███▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▄▇█▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▆▆▆▇▇▅▇▅▇▆▇▇▅▇▆▆▆▆▇▇▇▆▇▇▇▇▆▇████▇█▇▇▇▇▇
wandb:                 train_loss █████▇▇▇▇▇▆▆▆▆▆▅▅▅▆▆▅▅▄▄▅▄▃▄▃▃▃▃▂▃▂▂▂▃▂▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 █▆▂▂▁▃▂▂▂▂▁▂▂▁▂▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▂▃▂▇███▇▇▆▆▆▆▅▅▅▅▅▅▅▅▄▄▄▄▃▄▄▃▃▃▃▃▃▂▃▃▃▂
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▃▃▃▅▆▇▇▅▅▆▅▆▅▇▇▇▆▇▇▇█▇█▇▇▇▇▇▇▇▇█▇█▅███▇
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 █▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▂▃▆▅▇▇▇▇███████▇█████▇███████████████▆█
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.55696
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.52373
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.52161
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.27273
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.45
wandb:            test_recall0.75 0
wandb:                train_auroc 0.62664
wandb:                 train_loss 1.98188
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.58095
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.62171
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5925
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.32
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.61538
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_64_14_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/76ma7g40
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_14/wandb/run-20250619_050142-76ma7g40/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_14/wandb/run-20250619_052444-fi78ehfd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_14_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/fi78ehfd
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▄▄▄▆▆▆▆▆▆▆▆▆▆▆▇▇▇▇▇█▇▇▇▇▇▇████▇██
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▁▁▂▂▃▄▄▄▅▅▅▅▆▆▆▇▇▇▇▇▇▇▇▇▇▇█████████████
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▄▄▄▄▄▄▄▄▁▁▃▁▂▅███▄▅▃▃▅▅▃▅▅▇▇▄▄▆▅▆▆▅▅▅▇▄▆
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▃▃▃▃▃▃▃▃▂▁▁▁▂▂▂███▄▂▂▁▂▄▂▅▃▃▆▆▃▅▄███▄███
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 █████████▆▅▄▃▃▃▂▃▃▃▃▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▂▁▁▃▂▆▆▆▇▇▇█▇██▇█▇▇█████████████████████
wandb:                 train_loss ██▇▇▇▇▆▆▆▆▆▆▆▅▅▅▅▅▅▅▅▅▅▄▄▄▃▃▃▄▃▃▂▂▂▁▂▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁▁▁▁▄▆▆▆▆▇▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█████████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc █▇▆▆▆▅▄▃▃▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▃
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▂▅▅▅▅▆█▇▆▆▇▆▄▆▅▆▅▇▇▇▇▇▇█████▆▆███
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁▃▃▅▅▅▄▄▅▅▅▅▄▄▄▅▅▄▆▅▅▆▆▆▅▆▆▆▆████▇██
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ████████▇▆▅▅▅▄▄▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.59494
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.51356
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.53051
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.28571
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.4
wandb:            test_recall0.75 0
wandb:                train_auroc 0.64613
wandb:                 train_loss 1.95846
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.64762
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.60005
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5981
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.35135
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.5
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_64_14_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/fi78ehfd
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_14/wandb/run-20250619_052444-fi78ehfd/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_14/execution_datetimes.json

**************************************************  Experiment 64 | Version 15 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 36, 1.0: 28}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 32, 1.0: 32}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 27, 1.0: 37}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 26, 1.0: 34}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_15/wandb/run-20250619_054329-ajjr3iel
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_15_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/ajjr3iel
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▃▆▆▇▇▇▇▇▇▇▇▇█▇▇█████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc █▇▆▆▄▂▂▂▂▂▂▂▂▁▁▁▁▁▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▅▅▅▅▅▅▅▅▅▅▂▁▂▅▄▇▇▆▇▇▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇█████
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▃▃▃▃▃▃▃▃▂▂▁▁▁▄▃▄▅▅▅▆▆▆▅▅▅▇▇▇▇▇▇▇▇▇▇█████
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ████████▇▆▅▅▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▄▁▄▆▇▇▇▇▇▇▇▇█▇████▇█▇██▇▇█▇▇█▇█▇█▇▇▇█▇█▇
wandb:                 train_loss ███▇▇▇▆▆▆▆▆▆▆▅▅▅▄▄▅▄▄▄▄▄▃▃▃▃▃▃▃▃▃▃▂▂▂▂▂▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▂▂▂▂▄▄▅▆▆█████████████████████
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ██▇▅▄▄▃▃▂▂▂▂▁▁▁▁▂▂▂▃▂▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▃
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▆▆▆▆▆█▇▆▅▅▄▅▆▂▄▄▄▂▂▂▃▁▃▃▃▃▃▂▃▃▂▃▃▃▃▃▃▃▃▃
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▇▇▇▇▇▇▇▇▇█▇▇▆▄▅▄▁▃▄▄▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ████████▇▇▅▄▄▄▄▄▃▃▃▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.58228
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.51186
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.53856
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.29032
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.45
wandb:            test_recall0.75 0
wandb:                train_auroc 0.67395
wandb:                 train_loss 2.02386
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.52381
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.46835
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.46422
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.21429
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.34615
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_64_15_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/ajjr3iel
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_15/wandb/run-20250619_054329-ajjr3iel/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_15/wandb/run-20250619_055843-tn1f1fcx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_15_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/tn1f1fcx
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ███████████▇▇▇▇▇▅▅▃▃▃▃▃▃▃▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▂▁▁▂▂▆▆▆▆▆▆▆▆▇▇▇▇▇▇▇▇▇██████████████████
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▂▂▂▂▂▂▁▁▁▁▁▂▅██▇▇▅▅▅▆▆▆▆▆▄▄▄▄▄▄▄▄▄▄▄▄▄▄▃
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▆▇███▇▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▃▃▃▃▆▆▆▆▆▇▇██████████████████
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▄▅▅▅▇▇▇▆▆▇█▆█▇▇▇▇▇▇▇▇▇▇█▇▇▇▇▇▇█▇▇▇▇▇▇▇▇
wandb:                 train_loss █████▇▇▇▇▇▇▆▆▆▆▅▅▅▅▅▄▅▄▄▄▃▃▃▃▃▂▃▃▃▂▂▂▂▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 █████████▇▇▇▆▆▆▅▅▅▄▄▃▃▃▃▃▂▂▂▂▁▁▁▁▁▁▁▂▂▂▂
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▁▂▃▅▄▅▆▆▇▆▆▆▇▇████████████▇▇▇█████▇▇▇▇▇
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▆▅▄▄▄▅▇▇▇▇▇█▇▆▆▆▆▆▆▅▆▆▆▆▅▅▇▇▇▆
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁█▅▅▅▅▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▂▃▃▃▄▄▅▅▅▅▅▆▇████████████████████
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.55696
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.50847
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.52161
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.27273
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.45
wandb:            test_recall0.75 0
wandb:                train_auroc 0.62512
wandb:                 train_loss 2.04863
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.55238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.62415
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.57352
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.30189
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.61538
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_64_15_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/tn1f1fcx
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_15/wandb/run-20250619_055843-tn1f1fcx/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_15/wandb/run-20250619_061819-89kliwmg
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet18_2d_64_15_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/89kliwmg
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▂▃▄▅▅▅▇▇▇▇▇▇▇▇▇▇▇█████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▄▂▁▄▅▆▆▆▇▆▇▇▇▇▇▇██▇██▇▇▇▇███████████████
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▆▆▆▆▆▄▂▁▂▂▂▅▅▃▅▅▆▆▆▆▆▆▆▇▇▇▇▇████▆▄▃▃▃▃▄▄
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▅▅▅▅▅▅▅▅▅▅▃▄▃▃▃▂▂▁▂▂▄▆▇▅▅█▆▇████▃█▃▆▁▃▂▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 █████████▆▄▄▄▄▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▂▂▂▂▂▂▂▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▄▆▆▇█▇▇▇▇▇▇█▇▇▇▇▇▇█▇█▇███▇▇▇██▇██▇████▇
wandb:                 train_loss ██▇▇▇▇▆▆▆▆▆▆▆▆▅▅▅▅▅▅▄▄▄▄▃▃▃▃▃▃▂▂▂▂▁▂▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁▁▁▁▁▁▂▃▄▄▅▆▆▆▆▆▆▆▆▆▆▆▆▇▇▇▇▇▇▇▇▇██▇▇███
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▂▆▇▇▇██████████████████████████████████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▄▄▄▃▃▅▅▅▅▅▆▆▅▆▆▆▆▇▇▆▆▇█████▇▇▇▇▇
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▂▂▂▃▃▄▅▅▅▆▆▆▆▆▅▅▅▇▇▇▇▇▇▆▆▆▆▆▇█
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 █████▇▆▆▄▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.55696
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.50169
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.50508
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.25806
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.4
wandb:            test_recall0.75 0
wandb:                train_auroc 0.64261
wandb:                 train_loss 2.00799
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.62857
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.5908
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.59834
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.34146
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.53846
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet18_2d_64_15_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da/runs/89kliwmg
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_2d_roi_whole_slice_test_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_15/wandb/run-20250619_061819-89kliwmg/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_64/version_15/execution_datetimes.json
Finish time: 2025-06-19 06:42:53
