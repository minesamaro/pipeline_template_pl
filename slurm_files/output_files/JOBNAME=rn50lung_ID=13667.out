Initialization time: 2025-07-01 11:55:53
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)

**************************************************  Experiment 78 | Version 1 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 5}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 6}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 7}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Currently logged in as: maria-i-paiva (maria-i-paiva-inesc-tec) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: WARNING Using a boolean value for 'reinit' is deprecated. Use 'return_previous' or 'finish_previous' instead.
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_1/wandb/run-20250701_115622-hltamftv
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_1_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/hltamftv
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▁█▁▁▁█▁▁█▆▁█████████████████████████████
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▅▆▇▆▇▇▂▆▇▆▇▆▇▇▃▁▅▇▆▆▇▅▅▆█▅▆▅▇▅▇▃▇▃▆▆▅▆▆▅
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ███▇▁▁██▁██▁█▁▇▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ██▁▆▁██▁█▁███▁▇▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▂▄▄▄▆▃▃▄▄▂▂▃▄▃█▃▄▃▂▂▃▂▂▂▂▃▂▃▁▂▂▃▂▃▃▁▂▂▂▂
wandb:                 train_loss █▂▃▆▄▄▄▃▃▅▃▂▂▂▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁█▁▁▁▂▁██▁▁▁▁██████████████████████████
wandb:           val_accuracy0.75 ▁███████████████████████████████████████
wandb:                  val_auroc █▄▂▂▂▂▃▃▃▃▃▂▃▃▃▂▅▃▃▄▇▂▂▂▃▇█▃▂▂▃▂▅▅▁▆▃▃▃▃
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▅█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 █▁██▁▁█▁████▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.75 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ██▃▁█▁█▁███▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.75 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.5
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0
wandb:            test_recall0.75 0
wandb:                train_auroc 0.43729
wandb:                 train_loss 2.09375
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.75238
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.5
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet50_2d_78_1_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/hltamftv
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_1/wandb/run-20250701_115622-hltamftv/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_1/wandb/run-20250701_121119-2ysemas8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_1_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/2ysemas8
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 █▁▁▁█▁█▁█▁██▁▁▁██▁██▁▁▁▁▁▁▁▁▁█▁█▁▁█▁▁▁▁▁
wandb:          test_accuracy0.75 ▁███████████████████████████████████████
wandb:                 test_auroc ▇█▇▇▇▇▇▇▆▇▆▃▄▄▅▇▆▅▆▆▆▁▅▃▄▇▅▅▅▅▅▅▅▅▅▇▅▅▅▅
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁███▁▁██▁▁████▁█████████████████████▁██
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 █▁██▁█▁▁▁▁▁█████▁██████████▁████████████
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▃▅▅▅▆▄▆█▄▅▆▃▄▁█▅▂▄▂▄▄▇▃▅▃▅▄▆▃▃▅▃▂▃▅▃▅▄▄▄
wandb:                 train_loss █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁▁███▁█████▁█▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁
wandb:           val_accuracy0.75 ▁███████████████████████████████████████
wandb:                  val_auroc ▂█████▂▇▇▆▄▅▃▁▃▆▅▃▅▃▄▆▅▃▄▅▆▄▅▅▅▄▄▄▄▄▂▃▂▂
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁██▁██▁█▁██▁▁▁▁████▁█████████▁█▁█▁███▁██
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ██▁██▁██▁▇██▁▁▁██▁██████████████████████
wandb:             val_recall0.75 █▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.25316
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.5
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.25316
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 1
wandb:            test_recall0.75 0
wandb:                train_auroc 0.41149
wandb:                 train_loss 2.09363
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.24762
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.5
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.24762
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 1
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet50_2d_78_1_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/2ysemas8
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_1/wandb/run-20250701_121119-2ysemas8/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_1/wandb/run-20250701_122451-wuiafuhs
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_1_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/wuiafuhs
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▇▅▅▃▇▇▆▇▆▆▆▆▅██▆▅▄▅▇▇▅▅▅▆▆▂▃▇▄▄▄▅▄▄
wandb:           test_accuracy0.5 ██▅▁█▆█▇██▇█▇▇▂▇▇▇▇▇▅▇▆▇▆▇▆▅▆▇▇▅▅▇▇▇▅▆▅▅
wandb:          test_accuracy0.75 ███████▆▇▆▆▅█▅▆▅▅▆▅▃▆▆▄▆▆▅▄▅▃▆▅▃▇▇▇▄▁▅▅▂
wandb:                 test_auroc ▄▃▄▄▃██▆▇▅▇▇█▆█▇▅▆▅▅▆▅▇▅▄▅▇▆▅▃▁▆▅▂▂▂▄▃▂▄
wandb: test_balanced_accuracy0.25 ▂▂▂▂▃▂▂▇▅▅▃▄▆▄▄▅█▄▃▃▆▇▂▅▄▃▂▅▅▄▁▆▆▂▁▃▁▅▂▂
wandb:  test_balanced_accuracy0.5 ▂▄▂▂▂▃▂▂▆▃▆▇▇▅▆▃█▄▃▄▄▅▂▅▆▂▄▅▃▂▄▄▃▄▅▁▂▂▄▃
wandb: test_balanced_accuracy0.75 ▃▃▃▃▄▃▃▃█▄▅▅▅▅▄▄▄▄▄▃▄▅▄▆▅▅▄▄▅▄▄▅▅▂▃▃▁▄▃▄
wandb:         test_precision0.25 ▂▂▂▂▂▂▂█▂▃▅▃▄▃▂▅▃▃▄▃▂▃▄▄▄▂▇▃▃▃▃▂▁▂▂▂▃▃▃▃
wandb:          test_precision0.5 ▄▁▁▇▁▁▅▄▆█▅▅▅▅▅▇▇▅▆▄▄▄▅▅▆▆▄▅▄▄▄▅▄▁▄▄▄▄▄▄
wandb:         test_precision0.75 ▁▁▁█▁▃▄█▅▁▃▄▄▃▃▃▃▃▄▃▃▃▅▃▄▃▄▄▃▃▃▄▃▅▄▃▃▃▃▃
wandb:            test_recall0.25 ███▇███▇▁▅▃▃▃▅▃▃▃▂▄▃▃▅▅▅▅▃▃▅▄▃▃▄▄▂▄▄▅▅▃▆
wandb:             test_recall0.5 █▅▂▁▅▅▃▃▃▄▄▅▄▄▃▃▃▃▃▃▅▃▅▃▅▅▃▄▆▃▃▂▂▂▆▂▃▃▄▄
wandb:            test_recall0.75 ▁▂▂▂▅▃▂▄▄▇▃▅▄▄▄▂▄▅▄▄▅▄▄▄▅▂▄▅▅▅▅▄▂▂▄▅▅█▄▄
wandb:                train_auroc ▁▁▃▁▃▅▄▅▇▇██▇▇████████████▇██████▇▆█████
wandb:                 train_loss ██▇▇▆▄▄▆▃▂▃▂▁▁▂▂▂▃▂▂▁▁▁▁▁▁▁▁▃▁▂▂▇▅▆▄▃▂▂▂
wandb:           val_accuracy0.25 ▁▁▁▁▇▆▁▄▆▇▄▇▇▅▅█▇▇▆▅▇▇▆▆▆▆▇▇▇▆▆█▄▁▁▄▅▆▆▆
wandb:            val_accuracy0.5 █▄█▁▄█▇▇▇▇█▇▇▇▇▇▅▆▆▇▇▇▇▆▅▇▆▆▆▆▆▆▅▁▅▆▅▆▆▆
wandb:           val_accuracy0.75 ▇▇▇▇█▇▆▆▆▇▆▆▇▆▄▆▆▇▃▆▄▃▄▆▁▄▅▅▆▃▇▅▄▃▄▃▄▄▅▄
wandb:                  val_auroc █▆▆█████▃▄▅▂▄▄▅▆▇▆▃▃▄▆▂▆▆▄▃▅▅▅▂▄▁▆▄▃▄▃▂▆
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▂▅▄▅▆▃▅▅▆▃▆█▇▅▄▅▂▄▆▇▄▅▃▄▃▁▃▇▆▄█▁▄▇▅▅
wandb:   val_balanced_accuracy0.5 ▂▃▂▂▆█▃▅▆▅▃▆▅▃▃▆▃▁▇▅▅▃▃▅▃▁▇▆▄▃▄▆▄▄▂▁▁▃▂▄
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▂█▅▂▄▄▅▄▇▆▅▇▅▆▄▃▅▂▂▃▃▆▅▄▅▆▅▆▂▁▃▃▁▄▃▇
wandb:          val_precision0.25 ▄▄▄▄▄▄▄▄▄█▄▅▄▅▇▆▆▄▆▅▅▃▅▄▄▄▅▄▄▅▃▅▁▄▄▄▃▄▃▅
wandb:           val_precision0.5 ▆▁█▇▁▁▆▆▇▆▅▆▆▆▅▅▅▇▇▅▅▅▅▅▄▅▄▅▅▅▆▆▅▃▅▄▃▅▄▅
wandb:          val_precision0.75 ▁▁▁▁█▆▅▄▅▄▄▅▅▅▄▅▄▅▃▄▃▄▅▄▄▄▄▄▄▅▅▅▁▁▄▃▄▄▄▅
wandb:             val_recall0.25 ███▇██▅██▁▄▆▄▄▃▄▄▅▅▅▃▄▂▂▃▃▅▃▄▃▄▃▃▄▄▅▆▄▄▅
wandb:              val_recall0.5 ██▁▅▃▅▁▁▃▂▃▃▅▄▃▂▄▂▂▄▃▄▄▄▃▃▄▃▅▄▅▃▄▂▂▃▄▃▃▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▃▄▁▃▂▃▃▆▅▆█▃▅▅▇▅▄▄▆▄▆▆▅▃▄▆▅▆▁▁▄▄▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.50633
wandb:           test_accuracy0.5 0.5443
wandb:          test_accuracy0.75 0.56962
wandb:                 test_auroc 0.52034
wandb: test_balanced_accuracy0.25 0.50424
wandb:  test_balanced_accuracy0.5 0.51314
wandb: test_balanced_accuracy0.75 0.51356
wandb:         test_precision0.25 0.25641
wandb:          test_precision0.5 0.26471
wandb:         test_precision0.75 0.26667
wandb:            test_recall0.25 0.5
wandb:             test_recall0.5 0.45
wandb:            test_recall0.75 0.4
wandb:                train_auroc 0.98302
wandb:                 train_loss 0.25294
wandb:           val_accuracy0.25 0.55238
wandb:            val_accuracy0.5 0.6
wandb:           val_accuracy0.75 0.62857
wandb:                  val_auroc 0.53676
wandb:  val_balanced_accuracy0.25 0.53481
wandb:   val_balanced_accuracy0.5 0.54065
wandb:  val_balanced_accuracy0.75 0.54674
wandb:          val_precision0.25 0.2766
wandb:           val_precision0.5 0.28947
wandb:          val_precision0.75 0.30303
wandb:             val_recall0.25 0.5
wandb:              val_recall0.5 0.42308
wandb:             val_recall0.75 0.38462
wandb: 
wandb: 🚀 View run resnet50_2d_78_1_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/wuiafuhs
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_1/wandb/run-20250701_122451-wuiafuhs/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_1/execution_datetimes.json

**************************************************  Experiment 78 | Version 3 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 19, 1.0: 9}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 16, 1.0: 12}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 13, 1.0: 19}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 11, 1.0: 17}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_3/wandb/run-20250701_130130-1ygwpyk0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_3_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/1ygwpyk0
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading config.yaml
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▂▂▂▆▃▇▅█▅▆▅▅▃▃▂▂▂▃▆▃▃▃▅▂▃▂▃▂▃▃▅▃▃▂▂▂
wandb:           test_accuracy0.5 █▁██▁█▄▂▆▆▄▃▃▃▂▃▃▂▂▂▂▄▂▂▃▂▂▂▂▂▂▂▂▁▁▃▂▁▂▂
wandb:          test_accuracy0.75 ██████████▇█▇▇▅▆▂▃▃▃▃▅▂▂▂▃▂▂▃▂▃▄▂▂▂▁▂▂▁▁
wandb:                 test_auroc ▆▇▆▆▇▇▆▆▇█▅▅▅▂▆▂▃▂▃▅▃▂▃▅▅▃▃▃▄▄▂▁▃▃▃▃▄▃▃▂
wandb: test_balanced_accuracy0.25 ▆▆▆▅▆▆▆▄▅▇▅▆▃▅▁▄▄▄▄▄▇▆▄▃▄▇▆▆█▆▆▆▅▅▅▆▅▃▃▅
wandb:  test_balanced_accuracy0.5 ▅▅▇▆▇▅▅▆▆▅█▆▄▄▅▁▅▄▅▃▃▄▅▅▅▅▅▄▅▅▃▄▄▅▃▃▁▃▃▃
wandb: test_balanced_accuracy0.75 ▆▆▆▆▆▇▇▆▇█▆▆▄▃▅▅▆▄▅▄▂▁▃▂▆▅▃▅▅▃▄▆▆▆▁▁▃▂▃▃
wandb:         test_precision0.25 ▅▅▅▄▅▅▅▄▅▇█▅▇▅▄▆▇▄▄▃▄▅▆▅▅▃▃▄▅▃▂▅▄▄▄▃▄▁▃▄
wandb:          test_precision0.5 ▂▂█▂▄▂▂▂▃▄▂▃▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▂▂▂▂▂▁▁▁▁▁▁▁▁
wandb:         test_precision0.75 ▁▁▁▁▁█▁▁▁█▄▃▃▃▃▂▃▂▂▂▃▃▂▃▃▃▃▃▃▃▃▃▂▂▂▃▃▂▂▂
wandb:            test_recall0.25 █████████▇▇▅▄▅▅▄▅▃▃▆▆▄▁▅▅▇▆▆▇▅▅▆▆▇▅▆▅▄▆▆
wandb:             test_recall0.5 █▁▂▆▄▃▅▃▅▅▅▇▆▆▄▅▅▅▆▆▅▆▆▆▇▄▆▆▅▆▄▅▅▆▅▄▄▄▆▆
wandb:            test_recall0.75 ▁▁▁▁▁▅▃▂▁▃▂▄▅▄▆█▃▅▄▅▅▅▇▇▇▅▆▆▅▆▅▅▆▄▅▆▃▆▅▆
wandb:                train_auroc ▁▂▂▂▃▄▆▆████████████████████████████████
wandb:                 train_loss ███▇▇▇▇▆▆▅▄▃▃▃▂▂▂▁▁▂▅▂▁▁▂▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▃▁▆█▄▆▄▅█▄▄▅▃▇▆▄▄▃▃▃▄▃▆▃▅▂▃▂▄▃▃▃▄▃▃▂▃
wandb:            val_accuracy0.5 ▁██▁▁█▇▃▆▃▅▆▇▄▄▅▇▄▄▅▄▃▃▄▅▃▅▃▃▅▄▂▄▃▃▃▃▃▄▂
wandb:           val_accuracy0.75 █████████▇▇▆▇▅▃▅▂▄▄▄▅▅▅▄▃▂▂▄▄▅▂▃▂▃▃▃▂▃▁▁
wandb:                  val_auroc ▃▁▁▃▂▃▃▄▅▄▄▃▅▅▃▄▄▄▆▄▄▄▅█▅▅▃█▆▄▅▆▅▄▃▃▄▃▂▃
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▄▃▃▂▄▅▄▃▅▄▅▄▅██▆▅▅▅▄▅▆▆▇▃▂▇▄▅▁▃▄
wandb:   val_balanced_accuracy0.5 ▃▃▃▃▃▅▃▅▆▃▃▅▄▁▆▄▄▃▆▆▆▅▅▆█▆▇▅█▇▅▄▇▆▅▅▅▅▁▄
wandb:  val_balanced_accuracy0.75 ▃▃▃▃▄▃▃▃▂▂▄▆▁▅▅▄▅▅▅▄▅█▄▅▄█▄▆▅▆▄▅▃▁▃▆▄▅▆▃
wandb:          val_precision0.25 ▃▃▃▃▃▃▃▂▄▆▃▄▅▆▆▅▅▅▄▆▅▅▄▆▃▅█▅▅▃▆▇▅▄█▅▁▄▄▄
wandb:           val_precision0.5 ▆▆▁█▆▅█▇▇▅▆▄▆▆▆▆▆▆▇▇▇▆▇▆▇▆▆▆▆▇▆▆▆▆▆▆▅▅▆▆
wandb:          val_precision0.75 ▁▁▁▆▄▁█▆▄▄▃▄▄▄▄▄▄▄▅▄▄▄▄▄▃▄▄▄▄▄▄▄▄▄▄▄▄▄▃▄
wandb:             val_recall0.25 ██▇█▄▅▄▁▂▂▃▄▄▅▄▄▂▅▇▃▄▆▆▅▆▅▄▆▆▇▇▆▆▅▆▇▆▅▇▇
wandb:              val_recall0.5 █▁█▆▂▄▂▃▂▂█▂▃▅▅▅▅▅▅▅▆▅█▄▅▇▇▇▆▆▇▇▇▇▆▆▇▆▅▇
wandb:             val_recall0.75 ▁▁▁▁▁▁▂▁▂▂▃▆▃▇▆▅▆▆▅█▅▆▆▇▆▇▅▆▇▇▇▇▇▅▆▆▆▅▄▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.27848
wandb:           test_accuracy0.5 0.29114
wandb:          test_accuracy0.75 0.27848
wandb:                 test_auroc 0.39661
wandb: test_balanced_accuracy0.25 0.45085
wandb:  test_balanced_accuracy0.5 0.42627
wandb: test_balanced_accuracy0.75 0.40127
wandb:         test_precision0.25 0.23188
wandb:          test_precision0.5 0.21875
wandb:         test_precision0.75 0.20635
wandb:            test_recall0.25 0.8
wandb:             test_recall0.5 0.7
wandb:            test_recall0.75 0.65
wandb:                train_auroc 0.99964
wandb:                 train_loss 0.04173
wandb:           val_accuracy0.25 0.32381
wandb:            val_accuracy0.5 0.34286
wandb:           val_accuracy0.75 0.35238
wandb:                  val_auroc 0.48126
wandb:  val_balanced_accuracy0.25 0.52483
wandb:   val_balanced_accuracy0.5 0.51168
wandb:  val_balanced_accuracy0.75 0.50511
wandb:          val_precision0.25 0.25806
wandb:           val_precision0.5 0.25287
wandb:          val_precision0.75 0.25
wandb:             val_recall0.25 0.92308
wandb:              val_recall0.5 0.84615
wandb:             val_recall0.75 0.80769
wandb: 
wandb: 🚀 View run resnet50_2d_78_3_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/1ygwpyk0
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_3/wandb/run-20250701_130130-1ygwpyk0/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_3/wandb/run-20250701_133707-mi0cw922
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_3_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/mi0cw922
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 █▁▁███▁▁███▁█▁▁▁▁█▆█▁████▁█▁▁█▁█▁████▁█▇
wandb:          test_accuracy0.75 ███▁█████████████████▇██████████████████
wandb:                 test_auroc ▁▃▂▃▄▂▂▂▃▃▂▂▃▃▃▃▃▃▂▃▄▆▅▄▄▄▃▅▄▄█▇▆▆▅▇▆▅▅▇
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄█▄▃▃▆▃▄▄▄▆▂▁▄▄▄▄▄▄▄▄▄▄▄▆
wandb: test_balanced_accuracy0.75 ▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▃▃▃▁▃█▁▁▁▁▁▃▃▁▃▁▃▄▃▃▃▃▁▁▁▃▃▁▁▃▁▁▃▃▁▁▃▁▃▁
wandb:         test_precision0.75 ▁▁▃▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ██▁█▁██▁▁█▁█▁█▁█▁█▆▅▁█▁▁▁▂███▁▁▁██▁▁█▁▇▄
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▂▁▁▂▃▂▂▃▂▃▄▃▄▁▁▂▂▂▅▄█▃▄▆▂▆▆▆▂▂▂▃▂▁▃▂▅▄▆▇
wandb:                 train_loss ▇▇▇▇▇█▇▇▇▆▇▇▇▇▇▇█▇▇▇▆▇▆▁▇█▇▄▃▆▇▇▇▇▇▇▇▇▇▇
wandb:           val_accuracy0.25 █▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 █▁▁▁▁▁▁█▁▁▁█▁██▃▅█▆█▁███▇█▁▁▁███████▁▁▁█
wandb:           val_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁█▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:                  val_auroc ▅█▅▆▆▆▇▇▇▇▇▆▇▇▆▆▇▇▇▇▁▅█▆▆▂███████████▇█▇
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▂▂█▂▂▂▂▂▂▂▂▂▂▂▂▂▄▂▂▄▂▂▂▂▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▆
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▄▄▄▅▄▁▄▁▁▁▁▄▁▄▄▁▁▄▁▄▅▅█▁▁▄▄▄▄▁▄▄▁▄▁▄▄▁▄▄
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ██▁▂█▁██▁█▁▁███▁▁▁██▁█▁▁▁▁▁▁██▁▁█▁▁▁██▆▄
wandb:             val_recall0.75 ▁▁█▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.70886
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.57119
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5572
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.38462
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.25
wandb:            test_recall0.75 0
wandb:                train_auroc 0.5951
wandb:                 train_loss 2.03726
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.66667
wandb:           val_accuracy0.75 0.7619
wandb:                  val_auroc 0.66212
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.58496
wandb:  val_balanced_accuracy0.75 0.51923
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.35484
wandb:          val_precision0.75 1
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.42308
wandb:             val_recall0.75 0.03846
wandb: 
wandb: 🚀 View run resnet50_2d_78_3_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/mi0cw922
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_3/wandb/run-20250701_133707-mi0cw922/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_3/wandb/run-20250701_135352-9gf0gwh1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_3_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/9gf0gwh1
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: uploading history steps 392-393, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▃▂▇▆▅▇▅▆▆▆▅█▅▅▅▂▄▃▅▄▆▅▃▄▃▄▅
wandb:           test_accuracy0.5 ▁█▁▁▁█▅█▇█▄▂▇██▂▆▇▇█▆▆▆█▄▅▄▅▇▇▅▅▆▆▃▆▅▅▃▆
wandb:          test_accuracy0.75 ████████████▇▇▇▇▇▆▇▅▆▅▇▇▃▅▅▄▅▄▃▄▅▄▆▁▄▆▂▃
wandb:                 test_auroc ▄▄▅▁▃▄▄▄▄▃▅▅▃█▅▄▆▄▇██▅▅▄▆▆▅▄▄▆▄▅▆▅▆▅▄▄▄▄
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▅▃▄▅▅▃▅▅▃▅█▄▃▄▂▆▆▆▅▆▇▄▆▆▅▅▅▆▃▁▄
wandb:  test_balanced_accuracy0.5 ▃▃▃▂▆▄▃▅▅▃▅▅█▄▅▆▂▄▅▅▄▅▄▇▅▅▃▅▃▄▅▅▅▆▄▃▃▂▁▂
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃▃▃▂▃▃▄▃█▅▇▆▄▁▂▄▆▃▅▄▇▄▄▅▅▅▅▅▃▄▁▂▃▂▆
wandb:         test_precision0.25 ▂▂▂▂▂▃▂▃▁▅▃▂▂▄▄▄▂▃▄▃▂▂▂▃▅▁▃▃▄▃▅▂▄▂▃▁▁▁▄█
wandb:          test_precision0.5 ▅▄▁█▆▅▅▁▁▆▆▆▃▆▇▅▅▄▅▅▅▅▅▆▇▇▅▅▅▆▅▅▅▅▅▅▅▆▅▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▆▁▁▇▇▁▇▆▆▆▆█▇▅▅▅▆▆█▇▅▆▅▆▅▆▆▅▅▅▇▆█
wandb:            test_recall0.25 ███▆███████▁▃▄▅▅▅▆▄▄▄▃▃▂▂▂▂▃▂▆▇▄▆▄▄▇▄▄▃▄
wandb:             test_recall0.5 █▁▁█▅▃▆▁▃▃▃▃▂▄▃▅▅▃▅▄▅▅▃▄▄▄▃▃▄▄▃▂▄▅▅▆▅▆█▅
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▂▁▁▁▁▃▄▄▅▃▄▅▄▄▄▄▄▅▅▅▅▅▃▄▆▅▄▅▅▅█▅▃
wandb:                train_auroc ▂▃▁▃▃▄▄▃▂▃▅▆▅▆▅▇██████▇▇████████████████
wandb:                 train_loss ▇▇▇▇▆▆▆▆▇█▅▄▄▄▃▃▃▂▂▁▄▂▂▁▂▃▂▂▃▂▂▁▁▁▁▁▂▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁█▁▁▁▁▆▆▁▅▆▇▄▄▅▄▅▄▅▄▆▁▁▅▃▄▄▄▃▃▅▅▄▅▅▃
wandb:            val_accuracy0.5 ██▃▇▆▇▁█▇▅▅▄▅▅▄▃▂▂▅▅▆▃▂▅▃▁▂▄▃▃▅▂▂▃▄▄▄▃▃▃
wandb:           val_accuracy0.75 ██████████████▆▄▃▄▃▅▄▅▂▃▂▃▂▂▅▂▃▅▄▁▃▆▄▄▃▅
wandb:                  val_auroc ▇▆▆▇▇██▅▆▆▇▄▆▅▅▆▅▅▂▂▅▄▄▅▂▅▅▂▄▄▅▄▅▄▄▃▃▂▁▅
wandb:  val_balanced_accuracy0.25 ▅▅▅▅▅▅▅▅▄▅▆▆▁▆▄▅▃▄▅▇▅▄▆▇▆█▇█▇▆▅▇▃▄▂▇▆▄▆▅
wandb:   val_balanced_accuracy0.5 ▂▂▁▁▆▃▁█▂▄▅▆▅▅▇▂▅▄▆▃▂▃▆▂▁▃▅▂▄▄▂▆▂▅▃▃▆▃▃▁
wandb:  val_balanced_accuracy0.75 ▃▃▃▃▃▃▃▃▃█▅▅▃▆▂▆▅▆█▄▄▄▄▅▃▂▂▂█▄▅▅▁▂▃▂▁▃▄▅
wandb:          val_precision0.25 ▄▄▄▄▄▄▆▃▆▇▃▆▅▃▅▄▄▄▆▅█▃▅▄▃▂▅▁▆▅▅▆▄▁▁▄▁▃▄▄
wandb:           val_precision0.5 ▁▅▅▁▁▅▁█▆▆▆▅▅▄▅▅▅▆▆▆▅▅▅▄▄▄▅▅▅▅▅▅▃▅▅▅▅▅▅▄
wandb:          val_precision0.75 ▁▃▁▁▁▇▁▁▁▁▁▄█▅▅▃▃▄▄▄▃▃▄▃▃▃▃▃▃▃▄▃▃▃▃▃▃▃▃▃
wandb:             val_recall0.25 ██████████▂▃▅▅▅▃▁▄▅▄▅▂▃▅▄▅▇▅▄▅▆▅▂▄▄▃▅▂▅▄
wandb:              val_recall0.5 ▅▁▂█▁█▅▆█▁▆▁▃▃▃▃▄▆▄▅▄▄▅▅▅▆▆▆▂▆▃▃▄▅▅▆▆▆▄▆
wandb:             val_recall0.75 ▁▁▄▁█▁▁▁▁▂▁▁▁▁▁▃▃▃▅▂▃▄▅▄▄▂▄▄▄▅▅▆▃▄▄▅▅▄▂▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.67089
wandb:           test_accuracy0.5 0.72152
wandb:          test_accuracy0.75 0.73418
wandb:                 test_auroc 0.60254
wandb: test_balanced_accuracy0.25 0.54831
wandb:  test_balanced_accuracy0.5 0.5822
wandb: test_balanced_accuracy0.75 0.55763
wandb:         test_precision0.25 0.33333
wandb:          test_precision0.5 0.42857
wandb:         test_precision0.75 0.44444
wandb:            test_recall0.25 0.3
wandb:             test_recall0.5 0.3
wandb:            test_recall0.75 0.2
wandb:                train_auroc 0.99175
wandb:                 train_loss 0.38777
wandb:           val_accuracy0.25 0.6381
wandb:            val_accuracy0.5 0.66667
wandb:           val_accuracy0.75 0.71429
wandb:                  val_auroc 0.51826
wandb:  val_balanced_accuracy0.25 0.54017
wandb:   val_balanced_accuracy0.5 0.53335
wandb:  val_balanced_accuracy0.75 0.55209
wandb:          val_precision0.25 0.3
wandb:           val_precision0.5 0.30435
wandb:          val_precision0.75 0.375
wandb:             val_recall0.25 0.34615
wandb:              val_recall0.5 0.26923
wandb:             val_recall0.75 0.23077
wandb: 
wandb: 🚀 View run resnet50_2d_78_3_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/9gf0gwh1
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_3/wandb/run-20250701_135352-9gf0gwh1/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_3/execution_datetimes.json

**************************************************  Experiment 78 | Version 5 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 36, 1.0: 28}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 32, 1.0: 32}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 27, 1.0: 37}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 26, 1.0: 34}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_5/wandb/run-20250701_143114-yoqv8o0h
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_5_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/yoqv8o0h
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading wandb-summary.json; uploading config.yaml
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▂▁▂▁▁▁▁▄▇▇▇▇▆▇▅▇▆█▆▄▄▅▅▆▅▄▄▃▃▃▄▄▄▄▇
wandb:           test_accuracy0.5 ▇█▅▇▅▂█▄█▇█▇▇▃█▄▅▃▄▂▁▄▃▂▃▃▂▃▃▂▆▁▃▂▂▁▁▁▁▁
wandb:          test_accuracy0.75 ██████▁█████████▇▆▆█▇▄▄▅▄▅▅▅▄▄▄▄▄▄▄▄▃▂▃▃
wandb:                 test_auroc █▆▆▅█▅▅▅▇▅▅▅▅▆▄▄▅▄▅▃▆▂▆▂▁▄▄▃▃▄▆▃▂▃▅▂▃▂▂▂
wandb: test_balanced_accuracy0.25 ▅▅▅▅▃▅▅▅▅▆▄▅█▅▇▆▅▆▇▅▆▆▄▄▄▇▇▇▇▅▅▅▆▄▁▄▄▅▅▇
wandb:  test_balanced_accuracy0.5 ▅█▄▄▄▇▆▄▄▂▃▂▇▆▅▄▄▄▄▂▁▄▃▂▂▅▄▁▅▂▅▅▂▄▁▁▁▂▃▅
wandb: test_balanced_accuracy0.75 ▅▆▆▆▅▆▆█▅▅▅▅▅▅▇█▆█▇▆▇▄▃▂█▂▄▅▃▄▃▄█▃▁▃▁▂▂▂
wandb:         test_precision0.25 ▅▃▅▅▅▃▃▅▅▅▅▅▅▆▁▅▃██▇▅▇▇▄▄▅▅▆▃▄▅▂▄▄▆▅▃▅▄▅
wandb:          test_precision0.5 ▂▂▄▂▅▄█▇▂▂▆▂█▆▅▄▂▇▅▃▂▃▂▃▂▁▃▂▂▂▂▂▃▂▂▃▃▂▂▂
wandb:         test_precision0.75 ▁█▁▁▁▇▁▁▁▁▅▅▅▅▅▅▅▅▅▄▅▄▅▅▅▄▄▄▄▄▅▆▅▅▅▄▄▄▅▄
wandb:            test_recall0.25 █▆▇▇▇███▁█▄▄▃▂▄▄▄▄▅▃▄▆▃▅▃▄▃▅▅▃▃▁▅▅▅▂▆▇▂▄
wandb:             test_recall0.5 ▁▁▅▁▆▁▆▁▄▅▄▆▄▇▆▇▇▄█▆▆▇▆▆▃▆█▅▆▇▆▇▄▆▆▆▆▇█▆
wandb:            test_recall0.75 ▂▂▁▂▂▁▁▁▁▂▄▃▅▄▄▇▅▇▆█▆▆▃▃▅▇▇▆▆▇▇▇▆▆█▆▇▇▇▇
wandb:                train_auroc ▁▃▄▃▄▆▃▃▅▅▄▇▇▇██████████████████████████
wandb:                 train_loss ▄▄▄▄▅█▄▃▄▄▄▄▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▂▂▅▂▂█▂▂▂▂▃▄▂▂▃█▄▂▅▂▂▃▄▆▃▃▄▄▄▄▂▂▃▄▂▅▁▁▁▁
wandb:            val_accuracy0.5 ▁█▆█▂▇▆▇▃▇▆▇██▇▆▅▅▄▂▂▃▂▂▅▂▁▂▂▂▃▃▃▄▅▃▁▁▁▁
wandb:           val_accuracy0.75 ███████████▅▇▅▃▃▄▃▅▂▂▂▃▂▃▂▄▃▄▂▅▃▃▄▅▁▁▁▁▄
wandb:                  val_auroc ▇█▇▆▄▃▅▇▇▇▅▃▃▄▃▃▁▁▅▂▃▃▃▃▂▂▂▁▁▂▁▂▄▃▃▂▂▂▁▃
wandb:  val_balanced_accuracy0.25 ▇▇▇▇▇▆▇▇▇▇█▇▇▂▂▃▄▃▂▄▄▄▃▅▂▂▅▃▃▅▄▃▄▃▁▂▃▂▃▄
wandb:   val_balanced_accuracy0.5 ▆█▆▇▆▆▅▆▆▆▆▃▃▃▅▄▃▄▄▁▃▄▂▂▂▄▅▃▃▄▃▄▄▁▂▂▂▄▂▄
wandb:  val_balanced_accuracy0.75 ▆▇▇█▇▆▆▆█▆▅▇▅▄▇▅▄▃▂▅▂▄▂▃▅▃▁▂▂▆▅▅▂▁▂▄▄▂▂▂
wandb:          val_precision0.25 ▇▇▇▇▇▇▃▇▇▇▇▇█▇█▇▇▂▇▃▄▄▁▂▄▁▃▅▃▅▅▂▄▃▃▄▄▃▂▃
wandb:           val_precision0.5 ▅▅▆▆▆▅▁▃▄▃█▅▃▅▄▄▄▄▄▄▄▄▄▄▅▅▃▃▄▅▄▄▄▃▄▄▄▄▃▄
wandb:          val_precision0.75 ██▁█▄▁▂▁▁▁▁▁█▁▄▃▂▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:             val_recall0.25 ██▁██▃██▅▆▃▅▅▃▅▅▄▅▄▄▅▄▄▆▄▆▅▃▄▄▃▄▅▅▅▄▆▅▆▃
wandb:              val_recall0.5 ▁█▃▄▂▂▃▄▂▂▃▁▂▆▁▂▄▃▃▃▄▅▄▄▅▃▄▅▄▄▄▄▃▃▃▅▅▄▅▅
wandb:             val_recall0.75 ▁▂▂▁▃▃▄▅▅▅▅▄▅▅▆▅▅▆▆▅▆▇█▇▄▆▇▆▆▆▄▄█▇▇███▅▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.40506
wandb:           test_accuracy0.5 0.43038
wandb:          test_accuracy0.75 0.4557
wandb:                 test_auroc 0.48644
wandb: test_balanced_accuracy0.25 0.50254
wandb:  test_balanced_accuracy0.5 0.45339
wandb: test_balanced_accuracy0.75 0.45381
wandb:         test_precision0.25 0.25455
wandb:          test_precision0.5 0.22222
wandb:         test_precision0.75 0.21951
wandb:            test_recall0.25 0.7
wandb:             test_recall0.5 0.5
wandb:            test_recall0.75 0.45
wandb:                train_auroc 0.99984
wandb:                 train_loss 0.05413
wandb:           val_accuracy0.25 0.27619
wandb:            val_accuracy0.5 0.32381
wandb:           val_accuracy0.75 0.34286
wandb:                  val_auroc 0.33325
wandb:  val_balanced_accuracy0.25 0.33836
wandb:   val_balanced_accuracy0.5 0.34421
wandb:  val_balanced_accuracy0.75 0.33106
wandb:          val_precision0.25 0.16216
wandb:           val_precision0.5 0.15385
wandb:          val_precision0.75 0.13559
wandb:             val_recall0.25 0.46154
wandb:              val_recall0.5 0.38462
wandb:             val_recall0.75 0.30769
wandb: 
wandb: 🚀 View run resnet50_2d_78_5_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/yoqv8o0h
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_5/wandb/run-20250701_143114-yoqv8o0h/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_5/wandb/run-20250701_152909-utah8vqb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_5_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/utah8vqb
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▅▂▁▁▁▂▇▄▃█▁▁▁▇█▅▆▅▅▆▇▅▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ████▇▇▄▆▆▅▁█▁█▂▆▅▇▇███████▇▇█▆▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ███▇███▇▅▅██████████▁█████▆▇▇▆▆▇▇▆▆█████
wandb:                 test_auroc ▁▅█▅▄▄▄▅▄▅▄▅▄▇▅█▆▇▆▄▅▆▆▄▅▅▅▅▃▄▄▃▃▃▄▄▄▃▃▄
wandb: test_balanced_accuracy0.25 ▂▂▂▂▄▂▂▂▅▅▄▆▄▃▅▃▅▂▄▁▃▂▅▂▃▂▅█▆▄▂▂▂▂▂▂▂▂▂▂
wandb:  test_balanced_accuracy0.5 ▃▃▄▃▆█▃▃▁▃▃▃▂▅▃▆▃▁▄▃▆▄▃▃▃▃▂▄▃▃▃▃▃▃▃▃▃▃▃▃
wandb: test_balanced_accuracy0.75 ▄▃▇▄▄▄▆▅▃▄█▄▄▄▅▄▆▄▄▄▄▄▄▁▆▅▅▇▄▄▄▄▄▄▄▄▄▄▄▄
wandb:         test_precision0.25 ▆▇▆▇▆▆▆▆▇▇▆▆█▆▆▅▅▆▆▆▆▆▆▆▇▆▁▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          test_precision0.5 ▃▃▃▃▄▅▁▁▃▃▁▃▁█▄▄▃▃▁█▁▁▁▄█▁▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:         test_precision0.75 ▆▁▄▆▇▅▅▅▄▁▁▁▅▅▁▁▁█▁▁▁▅▁▃▄▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ███████████▇▃▆▄▂█▅▄▇▁▅███▂▄▅▄▃██████████
wandb:             test_recall0.5 █▁▅▆▃▃▁▂▁▃▆▅▁▂▁▅▁▂▂▁▁▁▁▁█▂▂▂▄▂██████████
wandb:            test_recall0.75 ▁▁▂▁▁▃▃▅▃▁▁▄▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃█▃▃▁▅▁▁▁▁▁▁▁
wandb:                train_auroc ▄▂▄▄▄▄▆▇▃▂▃▃▃▄▃▅▇▇▅▅▆▆▃▅▆████▃▂▁▂▂▁▂▂▂▃▂
wandb:                 train_loss ▆▆▆▅▅▅▅▅▄▄▆▆▆▅▄▅▅▄▄▄▂▂▁▁█▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:           val_accuracy0.25 ▁▁▁▂▁▃▁▁▁▁▁▁▁▁▂▆▁█▁▁▁▃▆▆▇▄▅▆▆▆▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ▁██▄▄█▇█▃▄▇▇█▂▇▇▇████▇▆▇▇▇▅▇▅▅▆▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.75 ██▇▅▄█▇█▇██████▆▆███▁███▇▆▆▇▆▅██████████
wandb:                  val_auroc █▇▇▇▅▁▇█▇▄▄▁▂▂▂▃▂▄▁▃▂▃▄▃▄▄▄▄▄▄▄▄▄▄▄▄▄▃▄▄
wandb:  val_balanced_accuracy0.25 ▆▆▆▆▆▆▆▆▃▃▆▆▆▆▆▆▆▂▁▅▇▆▆▂▆▃█▄▇▅▅▆▆▆▆▆▆▆▆▆
wandb:   val_balanced_accuracy0.5 ▄▄▇▇▆▅▁▄▇▅█▆▄▃▃▃▅▆▅▃▂▃▃▂▄▃▃▃▃▄▄▄▄▄▄▄▄▄▄▄
wandb:  val_balanced_accuracy0.75 ▃▃▄▅▅▅█▄▃▃▃▃▃▄▅▅▅▄▃▃▃▃▂▃▃▂▃▂▄▁▄▂▄▆▃▃▃▃▃▃
wandb:          val_precision0.25 ▅▅▅▅▅▅▅▅▅▅▄▅▅▅█▅▅▅▃▁▂▅▅▁▅▄▄▂▅▅▄▅▅▅▅▅▅▅▅▅
wandb:           val_precision0.5 ▃█▅▃▄▃█▄▃▁▃▃▄▁▂▁▃▅▁▁▂▂▂▂▃▃▂▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:          val_precision0.75 ▁▅█▃▃▁▁▁▃██▃▁▁▁▃▁▁▁▁▁▁▂▃▃▃▃▃▃▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ███▅▅████████▇▃▅████▆▄▁▄▄▂▂▂▂▂▂▂▇███████
wandb:              val_recall0.5 ▁█▂▃▄▅██▂▃▃▁▂▃▁▁██▂▁▁▁▂▂▂▂▃▃▄▁██████████
wandb:             val_recall0.75 ▁▁▂▃▃▃█▄▆▅▅▁▁▁▃▃▂▁▁▁▄▁▃▁▁▁▅▆▅█▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.25316
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.525
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.5
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.25316
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 1
wandb:            test_recall0.75 0
wandb:                train_auroc 0.43557
wandb:                 train_loss 2.09362
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.24762
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.50706
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.5
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.24762
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 1
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet50_2d_78_5_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/utah8vqb
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_5/wandb/run-20250701_152909-utah8vqb/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_5/wandb/run-20250701_164317-fh35qxjq
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_5_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/fh35qxjq
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▂▁▁▁▅▄▄▇▇▄▆▅▂▃█▇▅▆▅█▆▃▇▄▃▂▆▆▇▇▃▃▅▄▇▅▅▄
wandb:           test_accuracy0.5 ███▇▃▇█▆▆▆▅▂▅▃▄▁▄▃▄▂▁▂▅▄▁▃▂▃▁▃▂▂▁▂█▃▂▃▄▂
wandb:          test_accuracy0.75 ████████▇▇▇██▆▅▄▄▃▆▅▄▆▅▃▄▄▄▅▅▂▃▅▂▂▄▄▃▁▄▄
wandb:                 test_auroc ▆▇▆▆▆▇█▇██▁▆▄▄▄▁▁▃▂▂▅▂▂▆▆▃▃▁▃▄▃▃▂▃▆▃▄▅▃▄
wandb: test_balanced_accuracy0.25 ▆▆▆▅▅▆▇█▅▆▆▅▄▂▄▅▆▅█▅▄██▄▇▅▃█▇▅▆▁▂█▇▃▅▇█▄
wandb:  test_balanced_accuracy0.5 ▅▅▅▇▄▆██▃▃▄▃▆▃▂▄▄▅▃▄▄▂▂▂▅▄▄▄▄▅▃▃▁▄▃▄▅▃▂▄
wandb: test_balanced_accuracy0.75 ▆▆▆▆▆▇▆▆▆▅▇▄▂▅▇▆▄▃▄▃▆▆██▇▃▄▃▄▄▆▇▄▁▅▄▄▆▇▅
wandb:         test_precision0.25 ▇▇▆▆▆▇▇▇▇▇▇▇▅█▆▆▅▆▄▄▁▇▇▆▆▆██▇▆▆▆▆▆▅▆▆▆▇▇
wandb:          test_precision0.5 ▆▁▅▄▄▆█▆▃▅▃▄▅▃▄▄▃▃▄▃▃▃▄▄▄▄▄▄▄▄▄▃▄▄▃▄▄▃▃▃
wandb:         test_precision0.75 ▁▁▁█▁▁▁▅▁▁▁▁▁▂▂▃▂▃▃▁▃▃▃▃▃▃▃▂▃▂▃▃▂▂▃▃▂▂▂▃
wandb:            test_recall0.25 ███████▆▇▁▃▇▆▅▄▃▄▃▇▅▅▅▆▆▅▄▄▆▆▅▆▆▅▅▅▅▇▆▇▁
wandb:             test_recall0.5 ▁▂▁▄▃▆▅▂▁▁▃▃▃▄▃▄▅▄▃▃▂▅▂▄▅▆▇▅▆▃▆▆▅▅▅▅█▅▆▂
wandb:            test_recall0.75 ▁▁▂▁▁▃▁▂▃█▄▅▄▅▄▃▅▆▆▆▅▆█▃▆▆▇█▃▁▇▇▆▆█▇▆▆▇█
wandb:                train_auroc ▁▁▁▁▁▃▃▁▂▃▅▅▆▆▆▇▃▄▇▇████████████████████
wandb:                 train_loss █▆▇▆▆▃▄▃▂▂▃▂▃▂▁▂▂▁▄▂▂▁▁▁▂▁▂▁▁▂▁▁▁▁▂▄▄▂▂▄
wandb:           val_accuracy0.25 ▁▁▂▂▂▁▁▃▃▃▄▂▅▃▄▅▃▅▄▇▃▃▆▄▃▃▄▄▃▃▂▃▃▃▃█▅▄▃▇
wandb:            val_accuracy0.5 ▇▇▄██▆▆█▄▄▇▇▅▄▃▆▂▆▄▄▃▃▅▃▄▃▃▁▃▃▂▁▆▄▂▄▅▃▂▂
wandb:           val_accuracy0.75 ███████████▆▇▇█▅▆▅▄▄▇▃▄▅▄▂▂▅▄▄▅▃▄▃▃▃▄▄▁▃
wandb:                  val_auroc ▆▇▆▆▆▇▇▇█▇▄▆▆▅▅▃▆▂▅▅▁▂▄▃▄▇▂▂▄▄▂▄▆▃▂▂▁▂▂▃
wandb:  val_balanced_accuracy0.25 ▆▆▆▆▅▆▆█▆█▄█▇▄▅▁▆█▆▇▆▆▃█▅▆▆▇▄▅▆▆▆▆▅▆▇▅█▆
wandb:   val_balanced_accuracy0.5 ▂▂▇█▂▂▅▇▆▇▆▆▅▄▇▆▅▂▄▅▂▄▂▅▂▃▄▄▃▂▄▃▂▄▃▁▂▃▃▄
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▂▅▇▂▂▆▇▅▄▇▆▃▃▃▅▃█▃▃▁▂▆▁▄▃▅▆▅▂▂▁▄▄▄▁▂
wandb:          val_precision0.25 ▄▅▅▄▅▆▅▅█▄▃▇▃▄▃▆▄▃▅▆▃▅▆▇▅▅▄▇▆▇▅▃▆▃▂▃▃▅▄▁
wandb:           val_precision0.5 ▁▁▁▆▇█▅▇▅▇▆▆▄▅▅▆▅▅▅▆▅▄▅▅▄▅▄▄▄▅▅▅▅▄▄▅▅▅▅▄
wandb:          val_precision0.75 ▁▅▁▆▁█▆▇▆▅▃▇▅▄▅▄▄▄▄▄▄▄▄▄▃▄▄▃▄▄▄▃▃▄▄▄▄▇▄▄
wandb:             val_recall0.25 ███▇▇██▆█▇▄▅█▃▅▇▄▃▅▃▄▇▄▄▁▄▄▄▅▅▄▇▄▄▅▆▃▅▄▅
wandb:              val_recall0.5 █▁▁▅▆▄▄▄▅▅▅▄▅▄▅▄▅▆▆▅▅▅▆▅▆▅▅▆▆▆▆▆▆▆▅▄▄▅▅▇
wandb:             val_recall0.75 ▁▁▁▁▃▃▄▁▄▂▇▆▇▆▆█▆▇▆▅▆▆▇▆▇▇▇███▆▆▆▆▇▅▆▇▇▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.60759
wandb:           test_accuracy0.5 0.63291
wandb:          test_accuracy0.75 0.63291
wandb:                 test_auroc 0.45678
wandb: test_balanced_accuracy0.25 0.45636
wandb:  test_balanced_accuracy0.5 0.47331
wandb: test_balanced_accuracy0.75 0.44025
wandb:         test_precision0.25 0.17647
wandb:          test_precision0.5 0.2
wandb:         test_precision0.75 0.09091
wandb:            test_recall0.25 0.15
wandb:             test_recall0.5 0.15
wandb:            test_recall0.75 0.05
wandb:                train_auroc 0.97893
wandb:                 train_loss 1.03838
wandb:           val_accuracy0.25 0.61905
wandb:            val_accuracy0.5 0.64762
wandb:           val_accuracy0.75 0.69524
wandb:                  val_auroc 0.49294
wandb:  val_balanced_accuracy0.25 0.4888
wandb:   val_balanced_accuracy0.5 0.49489
wandb:  val_balanced_accuracy0.75 0.51363
wandb:          val_precision0.25 0.23077
wandb:           val_precision0.5 0.2381
wandb:          val_precision0.75 0.28571
wandb:             val_recall0.25 0.23077
wandb:              val_recall0.5 0.19231
wandb:             val_recall0.75 0.15385
wandb: 
wandb: 🚀 View run resnet50_2d_78_5_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/fh35qxjq
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_5/wandb/run-20250701_164317-fh35qxjq/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_5/execution_datetimes.json

**************************************************  Experiment 78 | Version 8 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 5}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 6}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 7}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_8/wandb/run-20250701_171800-32ska9jb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_8_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/32ska9jb
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▅▁▇▆▅▇▇▇▇▇███▇▇█▇▇▇▇████▇██▇▇▇▇█▇
wandb:           test_accuracy0.5 ▁▇▆▇▄▇▇█▇▇████▇▇▇▇▇▇█▇███▇▇█▇█▇▇▇▇▇▇▆█▇▇
wandb:          test_accuracy0.75 ▇▇▇▇▇▇▄▄▄▆▇▇▅▅▃▃▂▅▄▂▅▆▆▇▃▆█▆▄▄▇▁▅▄▅▄▆▂▂▁
wandb:                 test_auroc ▄▃█▃▃▅▃▇▃▅█▆▄▆▆▅▁▄▅▆▆▆▄▄▅▅▅▄▄▅▆▅▃▃▇▆▅▅▇▆
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▄▃▇▇▆▄▅▁▃▇▇▄▆█▇▆▅▅▇▆▇▇▇▆▆▇▆▆▄▄▅▄▆
wandb:  test_balanced_accuracy0.5 ▃▃▃▅▂▃▇▄▄▆▄▄▃▃▅▆▅▁▄▃▆▆▃▆▄▅▃▃▃▇▃▆▄▆▆▆▅█▅▆
wandb: test_balanced_accuracy0.75 ▃▃▃▃▁▄▅▄▄▅▅▅▄▁▅▇▅▅▄█▇▃▄▃▄▅▆▅▄▄▆▇▄▄▄▅▅▅▃▅
wandb:         test_precision0.25 ▂▂▂▂▂▃▂▁▁▃▂▄▃▄▄▁▆▆▄▄▂▇▇▅▂▇▅█▃▇▅▃▄▄▄▃▄▄▆▆
wandb:          test_precision0.5 ▁▁▁▁▅▆▅▇▅▆▅▆▅▆▅█▅▆▅▇▆▅▆▅▅▆▅█▇▆▅▇█▄▆▆▅▆▆▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▂▁▁▆▁▅▅▆▆▆▆▇▅▆▇▅▅▅▅▆▇▇▆▆▆▅▄▆▆█▆▅▅▇
wandb:            test_recall0.25 █████▇█▆██▇▆▄▂▃▁▁▁▁▂▂▂▁▁▃▁▃▂▄▂▃▃▂▃▃▃▃▁▃▂
wandb:             test_recall0.5 █▁▁▃▃▅▅▄▂▂▃▃▂▃▂▂▂▂▃▂▂▂▂▃▃▂▃▃▂▃▃▃▂▂▃▃▃▂▂▃
wandb:            test_recall0.75 ▁▁▁▁▁▂▂▁▃▅▄▂▄▅▄▄▄█▅▃▄▃▃▅▄▃▃▃▄▂▂▄▅▄▅▄▄▄▃▃
wandb:                train_auroc ▁▂▄▄▆█▇████████████████▇▅███████████████
wandb:                 train_loss ██▇▄▂▁▂▂▁▁▁▁▁▁▂▁▁▂▄▁▁▂▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▆▁▁▂▂▂▁▂▅▁▇▇▆▇▆▇▇▆▇▇▇█▆▇▆▆▇▆██▇▇▇▇▆▆▆▇▇▆
wandb:            val_accuracy0.5 ▁▆▅▆▇▆▆▆▆▇▅▇▆▆▇▆▆▆▇▇▇▇▇▇█▆▆▇▆▇█████▇▆▆▇▆
wandb:           val_accuracy0.75 ▇▆▇▇▇▇▁▇▄▇▅▆▅▅▆▆▆▅▄▅▆▆▄▆▆▇▅▆▆▅▆█▅▇█▆▄▄▆▅
wandb:                  val_auroc ▂▁▂▃▃▃▂▄▂▂▃▃▄▄▃▃▃▅▃▄▃▃▄▃▃▆▆▁▂▆▆▇███▇▅▆▅▄
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▃▂▂▅▂▃▃▃▃▃▁▅▄▄▃▄▄▂▄▄▃▃▄▇▄▆▅█▃▅▅▄▃▃▃▃
wandb:   val_balanced_accuracy0.5 ▃▂▃▅▅▃▃▂▄▄▁▃▄▁▃▃▆▅▅▃▄▄▄▅▅▆▄▄▃▇▆▅▇▇██▄▆█▄
wandb:  val_balanced_accuracy0.75 ▃▂▃▂▃▄▃▄▄▁▂▁▄▂▂▃▂▂▂▄▃▄▃▄▄▆▆▇▆▅█▇▆▃▄▄▄▄▄▃
wandb:          val_precision0.25 ▅▅▅▅▅▅▅▆▅▆▆▅▆▃▄▆▆▅▄▆▅▆▅██▅▅▁▇█▇▇▇▇▇▆▆▆▆▅
wandb:           val_precision0.5 ▁▄▃▃▅▄█▅▃▆▅▃▅▅▅▅▅▅▇█▅▆▅▆▇█▆▇▆▆███▆▆▆▅▅▆▅
wandb:          val_precision0.75 ▁▁▁▁▁▇▅▅▃▄▅▃▃▃▄▄▄▅▄▄▅▅▄▇▆▇▆▅█▅▆▆▆▆▅▅▅▆▆▄
wandb:             val_recall0.25 █████▇▅▅█▅▃▃▂▂▂▃▃▃▃▃▄▂▃▃▃▂▂▃▁▃▅▅▅▄▅▄▄▄▂▃
wandb:              val_recall0.5 ▇▄▅█▄▂▃▁▃▂▂▂▂▂▁▂▃▂▃▃▂▂▃▂▃▂▃▃▄▃▄▄▃▃▄▃▂▃▃▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▄▅▃▂▂▂▂▇▃▆▅▅▅▅▅▅▅▅▅▆██▅▅▇▇▆▇▄▃▅▄
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.64557
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.6962
wandb:                 test_auroc 0.58559
wandb: test_balanced_accuracy0.25 0.53136
wandb:  test_balanced_accuracy0.5 0.52373
wandb: test_balanced_accuracy0.75 0.5322
wandb:         test_precision0.25 0.3
wandb:          test_precision0.5 0.30769
wandb:         test_precision0.75 0.33333
wandb:            test_recall0.25 0.3
wandb:             test_recall0.5 0.2
wandb:            test_recall0.75 0.2
wandb:                train_auroc 0.9996
wandb:                 train_loss 0.05731
wandb:           val_accuracy0.25 0.58095
wandb:            val_accuracy0.5 0.62857
wandb:           val_accuracy0.75 0.64762
wandb:                  val_auroc 0.54479
wandb:  val_balanced_accuracy0.25 0.52799
wandb:   val_balanced_accuracy0.5 0.52093
wandb:  val_balanced_accuracy0.75 0.49489
wandb:          val_precision0.25 0.275
wandb:           val_precision0.5 0.27586
wandb:          val_precision0.75 0.2381
wandb:             val_recall0.25 0.42308
wandb:              val_recall0.5 0.30769
wandb:             val_recall0.75 0.19231
wandb: 
wandb: 🚀 View run resnet50_2d_78_8_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/32ska9jb
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_8/wandb/run-20250701_171800-32ska9jb/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_8/wandb/run-20250701_180907-2t9f3lu9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_8_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/2t9f3lu9
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: updating run config
wandb: uploading history steps 579-579, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▆█▁▆▆▆▇▆▇▆▆▆▇▅▆▆▆▆▆▅▆▆▆▅▆▆▆▆▆
wandb:           test_accuracy0.5 ██▇▇▁▅▆▇███▆█▇▇▇▇▆▅▇▆▆▆▅▅▆▅▆▆▇▆▆▆▅▇▅▅▅▅▆
wandb:          test_accuracy0.75 ██████████▁█████▇▇▅▅▇▇▇▆▆█▇▇▇▆▆▅▅▆▇▆▅▅▆▅
wandb:                 test_auroc ▂▁▄▃▄▄▆▄█▆▆█▇▇▆▄▅▄▄▅▂▄▄▆▅▇▂▁▁▁▆▅▂▁▁▄▃▃▃▃
wandb: test_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▂█▆▅▆▁▃▆▃▇▄▆▃▃▄▇▃▆▆▅▅▃▆▄▆▃▄▃▁▄▂
wandb:  test_balanced_accuracy0.5 ▄▄▄▄▄▄▁▄▅▆▄█▅▆▅▄▅▅▅▃▂▄▂▃▄▃▃▃▄▅▆▆▄▆▄▂▅▃▄▄
wandb: test_balanced_accuracy0.75 ▄▄▄▄▄▄▄▅▄▄▃▂▄▄▆▁█▃▅▆▄▆▄▄▆▆▆▄█▃▄▄▂▃▃▃▃▃▃▃
wandb:         test_precision0.25 ▂▂▂▂▂▃▃▄▂▃▃▁▃▄▃▄▂▄▄▃▄█▃▅▁▄▄▃▃▂▁▁▃▁▁▃▄▄▃▄
wandb:          test_precision0.5 ▇▁▄▅▅▄█▅▁▄▄▃▄▄▃▅▄▄▅▅▄▃▄▄▃▄▄▄▄▃▄▃▃▄▄▄▄▄▄▄
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▄▅▄▅█▆▃▄▅▄▅▅▅▅▅▄▄▆▅▄▅▃▄▄▄▅▄▄▄▄
wandb:            test_recall0.25 ███████▄▁▂██▁▃▃▂▃▃▂▁▃▃▂▁▂▃▃▄▄▂▃▄▄▆▆▃▂▂▂▂
wandb:             test_recall0.5 ▁▁██▆▁▁▂▃▂▂▃▄▅▄▇▁▂▃▃▅▄▅▃▃▄▄▄▅▃▂▃▆▄▃▃▃▄▃▄
wandb:            test_recall0.75 ▁▂▂▁▁▁▁▁▁▁▂▁▅▂▅▃▁▁▂▃▄▄▄█▄▁▄▄▃▃▅▃▃▅▅▄▄▃▄▅
wandb:                train_auroc ▂▅▄▁▁▄▃▄▇▆███▄██████████████████████████
wandb:                 train_loss ▇██▇████▂▆▄▃█▁▁▁▁▁▁▁▁▂▁▁▂▁▁▁▁▁▁▁▃▁▂▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▂▁▅▃▅█▆▇▇▄▆▇▆▆▆▇▇█▇▇▇▇██▆█▇▇▇▇
wandb:            val_accuracy0.5 ███▇▇▇▁▆██▆▇▆▇█▇▆▆▇▆▇▆▆▆▆▅▆▆▇▇▇▅▇▇▇▆▆▆▇▆
wandb:           val_accuracy0.75 ██▇▇▇▇▇█▇█▇▇▇▇▇▄▇▇▅▇█▄▄▃▁▅▃▇▄▃▅▃▆▇▆▆▅▅▅▅
wandb:                  val_auroc ▆██▇▇▅▆▇▇▄▂▂▂▄▃▃▃▃▃▃▂▂▂▃▁▁▂▂▂▂▄▅▄▅▇▂▂▁▁▁
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▃▃▁▇▃█▂▁▄▆▇▂▄▅▇▆▂▅▂▆▆▅▇▃▃▂▄█▆▅▄▅▄▅▄▅
wandb:   val_balanced_accuracy0.5 ▂▂█▆▁▃▆▆▄▃▅▄▅▆▅▂▃▂▅▅▄▂▅▄▄▃▃▄▆▆█▆▅▅▆▅▅▄▄▅
wandb:  val_balanced_accuracy0.75 ▂▂▃▄▂▂▄▃▅▆▃▁▇▅▅▅▃▃▂▆▄▂▄█▅▃▄▅▆▆▄▃▅▃▆▄▅▅▅▅
wandb:          val_precision0.25 ▂▂▂▂▂▂▂▂▂▃▆▃▄▂▅▃▁▄▂▄▅▅▇▆▆▄▂▃▄██▇█▆▄▇▆▄▄▅
wandb:           val_precision0.5 ▃▃▅▃▃▃█▅▅▁▁▄▄▄▃▃▃▃▃▄▃▃▃▃▃▃▃▃▃▄▃▄▄▃▃▄▄▃▃▃
wandb:          val_precision0.75 ▁█▄▄▅▄▃▅▄▄▄▅▃▄▃▃▄▅▃▄▃▃▃▃▃▃▄▃▅▄▄▃▄▄▄▃▃▃▃▃
wandb:             val_recall0.25 ██████▁▄▄▂▃▂▂▂▂▁▂▂▃▂▃▃▃▃▂▂▃▂▂▂▃▂▄▂▃▂▂▂▂▂
wandb:              val_recall0.5 ▁▃▄▂▂▂▄█▂▃▃▃▂▂▃▃▃▂▄▃▄▃▄▄▃▃▃▃▃▄▄▃▃▃▃▃▃▃▃▃
wandb:             val_recall0.75 ▂▁▁▁▁▂▂▂▂▃▁▁▂▃▁▄█▄▄▄▃▃▃▅▄▃▃▂▅▅▄█▃▅▃▃▄▄▄▄
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.59494
wandb:           test_accuracy0.5 0.58228
wandb:          test_accuracy0.75 0.60759
wandb:                 test_auroc 0.52966
wandb: test_balanced_accuracy0.25 0.51398
wandb:  test_balanced_accuracy0.5 0.47246
wandb: test_balanced_accuracy0.75 0.48941
wandb:         test_precision0.25 0.26923
wandb:          test_precision0.5 0.21739
wandb:         test_precision0.75 0.2381
wandb:            test_recall0.25 0.35
wandb:             test_recall0.5 0.25
wandb:            test_recall0.75 0.25
wandb:                train_auroc 0.99972
wandb:                 train_loss 0.03122
wandb:           val_accuracy0.25 0.66667
wandb:            val_accuracy0.5 0.68571
wandb:           val_accuracy0.75 0.67619
wandb:                  val_auroc 0.46933
wandb:  val_balanced_accuracy0.25 0.54625
wandb:   val_balanced_accuracy0.5 0.55891
wandb:  val_balanced_accuracy0.75 0.53968
wandb:          val_precision0.25 0.32
wandb:           val_precision0.5 0.34783
wandb:          val_precision0.75 0.31818
wandb:             val_recall0.25 0.30769
wandb:              val_recall0.5 0.30769
wandb:             val_recall0.75 0.26923
wandb: 
wandb: 🚀 View run resnet50_2d_78_8_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/2t9f3lu9
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_8/wandb/run-20250701_180907-2t9f3lu9/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_8/wandb/run-20250701_190856-nrx2749d
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_8_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/nrx2749d
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▄▁▃▆█▅▄▄▃▅▄▄▆▄▅▅▂▂▃▄▂▂▃▃▃▃▃▃▄▄▄▃▃▃
wandb:           test_accuracy0.5 ▁▁██▆█▅▆▇▅▆▂▅▃▄▄▃▃▅▃▃▃▃▄▃▂▄▃▃▂▃▄▃▃▂▄▅▃▃▃
wandb:          test_accuracy0.75 █████▆▇▆██▅▅▅▄▂▅▃▃▄▃▂▃▃▂▂▁▃▂▂▁▃▃▂▂▂▃▂▁▁▄
wandb:                 test_auroc ▇▇▇▅▃▇▃▇▅▄▆▅█▄▅▄▇█▆▅▄▄█▆▅▃▃▃▂▂▅▁▁▁▅▅▄▅▃▅
wandb: test_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▅▆█▄▆▄▅▅▃▅▄▇▄▃▃▂▂▃▃▂▁▄▄▅▄▂▄▄▄▃▁▄
wandb:  test_balanced_accuracy0.5 ▅▇▅▅▅▅▆▇▆▇▃█▇▅▆▇▆▅▅▆▄▄▅▅▄▆▆▅▄▄▄▅▅▄▂▅▁▄▄▅
wandb: test_balanced_accuracy0.75 ▆▆▆▆▇▆▇▆▆▅▆▆▆▇▆█▄▇▅▄▇▇▃▆▆▆▄▅▃▃▇▄▁▁▆▅▅▃▅▃
wandb:         test_precision0.25 ▅▅▅▅▅▅▅▅▅▅▆▇▅█▇▄▄▅▅▃▂▃▄▃▄▃▃▅▂▁▄▅▂▅▄▄▄▄▄▅
wandb:          test_precision0.5 ▆▅▅▁▁▆▇█▆▅▆▅▅▆▅▆▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▄▄▅▅▅▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▇█▇▇▆██▇▇▇▇█▇▆▇▆▆▇▇▆▆▆▅▇▆▇▇█▇▇▅▇
wandb:            test_recall0.25 ██████▇███▇▄▁▇▆▃▄▄▅▅▄▅▄▃▄▃▄▄▄▅▄▅▄▅▃▅▄▄▄▄
wandb:             test_recall0.5 █▁█▃▁▁▄▃▄▃▄▃▆▅▅▆▆▆▄▅▆▆▆▅▆▆▆▆▆▅▆▆▅▆▆▆▆▆▆▅
wandb:            test_recall0.75 ▁▁▁▁▅▃▂▂▆▅▇▅▇▅█▇▇▇▇▆▇▇▃▆▅█▇▃▅▄▇▅▆▆▇▇▇▇▆▆
wandb:                train_auroc ▁▁▂▃▂▆▇▇████████████████████████████████
wandb:                 train_loss ▇████▇▇▅▆▆▄▃▃▂▂▂▃▃▁▁▁▃▁▁▁▁▂▁▁▁▁▁▁▁▁▂▁▁▁▁
wandb:           val_accuracy0.25 ▁▃▁▁▃▂▄▄█▅▅▃▄▅▅▄▇▄▃▄▅█▄▄▃▄▄▄▅▅▅▄▅▄▅▄▄▇▄▅
wandb:            val_accuracy0.5 ▁▁██▇▄▅▅▅▅▆▅▄▄▇▄▃▄▄▄▅▄▅▄▄▄▅▃▄▄▅▄▃▃▃▃▄▃▆▅
wandb:           val_accuracy0.75 ▇▇▇█▇███▅▇▅▃▅▆▆▄▄▂▅▆▆▃▂▄▂▄▂▂▅▅▂▁▂▂▂▂▃▄▁▂
wandb:                  val_auroc ▆▆▆▆▅▆▆▆▇▂▇▃▅▂▄▅▁▃▆▄▃▅▃▄█▅▇▆▆▆▃▅▄▅▇▄▄▄▅▅
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▃▃▃▁▆█▃▆▅█▄▅▃▄▂▆█▅▆▂▂▆▇▆▇▃▅▆▄▅▃▅▄▆▇▆
wandb:   val_balanced_accuracy0.5 ▁▅▁▃▄▆▆▅▃▂▄█▃▂▄▃▃▄▄▄▃▆▄▂▂▃▁▄▃▃▂▃▂▂▂▅▂▃▃▃
wandb:  val_balanced_accuracy0.75 ▁▃▃▂▃▄▂▅▄█▂▃▂▃▅▁▃▄▁▂▃▄▂▃▃▄▄▃▃▂▃▂▂▂▁▂▄▂▄▃
wandb:          val_precision0.25 ▂▂▂▂▂▂▂▂▁▃█▂▄▂▂█▃▅▄▅▁▂▄▄▆▅▅▄▃▅▂▂▃▃▄▃▃▃▄▃
wandb:           val_precision0.5 ▃▄▁█▅▅▄▄▆▅▄▄▃▄▃▄▃▃▄▃▃▃▄▄▃▄▄▄▃▃▄▃▃▃▃▄▄▄▄▄
wandb:          val_precision0.75 █▆▃▅▂▁▁▂▂▂▃▂▄▃▂▁▂▁▁▁▂▃▂▁▁▂▂▂▂▄▂▂▂▂▂▁▂▂▂▂
wandb:             val_recall0.25 █▇████████▅▆▇▆▄▆▅▆▆█▄▆▆▆▆▆▆▆▆▆▆▁▆▆▅▇██▆▆
wandb:              val_recall0.5 ▁███▄▅▄▂▅▆▅▆▆▆▆▆▆▅▇▇▅▆▆▇▆▄▅▆▇▇▆▇▆▇▆█▆▆▇▆
wandb:             val_recall0.75 ▂▃▁▂▁▅▃▃▂▅▂▅▆▆▄▇▅▅▄▆▇▆▇▆▇▆▇▇▇▆▆█▇█▆▇▇█▇█
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.39241
wandb:           test_accuracy0.5 0.40506
wandb:          test_accuracy0.75 0.4557
wandb:                 test_auroc 0.55381
wandb: test_balanced_accuracy0.25 0.52712
wandb:  test_balanced_accuracy0.5 0.51907
wandb: test_balanced_accuracy0.75 0.55297
wandb:         test_precision0.25 0.26667
wandb:          test_precision0.5 0.26316
wandb:         test_precision0.75 0.28302
wandb:            test_recall0.25 0.8
wandb:             test_recall0.5 0.75
wandb:            test_recall0.75 0.75
wandb:                train_auroc 0.99623
wandb:                 train_loss 0.19469
wandb:           val_accuracy0.25 0.40952
wandb:            val_accuracy0.5 0.45714
wandb:           val_accuracy0.75 0.46667
wandb:                  val_auroc 0.6037
wandb:  val_balanced_accuracy0.25 0.53019
wandb:   val_balanced_accuracy0.5 0.56183
wandb:  val_balanced_accuracy0.75 0.56816
wandb:          val_precision0.25 0.26316
wandb:           val_precision0.5 0.28169
wandb:          val_precision0.75 0.28571
wandb:             val_recall0.25 0.76923
wandb:              val_recall0.5 0.76923
wandb:             val_recall0.75 0.76923
wandb: 
wandb: 🚀 View run resnet50_2d_78_8_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/nrx2749d
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_8/wandb/run-20250701_190856-nrx2749d/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_8/execution_datetimes.json

**************************************************  Experiment 78 | Version 10 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 19, 1.0: 9}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 16, 1.0: 12}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 13, 1.0: 19}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 11, 1.0: 17}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_10/wandb/run-20250701_193821-rpes0tv1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_10_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/rpes0tv1
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▇▁▂▁▂▄█▁█▅▅▂▆▆▅▇▇▇▇▇▆▆▁▁▁▇▇▄▇▆▇▅▇▆
wandb:           test_accuracy0.5 █▁█▁▂███▁██▇█▅▇▇██▇█▇██▆▇▆▆▆█▇▆▅▇▇▇▇▆▇▆▆
wandb:          test_accuracy0.75 ███▇███▇▇▇█████▃▇▆▅▆▅▃▃▃▅▃▃▄▂▁▃▄█████▇█▆
wandb:                 test_auroc ▄▄▄▄▆▆▅▇▅▅▆▇▃█▆▂▃▇▂▃▃▄▇▅▄▃▄▃▄▄▅▄▃▁▄▄▆▅▁▃
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▄▃▂▃█▄▄▁▃▃▅▂▇▃▂▂▃▂▅▃▄▂▃▆▄▃▃▆▁▄▃▃▃▄
wandb:  test_balanced_accuracy0.5 ▄█▇▄▃▄▄▅▃▅▄▄▅▂▃▅▃▂▄█▃▃▃▅▅▃▄▃▃▂▇▄▁▃▅▄▅▃▄▂
wandb: test_balanced_accuracy0.75 ▄▄█▄▄▄▄▄▄▆▄▃▅▄▅▆▂▄▅█▃█▅▃▄▃▄▂▂▇▄▄▅▅▅▄▃▃▁▆
wandb:         test_precision0.25 ▃▃▃▃▃▃▄▂▂▃▃▃▃▃▂▂█▄▄▃▄▂▃▁▁▃▂▂▂▂▃▂▃▂▂▃▂▂▂▃
wandb:          test_precision0.5 █▄▆▁▁▄▁▅▃▁▇▄▃▁▅▄▄▄▄▃▃▄▃▃▃▃▃▃▅▅▄▃▁▄▅▄▃▃▆▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▄▅█▆▆▅▁▄▃▆▄▄▅▄▄▁▁▁█▁▅▃▁▆▁
wandb:            test_recall0.25 █████▇▇▇▇▆██▇█▃▃▃▆▁▄▃▃▁▂▃▃▄▂▃▂██▇█▂▃█▃▃▂
wandb:             test_recall0.5 █▁▂▂▁▃▆▂▁▅▂▄█▆▆▅▃▁▂▂▄▃▃▃▄▃▂▂▄▅▂▁▁▃▂▂▂▁▃▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▆▁▁▂▂▁▁▁▅▇▇▆▅▅▅▂▃▁█▃▆▅▅▅▅▆▅▁▁▁▁▁▁▁
wandb:                train_auroc ▂▁▂▃▃▂▄▄▄▄▄▄▆▃▅███████████████▁▂▃▇▅███▅▇
wandb:                 train_loss ▇▆▆▆▄█▆▅▅▅▅▅▇▆▄▃▂▂▁▂▁▁▁▁▁▁▁▁▁▁█▆▆▆▆▆▅▄▃▂
wandb:           val_accuracy0.25 ▁▁▁▃▁▁▁▁▂▂▂▃▁▃▁▇█▆▅▅▆▇▄▆▆▅▇▅▅▅▁▁▄▁▅▇█▆▁█
wandb:            val_accuracy0.5 ▂▇▁▅▅▇▄▇▄▅▃▂▃▆█▄▅▇▆▆▅▅▅█▆▅▅▅▅▄▇█▆██▆▇▆▆█
wandb:           val_accuracy0.75 ████████▇█▇▇██▇▆▇▂▆▃▅▅▄▃▃▃▂▆▄▃▂▁███▇██▅▄
wandb:                  val_auroc ▅▅▆██▇▇█▆▆▆▆▇▇▇█▄▄▂▁▄▂▇▇▆▂▂▅▄▄▆▅▄▅▅▇▆▇▃▃
wandb:  val_balanced_accuracy0.25 ▅▅▅▅▅▅▅▅▅▆▅▃▂▂▃▄▄▆▆▃▁▃▂▅▅▆▆▅▅▆█▅█▂▄▆▃▅▂▅
wandb:   val_balanced_accuracy0.5 ▅▆▅▆█▆▅▂▅▄▄▆▅▇▅▆▄▆▆▁▄▅▅▄▆▃▆▄▇▆▇▆█▆▅▆▆▅▄▆
wandb:  val_balanced_accuracy0.75 ▆▆▆▆▆▅▅▅▆▆▅▅▇█▆▃▄▂▅▄▇█▆▂▁▅▃▃▆▆▆▅▇▅▅▇▆▅▆▆
wandb:          val_precision0.25 ▅▅▅▅▅▄▅▅▅▅▅▅▄▄▃▁▅▅▅▅▂▂▂▁▄▂▂▂▂▃▅▅▃▅▅▅▇█▃▇
wandb:           val_precision0.5 ▄▄▄▄▄▄▄▄▆▅▄▁▅▆▄▃█▅▃▃▄▄▅▃▄▃▃▃▄▅▃▆▆▁▅▄▃▄▄▆
wandb:          val_precision0.75 ▁▁▁▁▁▃▃▃▁▁▁▁▁▁▅▁▅▁▁▅▃▃▂▂▂▂▃▃▂▃▃█▁▁▅▂▃▂▃▂
wandb:             val_recall0.25 ████▆██▅▆▅█▆▇██▇▃▁▄▃▂▃▂▃▃▂▂▂▂▃█▇▃▄▃▂▃▃█▃
wandb:              val_recall0.5 ▇▂▂▆▅▁▄▇▇▂▂▂▂▂▂▃▂▂▃▄▃▃▂▂▃▃▃▃▃▂▁▁▂▃▃█▂▃▂▂
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅█▃▅█▄▅▄▅▄█▄█▆▇▇▇█▁▁▂▅▂▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.59494
wandb:           test_accuracy0.5 0.62025
wandb:          test_accuracy0.75 0.65823
wandb:                 test_auroc 0.44322
wandb: test_balanced_accuracy0.25 0.46441
wandb:  test_balanced_accuracy0.5 0.44831
wandb: test_balanced_accuracy0.75 0.47373
wandb:         test_precision0.25 0.2
wandb:          test_precision0.5 0.14286
wandb:         test_precision0.75 0.18182
wandb:            test_recall0.25 0.2
wandb:             test_recall0.5 0.1
wandb:            test_recall0.75 0.1
wandb:                train_auroc 0.98602
wandb:                 train_loss 0.38485
wandb:           val_accuracy0.25 0.66667
wandb:            val_accuracy0.5 0.65714
wandb:           val_accuracy0.75 0.70476
wandb:                  val_auroc 0.60565
wandb:  val_balanced_accuracy0.25 0.54625
wandb:   val_balanced_accuracy0.5 0.50122
wandb:  val_balanced_accuracy0.75 0.51996
wandb:          val_precision0.25 0.32
wandb:           val_precision0.5 0.25
wandb:          val_precision0.75 0.30769
wandb:             val_recall0.25 0.30769
wandb:              val_recall0.5 0.19231
wandb:             val_recall0.75 0.15385
wandb: 
wandb: 🚀 View run resnet50_2d_78_10_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/rpes0tv1
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_10/wandb/run-20250701_193821-rpes0tv1/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_10/wandb/run-20250701_202543-g8w2je5r
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_10_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/g8w2je5r
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▃▁▁▁█▃▂▄▆▅▄▂▂▆▄▅▃▅▆▇▆█▄▄▄▅▄▄▇▅▁▂▂▂
wandb:           test_accuracy0.5 █▇▅██████▇▆▆▆▅▄▆▄▄▄▃▄▃▆▃▂▂▃▃▃▂▂▃▄▃▃▃▂▃▂▁
wandb:          test_accuracy0.75 ██████████▇█▇▇▇▇▆▃▃▂▄▄▃▇▃▄▃▃▄▃▂▂▂▃▃▃▂▂▁▁
wandb:                 test_auroc ▃▅▅▆▇▄▂▃▅▅▆▅▅▆▃▂▂▁█▃▃▃▅▄▄▄▄▅▅▆▆▆█▄▅▆▆▆▆▄
wandb: test_balanced_accuracy0.25 ▄▄▄▄▁▂▄▄▄▄▄▄▃▄▃▃▃▄▇▂▄▅▆▅▄▅▄▇▆▆▆█▆▆▆▆▄▄▄▄
wandb:  test_balanced_accuracy0.5 ▅▅▅▅▅▅▆▆█▆▅▆▆▆▆▅▅▆▄▄▄▆▄█▅▃▆▂▅▇▆▁▅▄▂▆▆▆▄▅
wandb: test_balanced_accuracy0.75 ▅▅▅▅▅▅▅▃▄▅▅▆▂▆▆▇▁▄▅█▂▄▅▄▄▅▆▅▇▅▅▁▁▃▅▇▆▆▅▆
wandb:         test_precision0.25 ▃▃▃▃▃▂▃▃▃▃▃▃█▂▂▂▃▂▆▁▃▃▄▂▄▃▃▄▁▃▃▄▂▂▃▄▅▃▃▃
wandb:          test_precision0.5 ▄▁▄▁▄▆▇█▇▆▁▆▁▄▄▃▄▄▄▄▅▄▄▅▄▄▃▄▄▄▄▄▄▃▄▄▄▄▄▄
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁█▁▁▅▁▂▄▂▄▄▃▄▄▄▃▃▃▄▄▄▄▃▄▄▄▄▄
wandb:            test_recall0.25 ████████▇███▁██▇▃▆▆██▆▆▆▇▆▆▆▆▅▇▆▅▇▇▆▇▇▇█
wandb:             test_recall0.5 █▃▁▁▃▁▁█▁▁▆▄▁▁▂▂▂▂▂▃▃▅▄▃▅▄▅▆▆▄▅▇▆▆▇▇▆▆▇▇
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▃▂▃▅▁▂▃▅▄▆▆█▆▆▆▆▄▃███▆███▇█
wandb:                train_auroc ▁▁▃▁▃▄▄▄▄▅▅▅▆▆▆▇████████████████████████
wandb:                 train_loss ██▇██▇▇▇▇▇▇▆▆▅▅▄▃▂▂▂▃▂▁▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁█▁▃▃▃▄▄▅▃▅▄▃▃▅▄▄▄▂▃▃▃▃▃▃▄▃▂▃
wandb:            val_accuracy0.5 █▆█▄█▇▇███▇▇▅▆▆▅▆▆▆▃▅▅▃▃▄▃▄▄▄▅▄▃▃▅▁▂▂▁▁▁
wandb:           val_accuracy0.75 ████████▇████▇▇▆▆▇▆█▆▅▆▄▄▄▃▃▄▄▃▃▄▃▄▁▃▅▂▁
wandb:                  val_auroc ▇█▅▅▆▅▇▁▇█▇▇▅▅▅▅▂▄▅▆▇▆▅▆▆▁▄▇▆▄▅▃▄▅▅▃▆▆▇▇
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁▁▁▇▄▂▄█▇▃▅▅▂▁▂▃▃▄▃▅▂▅▃▆▅▃
wandb:   val_balanced_accuracy0.5 ▁▂▂▁▁▂▃▅▅▆▄█▅▄▄▅▅▇▆▄▄▃▆▃▄▄▃▅▅▃▃▅▄▄▆▃▅▅▄▄
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▂▂▅▅▃▂▆█▆▃█▅▄▃▅▆▆▅▅▅▄▃▃▃▃▅▂▂▃▃▄▄▄▄▄
wandb:          val_precision0.25 ▂▂▂▂▂▂▂▂▂▂█▃▂▂▃▃▂▂▂▄▅▃▁▃▃▄▃▃▄▃▃▄▄▄▃▄▃▃▃▄
wandb:           val_precision0.5 ▁▁▆▆▅▇▇██▇█▇▆▆▇▇▆▆▆▆▅▆▆▇▆▆▆▆▆▆▆▆▆▆▆▆▆▇▆▆
wandb:          val_precision0.75 ▁▁▁▁▅▅█▆▇▅▄▅▅▄▅▅▄▅▅▄▄▄▄▄▄▅▄▅▄▄▄▄▅▄▄▄▄▄▄▄
wandb:             val_recall0.25 ███████████████▂▃▇▄▁▇▄▄▂▅▇▄▄▄▅▆▃▅▄▆▇██▇▇
wandb:              val_recall0.5 ▅▁▁▇▅▆▆▁▁▆▂▂▅▄▂▃▄▂▄▆▄▆▅▅▇▅▅▆█▆▆▇█▇▆█▄███
wandb:             val_recall0.75 ▁▁▁▁▁▁▂▃▂▁▂▂▂▂▂▄▂▅▅▅▅▄▇▇▆▆▆█▆▅▆▆▇▆▇▆████
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.27848
wandb:           test_accuracy0.5 0.3038
wandb:          test_accuracy0.75 0.32911
wandb:                 test_auroc 0.55551
wandb: test_balanced_accuracy0.25 0.51695
wandb:  test_balanced_accuracy0.5 0.50085
wandb: test_balanced_accuracy0.75 0.5178
wandb:         test_precision0.25 0.25974
wandb:          test_precision0.5 0.25352
wandb:         test_precision0.75 0.26087
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.9
wandb:            test_recall0.75 0.9
wandb:                train_auroc 0.99942
wandb:                 train_loss 0.05977
wandb:           val_accuracy0.25 0.33333
wandb:            val_accuracy0.5 0.35238
wandb:           val_accuracy0.75 0.3619
wandb:                  val_auroc 0.64654
wandb:  val_balanced_accuracy0.25 0.54406
wandb:   val_balanced_accuracy0.5 0.54382
wandb:  val_balanced_accuracy0.75 0.55015
wandb:          val_precision0.25 0.26596
wandb:           val_precision0.5 0.26667
wandb:          val_precision0.75 0.26966
wandb:             val_recall0.25 0.96154
wandb:              val_recall0.5 0.92308
wandb:             val_recall0.75 0.92308
wandb: 
wandb: 🚀 View run resnet50_2d_78_10_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/g8w2je5r
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_10/wandb/run-20250701_202543-g8w2je5r/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_10/wandb/run-20250701_210401-0v20knvt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_10_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/0v20knvt
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁█▁▃▄▁▆▆▇█▅▄▄▄▅▄▃▄▄▄▃▃▃▄▃▄▄▄▃▄
wandb:           test_accuracy0.5 ▁▄▁█▁▄█▁█▇▇████▅▇▇▅▅▅▃▄▄▄▄▄▄▃▄▂▄▂▂▂▂▃▃▃▂
wandb:          test_accuracy0.75 ███████▆███████▇▇▄▅▆▃▄▃▂▃▄▂▂▁▂▂▂▂▁▁▄▂▁▂▂
wandb:                 test_auroc ▄▄▄▅▄▇▆▆▅▆▇▆▇▆▆▆▅▆▇▅▄▅▄▄▅▃▄▃▅▆▃▄▅▄▂▃▃▁▄█
wandb: test_balanced_accuracy0.25 ▅▅▅▅▂▂▃▅▅▅▃▅▅▃▃▅▅▅▃▇▆▂▁▂█▅▅▂▃▄▅▅▂▆▁▃▅▄▃▆
wandb:  test_balanced_accuracy0.5 ▃▃▃▂▃▄▃█▇▅█▅▆▄▄▃█▆▆█▃▂▇▅▅▂▃▅▂▃▁▃▅▄▃▂▃▆▁▁
wandb: test_balanced_accuracy0.75 ▅▅▅▅▅▅▅▅▅▅▅▅▅▅▆▅▇▇▆▃▄▇▁▅▃▃██▅▆▄▇▇▃▆▂▁▂▇▆
wandb:         test_precision0.25 ▅▅▅▅▅▅▅▄▅▅▅▄▆█▂▆▆▇▄▃▅▆▅▄▅▆▄▅▄▇▁▄▄▆▅▄▃▃▇▅
wandb:          test_precision0.5 ▂▇▂█▂▄▃▃▆▇▄▃▄▃▂▂▃▂▃▃▃▃▂▂▃▁▂▂▂▃▂▂▂▂▂▂▂▃▃▄
wandb:         test_precision0.75 ▁▁▁▁▁▃▁▁▁▁▁▃▅▁█▃▃▃▃▃▃▂▃▃▃▃▃▃▃▃▃▃▃▃▃▂▃▃▃▃
wandb:            test_recall0.25 ███████▇█▇██▅▄▂▂▃▄▂▂▅▅▂▁▅▄▆▄▃▂▂▄▅▅▃▄▃▂▄▇
wandb:             test_recall0.5 ▁▁█▇▂▄▇▁▁▁▂▂▂▅▆▅▅▃▅▄▂▅▅▆▄▅▅▅▇▆▅▄▆▆▆▄▅▆▅▅
wandb:            test_recall0.75 ▁▁▁▁▁▁▃▁▁▁▁▃▁▅▄▆▅▅▆▅▅▄▇▄▆▆▆▆▆▆▆▅▆▆▄▆▇██▆
wandb:                train_auroc ▂▂▂▂▁▃▃▂▄▄▄▅▅▅▆▇▇██▇████████████████████
wandb:                 train_loss ██████▇█▇▇▇▇▆▆▆▃▂▂▁▂▁▂▁▁▁▁▁▁▁▁▁▁▁▃▂▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▂▄▁▁▁█▄▄▅▆▄▅▆█▅▅▄▄▃▅▃▇▃▄▄▄▅▄▄▆
wandb:            val_accuracy0.5 ▁▁▇██▆█▂█▆▇▇▇▆▆▇▇▇▅▅▅▅▅▃▃▃▃▃▃▃▃▄▅▅▃▃▃▄▃▃
wandb:           val_accuracy0.75 ██████▇▇██▇██████▇▄▅▂▃▃▃▃▆▄▂▃▂▄▃▂▂▁▄▃▃▂▄
wandb:                  val_auroc ▁▆▆▆▆▆▇▇▇█▇▇▇▆▆▆▅▃▅▄▅▄▅▃▂▄▂▂▂▃▄▂▂▃▁▄▃▅▅▆
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▆▄▄▅▆▄▃▃▄▅▅▄█▅▇▂▂▅▄▄▃▅▅▃▁▃▁▃▁▅▄▇
wandb:   val_balanced_accuracy0.5 ▄▄▄▄▄▄▄▄▆▇█▇▇███▄▅▄▅▁▄▅▃▅▃▂▂▅▂▄▃▂▂▃▄▅▄▄▅
wandb:  val_balanced_accuracy0.75 ▄▄▄▄▄▄▄▆▇▆▃▃▅▆█▄▇▃▃▄▃▃▄▆▁▁▄▅▃▂▃▃▂▁▂▃▆▃▄▄
wandb:          val_precision0.25 ▃▃▃▃▃▃▃▃▃▃█▃▃▃▃▃▃▄▄▃▂▄▃▂▃▃▃▃▂▃▃▂▂▄▂▂▁▃▃▃
wandb:           val_precision0.5 ▄▁▁▄▅▃▁▆▁▅█▇▇▅▆█▄▅▆▅▅▄▅▅▅▄▅▄▄▄▄▄▄▄▄▄▅▅▅▅
wandb:          val_precision0.75 ▁▁▁▁▁▁█▁▆██▆▅▃▄▃▃▃▃▄▃▃▄▄▄▃▄▃▄▃▄▃▃▃▃▃▃▃▃▄
wandb:             val_recall0.25 ███████████████▅▂▄▃▁▄▄▆▆▆▃▅▂▆▄▅▄▄▄▅▁▅▆▆▅
wandb:              val_recall0.5 ██▅▄▃▄▃▄▃▅▃▂▁▃▅▃▅▆▅▆▅▅▅▅▆▆▆▅▆▄▆▅▄▆▅▆▄▄▆▅
wandb:             val_recall0.75 ▁▁▁▁▁▃▁▁▂▂▁▂▄▂▆▄▆▅▆▅▅▆▇▇▆▆▆▆▇▇▇▇▆▅▇▇▇▇█▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.32911
wandb:           test_accuracy0.5 0.31646
wandb:          test_accuracy0.75 0.32911
wandb:                 test_auroc 0.44492
wandb: test_balanced_accuracy0.25 0.46822
wandb:  test_balanced_accuracy0.5 0.44322
wandb: test_balanced_accuracy0.75 0.45169
wandb:         test_precision0.25 0.2381
wandb:          test_precision0.5 0.22581
wandb:         test_precision0.75 0.22951
wandb:            test_recall0.25 0.75
wandb:             test_recall0.5 0.7
wandb:            test_recall0.75 0.7
wandb:                train_auroc 1
wandb:                 train_loss 0.0259
wandb:           val_accuracy0.25 0.45714
wandb:            val_accuracy0.5 0.47619
wandb:           val_accuracy0.75 0.50476
wandb:                  val_auroc 0.5925
wandb:  val_balanced_accuracy0.25 0.58763
wandb:   val_balanced_accuracy0.5 0.58739
wandb:  val_balanced_accuracy0.75 0.59348
wandb:          val_precision0.25 0.29333
wandb:           val_precision0.5 0.29577
wandb:          val_precision0.75 0.30303
wandb:             val_recall0.25 0.84615
wandb:              val_recall0.5 0.80769
wandb:             val_recall0.75 0.76923
wandb: 
wandb: 🚀 View run resnet50_2d_78_10_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/0v20knvt
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_10/wandb/run-20250701_210401-0v20knvt/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_10/execution_datetimes.json

**************************************************  Experiment 78 | Version 13 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 36, 1.0: 28}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 32, 1.0: 32}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 27, 1.0: 37}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 26, 1.0: 34}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_13/wandb/run-20250701_213854-pspvfwg9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_13_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/pspvfwg9
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▂▇▇▆█▂▅▅▆▅▆▇▇▆▅█▇▄▆▂▃▆▆▅▆▅▄▄▆▅▅▅▄
wandb:           test_accuracy0.5 █▁█▅██▆█▇██▇█▇▅▆▅▇▅▅▅▆▇▅▅▆▂▆▆▆▆▄▃▄▄▅▄▅▅▄
wandb:          test_accuracy0.75 ███████████████▆█▅▆▃▄▂▅▄▃▅▅▅▂▂▁▂▂▁▁▆▄▅▃▁
wandb:                 test_auroc ▁▁▂▆▅▃▃▃▄▄▆██▇▇▄▄▅▄▅▅▄▅▅▅▄▅▄▄▃▃▃▃▄▆▆▅▅▅▅
wandb: test_balanced_accuracy0.25 ▃▃▂▃▃▃▁▃▁▁▇▄▄▅▄▆▆▅▆▆▇▇█▇▄▅▅▆▅▆▅▄▃▄▆▅▇▆▅▆
wandb:  test_balanced_accuracy0.5 ▂▅▂▄▂█▄▄▄▂▄▃▄▁▁▃▄▂▄█▆▆▅▇▆▇▄▄▂▁▅▄▂▅▄▄▅▄▄▄
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▄▃▃▃▃▃▃▃▃▄▅▁▃▆▅█▆▆▇▇▆▅▆▅▄▅▆▃▂▂▄▄▅▅▄
wandb:         test_precision0.25 ▂▂▂▂▂▂▂▁▁▁▂█▅▅▆▅▅▅▆▄▄▇█▇▇▂▃▅▄▇▂▃▃▇█▇▅▄▅▄
wandb:          test_precision0.5 ▃▃██▄▃▃▁▃▅▃▁▃▁▃▃▃▃▂▃▃▃▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁█▁▃▃▂▃▃▃▃▃▄▄▃▃▃▃▃▃▆▃▃▃▄▃▄▃▃▃▃
wandb:            test_recall0.25 ███▆█▆█▆▆█▇▆█▃▄▃▄▃▁▅▆▅▆▅▅▆██▄▂▅▆▆▆▆▆▅▆▆▆
wandb:             test_recall0.5 ▅▁▁▁▅▅▂▁▆▁▅▂▃▄▁▂▅▅▆▅▇▅▆▅▆▆█▃▆▆▆▆▆▅▇▆▆▇▇▇
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▂▂▂▂▃▅▂▃▆▆▅▂▄▂▅▄▆▅▄▅▆▆▆▆
wandb:                train_auroc ▂▄▄▁▁▁▃▃▄▄▆▆▇▆████████████████▂▆████████
wandb:                 train_loss ▇██▇▇▇██▇▆▄▄▄▃▅▂▃▂▄▃▁▂▁▁▂▁▁▁▃▃▂▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▃▁▁▂▁▃▁▁▁▁█▅█▇▆▁▅▅▆▆▆▄▅▆█▄▅▄▅▃▇▆▅▆▆▄
wandb:            val_accuracy0.5 ▄▇▄▅▆▇▇█▁▅▆▆▆▅▃▄▅▅▅▅▅▆▅▆▅▅▅▅▄▄▄▅▄▆▅▅▄▄▂▃
wandb:           val_accuracy0.75 ████████▇█▆▄▄▅▇▅▄▃▃▃▄▃▄▃▇▃▃▁▄▂▃▄▃▃▂▄▂▂▃▁
wandb:                  val_auroc ▁▄▃▄▅▄▅▅▆▆▆▃▆▆▆▄▅▅▄▅▄▅▅▇█▄▄▃▇▂▂▄▃▃▆▆▆▇▅▅
wandb:  val_balanced_accuracy0.25 ▄▇▄▄▄▅▆▄▄▄▄▄▄▄▄▃▅▆▃▂▅▇▅▆▄▁▆▅▄▂▆██▇▅▆█▅▃▃
wandb:   val_balanced_accuracy0.5 ▄▃▄▄▄▄▃▄▄▂▄▃▆▃▃▂▃▃▁▄▃▅▁▅▂▂▃▄▄▄▇▆▅█▆▅▅▅▄▄
wandb:  val_balanced_accuracy0.75 ▄▄▄▄▄▃▁▂▆▂▄▄▄▃▄▆▃▄▄▄▄▄▄▃▃▃▅▅▃▃█▅▅▅▅▄▅▄▄▅
wandb:          val_precision0.25 ▄▄▄▅▂▄▅▄▇▅▆▃▁▃▂▅▃▂▄▃▃▅▅▄▄▇▅▂▁▃▂▇▇█▇▄▇█▆▅
wandb:           val_precision0.5 ▁▄▆▁█▆▅▆▂▅▆▅▆▄▅▆▅▅▅▆▆▅▆▅▅▅▆▆▆▅▅▅▅▅▅▇▆▇▇▆
wandb:          val_precision0.75 ▁▁▁▅▁▁▄▁▁█▃▅▃▄▃▃▃▃▃▃▂▃▃▂▃▃▂▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:             val_recall0.25 ███████▇▇▆▄▃▂▃▃▃▃▃▃▁▅▄▃▂▁▄▃▂▆▃▄▅▃▆▆▇▆▅▅▅
wandb:              val_recall0.5 ▅▁█▂▂▄▁▄▃▃▄▅▃▆▅▂▅▅▃▅▅▅▃▅▅▅▆▅▅▆▇▇▇▇▆▆▇▇▇▇
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▂▁▁▁▂▂▃▄▂▄▄▄▅▆▅▅▅▅▃▅▇▇▅█▄▇█▄▇▇███
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.46835
wandb:           test_accuracy0.5 0.4557
wandb:          test_accuracy0.75 0.4557
wandb:                 test_auroc 0.58898
wandb: test_balanced_accuracy0.25 0.59449
wandb:  test_balanced_accuracy0.5 0.53644
wandb: test_balanced_accuracy0.75 0.53644
wandb:         test_precision0.25 0.30357
wandb:          test_precision0.5 0.27451
wandb:         test_precision0.75 0.27451
wandb:            test_recall0.25 0.85
wandb:             test_recall0.5 0.7
wandb:            test_recall0.75 0.7
wandb:                train_auroc 0.99954
wandb:                 train_loss 0.05259
wandb:           val_accuracy0.25 0.37143
wandb:            val_accuracy0.5 0.42857
wandb:           val_accuracy0.75 0.44762
wandb:                  val_auroc 0.49611
wandb:  val_balanced_accuracy0.25 0.47907
wandb:   val_balanced_accuracy0.5 0.51704
wandb:  val_balanced_accuracy0.75 0.5297
wandb:          val_precision0.25 0.23684
wandb:           val_precision0.5 0.25714
wandb:          val_precision0.75 0.26471
wandb:             val_recall0.25 0.69231
wandb:              val_recall0.5 0.69231
wandb:             val_recall0.75 0.69231
wandb: 
wandb: 🚀 View run resnet50_2d_78_13_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/pspvfwg9
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_13/wandb/run-20250701_213854-pspvfwg9/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_13/wandb/run-20250701_230047-rwkwbvzu
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_13_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/rwkwbvzu
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 645-646, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁█▁▆▄▃▃▄▃▃▂▃▂▂▁▄▁▃▄▄▃▄▃▂▂▂▂▂▃▂▂▂▃▂▃
wandb:           test_accuracy0.5 ▂▅▇█▇▆▇▇▅▆▄▅▄▃▃▂▃▃▂▃▂▂▁▁▄▄▃▃▃▁▂▂▂▂▃▂▁▂▂▁
wandb:          test_accuracy0.75 ██████████▇▇▇▃▆▄▂▁▂▁▁█▆▆▅▃▃▃▂▁▂▁▄▃▃▃▁▂▂▂
wandb:                 test_auroc ▆▅▅▆▇▅▄█▆▆▅▆▅▃▅▁▄▇▆█▁▄▅▅▅▅▄▆▇▇▆▇▆█▄▄▄▃▄▄
wandb: test_balanced_accuracy0.25 ▆▆▆▆▅▆█▆▇▆▅▇▇▆▆▁█▇▇▇▇▄▆▇▆▅▄▅▆▇▆▅▅▆▇▆▆▇▆▅
wandb:  test_balanced_accuracy0.5 ▄▄▄▅█▅▄▆▄▅▄▁█▂▅▇▅▄▃▃▃▁▂▃▂▄▅▇▅▅▁▅▅▃▅▄▅▃▂▃
wandb: test_balanced_accuracy0.75 ▄▄▄▄▄▄▄▄▄▃▄▃▅▄▃▅▆▃▃▄▁▆▅▄▂▄▅▂▄▄▄▃█▃▅▂▄▂▃▃
wandb:         test_precision0.25 ▆▆▆▅▆▆▆▆▆▅▆▆███▇▇▁▅▅▆▅▆▆▆▂▆▆▇█▇▇▇▅▇▅▅▆▆▆
wandb:          test_precision0.5 ▃▄█▃▅▅▅▁▂▄▄▃▃▃▃▃▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁█▁▅▅▅▆▄▄▅▅▄▅▅▄▅▄▃▅▅▅▅▄▄▅▅▅▅▄▄▄▄▅▄
wandb:            test_recall0.25 ██████████▂▁▂▅▄▂▄▅▇▇▅▅▇▅█▂▅▆▅▅▆▇▆▅▅▆▅▅▆▅
wandb:             test_recall0.5 ▁▃▁▃▁▂▁▇▁▁▃▂▁▂▃▅▆▅█▇▇▆▇▆▂▃▆▇▇▆▇██▃▆▆▇▇▇▇
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▃▂▄▅▇▆▅▆██▇▇▇▇▇█▇▁▂▄▄▄▅▅██▇█▆█
wandb:                train_auroc ▁▂▃▃▂▆▇▇▇████████████▆▇▇▇███████████████
wandb:                 train_loss ███▇▇▇█▇▇▇▁▂▂▂▁▂▁▂▂▁▂▂▁▁▁▇▅▅▄▅▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▃▁▁▃▁▁▇▄▄▄▅▃█▄▄▄▅▃▃▁▁▇▄▃▃▄▃▃▃▃▃▃▄▂▃▃▃▃
wandb:            val_accuracy0.5 ▂█▁███▇▇▇▅▅▆▅▄▅▄▄▄▄▂█▇▆▄▄▃▃▄▃▃▂▂▂▃▄▂▂▃▃▂
wandb:           val_accuracy0.75 ██▇█▅▆▆▆▅▃▄▄▃▅▄▃▃▂▃▂▁▇▃▄▄▄▂▄▃▃▁▂▃▃▂▁▁▁▁▁
wandb:                  val_auroc ▇█▂██▇▇▁▄█▆▅▃▄▅▄▆▆▅▅▆▆▄▄▂▄▃▂▃▄▄▄▅▃▄▆▄▅▇▅
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▄▄▇▄██▄▅▂▆▆▆▆▅▇▅▇▄▃▄▁▄▅▃▄▄▄▃▃▅▅▄▇▄▅▅
wandb:   val_balanced_accuracy0.5 ▁▅▇█▇▇█▇▆▆▆▇▇▆▇▆▇▆▇▆▇▇▅▆▆▅▄▅▅▆▄▅▆▅▅▅▆▆▆▆
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▄▄▄▃▂▃▅▅▃▅█▇▄▄▆▆▅▄▄▆▅▂▆▃▄▂▁▃▅▆▆▃▁▂▃▄
wandb:          val_precision0.25 ▄▄▄▄▄▄▄▄▄█▆▅▅▁▇▁▅▆▇▆▅▇▆▆█▁▃▁▄▃▆▂▅▄▄▃▇▇▅▅
wandb:           val_precision0.5 ▃█▃▇▅▂▄▄▃▃▄▂▂▂▂▁▂▃▂▂▂▂▂▂▂▁▁▁▁▂▂▁▂▂▂▂▁▁▁▂
wandb:          val_precision0.75 ▁▁▅▆██▁▁▅▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▁▅▄▄▄▃▄▄▄▄▄▄▄▄▄
wandb:             val_recall0.25 ████████████▃▃▁▄▄▅▆▆▆▇▇▇▇▆▆▅▅▆▆▆▇▆▇▆▇▇▇▇
wandb:              val_recall0.5 ██▃▁▂▄▄▄▄▆▄▆▆▆▆▆▆▇▇▇▇▇▇▇▃▅▅▆▆▆▇▇▇▇▆▇▇▇▆▇
wandb:             val_recall0.75 ▁▁▁▂▂▁▂▂▂▁▁▁▂▃▄▇▇▆█▇▇▇▇██▅▆▇▅▇▇▇█▇▇▆▇▇▇█
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.35443
wandb:           test_accuracy0.5 0.36709
wandb:          test_accuracy0.75 0.35443
wandb:                 test_auroc 0.48686
wandb: test_balanced_accuracy0.25 0.53475
wandb:  test_balanced_accuracy0.5 0.51017
wandb: test_balanced_accuracy0.75 0.48517
wandb:         test_precision0.25 0.26866
wandb:          test_precision0.5 0.25806
wandb:         test_precision0.75 0.2459
wandb:            test_recall0.25 0.9
wandb:             test_recall0.5 0.8
wandb:            test_recall0.75 0.75
wandb:                train_auroc 0.99948
wandb:                 train_loss 0.06113
wandb:           val_accuracy0.25 0.32381
wandb:            val_accuracy0.5 0.35238
wandb:           val_accuracy0.75 0.34286
wandb:                  val_auroc 0.58057
wandb:  val_balanced_accuracy0.25 0.52483
wandb:   val_balanced_accuracy0.5 0.54382
wandb:  val_balanced_accuracy0.75 0.52459
wandb:          val_precision0.25 0.25806
wandb:           val_precision0.5 0.26667
wandb:          val_precision0.75 0.25843
wandb:             val_recall0.25 0.92308
wandb:              val_recall0.5 0.92308
wandb:             val_recall0.75 0.88462
wandb: 
wandb: 🚀 View run resnet50_2d_78_13_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/rwkwbvzu
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_13/wandb/run-20250701_230047-rwkwbvzu/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_13/wandb/run-20250702_002725-6lseolep
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_13_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/6lseolep
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁█▂▃▁▆▅▆▇▆▄▄▆▃▆▅▇▆▅▄▄▄▄▅▆▄▆▅
wandb:           test_accuracy0.5 █▁█▂█▄▄██▇█▂████▇█▇▇▆▆▇▇▆▆▆▅▄▅▃▆▄▆▆▄▆▆▄▅
wandb:          test_accuracy0.75 ██████████▇█▇████▅▅▇▅▅▃▅▅▄▅▂▄▄▃▁▂▄▄▅▃▆▅▄
wandb:                 test_auroc ▂▂▃▆▄▄▄▁▄▄▄▄▃▃▅▅▄▆▄▃▇▇▅▆▅▆▂▃█▆▆▃▅▆▆▇▆▆▅▇
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▂▃█▁▃▁▃▃▃▃▅▂▁▂▅▄▅▆▅▆▆▅█▅▃▄▅▄▆▅▇▃▄▇
wandb:  test_balanced_accuracy0.5 ▃▃▃▃▄▇▅▄▄▃▇▄▅▅▃▄▄▂▁▄▃▃▄▅▁▃▃▅▅▃▆▄▃▆▄▄▃▄▄█
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▃▃▄▃▃▆▅▁▆▃▂▃▄▃▂▄▂▂▅▆▂█▅▃▄▅▇▇▆▆
wandb:         test_precision0.25 ▂▂▂▂▂▂▂▁▁█▂▁▂▃▂▂▂▃▄▃▃▄▃▂▃▁▂▃▄▅▂▃▂▃▃▃▃▂▂▂
wandb:          test_precision0.5 ▁▅▅▇▇█▆▆▅▅▇▆▁▆▅▄▅▄▄▅▄▄▅▄▄▄▄▄▅▅▄▄▄▄▄▄▅▄▅▄
wandb:         test_precision0.75 ▁▁▁▁▅▁▁▁▁▃▁▁█▅▁▃▃▂▂▂▃▂▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃
wandb:            test_recall0.25 █████▆▇██▅▄▂▆▅█▂██▄▄▃▃▂▆▁▃▂▃▄▃▆▂▃▃▃▁▂▃▂▅
wandb:             test_recall0.5 ▁█▂▄▃▄▁▂▁▁▂▁▃▄▂▂▄▃▂▅▃▃▃▅▄▄▅▅▅▅▆▅▆▅▅▅▄▅▆▅
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▂▁▂▃▃▂▃▂▅▂▂▄▄▅▄▆▅▅▇▆▇▅█▇▇▆▇▅▆▅▇▅▇
wandb:                train_auroc ▁▄▄▄▅▅▅▄▄▃▄▄▅▅▆▇▇███████████████████████
wandb:                 train_loss █▇▇██▇▇▆▆▆▇▇▆▆▆▃▄▂▂▃▂▂▂▂▂▁▁▁▁▂▁▁▂▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▂▁▃▁▁▁▁▂▂▄▃▁▁▅▁▇██▇▆█▇▆▆▇▇▄▆█▇█▇▄▆▄▅▆
wandb:            val_accuracy0.5 ██▆▆▃▇██▇█▇▇▇▆█▇█▄▇▅▅▂▃▃▄▃▄▄▃▅▃▃▃▃▅▄▅▁▁▃
wandb:           val_accuracy0.75 ▇▇▇▇▆▇█████▇▇██████▇▃▅▄▅▂▃▂▄▄▁▂▄▂▅▄▄▃▃▂▁
wandb:                  val_auroc ▄▆█▆▆▆▇█▇▃▆██▆▆▆▆▆▄▅▆▃▃▃▄▆▅▅▇▃▁▅▆▇▆▅▆▃▃▄
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▂▁▁▁▂█▆▁▁▁▂▃▅▁▃▃▇▆▇▆▆▃▂▃▇▆▇▂▄▆▄▆▄▅▂▄
wandb:   val_balanced_accuracy0.5 ▇▄▁▆▆▆▄▄▆▆▆▇▆▇▆▄▆▇▃▃▅▄▇▅▆▆▄▄▄▅▆█▆▇█▃▆▆▅▆
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▁▄▄▆▅▆▆▅▃▅▂▆▃▆▄▃▆▃▃▅▂▄▇▂▁▃▆█▇▅▆▂▄▄▅▆
wandb:          val_precision0.25 ▁▁▁▂▁▁▂▁▁▁▁▂▃█▁▂▁▁▄▄▃▃▃▃▆▅▄▃▄▄▅▅▅▂▃▅▃▂▁▃
wandb:           val_precision0.5 ▄▁▄▃▁▆▆▇▆▆▄▇▅█▆▇█▄▅▇▄▅▅▄▄▅▅▅▄▄▄▅▄▅▄▄▄▄▄▄
wandb:          val_precision0.75 ▁▁▁▁▁▁▆▆▅▅▇▇▄██▄▆▄▄▄▃▄▄▃▃▃▄▄▃▄▃▃▄▄▄▄▃▄▄▄
wandb:             val_recall0.25 ▇▇███▇██▇████▆▂▃▂▃▅▂▁▁▄▆▅▄▃▁▂▄▅▅▅▃▃▄▃▄▁▄
wandb:              val_recall0.5 █▇▁▅▅▄▂▃▄▁▆▂▃▂▄▅▆▅▄▅▅▅▄▅▅▆▅▅▆▅▄▅▅▅▅▆▅▅▅▅
wandb:             val_recall0.75 ▁▁▁▁▁▁▂▃▂▃▃▃▄▅▆▅▆▃▆▅▅▅▇██▇▆▆▆▆▆▆▇▇▆▇▇▇██
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.48101
wandb:           test_accuracy0.5 0.49367
wandb:          test_accuracy0.75 0.49367
wandb:                 test_auroc 0.55169
wandb: test_balanced_accuracy0.25 0.48729
wandb:  test_balanced_accuracy0.5 0.49576
wandb: test_balanced_accuracy0.75 0.49576
wandb:         test_precision0.25 0.2439
wandb:          test_precision0.5 0.25
wandb:         test_precision0.75 0.25
wandb:            test_recall0.25 0.5
wandb:             test_recall0.5 0.5
wandb:            test_recall0.75 0.5
wandb:                train_auroc 0.99856
wandb:                 train_loss 0.12007
wandb:           val_accuracy0.25 0.44762
wandb:            val_accuracy0.5 0.46667
wandb:           val_accuracy0.75 0.49524
wandb:                  val_auroc 0.5723
wandb:  val_balanced_accuracy0.25 0.5297
wandb:   val_balanced_accuracy0.5 0.54236
wandb:  val_balanced_accuracy0.75 0.54844
wandb:          val_precision0.25 0.26471
wandb:           val_precision0.5 0.27273
wandb:          val_precision0.75 0.27869
wandb:             val_recall0.25 0.69231
wandb:              val_recall0.5 0.69231
wandb:             val_recall0.75 0.65385
wandb: 
wandb: 🚀 View run resnet50_2d_78_13_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/6lseolep
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_13/wandb/run-20250702_002725-6lseolep/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_13/execution_datetimes.json

**************************************************  Experiment 78 | Version 14 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 5}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 6}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 7}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_14/wandb/run-20250702_012547-9saliiaa
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_14_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/9saliiaa
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▇▂▇▇▇▅█▅▇▇▇▅▇▇▆▇▇▇▇▇▇▅▇▅█▆▆▃▅▅▆▆▅▆▆
wandb:           test_accuracy0.5 ▁█▅▆██▆▇▇▅▅▇▇▇▇▆▄▇▇▆▇▃█▆▆▇▇▃▇▆▆▆▆▁▄▆▅▆▆▆
wandb:          test_accuracy0.75 ██████▇▇▆▇▆▇▇▅▅▆▆▅▅▆█▆▅▅▇▂▄▃▃▃▆▄▅▁▅▂▅▅▅▅
wandb:                 test_auroc ▁▁▂▄▅▇▃▄▃▃▅▆▇▆▆▆▆▆▆▆█▆▇▆▆▆▆▆█▄▃▇▆▅▅▅▇▅▅▆
wandb: test_balanced_accuracy0.25 ▂▁▂▁▄▃▂▇▅▂▄▃▃▃▄▆▇▅▅▇▄█▇▆▃▄▆▆▃▃▅▆▆▆▇▃▃▇▆▅
wandb:  test_balanced_accuracy0.5 ▃▆▁▃▄▂▅▃▄▃▂▅▂▄█▃▆▂▆▆▅▅▅▄▅▄▆▄▁▅▄▃▅▆▆▆▆▁▇▄
wandb: test_balanced_accuracy0.75 ▃▄▃▃▃▃▃▃▃▃▂▃▅▅▅▇▃▇▂▄▃▅▄▅▄▄▆▆▇▁▄█▅▄▇▅▃█▁▆
wandb:         test_precision0.25 ▃▃▃▆▃▄▃▃▅▄▄▅▅█▆▃▂▇█▄▃▇▆▅▆▇▅▇▄▅▅▇▇▅▅▅▁▆▆▄
wandb:          test_precision0.5 ▃██▁▃▃▄▁▃▁▃▄▃▄▃▄▃▃▄▃▃▃▄▄▃▃▃▁▃▂▃▄▃▃▃▃▁▄▃▃
wandb:         test_precision0.75 ▁▁▃▁▁▁▁▁▁▁▁▃▅▇▄▅▇▆▇▇▆▆▆▆▆▇▇█▅▆▇▇▆▆▆▆▅▆▁▇
wandb:            test_recall0.25 ██▇██▂▂▅▅▁▆▅▃▄▃▆▅▅▅▄▆▅▅▄▆▄▆▅▆▄▂▄▅▅▅▆▅▄▁▅
wandb:             test_recall0.5 ▆▂▇▂▃▂▃▅▃█▂▅▆▆▆▃▆▂▅▇▆▅▃▄▄▅▅█▆▃▄▆▅▅▇▁▆▇▁▆
wandb:            test_recall0.75 ▁▁▁▁▁▁▂▁▁▂▇▄█▃▃▄▄▅▆▅▂▄▄▆▄▅▃▅▃▃▅▃▂▄▅▄▂▅▅▅
wandb:                train_auroc ▃▁▁▃▃▅▅▆▆▆▇█████████████████████████████
wandb:                 train_loss ███▅▅▄▄▃▂▂▂▁▁▂▁▁▁▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▂▁▁▁▄▃▄▁▇▄▅▇▇▇▅▆▄▆▆▆▆▅▅▇▆▅▆█▆▅▄▄▆█▄▅▄▄
wandb:            val_accuracy0.5 ▆▁▇▇▅█▇▇█▇▅▄▇▅▃▇▇▇▆█▇▄▇▇▆▅▅▅▄▆▅▅▆▆▅█▇█▄▅
wandb:           val_accuracy0.75 ███▇▇█▇███▇█▇██▂▃▅▅▇▂▅▅▁▆▆▅▆▅▅▆▄▄▄▄▆▃▄▅▃
wandb:                  val_auroc ▃▃▇▆▇▅▆▆▆▆▇▆▆▄▄▄█▄▃▆▄▄▆▅▄▅▂▄▃▃▁▁▁▁▂▄▃▅▇▁
wandb:  val_balanced_accuracy0.25 ▅▅▅▆▅▅▆▅▇▃▇█▆█▃▅▃▇▆▆▄▄▄▆▆▆▆▄▆▆▄▄▁▃▄▄▅▅▆▂
wandb:   val_balanced_accuracy0.5 ▄▃▄▄▅▄▄▆▃▆▅▆▇▅▇▅▅▄█▆▆█▆▄▆▆▄▆▅▄▂▂▂▄▃▂▃▆▄▁
wandb:  val_balanced_accuracy0.75 ▄▄▄▄▃▆▆▄▆▄▄███▆▆▅▅▆▄▅▆█▆▆▅▄▇▇▅▅▂▁▂▄▅▆▆▆▃
wandb:          val_precision0.25 ▃▃▃▃▃▅▄▃▅▆▃▃▃▂▂▃▃▄▃▃▃▃▃▄▃▂▂▁▂▂▂▁▅▄▃▃█▂▁▂
wandb:           val_precision0.5 ▃▃▃▄▅▂█▅▇█▅▄▃▃▅▃▄▄▃▂▂▂▂▃▄▃▂▃▂▄▃▃▃▃▃▃▁▇▄▁
wandb:          val_precision0.75 ▁▁▁▁▁▄▃▇▅▅▇▁▄█▄█▅▅▆▅▄▄▄▄▅▄▅▄▄▄▄▅▄▃▄▄▄▄▅▃
wandb:             val_recall0.25 █▇█▆▂▇▅▁▂▃▄▃▅▂▄▅▄▃▄▅▄▃▃▃▃▄▅▂▂▄▂▃▃▅▃▂▃▄▃▂
wandb:              val_recall0.5 ▁▅▁▄▃▄▂▃▃█▅▃▆▃▃▆▄▆▅▅▅▃▄▅▅▆▅▅▄▃▆▃▄▅▃▄▆▆▅▃
wandb:             val_recall0.75 ▁▁▁▁▃▄▂▁▃▃▄█▇▄▄▅▃▄▄█▂▅█▃▄▄▆▅▄▆▆▂▃▄▇▃▆▂▅▄
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.58228
wandb:           test_accuracy0.5 0.64557
wandb:          test_accuracy0.75 0.65823
wandb:                 test_auroc 0.61525
wandb: test_balanced_accuracy0.25 0.58814
wandb:  test_balanced_accuracy0.5 0.59746
wandb: test_balanced_accuracy0.75 0.57288
wandb:         test_precision0.25 0.32432
wandb:          test_precision0.5 0.35714
wandb:         test_precision0.75 0.34783
wandb:            test_recall0.25 0.6
wandb:             test_recall0.5 0.5
wandb:            test_recall0.75 0.4
wandb:                train_auroc 0.99956
wandb:                 train_loss 0.05602
wandb:           val_accuracy0.25 0.47619
wandb:            val_accuracy0.5 0.52381
wandb:           val_accuracy0.75 0.57143
wandb:                  val_auroc 0.42162
wandb:  val_balanced_accuracy0.25 0.41967
wandb:   val_balanced_accuracy0.5 0.42551
wandb:  val_balanced_accuracy0.75 0.45716
wandb:          val_precision0.25 0.17778
wandb:           val_precision0.5 0.16667
wandb:          val_precision0.75 0.19355
wandb:             val_recall0.25 0.30769
wandb:              val_recall0.5 0.23077
wandb:             val_recall0.75 0.23077
wandb: 
wandb: 🚀 View run resnet50_2d_78_14_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/9saliiaa
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_14/wandb/run-20250702_012547-9saliiaa/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_14/wandb/run-20250702_015456-i2o44dl5
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_14_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/i2o44dl5
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▃▁▄▇▇▇▆▄▃▆▅▆▃▃▆▅▅▃█▅▇▃▅▂▅▄▃▇▄▁▁▅
wandb:           test_accuracy0.5 ▁▁▂█▇█▇▇▇▅█▇▆▇▅▇▅▅▄▇▄▅▆▆▆▆▅▅▅▄▂▆▅▄▅▁▆▆█▅
wandb:          test_accuracy0.75 ███▇███████▇▄▂▇▅▂▇▁▅▆▂▇█▃▄▅▄▁▅▄▃▃▄▃▄▅██▇
wandb:                 test_auroc ▃▃▄▅▅▇▆▅█▆▅▇▆▄▆▅▆▆▆▅▅▄▄▄▄▁▇▆▅▆▅▅▄▅▅▅▅▂▂▇
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▃▃▃▃▃▃▆█▇██▅▇▆▆▄▇▇▅▆▆▁▂▅▄▆▄▅▃▆▄▅█▃█
wandb:  test_balanced_accuracy0.5 ▂█▃▂▅▆▆▅▄▇▄▅▃▃▄▅▄▂▄▃▃▂▁▃▄▅▅▄▅▄▂▂▅▅▁▂▂▂▃▅
wandb: test_balanced_accuracy0.75 ▂▂▁▂▃▁▂▂▆▂▄▁▂▃▁▃█▃▅▃▂▃▂▂▁▂▄▃▂▃▄▃▂▂▅▅▂▂▂▄
wandb:         test_precision0.25 ▂▂▂▂▂▂▂▃▄▄█▂▆▄▆▄▄▄▂▂▄▂▇▆▄▁▄▅▆▅▄▃▃▄▃▂█▃█▆
wandb:          test_precision0.5 ▅▅▅▆█▁▁▅▇▇▆▆▆▆▆▆▅▆▆▆▇▅▆▅▅▅▆▆▆▆▆▅▅▅▅▆▆▅▇▇
wandb:         test_precision0.75 ▁▁▁▁█▁▃█▁▇▆▅▆▅▅▆▅▄▅▄▅▅▆▅▅▇▆▄▄▅▅▅▅▅▄▅▅▅▅▁
wandb:            test_recall0.25 ███████▅██▃▄▅▆▁▆▆▃▄▇▇▆▅▁▃▃▃▅▄▄▄▇▇█▆▅▅▅▆█
wandb:             test_recall0.5 █▁▆▂▄▅▂▁▂▆▃▃▄▃▆▂▆▄▄▅▃▃▃▆▄▆▅▅▅▅▅▅▃▆█▃▃▁▃▅
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▂▃▇▃▂▂█▅██▃█▃▇▃▃▆▂▄▃▅▄▅▅▅▇▇▄▇▄▁▁▆
wandb:                train_auroc ▂▁▂▂▁▃▄▅▆▇▇▇████████████████████████▂▃▅█
wandb:                 train_loss ▇▇▇█▇▆▆▅▄▅▃▂▂▁▁▁▁▁▁▁▁▁▁▁▇▁▁▁▂▁▁▁▁▁▁▁▁▁█▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▂█▇▅▇█▅▅▄█▄▆▄▅▄█▃▆▅▇▅▆▆▄▄▄▆▄▅▃▄▅▃▄▁
wandb:            val_accuracy0.5 ▁█▆█▅▇▇▂▇▇▄▇▆█▅▂▅▇▃▃▂▆▇▂▂▆▅▄▄▃▂▄▂▃▃▄▅▇█▆
wandb:           val_accuracy0.75 ███████▆██▇▇▆▄█▇▅▇▇▅▇▄▆▅▅▅▆▃▄▅▄▅▆▆▄▆▁██▆
wandb:                  val_auroc ▇▇███▅▇▂▂▂▄▄▃▇▄▆▅▅▂▃▁▄▇▅▇▄▄▆▆▆▅▆▅▄▅▄▅▄▅▇
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▆▄▃▃▁▄▅▆▅▂▄▁▃█▇▇▁▃▆▇▆▇▇▆▆▆▂▇▂▇▂▅▇▄▂▅
wandb:   val_balanced_accuracy0.5 ▄▂▂▅▇▃▅▂▄▄▂▂▂▃▄▂▄▃▄▂▅▄▃▅▄▄▅▄▅▃▄▆▄▃▅▁▂▁▅█
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▃▃▄▅▃▃▆▃▇▆▆▆▅█▆▃▂▅▄▄▆▆▆▅▅▄▃▃▅▃▆▅▃▅▄█
wandb:          val_precision0.25 ▂▂▂▂▂▂▂▂▂▂▂▂▂▁▃▄█▃▃▄▄▃▅▂▁▅▄▃▃▂▄▅▇▅▂▄▂▂▃▄
wandb:           val_precision0.5 ▄▅▅▆▇▆▄▇▆▆██▅█▅▅▅▅▄▅▅▅▆▆▅▅▆▅▅▅▅▅▅▅▅▅▅▁▅▆
wandb:          val_precision0.75 ▁▁███▄▅▅▄▅▄▃▃▃▄▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▁▁▃
wandb:             val_recall0.25 ███████▇█▂▁▂▃▄▂▄▃▄▂▅▁▇▅▄▄▁▃▂▄▄▄▅▅▅▅▆▅▅▅▄
wandb:              val_recall0.5 ▃█▂▂▁▂▃▂▂▂▃▃▄▅▇▄▃▃▄▃▄▃▃▅▅▅▅▅▅▄▅▇▇▆▄▅▃▃▅▅
wandb:             val_recall0.75 ▁▁▁▁▁▂▂▂▂▂▂▂▅▅▃▄▅▃▅█▅▄▅▅▄▃▄▅▅▅▇▇▅▅▄▅▁▁▁▃
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.48101
wandb:           test_accuracy0.5 0.55696
wandb:          test_accuracy0.75 0.5443
wandb:                 test_auroc 0.61102
wandb: test_balanced_accuracy0.25 0.60297
wandb:  test_balanced_accuracy0.5 0.62076
wandb: test_balanced_accuracy0.75 0.54619
wandb:         test_precision0.25 0.30909
wandb:          test_precision0.5 0.33333
wandb:         test_precision0.75 0.28947
wandb:            test_recall0.25 0.85
wandb:             test_recall0.5 0.75
wandb:            test_recall0.75 0.55
wandb:                train_auroc 0.9986
wandb:                 train_loss 0.16383
wandb:           val_accuracy0.25 0.49524
wandb:            val_accuracy0.5 0.57143
wandb:           val_accuracy0.75 0.60952
wandb:                  val_auroc 0.61733
wandb:  val_balanced_accuracy0.25 0.54844
wandb:   val_balanced_accuracy0.5 0.58617
wandb:  val_balanced_accuracy0.75 0.59859
wandb:          val_precision0.25 0.27869
wandb:           val_precision0.5 0.31373
wandb:          val_precision0.75 0.33333
wandb:             val_recall0.25 0.65385
wandb:              val_recall0.5 0.61538
wandb:             val_recall0.75 0.57692
wandb: 
wandb: 🚀 View run resnet50_2d_78_14_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/i2o44dl5
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_14/wandb/run-20250702_015456-i2o44dl5/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_14/wandb/run-20250702_022141-cs347iz1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_14_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/cs347iz1
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: uploading history steps 281-282, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▂▁▄▁▂▅█▇▂▇▁▃▃▆▇▇▇▅▃▄▄▄▄▂▇▇▅▅▅▅▄▆▆▇▃▃▃▃▄▄
wandb:           test_accuracy0.5 █▅█▁██▁▅▇▇▂▅▁█▇▄▆▄▁▃▂▂▂▂▃▁▄▄▂▃▂▂▃▁▂▂▁▁▁▂
wandb:          test_accuracy0.75 ██████▇█▇▆▆▃▆▇▆▄▃▂▅▅▆▂▁▁▃▃▂▂▂▁▅▂▂▂▃▆▂▂▁▂
wandb:                 test_auroc ▅▆█▇▆▇▆██▇▄▇▄▇▆▄▆▅▄▄▅▄▃▄▄▅▄▄▆▅▃▇▇▆▂▁▁▁▂▂
wandb: test_balanced_accuracy0.25 ▄▁▄▄▄▂▁█▃▂▇▇▂▅▆▆▄▁▃▄▄▃▄▄▇▂▂▂▂▃▅▅▄▃▂▂▂▂▃▄
wandb:  test_balanced_accuracy0.5 ▄▃▃▂█▂▅▄▅▅▄▃▂▁▃▂▅▄▆▅▂▃▄▂▃▃▃▄▂▂▂▂▂▃▂▂▃▂▁▁
wandb: test_balanced_accuracy0.75 ▄▄▄▅▄▄▄▆█▇▄▄▅▆▃▅▆▃▅▃▃▃▄█▇▅▄▁▄▂▅▄▅▄▂▄▃▃▃▄
wandb:         test_precision0.25 ▃▃▂▃▂▂▄█▃▄▁▇▄▂▂▃▆▄▅▄▂▆▂▁▃▄▄▅▄▄▅▃▃▄▃▃▃▂▃▁
wandb:          test_precision0.5 ▄██▁▁▆█▁▄▄▅▅▆▅▄▅▅▅▄▄▄▄▄▅▄▅▄▅▄▄▄▄▄▄▄▄▄▄▄▄
wandb:         test_precision0.75 ▁▁▁█▁▁█▄▅▅▆▅▅▄▆▅▅▅▄▅▄▅▅▅▅▅▅▅▅▄▅▅▇▄▅▄▄▄▄▄
wandb:            test_recall0.25 █▇▇▆█▅▅▇▆▄▇▂▅▃▅▇▆▁▆▅▆▅▅▅▅▅▅▅▇▆▆▆▅▆▅▇▅▆▅▇
wandb:             test_recall0.5 ▅▅▁▃▇▁▂▃▄▁▇▃▂▂█▇▅▆▆█▄▄▇▇▇▅▆█▇▆▇▄█▆▆▇▇▇▇▇
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▆▄▅▅▅▄▅▆▆▆▇▇▇▇▅▆▇▅▇▅▇▄▄▅▇▇█▇▇▇▇▇█
wandb:                train_auroc ▁▄▅▅▄▅▃▇█▅██████████████████████████████
wandb:                 train_loss ██▇▇▇▇█▄▂▁▂▃▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▂▁▂▁▂▅▃▅▅▇▅█▆▅▄▆▄▄▇▅▇▇▅▅▅▅▅▅▄▄▅▄▄▄▄▄▄▄▅
wandb:            val_accuracy0.5 ▆█▂▇▇▇▇█▅█▇▅▇▃▃▄▂▄▂▅▃▄▃▃▄▄▃▂▁▂▃▄▄▂▅▁▁▂▂▂
wandb:           val_accuracy0.75 ██████████▅▇▅▇▅▅▃▃▃▂▄▇▄▂▁▃▃▁▂▃▃▆▁▁▁▁▁▁▂▃
wandb:                  val_auroc ▂▂▄▄▃▁▃▃▄▄▂▄▅▅▅▃█▅▅▇▆▂▃▃▄▅▆▆▆▃▆▅▄▃▄▄▂▃▃▅
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▅▄▁▇▅▇▅▂▅▅█▇█▇▅▆▄▅▅▅▂▂▄▂▇▃▂▂▁▂▂▂▂▂▂▂
wandb:   val_balanced_accuracy0.5 ▂▇▁▃▃▇▄▄▅▆▄▃▂▆▇▂▆▇█▇▇▇▅▆▆▅▄▅▄▃▅▄▅▁▂▃▃▃▃▄
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▂▄▄▅▂▄▇▃█▇▆▅▅█▆▆▆██▆▄▃▃▅▆▄▆▅▇▆▅▂▂▃▃▃
wandb:          val_precision0.25 ▁▁▁▁▁▄▄▄▁▇▃▃▅▄▃▃▄▆█▅▅▄▄▄▄▄▃▂▆▇▄▄▃▂▂▁▂▂▂▂
wandb:           val_precision0.5 ▁▃▆▆▇▅▆██▇▅▆▆▆▆▆▅▅▆▅▅▅▅▅▅▅▅▅▅▅▆▆▆▅▅▅▅▅▅▅
wandb:          val_precision0.75 ▁█▁▅▅▅▅▅▄▃▅▄▄▆▅▄▄▅▅▄▄▄▄▄▄▅▄▅▅▄▄▄▄▄▄▄▄▄▄▄
wandb:             val_recall0.25 ███▂▇▁█▆▅▄▆▁▄▄▇▆▃▇▆▆▆▇▇▆▆▅▆▆▆▆▂▆▆▁▄▅▆▆▆▅
wandb:              val_recall0.5 ▅▆▂▂▁▂▆█▅▁▆▆▇▇█▆▇▇█▆▇███▄▆▇▇▇▇▇▇▆█▇▇▇▇▇▅
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▃▁▆▅▇▁▆▇██▆▇█████▆▇▇▇█▇█▅█▆▇▇▇▇▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.34177
wandb:           test_accuracy0.5 0.37975
wandb:          test_accuracy0.75 0.37975
wandb:                 test_auroc 0.4661
wandb: test_balanced_accuracy0.25 0.44364
wandb:  test_balanced_accuracy0.5 0.45254
wandb: test_balanced_accuracy0.75 0.43602
wandb:         test_precision0.25 0.22414
wandb:          test_precision0.5 0.22642
wandb:         test_precision0.75 0.21569
wandb:            test_recall0.25 0.65
wandb:             test_recall0.5 0.6
wandb:            test_recall0.75 0.55
wandb:                train_auroc 0.99964
wandb:                 train_loss 0.07466
wandb:           val_accuracy0.25 0.40952
wandb:            val_accuracy0.5 0.40952
wandb:           val_accuracy0.75 0.40952
wandb:                  val_auroc 0.62147
wandb:  val_balanced_accuracy0.25 0.54309
wandb:   val_balanced_accuracy0.5 0.54309
wandb:  val_balanced_accuracy0.75 0.51728
wandb:          val_precision0.25 0.26923
wandb:           val_precision0.5 0.26923
wandb:          val_precision0.75 0.25676
wandb:             val_recall0.25 0.80769
wandb:              val_recall0.5 0.80769
wandb:             val_recall0.75 0.73077
wandb: 
wandb: 🚀 View run resnet50_2d_78_14_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/cs347iz1
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_14/wandb/run-20250702_022141-cs347iz1/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_14/execution_datetimes.json

**************************************************  Experiment 78 | Version 15 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 19, 1.0: 9}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 16, 1.0: 12}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 13, 1.0: 19}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 11, 1.0: 17}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_15/wandb/run-20250702_024714-66kme92x
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_15_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/66kme92x
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▇█▂▇▃▄▄▆▅▄▆▄▄▃▄▃▄▄▅▃▄▄▄▄▃▅▃▄▄▄▄▃▄▄▄▄▃▃▅
wandb:           test_accuracy0.5 ▁▂▆█▆▇█▇██▅▇▅▆▄▅▄▆▄▄▄▅▄▅▅▃▄▃▇▅▄▅▄▄▄▅▄▄▄▆
wandb:          test_accuracy0.75 ████████▆██▃▄▃█▇▃▄▃▃▃▄▃▃▄▃▂▁▃▃▄▂▇▃▁▅▃▅▃▅
wandb:                 test_auroc ▂▂▁▄▄▅█▆▃▃▃▃▂▂▄▄▇▄▅▂▄▄▃▃▃▄▄▅▅▅▄▅▄▄▄▃▃▂▁▅
wandb: test_balanced_accuracy0.25 ▃▃▄▃▂▇▆▃▃▂▄▄▅▅▅▅▅▅▇▂▄▅▁▁▄▅▂▄▇▃▃▅▂█▃▁▂▂▄▄
wandb:  test_balanced_accuracy0.5 ▄█▃▅▄▃▃▄▅▄▅█▃▄▃▂▄▄▃▃▁▁▂▄▂▃▄▅▆▃▃▄▄▄▅▂▄▂▅▆
wandb: test_balanced_accuracy0.75 ▄▄▄▄▄▄▄▇▇▄▂▂▁▃▄▅▄█▇▅▂▆▂▃▂▃▄▄▃▄▁▆▂▄▅▇▃▄▃▄
wandb:         test_precision0.25 ▄▃▄▄█▇▅▇▇▅▅▄▅█▆▅▆▃▆▂▄▃▅▆▄▆▅▃▃▆▅▃▄▅▃▆▁▅▃▅
wandb:          test_precision0.5 ▅▅▄▇▅▁█▆▅▁▅▄▅▅▄▅▄▄▄▄▄▅▅▅▄▅▅▄▄▅▅▅▄▄▄▅▄▄▄▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▆▇▅█▅▆▆▆▅▅▆▅▅▄▅▅▅▅▅▅▅▅▅▆▅▅▅▄▅▅▅▆
wandb:            test_recall0.25 █▆▇▇▇█▆▆▆▆▆▆▆▁▃▅▅▄▃▃▄▄▇▄▅▆▅▆▆▄▆▅▅▅▅▄▄▄▅▅
wandb:             test_recall0.5 █▂▂▂▆▁▂▂▁█▂▄▄▇▄▅▅▆▄▆▄▅█▆▅▅▅▅▇▆▂▆█▅▆▇█▆▇▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▂▁▁▁▂▆▄▅▆▅▅▄█▅▆▅▅█▆▆▅▆▇█▇▆▄▆▆▆▆▆▆▃
wandb:                train_auroc ▁▂▃▃▂▂▃▃▄▅▅▇▇▅██████████████████████████
wandb:                 train_loss ██▇▇▇▆▅▄▃▆▂▂▂▂▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▂▂▃▃▄▄▃▃▇▅█▄▇▃▅▄▇▇▆▆▅▆▄▆▅▅▄▆▅▆▅▄▄▅▅▂▅▅▅
wandb:            val_accuracy0.5 ▆▃▅▅▅▇██▁█▅▃▅▆▆▃▃▆▆▆▂▁▁▃▃▄▄▄▃▅▄▂▂▃▄▄▄▃▃▂
wandb:           val_accuracy0.75 █████▇▇█▇█▅▅▇▅▆▄▄▅▅▅▅▃▂▄▄▅▄▄▁▄▄▅▅▁▃▃▂▃▂▄
wandb:                  val_auroc █▁▂▃▅▆▇▆▅▇▅▇▅▅▅▅▅▆▆▆▆▇▆▅▅▆▆▆▆▆▅▄▄▅▅▆▆▆▆▅
wandb:  val_balanced_accuracy0.25 ▃▃▃▃▃▇▂▆▅▄▆█▇▁▆▃▄▂▅▅▃▅▅▄▄▃▄▁▅▂▃▅▅▃▄▃▆▆▆▄
wandb:   val_balanced_accuracy0.5 ▂▅▅▃▃▅▅▁▆▅▅▅█▇▅▇█▆▄▆▆▆▇▆▆▆▆▅▅█▄▅▄▅▅▅▄▅▇▇
wandb:  val_balanced_accuracy0.75 ▃▂▃▃▃▃▂▂▅▇▇▇▇▇▅▇▇▆▅▆▆█▅▅▇▅▄▅▄▅▄▃▁▆▆█▃▆▅▇
wandb:          val_precision0.25 ▂▂▃▃▃▇▄▂▅█▄▄▁▁▄▃▃▃▂▃▂▂▃▃▄▃▅▃▂▃▃▂▃▂▂▂▃▃▃▂
wandb:           val_precision0.5 ▁▄▄█▃█▄▄▄▄▅▄▃▄▅▄▄▄▅▄▃▃▃▃▃▄▄▄▂▃▄▅▅▄▄▃▄▄▄▃
wandb:          val_precision0.75 ▁▁▁▁▁▁█▃▅▅▅▅▄▄▅▄▄▅▅▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▆
wandb:             val_recall0.25 ▇▇▇██▅▂▂▂▅▁▁▁▂▃▁▃▂▂▂▄▄▃▃▂▄▂▄▃▄▁▂▃▃▄▄▅▅▅▄
wandb:              val_recall0.5 ▆▃▆▃▂█▃▂▂▁▂▅▄▄▆▆▃▅▅▅▆▅▄▆▆▅▄▄▄▆▄▅▆▄▄▄▆▇▆▇
wandb:             val_recall0.75 ▁▁▁▁▁▁▃▁▁▁▁▄▄▅▁▄▄▅▅▅▄▅▆▅▅▄▅▅▅▆▆█▆▇▇▆▆▆█▂
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.55696
wandb:           test_accuracy0.5 0.59494
wandb:          test_accuracy0.75 0.62025
wandb:                 test_auroc 0.50169
wandb: test_balanced_accuracy0.25 0.50508
wandb:  test_balanced_accuracy0.5 0.49746
wandb: test_balanced_accuracy0.75 0.51441
wandb:         test_precision0.25 0.25806
wandb:          test_precision0.5 0.25
wandb:         test_precision0.75 0.27273
wandb:            test_recall0.25 0.4
wandb:             test_recall0.5 0.3
wandb:            test_recall0.75 0.3
wandb:                train_auroc 0.99876
wandb:                 train_loss 0.16216
wandb:           val_accuracy0.25 0.50476
wandb:            val_accuracy0.5 0.5619
wandb:           val_accuracy0.75 0.59048
wandb:                  val_auroc 0.48637
wandb:  val_balanced_accuracy0.25 0.47736
wandb:   val_balanced_accuracy0.5 0.50243
wandb:  val_balanced_accuracy0.75 0.48272
wandb:          val_precision0.25 0.22917
wandb:           val_precision0.5 0.25
wandb:          val_precision0.75 0.22581
wandb:             val_recall0.25 0.42308
wandb:              val_recall0.5 0.38462
wandb:             val_recall0.75 0.26923
wandb: 
wandb: 🚀 View run resnet50_2d_78_15_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/66kme92x
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_15/wandb/run-20250702_024714-66kme92x/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_15/wandb/run-20250702_034155-osqqu2a9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_15_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/osqqu2a9
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▂▅█▇▁▃▆▄▇▅▇█▇▇██▅█▆▆▇▇▇▇▆▇▇▁▅█▆█▇▇▆▇▇▆▆▆
wandb:           test_accuracy0.5 ▇██▇▇▁▃▇▇█▇▇█▇▇▆▇▇▆▇▆▅▆▅▆▅▆▆▆▆▆▁█▇▇▇▆▇▅▆
wandb:          test_accuracy0.75 ▇▇▇▇▇▇▇▇▇▇▆▃▆▆▅▇▃▆▄▃▁▂▅▃▅█▆▇▇▇▇▇▃▄▆▁▃▅▅▃
wandb:                 test_auroc ▁▅▄▄▅▇▆█▇▇▅▃▆█▇▂▃▃▃▃▅▂▅▅▅▄▅▇▆▄▄▆▆▃▃▄▃▃▃▄
wandb: test_balanced_accuracy0.25 ▂▂▄▅▁▂▂▆▅▅▁▄▆▄▆█▂▃▅▄▆▅▃▃▄▅▄▆▂▂▃▅▅▇▅▅▄▆▆▇
wandb:  test_balanced_accuracy0.5 ▅█▆▅▁▁▃▄▂▃▂▁▃▃▂▁▄▂▂▁▂▃▄▄▄▂▃▆▁▆▁▃▅▂▃▂▃▃▃▄
wandb: test_balanced_accuracy0.75 ▂▂▁▁▂▂▂▃▂▂▅▃▁▄▅▇▂▂▂▂▂▃█▁▆▇▅▄▅▆▂▃▃▇▄▆▅▅▇▃
wandb:         test_precision0.25 ▁▁▁█▃▃▁▃▃▄▃▃▂▃▂▂▂▂▂▃▂▂▁▁▂▄▃▃▁▃▃▃▂▂▂▃▅▃▃▂
wandb:          test_precision0.5 ▃▃█▃▄▃▆▁▅▃▂▄▃▄▃▃▁▄▃▃▃▃▃▄▃▄▆▃▁▃▄▃▃▃▃▃▃▃▃▃
wandb:         test_precision0.75 ▁▁▁█▁▂▁▁▁▁▃▅▃▃▄▄▃▃▂▃▃▃▃▃▃▃▃▃▃▃▁▁▁▅▄▃▃▄▄▃
wandb:            test_recall0.25 ██▆▁▄▁█▂▃▁▄▄▂▆▃▁▂▂▂▃▂▂▂▃▃▃▃▄▃▂▆▇▃▃▃▃▃▃▁▃
wandb:             test_recall0.5 ▃▆▁▄▁▁▄▆▁▃▄▂▆▄▆▃▃▂▃▂▃▃▃▃▃▃▃▃▄▄▃▁█▂▃▃▄▃▄▂
wandb:            test_recall0.75 ▁▁▁▁▃▄▃▅▂▂▅▆▃▁▃▃▆▃▃▃▅▇▂█▅▅▁▁▁▅▇▅▄▇▁▆▅▅▂█
wandb:                train_auroc ▃▆▄▅▆▇▇▇█████▅██████████████▁▃▆▅▆▆▇█████
wandb:                 train_loss ▇▇▆▆▅▅█▆▅▄▂▂▁▂▁▃▂▁▁▁▁▁▁▁▁▁▁▁▂▆▃▂▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▅▂▃▄▇▇█▅▆▅█▆▇▅█▆█▅▅▆▆▂▄▆▄▇▅▆▅▆▇▇▆▄▇
wandb:            val_accuracy0.5 ▇▇██▁█▇▆▇▇▆█▅▅▇▇▇▄▆▄▆▄▇▅▅▄▆▇█▅▅▅▆▆▆▇▇▇▆▅
wandb:           val_accuracy0.75 █▅█▆███▆▇▄▇▆▅▅▃▁▃▄▃▃▁▃▃▃▃▃█▆▆▆▅▃▆▃▄▃▄▁▅▁
wandb:                  val_auroc ▇▆▅▆██▅▅▆▅▅▅▆▆▃▄▁▂▃▄▅▄▄▄▄▄▄▄▇▅▅▅▅▅▅▅▅▅▅▅
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▅▅▄▄▄█▆▅▂▆▃▄▄▅▄▄▄▅▅▅▅▅▃▂▁▃▃▃▄▄▄▅▅▅▄▅
wandb:   val_balanced_accuracy0.5 ▄▅█▄▃▃▃▇▃▄█▅▃▄▄▄▆▃▃▂▂▁▂▁▂▁▂▂▂▂▁▂▂▂▂▄▃▃▃▄
wandb:  val_balanced_accuracy0.75 ▄▅▄▄▄▄▄▇▅▇▅█▇▇▇▂▂▄▃▁▆▁▂▂▂▁▂▃▃▄▆▆▆▅▆▆▆▆▅▅
wandb:          val_precision0.25 ▅▄█▅▆▅▅█▅▅█▅▄▅▃▁▄▄▅▅▄▅▅▅▃▅▅▅▅▄▅▆▅▅▅▆▅▅▆▅
wandb:           val_precision0.5 ▂▃▆█▅▄▄▇▅▇▇▆▅▄▃▃▃▁▁▃▂▁▂▃▃▃▂▄▇▆█▄▃▄▅▅▃▃▃▅
wandb:          val_precision0.75 ▁▁▁█▄▅▅▅▇▅▅▇▅▅▄▄▄▂▄▃▄▁▃▁▄▃▃▄▁▁▄▄▅▅▅▅▄▄▄▄
wandb:             val_recall0.25 █▂▃██▄▄▃▃▃▂▃▄▅▄▂▁▂▂▃▄▄▃▃▃▂▄▃▃▅▄▄▅▄▅▄▃▃▃▃
wandb:              val_recall0.5 ▆▁▁▃▁▃▅▃█▃▃▄▃▂▃▆▃▂▂▁▄▁▅▁▃▃▅▃▃▄▁▃▃▃▅▆▆▅▄▅
wandb:             val_recall0.75 ▄▂▁▁▂▂▂▂▂▂▄▃▅▂▃▁▇▃▂▄▅▂▄▂█▄▃▃▃▁▁▁▃▇▇▄▆▅▅▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.63291
wandb:           test_accuracy0.5 0.63291
wandb:          test_accuracy0.75 0.63291
wandb:                 test_auroc 0.57712
wandb: test_balanced_accuracy0.25 0.62203
wandb:  test_balanced_accuracy0.5 0.57246
wandb: test_balanced_accuracy0.75 0.57246
wandb:         test_precision0.25 0.36364
wandb:          test_precision0.5 0.33333
wandb:         test_precision0.75 0.33333
wandb:            test_recall0.25 0.6
wandb:             test_recall0.5 0.45
wandb:            test_recall0.75 0.45
wandb:                train_auroc 0.99974
wandb:                 train_loss 0.05547
wandb:           val_accuracy0.25 0.59048
wandb:            val_accuracy0.5 0.62857
wandb:           val_accuracy0.75 0.6381
wandb:                  val_auroc 0.51509
wandb:  val_balanced_accuracy0.25 0.53432
wandb:   val_balanced_accuracy0.5 0.54674
wandb:  val_balanced_accuracy0.75 0.55307
wandb:          val_precision0.25 0.28205
wandb:           val_precision0.5 0.30303
wandb:          val_precision0.75 0.3125
wandb:             val_recall0.25 0.42308
wandb:              val_recall0.5 0.38462
wandb:             val_recall0.75 0.38462
wandb: 
wandb: 🚀 View run resnet50_2d_78_15_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/osqqu2a9
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_15/wandb/run-20250702_034155-osqqu2a9/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_15/wandb/run-20250702_050748-iovjza3g
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_15_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/iovjza3g
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▅▃▅▇▄▆▆▁█▆▅▅▆▅▆▇▇▇▆▆▇▆▆▇▇▆▇▇▆█▆▇▅
wandb:           test_accuracy0.5 ▁▄▅███▄▅█▇▇██▇▆▇▇▇▇█▇▇▇▆▆▇▇▆▆▅▆▆▇▆▆▆▆▇▅▇
wandb:          test_accuracy0.75 █████████████▇▇▃▇▇█▅▆▅▇▃▄▃▃█▃▂▅▆▅▂▇▅▁▂▂▆
wandb:                 test_auroc ▄▅▅▅▁▂▄▆▇▇▅▇▅▆▅▆▄▃▅▇▇▇▇▇▇▇▇██▇▆▇▆▆█▇█▇▅▆
wandb: test_balanced_accuracy0.25 ▂▂▂▂▂▂▁▂▂▂▄▄▅▆▅▆█▅▃▄▆▆▆▇▅▅▃█▇▆▃▇▇▄▅█▆▅▆▅
wandb:  test_balanced_accuracy0.5 ▁▁▆▃▅▅▆▄▅▄▄▆▅▄▆▆▄▆▆█▆▇▇▅▆▇▅▇▇▇▆▇▄▆▇▆█▇▇▆
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▅▄▁▄▁▂▃▂▄▆▅▆▃▇█▇▄▃▅▄▃▃▂▇█▃▅▇
wandb:         test_precision0.25 ▂▂▂▂▁▂▂▂▂▂▃▅▇▂▂█▁▄▄▅▅▄▆▅▄▄▄▄▂▁▄▇▅▃▄▃▆▅▅▄
wandb:          test_precision0.5 ▅▄█▄▆▁▆▅▇▆▆▆▆▅▁▅▅▅▇▆▅▅▅▄▅▅▅▆▅▅▆▅▄▅▅▅▅▆▇▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▄▁▁▆▄▄▅▆█▅▅▆▅▅▅▅▄▅▅▅▅▅▅▄▄▄▅▄▅▅▆▅▄▅
wandb:            test_recall0.25 ██████████▃▄▁▃▄▃▃▃▆▆▃▂▅▄▆▄▂▆▅▃▃▄▁▁▃▅▅▄▄▄
wandb:             test_recall0.5 █▆▁▄▄▅▆▄▂▁▃▂▅▂▁▅▂▅▄▇▃▃▄▃▃▅▆▄▄▃▄▅▆▃▅▅▄▄▄▄
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▄▃▅▁▁▃▅▆▅▇█▆▅▅▂▆▅▆▃▄▅▅▅▇▃▆▅▆▇▆
wandb:                train_auroc ▂▃▄▄▄▅▅▁▃▃▅▄▅▆▄▇▇█▆█████████████████████
wandb:                 train_loss ████▇▇██▇▇▅▅▅▅▆▂▆▂▂▁▃▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▂
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▂▁▃█▆▇▄▅▅▇▄▆▅▇▆▆▇▅▆▇▇▅▆▆▆▆▆▆▅▄▇▆
wandb:            val_accuracy0.5 ▁▇▇▆█▇██▇▇▆▇█▅▇▇▆▆▆▆█▇▆▇▆▅▆▆▆▆▆▆▆▆▅▆▄▅▆▇
wandb:           val_accuracy0.75 ▇▇▇▇▇▇▇█████▅▆▅▆▄▅▄▄▅▃▅▆▄▃▄▃▅▄▅▃▃▅▅▁▃▁▂▁
wandb:                  val_auroc ▁▄▄▄▄▄▇▇██▆▅▆▆▆▄▅▃▅▁▄▃▄▃▂▄▂▅▅▄▄▅▆▆▃▂▁▂▅▆
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▄▇▂▇▇▄▇▃█▄▄▅▄▃▁▃▇▄▇▆▅▆▅▄▄▅▂▆▁▁▆
wandb:   val_balanced_accuracy0.5 ▂█▇▄▄▆▇▆▆▅█▂▇▅▄▆▁▆▇▆▅▅▅▆▄▅▅▄▅▄▅▄▃▃▂█▅▇▅▆
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▂▂▂▁▂▃▅▇▆▅▆▄▄▆▅▄▅▅▆█▇▅▇▇▅▄▁▇▃▆▆▂▃█▆▄
wandb:          val_precision0.25 ▂▂▂▂▂▂▂▂▂▆▂▄▄▅▄▄▂▄▅█▇▃▅▅▅▄▅▅▆▂▁▄▅▃▂▄▄▃▄▆
wandb:           val_precision0.5 ▂▂▂▂▃▅▆▄█▃▄▄▅▆▃▅▃▁▂▃▅▃▂▃▃▃▄▃▃▃▃▃▄▃▃▂▂▂▂▃
wandb:          val_precision0.75 ▁▁▁████▇██▆▆▂▁▅▅▄▄▄▅▄▇▄▅▄▄▄▄▄▄▅▄▄▄▄▅▅▅▅▅
wandb:             val_recall0.25 █████████▆▄▅▇▂▅▆▂▂▄▁▁▄▄▄▄▄▅▃▂▄▄▅▁▄▂▂▄▄▆▄
wandb:              val_recall0.5 ▃▁▇▄▁▃▄▃▅█▃▆▄▅▄▄▂▁▅▄▅▅▆▅▅▆▅▇▆▆▅▆▃▅▆▆▆▆▇▅
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▂▂▂▃▃▃▁▂▄▄▄▂▃▅█▅▅▇▅▅▅▅▇▆▅▆▅▆▃▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.67089
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.68354
wandb:                 test_auroc 0.63559
wandb: test_balanced_accuracy0.25 0.54831
wandb:  test_balanced_accuracy0.5 0.54025
wandb: test_balanced_accuracy0.75 0.54025
wandb:         test_precision0.25 0.33333
wandb:          test_precision0.5 0.33333
wandb:         test_precision0.75 0.33333
wandb:            test_recall0.25 0.3
wandb:             test_recall0.5 0.25
wandb:            test_recall0.75 0.25
wandb:                train_auroc 0.99375
wandb:                 train_loss 0.32433
wandb:           val_accuracy0.25 0.68571
wandb:            val_accuracy0.5 0.69524
wandb:           val_accuracy0.75 0.68571
wandb:                  val_auroc 0.61952
wandb:  val_balanced_accuracy0.25 0.58471
wandb:   val_balanced_accuracy0.5 0.57814
wandb:  val_balanced_accuracy0.75 0.55891
wandb:          val_precision0.25 0.37037
wandb:           val_precision0.5 0.375
wandb:          val_precision0.75 0.34783
wandb:             val_recall0.25 0.38462
wandb:              val_recall0.5 0.34615
wandb:             val_recall0.75 0.30769
wandb: 
wandb: 🚀 View run resnet50_2d_78_15_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/iovjza3g
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_15/wandb/run-20250702_050748-iovjza3g/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_15/execution_datetimes.json

**************************************************  Experiment 78 | Version 16 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 36, 1.0: 28}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 32, 1.0: 32}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 27, 1.0: 37}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 26, 1.0: 34}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_16/wandb/run-20250702_060044-lqo3hjwt
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_16_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/lqo3hjwt
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▇▁▃▂▁▂▆▃▆▂▁▂▃▄█▃▇▅▇▄▆▃▅▅▆▄▆▅▅▄▆▅▅▅▆
wandb:           test_accuracy0.5 ▁▆▆▆▆█▆▇▆▆▇▇█▆▆▇█▆▇▇▇█▆▆▇▇▆▆▅▃▅▄▆▆▅▅▅▇▇▅
wandb:          test_accuracy0.75 ██████████████████▆▆▇█▆▄▅▂▄▅▅▇▂█▂▇▃▃▁▁█▂
wandb:                 test_auroc ▁▁▁▁▂▅▅▆▇▆█▇▆▅█▄▅▆▅▅▄▅▆▆▆▇▄▅▅▇▄▅▇▇▆▇▇▇█▇
wandb: test_balanced_accuracy0.25 ▃▃▃▁▁▁▃▃▃▁▃▃▃▃▃▃▃█▂▃▅▆▃▄▄▄▄▅▃▄▅▅▃▂▄▃▅▄▅▅
wandb:  test_balanced_accuracy0.5 ▃▂▂▅▅▄▃▃▃▁▃▇▆▁▁▁▃▃▃▅▆▆▄▁▅▆▃█▃▄▁▃█▅▅▃▅▄▆▅
wandb: test_balanced_accuracy0.75 ▂▂▂▂▂▂▃▂▂▂▂▁▁▁▂▃▁▂▁▂▇▆▆▆▂█▆▅▅▆▆▅▃▇▅▅▄▄▂▃
wandb:         test_precision0.25 ▄▄▄▄▄▄▁▄▄▄▄▄▄▆▅▇▄▄▅▅▆█▄▅▆▄▄▄▅▄▅▄▅▄▄▅▄▅▅▅
wandb:          test_precision0.5 ▆▅▄█▅▆▆▆▁▆▇▅▃▆▁▆▆▇▆▆▆▇▅▆▅▅▆▅▅▅▅▅▆▅▅▅▅▆▅▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▆▁▄▁▁▁▁▁▁▁▆▃▅▇▁▁▅▅█▆▄▅▇▅▅▅▅▅▅▄
wandb:            test_recall0.25 ██▇▇▆███▇▇▆▃▅▅█▄▂▅▅▄▃▅▃▃▃▃█▁▂▃▃▅▅▅▅▅▅▅▄▅
wandb:             test_recall0.5 ▄▄▃▃▂▁▁▅▂▆▁▁█▁▅▃▁▁▅▁▂▁▄▂▅▅▄▃▃▄▅▃▅▅▄▄▄▅▅▅
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▂▂▁▁▅▁▁▂▁▂█▆▁▂▅▂▄▄▃█▄▄▃▆▅█▆▆
wandb:                train_auroc ▄▃▄▄▄▅▆▅▁▂▅▆▆▅▅▆▆▆▇▅▇▇▇▇████████████████
wandb:                 train_loss ██▇▇▇▆▆█▇▇▆▅▅▅▅▇▅▅▄▄▂▂▁▁▁▁▁▁▁▅▃▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▂▂▃▁▁▁▃▆▁▁▁▃▅▄▅▄▇▄▅█▅▇▆▇▆▇▇█▆▅▇▆▄█▇▅▇▆▃
wandb:            val_accuracy0.5 ▅▆▇▆▇▇█▁▆▆█▇▆█▆██▇▆▆▇▇█▆▇▇██▃█▇▇█▆▇▆▇▄█▄
wandb:           val_accuracy0.75 ███████████████████▇▆█▇▆▆▄▇██▆▆█▃▇▁▄▅█▃▄
wandb:                  val_auroc ▁▂▄▅▅▅▄▄▄▆▆▆▆▅▅▇▆▇█▇▇▇▃▇▇▇▆▄▇▇▇▆██▇▇▇▆▇▇
wandb:  val_balanced_accuracy0.25 ▃▃▄▄▄▆▄▄▄▃▃▃▃▃▁▅▂▂▃▄▇▇▆▆▅▄▆▆█▇▇▅▇▆▃▆▄▆▆▆
wandb:   val_balanced_accuracy0.5 ▂▁▁▂▂▄▁▃▅▄▅▆▅▅▄▅▆▄▅▆▆▆▇▅█▆▇▅▄▃▆█▅▇▆▆▅▆▆▆
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▂▁▂▁▂▁▃▂▂▃▆▅▆▆▆▆▅▆▆▆█▆▅▅▄▅▂▅▄▄
wandb:          val_precision0.25 ▁▁▂▂▂▂▂▂▁▂▂▃▂▁▂▃▂▄▃▄▄▂▄▂▁▅▄▂▃▄▄▄▂█▃▂▃▂▁▂
wandb:           val_precision0.5 ▁▄▄▃▃▃▄▄▄▄▅▆▅▄▆▄▃▄█▄▇▆▆▇▄▆▄▅▆▄▇▇▆▅▆▆▅▆▆▆
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▂▅▅▅▄█▃▃▄▃▃▄▅▆▄▃▃▃▄▄▃▃▃▃▃
wandb:             val_recall0.25 ████▇▂▇█▆▅▄█▂▃▄▃▃▄▂▃▃▄▂▃▅▄▃▃▅▃▁▃▃▂▃▄▄▃▂▄
wandb:              val_recall0.5 ▁▄▂▁▂▂█▃▂▂▂▂▄▄▃▂▂▂▂▄▃▅▃▃▃▃▃▃▃▃▃▄▄▄▄▃▃▃▄▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▁▁▂▁▁▅▄▂▄▄▄▄▅▄▄▄█▄▄▆▄▅▅▅▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.48101
wandb:           test_accuracy0.5 0.5443
wandb:          test_accuracy0.75 0.60759
wandb:                 test_auroc 0.59661
wandb: test_balanced_accuracy0.25 0.55339
wandb:  test_balanced_accuracy0.5 0.54619
wandb: test_balanced_accuracy0.75 0.58856
wandb:         test_precision0.25 0.28571
wandb:          test_precision0.5 0.28947
wandb:         test_precision0.75 0.33333
wandb:            test_recall0.25 0.7
wandb:             test_recall0.5 0.55
wandb:            test_recall0.75 0.55
wandb:                train_auroc 0.99926
wandb:                 train_loss 0.08595
wandb:           val_accuracy0.25 0.52381
wandb:            val_accuracy0.5 0.6
wandb:           val_accuracy0.75 0.62857
wandb:                  val_auroc 0.5667
wandb:  val_balanced_accuracy0.25 0.52872
wandb:   val_balanced_accuracy0.5 0.56646
wandb:  val_balanced_accuracy0.75 0.54674
wandb:          val_precision0.25 0.26923
wandb:           val_precision0.5 0.30952
wandb:          val_precision0.75 0.30303
wandb:             val_recall0.25 0.53846
wandb:              val_recall0.5 0.5
wandb:             val_recall0.75 0.38462
wandb: 
wandb: 🚀 View run resnet50_2d_78_16_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/lqo3hjwt
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_16/wandb/run-20250702_060044-lqo3hjwt/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_16/wandb/run-20250702_065523-avjdsvwx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_16_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/avjdsvwx
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▆▅▅██▇▇▅▇▆▁▁▅▇▇▆▄▅▄▆▅▅▆▆▇▆▇▆▅▅
wandb:           test_accuracy0.5 ▅▅▆▁▅▃███▆▃█▇▆▆▇▇▅▆▇▇██▇▇▃▄▄▃▆▄▅▄▅▅▄▅▅▅▄
wandb:          test_accuracy0.75 █████████▇▇▆▇▇█▇▅▇█▇▅▇▇███▇▅▅▅▆▄▂▂▄▇▇▇▅▁
wandb:                 test_auroc ▃▂▂▂▂▂▃▄▁▆▆▇▆▆▄▅▃▄▃▄▅▄▃▅▅▅██▇▆▅▅▆▆▆▅▆▆▆▅
wandb: test_balanced_accuracy0.25 ▂▂▂▂▅▃▄▃▁▂▃▄▆▂▅▃▃▂▆▇█▆▆▆▆▄▄▅▅▄▅▄▆▆▆▇▆▄▅▅
wandb:  test_balanced_accuracy0.5 ▃▁▅▁▃▅▁▂▃▃▁▁▁▃▁▃▃▂▃▃▄▅▄▄▅▅█▆█▇▄▆▆▅▅▁▅▅▇▇
wandb: test_balanced_accuracy0.75 ▂▂▂▂▂▅▂▂▁▁▂▃▂▂▃▃▁▂▁▄▃▄▄▇▅▄▆▇▅▆█▆▂▅▃█▅▇▇▆
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▅▁▁▁▆▂▃▅▂▅▃▂▁▁▇█▄▄▄▄▂▂▃▃▄▂▄▄▆▃▄▃▃
wandb:          test_precision0.5 ▁▄▁▄▅▃▁▄▇▄▄▃▅▅▄▅▄▅██▅▅▆▅▅▅▆▄▄▅▅▅▅▅▅▅▅▅▅▄
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▆▁▁▁▁▁▁▁▅▁▄▆▇▇█▇▇█▇▇▇▆▇▇▆▁██▇▇▇▆▆
wandb:            test_recall0.25 ████▄▄▄▂▆▇▄▂▃▁▅▂▄▆█▆▇▇▅▂▂▅▆▆▄▅▆▅▅▄▅▅▆▅▆▇
wandb:             test_recall0.5 ▅▃▅▇█▂▂▂▁▂▂▂▁▁▁▃▃▁▁▃▂▂▂▃▄▃▁▆▃▇▆▆▆▇▇▅▆▆▆▆
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▃▁▂▅▃▄▃▆▇▆█▆▇▇▅▇▇▇▇▆▇▇▇▅▇
wandb:                train_auroc ▁▁▁▂▄▅▅▅▆▅▆▇▇▇▇████████▅████████████████
wandb:                 train_loss ▇▆▆▄▄▄▄▃▂▂▂▁█▄▄▂▂▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▅▁▁▁▁▁█▃▂▄▇▇▇█▆█▄▅▅▇▆▇▃▁▂▂▄▅▇▇▄▅▇▅▅▆▆▅
wandb:            val_accuracy0.5 ▇▃▇▇▅▆▇▇▇██▇▇▄██▅▄▇▅▃▁▂▄▆▆▅▃▃▄▂▃▃▃▄▂▅▅▅▅
wandb:           val_accuracy0.75 ▇▇▇▇▇▇█▇▇▇▇█▇▇██▅▇▇▄▄▇▇▄▂▂▆▅▂▃▄▃▂▄▁▄▃▅▅▅
wandb:                  val_auroc ▆▆▆▆▆▇▆▆▂█▆▄▄▄▃▅▅▅▄▄▃▅▅▅▆▅▁▃▄▆▆▅▆▇▆▆▆▆▆▆
wandb:  val_balanced_accuracy0.25 ▄▄▄▄▄▄▄▇▁▂▄▅▅▆▅▅▅▆▅▆▆▇▆▅▆▄▆▆▆▆▅▇▆██▇█▇▇█
wandb:   val_balanced_accuracy0.5 ▅▂▁▄▅▆▇▃▅▄▄▃▄▄▄█▅▆▄▅▇▅▃▅▆▄▄▃▅▅▃▂▇▄▄▃▂▅█▅
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▂▁▃▂▂▂▂▃▃▇▃▃▆▄▅▅▂▅▆▇▆▆▃█▇▆▄▄█▅▅▅▅▆▄▅
wandb:          val_precision0.25 ▂▂▂▁▂▂▂▁▂▆▇▃▂█▅▅▃█▂▂▃▄▄▃▃▃▄▂▃▂▃▃▃▄█▆▅▅▃▅
wandb:           val_precision0.5 ▁▅▄▃▄▄▃▄▆▄▅▇▅▇▅▅▅▅▇█▅▅▆▅▄▅▄▄▄▅▄▄▄▄▄▅▅▅▄▄
wandb:          val_precision0.75 ▁▁▁▁▁█▄█▅▅▆▆▄▅▅▅▆▆▆▆▃▄█▃▃▃▄▄▄▃▃▃▃▃▃▃▄▃▃▃
wandb:             val_recall0.25 ███████▇▆▇▁▂▄▂▃▃▁▃▃█▄▅▅▄▄▅▆▃▆▄▅▂▄▄▃▂▄▅▅▆
wandb:              val_recall0.5 ▁▃▁▄▃▆▄▂▃▃▂▃▄▃▄▃▆▃▄▇▅▇▆▆▇▆█▄▇▆▇▇▅▅▆▄▅▇▇▇
wandb:             val_recall0.75 ▁▁▁▁▁▂▂▂▂▄▂▃▃▄▂▃▂▂▅█▃▇▆▆▆▂▄▄█▆▆▆▆▇▅▅▇▇▇█
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.48101
wandb:           test_accuracy0.5 0.49367
wandb:          test_accuracy0.75 0.50633
wandb:                 test_auroc 0.61314
wandb: test_balanced_accuracy0.25 0.60297
wandb:  test_balanced_accuracy0.5 0.56186
wandb: test_balanced_accuracy0.75 0.55381
wandb:         test_precision0.25 0.30909
wandb:          test_precision0.5 0.29167
wandb:         test_precision0.75 0.28889
wandb:            test_recall0.25 0.85
wandb:             test_recall0.5 0.7
wandb:            test_recall0.75 0.65
wandb:                train_auroc 0.9997
wandb:                 train_loss 0.0594
wandb:           val_accuracy0.25 0.58095
wandb:            val_accuracy0.5 0.59048
wandb:           val_accuracy0.75 0.59048
wandb:                  val_auroc 0.62585
wandb:  val_balanced_accuracy0.25 0.65701
wandb:   val_balanced_accuracy0.5 0.62463
wandb:  val_balanced_accuracy0.75 0.62463
wandb:          val_precision0.25 0.35
wandb:           val_precision0.5 0.33962
wandb:          val_precision0.75 0.33962
wandb:             val_recall0.25 0.80769
wandb:              val_recall0.5 0.69231
wandb:             val_recall0.75 0.69231
wandb: 
wandb: 🚀 View run resnet50_2d_78_16_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/avjdsvwx
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_16/wandb/run-20250702_065523-avjdsvwx/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_16/wandb/run-20250702_081024-f72s4qor
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_16_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/f72s4qor
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁█▄█▇▅▅█▅▇██▆▆█▆▆▆▇▇▇▇▆▆▇▇▇▁▁▁▁▁
wandb:           test_accuracy0.5 █▇▄▇▇███▅█▇▇▇▇▄▅▇▇█▆▆▇▆▆▆██▅▆▆▆█▇▁▇▃██▄█
wandb:          test_accuracy0.75 ████████████▆███▇▇██▆▇▇▇▆▇█▆▇▇▇▇▇▆▁█████
wandb:                 test_auroc ▄▅▅▇█▇▇▇▆▇▆▅▆▅▅▄▃▅▅▁▃▃▃▄▄▃▃▁▅▄▄▅▄▄▄▅▅▆▆▆
wandb: test_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▄▄▃▇▄▆▇▄▃▂▂▄▃▄▃▂▃▅▅▃▄▄▃▆▄▄▄▄▄▄▁█
wandb:  test_balanced_accuracy0.5 ▂▄▇▇▆▄▄▃▄█▆▇▄▆▃▄▇▃▄▆▃▄▄▂▃▄▄▃▂▃▃▃▁▅▂▆▄▄█▄
wandb: test_balanced_accuracy0.75 ▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▆▅▅▅█▅▇█▅▆▄▄▄▄▃▃▁▃▃▆▄▆▅▅▅
wandb:         test_precision0.25 ▅▅▅▅▅▅▆▆▅▄▄▅▄▅▅▄▅▅▄▅▅▅▅▃▅▄▅▄▅▄▅▅▆▄▁▅▅▅▅█
wandb:          test_precision0.5 ▃▅█▃▃▁▅▃▁▁▄▃▃▃▅▃▅▂▃▃▃▂▁▃▃▃▂▁▃▃▂▃▃▃▃▂▃▄▁▂
wandb:         test_precision0.75 ▁▁▁▁▁▁▁█▁▁▁▁▁▃▅█▁▃▂▂▅▃▂▂▂▂▂▂▁▁▃▃▃▂▂▃▁▁▁▁
wandb:            test_recall0.25 ███▇▇█▇███▄▄███▇▇▄▇▁▁▁▄▄▁▂▃▅▂▃▁█▃▄▃▂▂██▆
wandb:             test_recall0.5 ▄▄▂▅▄▁▅▃▁▁▃▁▄▅▁▁▂▁▂▁▁▂▂▂▂▁▁▂▂▁▂▂▂▂▂█▃▁▄▃
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▁▄▅▂▁▂▂▁▄█▃▁▁▃▃▂▃▂▄▅▁▁▁▁▂
wandb:                train_auroc ▃▃▃▃▄▅▅▅▆▅▅▆▆▆▇▇▇▇▇███████▇▇██▁▂▃▂▃▃▃▄▄▄
wandb:                 train_loss ▅▅▅▅▅▄▄▄▄▄▄▄▄▄▄▃▃▃▃▃▃▂▁▅▃▁▁▁▁█▂▁▁▁▁▅▅▅▅▄
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▇▁▁▃█▅▇█▁▂█▅██▅▅▇▆▇▇▆▄█▇▇█▇█▅▁▁▁▁
wandb:            val_accuracy0.5 ▂▆▄▆█▆▅▇▇▇██▇▇██▇▇▅██▄▇▆█▆▇▇▇▇▇▇▇▇▆▆▅▆▆▁
wandb:           val_accuracy0.75 ▆▆▆▆▆▅▆▆▆▆▆▆▅▇▇▆█▆▁▇▅▆▆▅▆▆▆▃▅▅▅▅▅▃▆▆▆▆▆▆
wandb:                  val_auroc ▆▆▅▆▆▇▇█▇▆▇▆▆▆▆▆▆▅▅▆▄▇▇▆▇▆▁▅▇▇█▁▆▆▆▆▆▆▆▇
wandb:  val_balanced_accuracy0.25 ▁▂▁▁▁▁▁▂▇▅▂▆▇▄▃▁▃▆▄▄▆▄▅▄▆▇▄▄▄▆█▆▇▇▆▁▁▁▂▇
wandb:   val_balanced_accuracy0.5 ▁▁▁▃▆▅▆▆▄▆▆▅▅▇▇▅▅▅███▆▇▆▅▇▂▅▃▇▆▇▆▆▂█▅▆▁▇
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▂▄▅▆▂▄▃▃▃██▄▅▇▆▇▃▄▂▃▇▇▆▆▆▇▇▆▁▁▁▁▂
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▆▂▁▁▂▂▃▃█▁▇▃▂▃▂▂▁▂▃▂▂▃▃▃▄▁▁▁▁▁
wandb:           val_precision0.5 ▃▂▃▄▄▄▅▅▆▅▁▇▄▄▆▆▆▅█▅▄▆▆▄▄▄▆▄▄▅▅▅▅▅▃▃▁▄▄▄
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▇▅▁▇▇▇█▇▇▄▁██▅▅▆▅▅▅▅▅▅▅▅▅▄▁▁▁▁▁
wandb:             val_recall0.25 ███▇██████▇▅▇▆▄▆▅▃▃█▃▅▃▄▅▄▃▁▁▂▄▅▄▄▄████▇
wandb:              val_recall0.5 ▂▁▁█▇▃▃▆▄▃▃▄▂▆▄▄█▄▄▄▄▃▄▂▄▆▅▄▄▅▆▅▅▅▆▁▁▆▂█
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▂▁▆▂▆▄▂▃▃▅▅▆█▁▃▂▃▃▆▆▇▆█▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.4557
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.54068
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.47034
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.23256
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.5
wandb:            test_recall0.75 0
wandb:                train_auroc 0.7343
wandb:                 train_loss 1.77192
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.6
wandb:           val_accuracy0.75 0.73333
wandb:                  val_auroc 0.62244
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.60516
wandb:  val_balanced_accuracy0.75 0.48734
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.33333
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.61538
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet50_2d_78_16_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/f72s4qor
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_16/wandb/run-20250702_081024-f72s4qor/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_16/execution_datetimes.json

**************************************************  Experiment 78 | Version 17 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 5}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 6}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 7}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_17/wandb/run-20250702_085904-ia9o0qnx
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_17_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/ia9o0qnx
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▂▁▁▂▂▅▁▇▆▇▆▆▅▅▅▇▆▇▇▇█▇▆▇█▆▆▇▇▇▅▇▆▇▄▄▆
wandb:           test_accuracy0.5 ▁▁▅▇▅█▅▅▇▇▆▆▆▇▅▇▇▆▆▆▅▇▅▇▆▅▄▄▅▂▇▆▆▅▅▄▇▇▆▆
wandb:          test_accuracy0.75 ▇▇▇█▇▇▇▇▆▇▅▅▇▆▆▆▆▆▆▅▄▆▆▇▃▆▃▅▄▂▃▇▃▁▆▃▆▃▅▅
wandb:                 test_auroc ▂▂▄▃▅▄▅▃▄▄▅▇▃▄█▅▅▇▁▆▅▅▅▃█▃▆▅▆▃▂▇▄▃▇▇▆▄▄▂
wandb: test_balanced_accuracy0.25 ▄▄▁▂▃▂▆▇▄▃▇▄▄▇▆▇█▇▅▆▇▅▇▆▆▅▇▆▅▆██▆▇▇▆▆▅▆▄
wandb:  test_balanced_accuracy0.5 ▃▃▃▁▅▂█▆▁▁▄▆▆▅▅▆▂▄▄▄▅▅▂▆▅▅▇▅▃▅▅▄▄▅▆▃▃▆▅▆
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▁▂▂▃▂▃▅▃▃▂▃▃▆▆▅▃▆▅▃▇▇▄▆▅█▇▆▅▄▇
wandb:         test_precision0.25 ▂▂▂▂▁▂▁▂▇▆▂█▆▆▅▅▄▅▆▆▄█▅▅▄▇▅▇▆▅▇▆▆▆▂▅▆▆▄▅
wandb:          test_precision0.5 ▁▅▇▅▇▆▅▁▇▁▇▇▆█▇▄▁▇▁▇▆▆▅█▆▇▇▇▇▆▆▆▇▇▇▇▆▆▆▇
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅█▄▅▆█▅▆▆▁▆▆▆▇█▆▆▄▆▄▆▇
wandb:            test_recall0.25 █▇█▆▆▆▇█▅▅▅▄▄▃▆▂▅▂▂▄▄▁▄▂▅▅▄▅▄▃▄▃▆▅▃▁▃▄▂▄
wandb:             test_recall0.5 ▇▇▄▂▁▇▁▅▆▂▁▅▇▂▆▄▂▇▅▅▅▃▄▄▅▃▂▆▇▇▃▂▆▇▂▄▃▃▆█
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▂▅▃▃▇▃▃▄▄▆▆▅▆▄▂▂▃▆▃██▅▄
wandb:                train_auroc ▁▁▂▂▃▄▅▅▆▆▆▆▆▇▆▇▇▇▆█████████████████████
wandb:                 train_loss ███▆▆▅▅▅▅▅▄▄▄▄▄▃▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▂▂▂▂▄▂▇▅▅▄█▇█▇▆█▇█▅▅▆▅▃▇▆▆▅▄▆▆█▇▂▄▇▄▃▆
wandb:            val_accuracy0.5 █▂▁▅▃▆▆▄▇█▇██▇▇▇▆▅▇▇▆▆▇▇▇▆█▅▁▇█▇▇▃▆▆▄▇▄▆
wandb:           val_accuracy0.75 ████████▇███▇▇█▇▇█▇██▇▆██▇▇█▇█▇▆▇▇▇▁▄█▃▃
wandb:                  val_auroc ▁▁▁▁▂▂▄▄▄▄▅▅▆██████▆▇█▇▆▇▆▆▆▇▆▇▇▆▇█▆▆▇▇▆
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▃▃▃▃▃▃▃▁▄▄▄█▆▅▆▆▃▅▃▄▆▂▅▄▅▄▃▂▁▅▅▂▂▄▃▃
wandb:   val_balanced_accuracy0.5 ▁▂▃▁▂▃▃▆▆▄▅▅█▇▅▇▅▆▆▆▆▆▇▆▇▅▇▆▆▇▅▅▆▇▅▇▅▇▆▆
wandb:  val_balanced_accuracy0.75 ▃▃▃▂▃▂▃▁▃▂▂▂▅▃▃▅█▄▅▆▅▆▆▆▅█▆▆▅▆▆▆▆▂▇▇▇▇▆█
wandb:          val_precision0.25 ▂▂▂▂▂▂▁▂▂▂▃▂▃▇▆▂▇▃▂▆▄▄▁▄▂▄▂▇▂▃▃▄▂▃▂▂▂█▃▃
wandb:           val_precision0.5 ▁▁▄▄▄▃▄▄▄▁▁▅▅▅▄▅█▆▆▇▆▇▆▆▆▆▆▆▆▇▆▆▅▇▆▅█▆▅▅
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▄▁▆▁▅▅▇▆▆▆▆▆▅▆▇█▆▆▆▅▅▅▇█▇▆▇▇
wandb:             val_recall0.25 ████▇▇▇▅▇▄▅▆▆▃▄▄▆▅▅▄▇▅▄▅▂▂▁▂▄▂▂▂▂▄▂▁▃▇▁▄
wandb:              val_recall0.5 ▅▅▅▄▂▁█▃▅▁▅▃▄▆▄▃▄▂▆▄▃▂▄▄▃▂▂▃▂▃▅▃▅▄▂▆▃▄▄▄
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▂▃▃▂▃▂▂▃▂▄▂▃▃▄▃▂▆▃▇▃▃▂▅█
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.65823
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.6962
wandb:                 test_auroc 0.56695
wandb: test_balanced_accuracy0.25 0.58941
wandb:  test_balanced_accuracy0.5 0.57331
wandb: test_balanced_accuracy0.75 0.5322
wandb:         test_precision0.25 0.36
wandb:          test_precision0.5 0.36842
wandb:         test_precision0.75 0.33333
wandb:            test_recall0.25 0.45
wandb:             test_recall0.5 0.35
wandb:            test_recall0.75 0.2
wandb:                train_auroc 0.9996
wandb:                 train_loss 0.06098
wandb:           val_accuracy0.25 0.65714
wandb:            val_accuracy0.5 0.71429
wandb:           val_accuracy0.75 0.73333
wandb:                  val_auroc 0.56475
wandb:  val_balanced_accuracy0.25 0.53992
wandb:   val_balanced_accuracy0.5 0.565
wandb:  val_balanced_accuracy0.75 0.56475
wandb:          val_precision0.25 0.30769
wandb:           val_precision0.5 0.38889
wandb:          val_precision0.75 0.42857
wandb:             val_recall0.25 0.30769
wandb:              val_recall0.5 0.26923
wandb:             val_recall0.75 0.23077
wandb: 
wandb: 🚀 View run resnet50_2d_78_17_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/ia9o0qnx
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_17/wandb/run-20250702_085904-ia9o0qnx/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_17/wandb/run-20250702_095043-dcijz0g0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_17_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/dcijz0g0
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 580-582, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▃▂▆▂▄▇▂▃▄▂▅▅▅▄▂▆▂▆▅▆▆▅▇▆▄▆▅▇▇▂▇█▅▅▅
wandb:           test_accuracy0.5 █▂▅▁▄▆▂██▆▇▇▅▇▆▆▇█▇▅▅▇█▃▆▃▅▃▄▆▇▄▇▆▆▇▇▅▅▅
wandb:          test_accuracy0.75 █████▇██▇▇▇▇█▇▇██▆█▄▅▆▄█▇▅██▆▁▆█▇▆▆▂▄▅▅▃
wandb:                 test_auroc ▁▂▂▂▂▃▃▄▆▇▆█▆▆▆▆▆▅▅▆▆▆▄▇▆▆▆▆▇▆▆▆▆▆▇▇▆▅▇▇
wandb: test_balanced_accuracy0.25 ▃▁▁▁▃▃▆▅▇▇▅▇▇▆█▄▄▆▇▇▇█▆▆█▃▆▃▅▇▅▇▆▃▃▆▄▇▆▇
wandb:  test_balanced_accuracy0.5 ▃▃▇▁▃▃▇▅█▂▆▂▅▅▅▅▄▅▇▆▆▇▆▅▇▄▆▄▄▄▄▅▄▄▂▅▄▅▃▄
wandb: test_balanced_accuracy0.75 ▃▃▃▃▄▂▁▁▂▄▂▂▂▄▆▃▇▆▂▅█▆▅█▅▆▆▅▅▇▄▅▆▁▆▃▃▄▅▅
wandb:         test_precision0.25 ▂▂▂▂▂▂▂▄▂▃▂▃▂▂▃▂▄▁▃▂▃▄▃▂▃▄▃▃▂▂▄▂▂█▃▂▂▃▂▃
wandb:          test_precision0.5 ▇█▇▄▆▅▃▅▁▅▅▅▄▄▅▆▆▄▅▄▄▆▄▅▆▆▆▆▅▄▅▅▆▆▅▄▄▅▄▄
wandb:         test_precision0.75 ▁▁▁▁█▁█▁▁▁▁▁▃▃▄▄▃▄▂▃▄▅▅▄▃▃▃▄▃▃▄▃▃▃▃▃▃▄▃▃
wandb:            test_recall0.25 ███▇█▇▇██▇▇▄▆▇▅▅▃▇▅▁▃▄▆▄▁▆▁▅▃▄▂▇▅▃▃▁▅▄▅▅
wandb:             test_recall0.5 ▅▅█▄▄▅▁▁▃▃▁▁▂▄▅▆▃▃▅▃▃▆▅▃█▆▅▄▄▃▇▄▄▅▅▄▃▆▄▃
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▂▃▂▂▄▅▅▄█▄▅▄▄▇▅▂▅▅▅█▅▄▅▄▇▅▄▄
wandb:                train_auroc ▁▂▂▄▃▆▇▇▇▇██████████████████████████████
wandb:                 train_loss ██▇▆▆▅▄▅▄▄▃▃▂▂▂▂▁▂▁▁▁▁▁▁▁▁▁▂▁▁▁▁▂▁▁▂▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▂▂▆▂▁▄▃▃█▄▄▆▅▄▄▇▇▇▆▇▇▄▆▇▇▆▅██▃▄▇▇▇▇
wandb:            val_accuracy0.5 ▃▅▃▁▇▆▇▆▇█▅▃▇▇▅▇▄▄▅▇▅▆▄▄▅▄▅▅█▄▅▄▅▅▅▄▂▄▄▂
wandb:           val_accuracy0.75 ███▇▇█▇█▇█▇▇▇▇▇▇▇▆▅▇▇▇▄▄▅▅█▆▄▆▄▄▄▅█▄▄▅▁▄
wandb:                  val_auroc ▁▇▇▇▇███▇▆▇▆▅▄▄▆▅▄▅▄▅▄▆▃▅▆▃▅▃▇▃▃▇▄▃▆▄▄▆▅
wandb:  val_balanced_accuracy0.25 ▃▃▃▆▄▃▅▅█▇▂▇▄▅▃▄▂▅▅▁▄▅▄▆▅▄▅▇▆▆▂▅▅▆▄▄▃▆▅▄
wandb:   val_balanced_accuracy0.5 ▇▄▄▄▅▁█▂▁▂▄▄▃▃▃▃▃▄▃▄▄▅▆▃▃▆█▄▄▅▆▄▆▃▄▅▇▅▃▄
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▂▂▃▂▂▂▂▃▂▅▃▂▅▄▃▄▆▆▄▇▄▄▅▆▄▅▆▅▄█▅▅▆▇
wandb:          val_precision0.25 ▁▁▁▄█▅▃▁▄▄▃▃▄▄▄▃▃▁▁▅▅▃▃▁▃▄▃▃▂▄▃▃▅▄█▄▄▄▃▃
wandb:           val_precision0.5 ▅▃▅▄▅▁▂▄▂▅▃▄▄▄▅▃▅▅▃▄█▄▄▃▅▅▆▅▄▃▄▅▄▅▄▄▄▂▂▇
wandb:          val_precision0.75 ▁▁▁▁▁█▄▅█▅▅▆▅▅▆▅▅▆▅▅▆▅▅█▅▆▅▅▅▆▅▅▅▅▅▅▅▅▅▆
wandb:             val_recall0.25 ███████▃▆▇▂▅▇▅▃▅▃▃▃▃▃▃▁▆▂▅▃▃▄▃▃▃▃▃▄▃▁▃▄▅
wandb:              val_recall0.5 ▁▂▄▁▁▁▄▂▇▃▄▂▂▅▄▂▄▄▃▅▄▄▄▄▄▃▇▅▄▄▄█▄▆▄▄▄▅▅▆
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▃▁▃▂▂▃▃▄▃▃▃▃▄▄█▃▄▃▃▃▂▄▃▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.41772
wandb:           test_accuracy0.5 0.46835
wandb:          test_accuracy0.75 0.5443
wandb:                 test_auroc 0.55169
wandb: test_balanced_accuracy0.25 0.49449
wandb:  test_balanced_accuracy0.5 0.49534
wandb: test_balanced_accuracy0.75 0.52966
wandb:         test_precision0.25 0.25
wandb:          test_precision0.5 0.25
wandb:         test_precision0.75 0.27778
wandb:            test_recall0.25 0.65
wandb:             test_recall0.5 0.55
wandb:            test_recall0.75 0.5
wandb:                train_auroc 0.99928
wandb:                 train_loss 0.09523
wandb:           val_accuracy0.25 0.50476
wandb:            val_accuracy0.5 0.52381
wandb:           val_accuracy0.75 0.6
wandb:                  val_auroc 0.58228
wandb:  val_balanced_accuracy0.25 0.59348
wandb:   val_balanced_accuracy0.5 0.55453
wandb:  val_balanced_accuracy0.75 0.59226
wandb:          val_precision0.25 0.30303
wandb:           val_precision0.5 0.28571
wandb:          val_precision0.75 0.32609
wandb:             val_recall0.25 0.76923
wandb:              val_recall0.5 0.61538
wandb:             val_recall0.75 0.57692
wandb: 
wandb: 🚀 View run resnet50_2d_78_17_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/dcijz0g0
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_17/wandb/run-20250702_095043-dcijz0g0/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_17/wandb/run-20250702_103840-gd4jzf83
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_17_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/gd4jzf83
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: uploading history steps 519-520, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▂▁▂▆▃▅▅▅▅▆▄▃▃▃▇▄▆▅▅▆▄▆▅▅▅█▇█▆▆▆█▅▄▇▇
wandb:           test_accuracy0.5 ▂▇▇▂▇▅▂▇██▃▇▂▇▆▄█▂▄▆▇▃▆▆▆▄▆▄▄▆▆▅▄▅▄▄▃▄▆▁
wandb:          test_accuracy0.75 ██████████████████▆▄█▅▆▆▄▇▇▆▅▇▂▅▇▆▁▄▆▆▅▄
wandb:                 test_auroc ▄▆▅▆▆█▇▆▇▅▅▆▃▂▃▂▃▂▁▁▁▂▂▂▁▂▂▄▃▃▄▂▂▃▃▄▃▂▅▃
wandb: test_balanced_accuracy0.25 ▅▅▅▄▁▄▆▆▇▅▄▇▇▃▄▂▂▄▄▂▄▄▁▃▃▂▄▂▄█▅█▃▆▃▆▄▃▅▃
wandb:  test_balanced_accuracy0.5 █▅█▆▆▆█▇▇▇▅▅▅▅▅▄▅▄▅▄▅▅▁▃▃▆▄▃▅▄▄▁▅▄▆▅▅▆▅▅
wandb: test_balanced_accuracy0.75 ▄▄▄▄▄▇▄▄▄▄▄▄▄▄▄▄▅▆▅▄▄▃▂▁▂▄▃▄▄▁▃▃▃▄▅▄▃▄▃█
wandb:         test_precision0.25 ▇▇▇▆▅▅▅▇███▂▄▄▂▅▂▃▂▃▄▃▁▃▅▃▄▃▃▂▆▃▇▄▅▄▅▆▆▆
wandb:          test_precision0.5 ▅▆▇▇▄▅▄▄█▆▆▄▁▄▄▃▃▃▃▃▄▃▃▃▃▃▃▃▄▃▄▄▃▄▃▃▃▃▃▃
wandb:         test_precision0.75 ▁▁▁█▁▁▁▁▁▁▁▁▁▁▁▃▃▂▂▂▂▂▅▂▃▃▂▂▃▃▂▂▂▃▃▂▃▃▃▃
wandb:            test_recall0.25 ███▆▆▆▆▄▅▆▇▆▅▄▆▄▂▅▃▃▅▅▃▃▅▄▂▃▂▂▃▂▃▂▃▃▃▁▃▃
wandb:             test_recall0.5 ▇▁▄▆█▅▄▅▄▆▂▁▆▂▅▂▁▆▃▁▆▃▃▃█▃▃▅▄▃▃▃▅▃▄▄▃▃▂▆
wandb:            test_recall0.75 ▁▁▁▁▁▂▁▁▁▁▂▂▃▁▃▂▂▂▂▂▂▄▂▃▃▅▃▃▄▄▄▃▄▄█▃▅▃▇▄
wandb:                train_auroc ▁▂▃▃▄▄▅▄▄▅▆▇▇███████████████████████████
wandb:                 train_loss █▇▇▇▇▇▇▇▇▆▆▆▆▅▅▅▅▅▅▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▂▃▄▂▅▄▅▅▄▅▅▄▃▅▇▃▇▄▅▆▆▆▅▇██▆▅▅█▆▅▅▆▆█▄
wandb:            val_accuracy0.5 ▆▅▇▄▇▇█▇▇▇▆█▆▆▇█▇█▄▇▇▅▇▄▇▇▇▇▃▅█▇▇▂▇▇██▅▁
wandb:           val_accuracy0.75 █████▇▇█▇▇▇▇████▆█▇█▇▇▆▆▇▇▆▇█▇█▁█▇▇▅▇▇█▇
wandb:                  val_auroc ▂▁▂▁▁▂▁▂▃▄▆▆▆▇▆▇▆▇▇▇▆▅▇▆▆▆▆▇▆▅▇█▇▇▆▆██▆█
wandb:  val_balanced_accuracy0.25 ▁▁▁▅▅▃▄▅▅▆▆▆█▂▆▆██▆▇▆▇▆▇▅▇▇▅▇▇█▅▇██▅▅▇▇▇
wandb:   val_balanced_accuracy0.5 ▄▄▃▂▂▂▂▄▃▂▁▆▃▁▄▅▃▁▃▁▆▄▅▇▆▆▆▅▆▂▇▃▆▆▄▆█▄▃▇
wandb:  val_balanced_accuracy0.75 ▁▂▁▁▁▂▂▂▂▂▂▂▂▂▁▁▂▁▂▁▂▂▅▁▁▁▂▃▄▆▆▄▆▆▁█▄▄▆▅
wandb:          val_precision0.25 ▁▁▂▂▃▁▂▁▁▂▂▃▃▃▃▃▅▃▃▄▃▃▅▃▄▃▃▆▃▃▅▃▆▂▃▄█▄▃▇
wandb:           val_precision0.5 ▅▅▄▄▅▅▅▅▅▅▁▅▆▆▁▁▅▆▅▁▆▇▇▆▆▅▆▆▇▆▆▇▇▇█▇▇█▇█
wandb:          val_precision0.75 ▁▁▁▆▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▇▆▇▇▅█▇▆██▇▆█▇█▇▇█▇
wandb:             val_recall0.25 ███▇▇▇▅▇▄▆▇█▃▄▇▅▁▇█▅▆▅▄▆▆▆▅▃▄▃▄▃▄▅▃▂▃▃▅▃
wandb:              val_recall0.5 ▄▂▄▁▂▄▂▁▃▃▁▃▁▁▄▃▁▅▆▄▆▆▂▂▄█▄▄▆█▃▇▃▆▆▂▄▇▇▇
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▂▅▃▂▂▂▂▄▅▅█▅▃▂▄▅▅▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.37975
wandb:           test_accuracy0.5 0.39241
wandb:          test_accuracy0.75 0.41772
wandb:                 test_auroc 0.46017
wandb: test_balanced_accuracy0.25 0.50212
wandb:  test_balanced_accuracy0.5 0.44449
wandb: test_balanced_accuracy0.75 0.41186
wandb:         test_precision0.25 0.25424
wandb:          test_precision0.5 0.22
wandb:         test_precision0.75 0.19048
wandb:            test_recall0.25 0.75
wandb:             test_recall0.5 0.55
wandb:            test_recall0.75 0.4
wandb:                train_auroc 0.99996
wandb:                 train_loss 0.03887
wandb:           val_accuracy0.25 0.47619
wandb:            val_accuracy0.5 0.55238
wandb:           val_accuracy0.75 0.57143
wandb:                  val_auroc 0.67308
wandb:  val_balanced_accuracy0.25 0.56159
wandb:   val_balanced_accuracy0.5 0.59932
wandb:  val_balanced_accuracy0.75 0.59907
wandb:          val_precision0.25 0.28358
wandb:           val_precision0.5 0.31579
wandb:          val_precision0.75 0.32075
wandb:             val_recall0.25 0.73077
wandb:              val_recall0.5 0.69231
wandb:             val_recall0.75 0.65385
wandb: 
wandb: 🚀 View run resnet50_2d_78_17_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/gd4jzf83
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_17/wandb/run-20250702_103840-gd4jzf83/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_17/execution_datetimes.json

**************************************************  Experiment 78 | Version 18 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 19, 1.0: 9}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 16, 1.0: 12}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 13, 1.0: 19}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 11, 1.0: 17}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_18/wandb/run-20250702_112800-7ooe1duz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_18_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/7ooe1duz
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▂▂▁▂▂▂▂▂▄▂▃▇▄▃█▃▁██▄▆█▃▆▇█▄▇▅▆█▇▅▆▇▆
wandb:           test_accuracy0.5 █▄▃▆▅▄▅▆▅█▄▇▄▆▆▅▆▅▁▆▅▄▄▅▇▄▅▆█▅▅▂▄▆▅▇▆▇▆▇
wandb:          test_accuracy0.75 ▇▇▇▇▇▇▆▇█▇▇▇▇▇▇▇▆▇▇▇▅▇▇▇▇█▅▇▃▁▆▆▆▆▅▆▅▁▄▆
wandb:                 test_auroc ▁▃▃▃▃▄▅▅▅▅▆▅▇▆█▆▆▅▆▅▄▄▃▃▃▂▂▂▂▁▂▁▂▃▁▂▂▃▃▂
wandb: test_balanced_accuracy0.25 ▄▄▄▄▃▂▄▄▆▆▇▄▅▇▅▆▄▅▇█▃▅▄▄▃▄▁▄▃▅▃▁▁▅▆▄▆▃▆▃
wandb:  test_balanced_accuracy0.5 ▄▅▁▇█▅▅▄▆▇▆▅▆▃▅▄▄▅▂▄▅▅▃▄▃▄▅▄▃▄▄▅▄▄▁▅▅▆▅▆
wandb: test_balanced_accuracy0.75 ▄▄▄▄▄▄▆▆▄▇▄▅▅▄▃▅▃▃▄▅▇▅▆▆▆▅▃▄▃▆▄▇▅▃█▇▄▃▁▅
wandb:         test_precision0.25 ▆▆▆▆▆▆▆▆▆▆▇▆▆▇▇▇▆▆▆▇▆▆▆▆▇▅▆▆▆▆▅▅▅▅▅▇▅█▆▁
wandb:          test_precision0.5 ▃▄▄▆▄▅▄▂▃▂▁▃█▁▃▁▂▂▄▃▂▂▆▁▃▂▃▄▃▂▁▂▄▂▄▃▂▂▂▂
wandb:         test_precision0.75 ▁▁▁█▁█▁▁▁▂▃▃▃▁▅▅▃▄▁▂▅▃▃▁▁▁▃▃▂▃▃▁▄▃▅▃▂▄▃▁
wandb:            test_recall0.25 ██▇▅▆▆▆▁▆▆▅▁▆▁▁▁▄▅▁▁▁▃▂▁▁▄▂▁▄▁▃▃▃▁▃▁▄▁▆▃
wandb:             test_recall0.5 ▇▇▇▅▄▅▄▅▆▃▄▂▃▂▁█▂▅▂█▂▁▅▅▂▂▂▂▅▃▆▂▃▅▃▃▃▃▆▃
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▅▃▃▃▁▁▁▁▁▃▃▅▁▁▅▅▅▃▅▅▃█▃▃▁▆██
wandb:                train_auroc ▁▁▂▃▄▄▄▄▄▄▅▅▅▅▆▆▆▆▆▆▆▆▆▆▇▇▇▇▇███████████
wandb:                 train_loss █████▆▆▆▆▆▆▆▆▆▆▆▅▅▄▅▄▄▄▄▄▃▃▃▂▂▂▂▁▁▁▁▁▂▁▁
wandb:           val_accuracy0.25 ▁▂▃▂▃▅▅▃▅▆▆▂▆▇▆▆▆▇▃█▄▆▇█▃▇█▇▆█▇▇▇▂▆▇▇█▃▆
wandb:            val_accuracy0.5 ▁▁▂▃▃▁▅▄▅▂▄█▄▇▂▇▆▆██▇▇▆▇▆▇▄▇▇▆▆▇▆▅▆▆▇▅▇▇
wandb:           val_accuracy0.75 █▇▇▇▇▆█▇▆▆▆▁▆▇▆▇▇▃█▅█▃▇▆▆▃▆▄▆▄▄▃▄▄▆▃▄▃▃▅
wandb:                  val_auroc ▁▁▁▂▂▃▄▄▅▅▅▇▆▆▆▇█▇▇▇█▇████▇█▇▇▇▇▇▇▇▇▆▆▆▆
wandb:  val_balanced_accuracy0.25 ▃▃▄▄▄▄▄▄▅▃▅▅▄▄▄▃▅▄▄▅▃▆▃▆█▇▇▅▁▅██▆▆▇▆▅▆▆▃
wandb:   val_balanced_accuracy0.5 ▂▁▃▂▁▂▄▃▂▃▃▃▄▃▄▄▄▄▆▅▆▅▅█▇▅▄▅▇▇▆▆▃▆▅▅▄▅▆▅
wandb:  val_balanced_accuracy0.75 ▃▃▃▂▂▂▂▂▂▂▂▂▁▃▃▂▂▃▃▃▃▅▃▃▄▃▃▃█▇▂▂▄▆▁▅▄▄▄█
wandb:          val_precision0.25 ▁▂▂▂▂▃▂▂▂▂▂▃▂▃▄▅▃▂▂▄▅▆▂█▇▁▅▁▅▆▆█▄█▇▅▃▄▆▅
wandb:           val_precision0.5 ▄▄▁▂▂▇▅▆▆▇▆▆▆▅▇▅▇▇▅█▇▆▇█▆█▇███▇▇▇▆▇▇▆▆▇▆
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▅▁▅▁▅█▆▇▆▆▇▇▅▆▃▆▆▅▅▅▆▅▅▅▆▅▅▆
wandb:             val_recall0.25 ███▇██▇▇▇▄▄▂▄▃▆▃▇▇▂▂▅▅▅▂▂▅▂▂▂▂▅▁▃▄▃▂▁▃▁▅
wandb:              val_recall0.5 ▇▅▅▄▁▂▂▁▄▂▃▃▇▅▄▄▂▂▃▂▄▃▃▃▆▄█▆▅▃▇▃▄▄▃▅▂▅▃▆
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▃▃▂▆▁▂▃▂█▃▃▄▁▃▅▃▃▃▆▃▃▄▃▆
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.62025
wandb:           test_accuracy0.5 0.62025
wandb:          test_accuracy0.75 0.72152
wandb:                 test_auroc 0.49831
wandb: test_balanced_accuracy0.25 0.56398
wandb:  test_balanced_accuracy0.5 0.48136
wandb: test_balanced_accuracy0.75 0.54915
wandb:         test_precision0.25 0.32143
wandb:          test_precision0.5 0.22222
wandb:         test_precision0.75 0.4
wandb:            test_recall0.25 0.45
wandb:             test_recall0.5 0.2
wandb:            test_recall0.75 0.2
wandb:                train_auroc 0.99928
wandb:                 train_loss 0.13714
wandb:           val_accuracy0.25 0.62857
wandb:            val_accuracy0.5 0.68571
wandb:           val_accuracy0.75 0.71429
wandb:                  val_auroc 0.56621
wandb:  val_balanced_accuracy0.25 0.55964
wandb:   val_balanced_accuracy0.5 0.54601
wandb:  val_balanced_accuracy0.75 0.53919
wandb:          val_precision0.25 0.31429
wandb:           val_precision0.5 0.33333
wandb:          val_precision0.75 0.35714
wandb:             val_recall0.25 0.42308
wandb:              val_recall0.5 0.26923
wandb:             val_recall0.75 0.19231
wandb: 
wandb: 🚀 View run resnet50_2d_78_18_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/7ooe1duz
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_18/wandb/run-20250702_112800-7ooe1duz/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_18/wandb/run-20250702_130637-pttsphra
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_18_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/pttsphra
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading wandb-summary.json; uploading config.yaml
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▅▁▇▅▃▇▅█▇▆▅▇▅▇▇▇▆▅▆██▇▇▆▇▆▇▇▇▆
wandb:           test_accuracy0.5 ▇▄▅▆▁█▅▆▆▇▇▇▇██▇▆█▆▇██▇▅▇█▅▇▇▆▆█▆▆▇▇▇█▆▅
wandb:          test_accuracy0.75 ▇▇▇▇▇▅▂▆▇▇▆▆▆▅▆▅▆▆▆▆▆▅▅▅█▆▇▆█▃▃▆▂▅▂█▆▆▇▁
wandb:                 test_auroc ▂▂▁▁▁▂▂▃▅▆▅▆▆▆▅▅▅▆▅▆▆▆▆▆▇▆▇▆▇▇█████▆▆▇█▇
wandb: test_balanced_accuracy0.25 ▂▂▂▂▂▂▂▁▁▂▂▆█▄▇▆▃▃▃▄▅▄▂▃▆▅▆▆▄▄▅▇▅▄▅▃▅▅▅▇
wandb:  test_balanced_accuracy0.5 █▃▄▆▆▆▃▂▁▃▄▇▅▄▅▄▅▅▅▅▅▃▆▅▆▆▆▇▆█▅▆▆▅▇██▆▇▆
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃▁▃▃▃▃▆▅▃▃▅▅▃▃▅▅▆▅▄▅▆▇▅▆██▅▄▄▇▅▇▄▄▆
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▂▂▁▃▂▂▃▄▃▂▆▃▃▂▃▅▃▃▃▄▃▃▅▅▄█▅▆▃▇▃▄▃
wandb:          test_precision0.5 ▄▄▇▅▇▁▅▅▆▄▄█▇▅▅▇██▇▇█▇█▆█▅▅▆▆▇▇▆▆▇▇█▇▅▆▇
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▆▅▅▅▆▆█▅▅▆▆▅█▅▄▆▅▅▄█▅▆▄
wandb:            test_recall0.25 ███████████▂▅▅▆▄▁▂▃▃▃▃▅▃▃▆▂▃▃▆▅▆▃▁▂▃▃▄▃▆
wandb:             test_recall0.5 █▅▅▅▅▅▂▂▁▁▃▁▁▂▁▁▃▃▄▄▂▂▂▂▃▃▄▂▅▃▅▅▅▃▃▂▅▅▂▅
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▂▃▁▁▂▃▂▄▃▃▅▆▆▆▄▄▃▅▃▄▄▇██
wandb:                train_auroc ▁▂▂▃▄▄▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇██████████████▇
wandb:                 train_loss ██████▇▇▇▇▆▆▆▅▆▅▅▅▅▄▄▄▄▄▄▃▃▃▃▂▂▂▂▂▁▁▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▆▂▁▂▂▇▇▇▇█▇▇▄▆▇█▄▇▄▆▇▇▃▄▆▆▄█▇▆
wandb:            val_accuracy0.5 ▅▇▅▆▆▇▅▇▇▆▅▇█▅▅▇▆▆▅▅▅▁▅▆▅▇▅▆▅▆▅▄▆▆▅▆▂▆▆▃
wandb:           val_accuracy0.75 ▇▇▇▇▇▆██▅▆█▆▆█▅▇▄▅▆▆▅▇▇▂▆▇▅▃▅▆▆▄▅▄▃▄▃▃▄▁
wandb:                  val_auroc █▇█▇█▃▁▂▃▅▆▃▆▆▆▄▅▇▅▄▃▃▃▃▅▄▄▂▃▃▃▄▂▃▂▂▂▁▃▄
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▆▂▇▃▂▁▅▅▇▄▄▂█▃▂▁▂▄▅█▃▇▂▄▄▁▃▄▂▅▅▅▃▃
wandb:   val_balanced_accuracy0.5 ▅▅▅▁▃▃▂▂▁▂▂▄▂▃▄▃▂▃█▃▄▂▄▃▂▁▂▂▃▂▃▃▂▃▃▄▂▄▃▃
wandb:  val_balanced_accuracy0.75 ▁▁▁▂▁▂▃▃▃▃▂▆▄▄▅▅▆▆▃▆▃▆▅▃▄▂▃▄▅▄█▄▄▃▄▄▃▄▆▆
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▆▅▅▄▅▆█▆▅▆▄▄▇▃▄▃█▃▅▃▇▄▄▂▄▄▇▆▅▆▇
wandb:           val_precision0.5 ▃▃▂▂▂▁▃▂▂▆▁▃▃▃▁▁▃█▁▂▁▃▂▂▂▂▂▁▃▃▂▂▃▃▃▃▃▃▃▄
wandb:          val_precision0.75 ▁▁▁▁▁▁▁███▃▅▃▄▃▄▃▄▅▄▅▄▄▃▄▃▃▃▃▃▃▃▃▄▃▃▃▄▄▄
wandb:             val_recall0.25 █████▅█▅▃▆▆▆▇▅▂▁▅▅▅▆▆▃▃▅▂▂▁▅▅▂▄▃▄▄▄▂▆▄▃▃
wandb:              val_recall0.5 █▆▆▃▁▂▂▂▂▂▃▂▂▂▂▂▃▃▂▂▄▂▂▂▃▂▂▂▃▂▃▂▄▂▂▃▃▃▄▄
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▂▂▃▃▂▄▂▂▃▄▂▄▂▄▄▂▄▄▄▄▄▇▄▄▄█▄▅▂▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.50633
wandb:           test_accuracy0.5 0.56962
wandb:          test_accuracy0.75 0.62025
wandb:                 test_auroc 0.63051
wandb: test_balanced_accuracy0.25 0.60339
wandb:  test_balanced_accuracy0.5 0.59619
wandb: test_balanced_accuracy0.75 0.59703
wandb:         test_precision0.25 0.31373
wandb:          test_precision0.5 0.325
wandb:         test_precision0.75 0.34375
wandb:            test_recall0.25 0.8
wandb:             test_recall0.5 0.65
wandb:            test_recall0.75 0.55
wandb:                train_auroc 0.99916
wandb:                 train_loss 0.14251
wandb:           val_accuracy0.25 0.4
wandb:            val_accuracy0.5 0.6
wandb:           val_accuracy0.75 0.61905
wandb:                  val_auroc 0.56426
wandb:  val_balanced_accuracy0.25 0.49805
wandb:   val_balanced_accuracy0.5 0.61806
wandb:  val_balanced_accuracy0.75 0.57911
wandb:          val_precision0.25 0.24658
wandb:           val_precision0.5 0.34
wandb:          val_precision0.75 0.325
wandb:             val_recall0.25 0.69231
wandb:              val_recall0.5 0.65385
wandb:             val_recall0.75 0.5
wandb: 
wandb: 🚀 View run resnet50_2d_78_18_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/pttsphra
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_18/wandb/run-20250702_130637-pttsphra/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_18/wandb/run-20250702_144633-mbwx39pc
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_18_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/mbwx39pc
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▂▂▂▁▆▁▅▅▅▅▅▄▆▃▄▅▃▅▆▆▆▃▆▆▆▆█▆▆▅▆▆▃▆
wandb:           test_accuracy0.5 ▁▂▄▅▆▆▆█▆▆▆▆▆▆▆▆▅▅▄▇▆▆▄▅▅▅▆▅▅▇▅▆▆▆▇▅▅▄▅▅
wandb:          test_accuracy0.75 ▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▅▅▇▇▆▆▇▃▅▇▇▆▃█▅▂▁▇▃▃▇▅▄▃
wandb:                 test_auroc ▁▁▂▂▂▄▅▆▅▆▄▄▄▃▅▃▃▃▄▃▅▃▄▄▄▄▅▄▄▄▄▅▅▆▆▆█▆▆▇
wandb: test_balanced_accuracy0.25 ▃▂▂▁▂▃▇▂▂▃▅▄▅▅▆▃▅▅▅▆▃▄▄▄▃▅▄▃▅▄▃▃▃▃▄▆▄█▆▆
wandb:  test_balanced_accuracy0.5 ▂█▄▇▇▅▄▄▅▂▃▃▇▂▂▆▂▄▁▅▁▁▃▃▅▃▁▄▁█▃▄▁▁▃▃▆▅▂▃
wandb: test_balanced_accuracy0.75 ▃▃▃▃▃▃▃▄▃▃▃▃▃▂▂▃▂▂▃▃▂▃▄▄▃▁▄▃▄▁▄▄▄▂▃▂▃▄▁█
wandb:         test_precision0.25 ▄▄▄▃▄▄▄▄█▅▄▅▅▄▆▆▅▆▃█▅▇▁▆▄▄▅▇▄▅▆█▇▅▆▇▆▇▅█
wandb:          test_precision0.5 ▃▂▄▄▅▄▃▄█▃▄▁▄▁▃▃▃▄▃▄█▄▂▃▂▂▂▃▃▂▄▃▃▃▃▃▄▃▃▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▅▃▅▃▁▅▄▅▅▃▃▅▅▅▅▆▄▃▅▃█
wandb:            test_recall0.25 ████▇▇▇▇▇█▆▆▇▇▃▆▆▄▆▅▆▂▆▅▅▃▂▃▁▄▁▅▅▃▃▅▆▄▃▃
wandb:             test_recall0.5 ▅▅▅▅▅▅▆▂▃▇▂▇▅▂▁█▃▃▂▅▂▂▅▃▂▂▁▄▂▂▂▂▅▅▅▁▇▃▅▄
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▄▁▂▁▁▁▁▁▂▁▂▁▁▂▂▃▂▂▂▂▂▂▄▂█▂▂▅▂▂
wandb:                train_auroc ▁▁▂▁▃▃▄▄▅▅▅▅▅▆▆▆▆▇▇▇▇█▇█████████████████
wandb:                 train_loss ███▇▇▆▆▆▆▆▆▆▅▅▅▅▄▄▄▃▃▃▃▃▂▃▂▂▂▁▂▁▁▁▁▁▇▂▁▁
wandb:           val_accuracy0.25 ▁▂▁▂▃▂▆▅▂▅▅▅▃▆▆▅▅▇▄▆▆▅▆▇▇▇▅▅▅▆▆▆▇▅▇▇▆█▅▆
wandb:            val_accuracy0.5 ▅▄▅▅▅▆▃▇▃▄▇▂▇▅▇▆▄▃▇▂▇▄▆▆▃▅▃▂█▆▄▆▁▆▃▅▃▃▄▆
wandb:           val_accuracy0.75 ▇▇▇▇▇▇▇▇▇▅█▇█▅▇▇▆▆▅▅▆▅▄▇▇▇▃▄▆▃▁▇▄▄▇▁▁█▄▂
wandb:                  val_auroc ▂▂▂▁▁▁▂▃▇▅▇▇▆▇▇▇██▇███▇▇▇▅▇▇▆▇▇▅▇▆▇▆▅▆▇▇
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▂▁▂▂▂▅▄█▇▄▁▇▆▆▇▅▇▅▇▆▅▄▅▄▅▄▆▇▄▅▄▄▃▃▅▇
wandb:   val_balanced_accuracy0.5 ▅▇▅▄▃▂▁▆▂▃▃▃▄█▄▇▄▄▅▇█▅▅▄▄▂▃▃▃▅▄▄▅▅▆▄▅▆▄▅
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▂▂▂▂▂▂▃▂▄▂▃▂▂▁▄▃▂▂▁▁▂▄▅▃▃▆▆▆▆▇▅▆█▆▅▆
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▄▃▂▂▆▅▆▄▄▃▄▅▃▄▅▆▃█▃▃▄▃▃▃▅▄▃▄▃▃
wandb:           val_precision0.5 ▂▂▃▂▂▃▁▂▃▂▃▅▂▄▂▄▅▂▂▃▃▂▁▃▂▃█▂▄▃▃▂▂▃▂▂▆▃▂▃
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▄▁▄▄▁▅▁▃▅▁▃▅▃▅▁▅▅▅▅▇▅▅▅▅██▅▅
wandb:             val_recall0.25 ████▇▇▇▇▅▅█▆▆▆▇▅▅▅▅▃▆▄▃▆▂▄▄▃▃▁▃▃▄▄▃▃▆▃▄▃
wandb:              val_recall0.5 ▁▇▁▆▆▆▄▁▃▁▂▁▁▇▁▇▃▁▂▅█▆▄▂▄▄▂▃▃▄▂▄▂▇▆▄▅▃▄▅
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▂▁▁▂▁▂▁▁▁▁▃▂▃▂▆▁▁▂▃▂▃▂▄▂▅▃▃▅▄█
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.60759
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.67089
wandb:                 test_auroc 0.58898
wandb: test_balanced_accuracy0.25 0.52246
wandb:  test_balanced_accuracy0.5 0.55678
wandb: test_balanced_accuracy0.75 0.4822
wandb:         test_precision0.25 0.28
wandb:          test_precision0.5 0.35294
wandb:         test_precision0.75 0.2
wandb:            test_recall0.25 0.35
wandb:             test_recall0.5 0.3
wandb:            test_recall0.75 0.1
wandb:                train_auroc 0.99968
wandb:                 train_loss 0.13374
wandb:           val_accuracy0.25 0.62857
wandb:            val_accuracy0.5 0.66667
wandb:           val_accuracy0.75 0.71429
wandb:                  val_auroc 0.62926
wandb:  val_balanced_accuracy0.25 0.54674
wandb:   val_balanced_accuracy0.5 0.55915
wandb:  val_balanced_accuracy0.75 0.55209
wandb:          val_precision0.25 0.30303
wandb:           val_precision0.5 0.33333
wandb:          val_precision0.75 0.375
wandb:             val_recall0.25 0.38462
wandb:              val_recall0.5 0.34615
wandb:             val_recall0.75 0.23077
wandb: 
wandb: 🚀 View run resnet50_2d_78_18_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/mbwx39pc
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_18/wandb/run-20250702_144633-mbwx39pc/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_18/execution_datetimes.json

**************************************************  Experiment 78 | Version 19 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 36, 1.0: 28}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 32, 1.0: 32}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 27, 1.0: 37}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 26, 1.0: 34}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_19/wandb/run-20250702_162553-gcrbqgd1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_19_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/gcrbqgd1
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 998-999, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▂▁▂▁▁▅▅▆▅▅▆▅▇█▄▅█▇▆▄▂▅▇▄▅▆▅█▅▅▅▅▅▆
wandb:           test_accuracy0.5 ▁▁▄▅▅▆▅▆▇▇▇▇▇▆▆▇▇▆▄▇▇▅▅▇▆▅▆█▄▇▆██▅█▆▆███
wandb:          test_accuracy0.75 ▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▁▅▁▅▁▅▅▁▁▁▅█▅▅█▅█▅█▅
wandb:                 test_auroc ▁▁▁▁▁▁▂▃▄▄▆▇█▆██▇█▅▇▆▆▆▆▆▆▇▇▅▅▆▆▆▆▅▆▆▆▆▆
wandb: test_balanced_accuracy0.25 ▃▃▃▃▃▂▂▃▃▂▂▁▁▂▂▅▆▇▆▇▇▆▄▆▄▃▇██▄▅▅▆▅▅▆▆▃▆▅
wandb:  test_balanced_accuracy0.5 ▃▁▄▅▅▄▅▃▄▂█▆▆▆▄▄▃▆▄▅▅▄▅▅▄▆▇▆▃▄▇▆▅▇▄▂▅▄█▆
wandb: test_balanced_accuracy0.75 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▂▂▂▂▃▃▂▂▂▃▇▃▃▃▆▃▇▅▃█▃▃▂▇
wandb:         test_precision0.25 ▂▂▂▂▂▂▂▂▁▂▂▃▃▃▅▄▄▃▄▇▄▇▂▄▂▆█▅▅▃█▄▄▅▄▆▃▄▄▆
wandb:          test_precision0.5 ▄▄▂▁▃▃▂▄▄▃▂▇▄▃▄▃▄▆▄▃▄▃▃▄▄▄▄▄▄▃▃▅█▄█▃█▄▄▆
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁▅▁▆▆▅▅▆▆▆▆▆▆▆▆▁▆█
wandb:            test_recall0.25 ██▇▇▇▇▇▆▇▇█▅▂▆▃▆▁▃▆▇▁▅▂▆▇▆▆▃▁▂▆▁▆▂▆▅▆▂▃▁
wandb:             test_recall0.5 ▇▇▇▇█▆▂▂▆▆▄▁▁▃▃▅▄▄▁▃▂▄▄▃▄▃▂▂▁▃▁▄▁▃▆▆▅▆▆▅
wandb:            test_recall0.75 ▁▁▁▁▁▃▁▁▁▁▁▁▁▁▁▃▃▃▁▃▃▁▁▃▃▁▃▃▅▃▃▃█▃▁█▁█▃▃
wandb:                train_auroc ▁▁▁▂▂▄▅▅▅▅▆▆▆▆▅▆▆▆▆▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇██████
wandb:                 train_loss ██▇▇▇▆▆▆▆▆▄▄▄▄▄▄▄▄▄▃▄▄▃▃▃▃▃▃▃▃▃▂▃▂▂▂▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▂▂▂▂▂▂▃▅▆▅▅▆▆▆▅▅▆▆▆▆▆▅▆▇▆▇▇▅▆▅▇█▅▆█
wandb:            val_accuracy0.5 ▁▂▂▃▃▄▅▆▆▆▆▅▆▆▆▆▅▅▂▆▇▅▄█▄▆▄▇▇█▇▇▅▇▄▇▆▆▆▇
wandb:           val_accuracy0.75 ████████▇▇▇█▇▆▇█▆█▆██▆▆▆▆▆▆▆▇▅▁▃▃▅▆▃▃▅▆▃
wandb:                  val_auroc ▁▂▁▁▂▅▅▅▅▄▅▅▆▅▅▅▆▆▆▆▇▇▇▇▆▇██▇███▇█▇██▇█▇
wandb:  val_balanced_accuracy0.25 ▃▃▃▄▄▅▅▆▁▂▃▆█▇▂▇▄▄▅▅▅▄▅▇▄▆▄▆▅▅▅▅▆▅▆▇▄▆▅▅
wandb:   val_balanced_accuracy0.5 ▃▃▁▁▂▂▄▄▃▅▃▄▄▄▆▆▆▆▅▅▅▅▅▅▆▆█▅▇█▇▆▅█▇▇█▇█▇
wandb:  val_balanced_accuracy0.75 ▄▄▄▄▄▄▂▃▃▁▄▃▂▂▃▂▂▂▃▂▂▄▄▂▄▃▄▄▄▄▄▄▅▃█▃▅▆█▇
wandb:          val_precision0.25 ▂▂▂▂▃▄▄▆▅▄▂▄▃▁▂▁▃▂▅▃▄▅▅▃▄▆▃▄▅▄▆▄▇▄█▄▄▅█▅
wandb:           val_precision0.5 ▅▅▃▄▁▅▆▅▆▇▅▇▃▅▇▇▄▆▇▅▆▅▇▇▇▇▇▇▇▇▇▇▇█▇█▇▇▇▇
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▆▁▅▆▆▆▁▆▇▆▆▅▇▄█▆▆
wandb:             val_recall0.25 ██████▇▇▇▅▇█▄▃█▄▄▂▄█▄▃▂▃▂█▂▃▂▄▄▄▄▄▅▄▅▅▁▅
wandb:              val_recall0.5 ▇▇█▅▇▅▅▅▄▂▁▁▁▁▁▄▁▄▁▁▄▄▁▅▄▄▄▂▆▅▆▄▆▄▄▅▄▅▅▅
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▂▂▂▂▂▂▁▅▁▅▂▅▂▅▄▄▂▂█▅▂▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.5443
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.77215
wandb:                 test_auroc 0.6
wandb: test_balanced_accuracy0.25 0.57924
wandb:  test_balanced_accuracy0.5 0.57331
wandb: test_balanced_accuracy0.75 0.58305
wandb:         test_precision0.25 0.30952
wandb:          test_precision0.5 0.36842
wandb:         test_precision0.75 0.66667
wandb:            test_recall0.25 0.65
wandb:             test_recall0.5 0.35
wandb:            test_recall0.75 0.2
wandb:                train_auroc 0.98356
wandb:                 train_loss 0.58416
wandb:           val_accuracy0.25 0.48571
wandb:            val_accuracy0.5 0.67619
wandb:           val_accuracy0.75 0.70476
wandb:                  val_auroc 0.58666
wandb:  val_balanced_accuracy0.25 0.51631
wandb:   val_balanced_accuracy0.5 0.55258
wandb:  val_balanced_accuracy0.75 0.53286
wandb:          val_precision0.25 0.25862
wandb:           val_precision0.5 0.33333
wandb:          val_precision0.75 0.33333
wandb:             val_recall0.25 0.57692
wandb:              val_recall0.5 0.30769
wandb:             val_recall0.75 0.19231
wandb: 
wandb: 🚀 View run resnet50_2d_78_19_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/gcrbqgd1
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_19/wandb/run-20250702_162553-gcrbqgd1/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_19/wandb/run-20250702_183246-zwqbwnm9
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_19_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/zwqbwnm9
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 997-999, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▃▄▇▇▂▄▇▆▄▆▅▃▇▇▆▄▆▆█▇▄▄▄▅▅▇▄▅█
wandb:           test_accuracy0.5 ▁▃▂▅▆▆▅██▅▆▇▃▇▇▆▅▇▆▇█▄▆▆▇▆████▆▇▇▆▇▇█▃▁▇
wandb:          test_accuracy0.75 ███████████████▆█▆▆▃▆▆▆▆▆▆▆▆▁▆▆▆▆█▆▆▁███
wandb:                 test_auroc ▁▁▂▂▃▄▅█▇▇█▇▇▇▇▇▆▇▆▅▅▅▃▄▄▃▃▃▄▃▄▃▃▄▃▅▃▄▄▄
wandb: test_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▂▂▄▅▅▆▄▄▆█▅▄▂▃▃▃▁▁▃▂▅▄▂▃▂▃▂▂▂▄▂
wandb:  test_balanced_accuracy0.5 ▆▆▅▆█▆▄▄▆▅▄▂▂▃▂▃▃▄▄▄▅▄▄▄▃▅▅▂▄▁▅▄▃▃▄▄▅▅▄▅
wandb: test_balanced_accuracy0.75 ▅▅▅▅▅▅▃▁▃▃▃▃▁▁▃█▃▃▃▃▃▃█▆█▆█▆▃▄▄▃███▄█▆▆█
wandb:         test_precision0.25 ▃▃▃▃▄▃█▃▃▅▄▄▄▄▅▄▅▆▃▅▂▆▁▄▅▅▅▇▄▆▃▃▄▆▅▄▃▁▃▃
wandb:          test_precision0.5 ▆▅▅▆▅▅▆▆▆▅▅▅▅▃▁▄▄▅▄▄▅▄▅▅▅▄▅█▄▅▃▅▅▅▃▅▃▅█▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁▁▁▆▆██▁█▁▄████████▄
wandb:            test_recall0.25 ██████▇▂▆█▅▇██▇▁▆▄▃▇▆▃▅█▄▂▂▂▂▄▅▃▅▆▆▁▆▄▅▃
wandb:             test_recall0.5 █████▆█▄▃▅▆▁▅▄▃▁▅▁▂▆▂▅▃▂▅▃▂▃▂▂▃▃▂▃▃▂▂▂▆▅
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅▅▅▅▁▅▅▁▅▅▅▅█▅▅
wandb:                train_auroc ▁▁▂▂▂▃▄▅▅▆▆▆▆▆▆▇▆▇▆▆▇▇▇▇▇▇▇█▇█▇▇████████
wandb:                 train_loss ███▇▇▅▆▅▅▅▅▅▅▄▄▄▄▄▄▄▃▄▃▃▃▃▃▃▃▃▂▂▂▂▂▂▂▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▂▅▄▅▃▇▃▄▂▇▃▆▂█▆▃▅▄█▆▆▇▇▄▅▄▂▆█▇
wandb:            val_accuracy0.5 █▇▄▅▅▆▅▄▆▇▇▇▇▆▇▅▃▆▆▆▆▆▆▇▆▆▆▄▆▆█▃▇▁▇▇▅▇▇▇
wandb:           val_accuracy0.75 █████████▇▄▅██▅▅██▅▅█▅▅▇▇▇▇▇▂▇▇▂▇▇▁▂▇▁▁▇
wandb:                  val_auroc ▇█████▇██▇▆▇▄▂▄▁▃▅▄▄▇▅▃▅▅▄▆▅▄▅▄▄▃▄▄▄▄▄▅▄
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁█▇▃▅▄▅▂▂▅▁▄▅▁▄▅▂▁▂▃▂▆▅▅▄▃▄▅▅▅▄
wandb:   val_balanced_accuracy0.5 ▁█▇▇█▁▅▂▁▅▃▂▄▃▃▁▁▂▂▂▂▃▁▁▂▃▄▄▄▄▃▂▃▃▆▄▄▃▅▅
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▂▂▂▂▁▂▄▄▄▃▄▂▁█▁▃▂▂▃█▅▂▃▂▅▄▅▅▅▅▇▅▄▄▅▅
wandb:          val_precision0.25 ▁▁▁▁▁▁▄▁▃▂▄▃▄▂▁▂▁▂▃▅▃▅▅▂▅▆▄▆█▁▄▃▄▂▁▄▄▅█▂
wandb:           val_precision0.5 ▅▄▄▅▅▅▅▅▁▄▂▄▃▃▅▅▂▃▂▃▃▆█▁▂▂▂▁▃▂▆▂▄▃▃▄▆▅▃▅
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁████▅▅▅▆▅▆▅▅▆▇▇▇▆▆▇▅▇▇▆▅▅▇▆▅▇█▆▅
wandb:             val_recall0.25 ███████████▅▆█▆▇▆▂▆▇▅▅▄▃▅▇▁▃▄▁▅▅▁▆▃▄▄▇▂▆
wandb:              val_recall0.5 ▁██▇█▃▃▂▂▃▃▂▃▃▃▃▃▅▃▃▃▅▃▃▄▃▄▆▃▃▃▅▄▇▃▄▂▄▄▄
wandb:             val_recall0.75 ▁▁▁▁▁▁▂▁▂▂▂▂▂▂▂▂▂▂▃▂▄▂▅▃▅▅▃▃▃▂▆▄▃▄█▃▄▃▅▇
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.56962
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.53136
wandb: test_balanced_accuracy0.25 0.49703
wandb:  test_balanced_accuracy0.5 0.47415
wandb: test_balanced_accuracy0.75 0.51653
wandb:         test_precision0.25 0.25
wandb:          test_precision0.5 0.14286
wandb:         test_precision0.75 0.5
wandb:            test_recall0.25 0.35
wandb:             test_recall0.5 0.05
wandb:            test_recall0.75 0.05
wandb:                train_auroc 0.97354
wandb:                 train_loss 0.67029
wandb:           val_accuracy0.25 0.64762
wandb:            val_accuracy0.5 0.70476
wandb:           val_accuracy0.75 0.71429
wandb:                  val_auroc 0.57644
wandb:  val_balanced_accuracy0.25 0.611
wandb:   val_balanced_accuracy0.5 0.57157
wandb:  val_balanced_accuracy0.75 0.51339
wandb:          val_precision0.25 0.35897
wandb:           val_precision0.5 0.38095
wandb:          val_precision0.75 0.3
wandb:             val_recall0.25 0.53846
wandb:              val_recall0.5 0.30769
wandb:             val_recall0.75 0.11538
wandb: 
wandb: 🚀 View run resnet50_2d_78_19_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/zwqbwnm9
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_19/wandb/run-20250702_183246-zwqbwnm9/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_19/wandb/run-20250702_203958-mf475q3h
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_19_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/mf475q3h
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: uploading history steps 999-999, summary
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▂▁▁▅▃▃▂▁▁█▃▇▃▅▃▇█▄▁▆▆▂▄▇█▆▄▄▆▇▇▇▆
wandb:           test_accuracy0.5 ▃▅▄▃▅▆▆█▇▁▆▆▆▆▆▆▄▄▂▆▅▆▃▆▆▅▅▆▄▂▃▁▅▂▂▃▃▁▄▆
wandb:          test_accuracy0.75 ████████████████████▃██▆█▅▆▅▆▆▆▆█▆▅▆▃▃█▁
wandb:                 test_auroc ▁▁▁▂▂▂▃▃▃▃▆▄▇▆█▆▆▆▆▅▅▅▄▅▄▅▄▄▅▅▄▄▄▄▄▄▃▃▄▃
wandb: test_balanced_accuracy0.25 ▄▄▄▄▄▃▃▃▂▁▄▄▂▃▃▄▅▅▅█▇▄▂▆▅▂▄▆▅▃▄▃▃▇▆▆▆▄▅▄
wandb:  test_balanced_accuracy0.5 ▃▄▇▇▆▅▃▆▃▃▃▃▃▃▃▃▃▃▄▄▂▃▇█▂▃▄▂▁▄▂▃▄▁▁▁▃▂▃▁
wandb: test_balanced_accuracy0.75 ▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▁▂▄▄▂█▅▂▄▄▄▂▄▇▄▄█▄█▇▇
wandb:         test_precision0.25 ▅▅▅▅▅▅▅▅▅▄▆▆▅▅▅█▆▅▇▁▆▆▆▇▂▅▇▆▇▆▂▆▃▇▄▆▆▅▅▄
wandb:          test_precision0.5 ▁▅▄▄▄▄▄▅▃▄▄▄▅▄▅█▃▄▃▃▄▄▄▃▃▃▃▄▃▃▄▃▃▄▅▄▄▄▃▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▁▁▁▁█▁▁▁▇▁█▄█
wandb:            test_recall0.25 ███▇▇▆█▆▆▆██▅██▄█▆▅▅▁▆▃▁▂▄▂▁▂▅▅▆▁▅▂▂▅▆▃▂
wandb:             test_recall0.5 ▁▅▅▆▆▆▆▄▄▅▁▄▅▃▂▅▂▇█▅▃▃▃▃▃▃▃▃▃▂▂▅▂▃▃▂▃▃▄▂
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▁▁▁▁▁▁▁▃▁▁▁▁▁▃▆▃▁█▃▁▆█
wandb:                train_auroc ▁▁▁▂▁▃▄▅▅▅▆▆▆▆▇▆▇▇▇▇▇▇▇███████▇█████████
wandb:                 train_loss ██████▇▇▇▇▆▆▅▅▅▅▅▅▅▅▅▅▄▄▄▄▄▄▃▃▃▃▃▃▃▂▂▂▁▁
wandb:           val_accuracy0.25 ▁▂▂▂▂▂▁▁▇▆▃▅▆▄▅▆▇▅█▆▄▆▅▇▆▇▆▇▆▇▆▆▇▆█▅▇▇█▆
wandb:            val_accuracy0.5 ██▄▅▃▅▄▄▃▃▁█▆▄▅▃▇▆█▅▆▆▆▆▇▄▅▅▇▆▆█▄▆█▇▆▃▅▂
wandb:           val_accuracy0.75 ██████████████████▃▅▅█▁▃▅▅▁▅▅▅█▅▆▅▁▆▃▅▆▁
wandb:                  val_auroc ▁▁▂▃▃▅▅█▇▅▇▇▆▇▇▅▅▅▄▇█▅▅▇▇▃▄▅▆▆▇▇▃▅▅▄▂▃▃▆
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▂▂▁▂▁▂▁▅▁▁▁▇▇▄▇▂▃▆▂▂▅█▅▂▃▆▅▄▆▅▄▃▆▅▅
wandb:   val_balanced_accuracy0.5 ▂▇▄▄▄▁▂▁▃▂▃▅▂▁█▂▄▃▂▃▃▃▁▁▃▄▃▅▄▃▆▄▅▁▂▂▄▄▆▄
wandb:  val_balanced_accuracy0.75 ▄▄▄▄▄▄▄▄▄▄▃▄▃▄▄▃▄▃▄▄▄▅▅▄▄▅▄▂▃▂▁▃▄▄▄▄█▄▇▇
wandb:          val_precision0.25 ▁▁▁▁▄▆▂▂▃▄█▂▅▅▂█▅▂▇▄▆▂▅▆▇▇▆▆▃█▄▄▇▄▂▃▄▄▆▄
wandb:           val_precision0.5 ▅▅▅▂▄▄▂▁▄▃▄▃▃▃▄▃▄▅█▆▅▄▅▄▆▄▄▅▄▅▆▅▄▆▆▅▅▄▆▅
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▆▁▁█▁▁▁▄▁▆▆▁▁▁▅▁▆▆▃▁▆▆
wandb:             val_recall0.25 ███▇▇▇▇▇██▆▆▅▆▅▇▃▆▆▆▁▆▁▆▅▆▅▃▅▅▃▅▅▇▃▃▂▅▃▂
wandb:              val_recall0.5 ▁▅▄▄▆▂▂▄▂▁▂▂▄▂▂▂▄▁▄▅▅▅▃▃█▃▄▃▃▄▁▃▄▁▇▂▆▃▅▄
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃█▃▃▃▃▃▅▅
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.62025
wandb:           test_accuracy0.5 0.6962
wandb:          test_accuracy0.75 0.73418
wandb:                 test_auroc 0.53136
wandb: test_balanced_accuracy0.25 0.48136
wandb:  test_balanced_accuracy0.5 0.49915
wandb: test_balanced_accuracy0.75 0.49153
wandb:         test_precision0.25 0.22222
wandb:          test_precision0.5 0.25
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.2
wandb:             test_recall0.5 0.1
wandb:            test_recall0.75 0
wandb:                train_auroc 0.98926
wandb:                 train_loss 0.46425
wandb:           val_accuracy0.25 0.67619
wandb:            val_accuracy0.5 0.72381
wandb:           val_accuracy0.75 0.74286
wandb:                  val_auroc 0.60297
wandb:  val_balanced_accuracy0.25 0.55258
wandb:   val_balanced_accuracy0.5 0.50682
wandb:  val_balanced_accuracy0.75 0.50657
wandb:          val_precision0.25 0.33333
wandb:           val_precision0.5 0.28571
wandb:          val_precision0.75 0.33333
wandb:             val_recall0.25 0.30769
wandb:              val_recall0.5 0.07692
wandb:             val_recall0.75 0.03846
wandb: 
wandb: 🚀 View run resnet50_2d_78_19_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/mf475q3h
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_19/wandb/run-20250702_203958-mf475q3h/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_19/execution_datetimes.json

**************************************************  Experiment 78 | Version 20 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 5}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 6, 1.0: 6}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 5, 1.0: 11}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 8, 1.0: 8}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 7, 1.0: 9}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 9, 1.0: 7}
    Batch label distribution: {0.0: 6, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 7}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 14, 1.0: 2}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 6}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_20/wandb/run-20250702_224616-36719zc6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_20_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/36719zc6
    Batch label distribution: {0.0: 12, 1.0: 4}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 11, 1.0: 5}
    Batch label distribution: {0.0: 13, 1.0: 3}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading history steps 998-999, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▃▂▁▃▃▃▃▃▃▃▃▅▄▇▄▇█▅▅▄
wandb:           test_accuracy0.5 ▄▁▁▁▂▂▂▃▂▂▃▃▄▇▇▇▇▇█▆▅▄▅▆▅▆▅▆▆▆▇▆▆█▇██▆▇█
wandb:          test_accuracy0.75 ███████████████████████████████▅███▅▅▅▁▅
wandb:                 test_auroc ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▂▃▃▃▄▄▅▆▆▆▇▆▇▇▆▇▆▇▆██▇█
wandb: test_balanced_accuracy0.25 ▃▃▁▁▁▂▂▂▂▁▁▂▁▁▂▁▁▁▃▃▂▃▁▄▁▄▃▃▃▅▃▆▆██▆▇███
wandb:  test_balanced_accuracy0.5 ▃▂▆▆▇▂▂▂▂▃▅▄▅▅▆▇▇█▇▅▁▄▄▁▁▄▄▃▄▄▄▅▄▅▅▅▂▅▄▄
wandb: test_balanced_accuracy0.75 ██████████████████████████████▄█▄▄█▁▄█▄▄
wandb:         test_precision0.25 ▂▂▂▂▂▂▂▂▂▂▁▁▁▁▂▂▁▂▂▂▃▁▁▂▂▃▂▆▇▂▃▅▅▆▃▃▆▃▆█
wandb:          test_precision0.5 ▁█▄▄▄▅▄▄▅▅▅▄▅▅▅▅▅▆▆▆▄▄▄▄▄▅▅▅▄▅▄▄▅▆▅▅▃▆▄▆
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ██████▆▆▆▆▆▆▆▅▆▆▅▅▆▅▅▆▅▅▆▆▆▆▅▆▅▅▅▅▅▅▅▁▄▄
wandb:             test_recall0.5 ▁▇███████████████▇▆█▃▃▃▄▄▃▃▃▃▄▅▅▅▃▄▅▂▂▃▃
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▅▄▄▄▅▄▅▅▅▅▅▅▅▆▆▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇███████
wandb:                 train_loss ████▇▇▇▇▇▇▇▇▆▆▆▄▄▄▄▄▄▄▃▃▃▃▃▃▃▃▂▃▂▂▂▂▂▂▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▂▂▂▂▃▃▂▂▂▂▂▃▃▄▃▃▅▄▅▅▆▆▇▆▇▇▆▆▇█▇█▇██
wandb:            val_accuracy0.5 ██▁▂▂▂▂▂▂▂▃▂▃▃▃▄▄▅▅▅▅▅▅▆▆▆▆▅▅▆▆▆▆▆▆▆▆▆▆▆
wandb:           val_accuracy0.75 ███████████████████████████████████▁▁▁▁▁
wandb:                  val_auroc ▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▃▃▄▄▄▅▅▆▆▆▆▆▆▆▇▇▇▇▇███
wandb:  val_balanced_accuracy0.25 ▁▁▃▁▁▁▁▁▂▂▁▂▁▂▂▃▁▁▂▃▂▂▄▄▂▄▆▅▄▆█▇█▅▆▆▆█▅▆
wandb:   val_balanced_accuracy0.5 ▄▄▄▅▄▆▄▄▅▄▅▄▄▄▃▃▄▄▄▃▁▃▃▄▃▃▄▄▆▄▇▅▅▇█▆▇▇▇▆
wandb:  val_balanced_accuracy0.75 ████████████████████████████▅█▁▅▅▅▅▅▅▅▅▅
wandb:          val_precision0.25 ▂▂▂▂▂▂▃▂▂▂▂▂▃▂▃▂▂▂▂▂▃▁▂▃▃▄▄▃▅▆▄▄▆▆▇██▄▆▆
wandb:           val_precision0.5 ▁▁▁▅▅▆▆▆▆▆▆▆▆▆▅▄▅▅▂▄▃▄▃▃▃▃▇▇▅▇▆▅▇▃▇▇▇█▇▇
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 █████▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆▆▇▇▆▅▅▅▅▅▆▄▇▅▅▅▅▂▇▁▅
wandb:              val_recall0.5 ▂▆▆█▇▇▇▅▇▅▅▅▅▅▆▄▄▄▂▂▄▄▂▁▂▂▃▃▃▄▄▄▂▃▃▃▄▄▄▄
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.48101
wandb:           test_accuracy0.5 0.68354
wandb:          test_accuracy0.75 0.73418
wandb:                 test_auroc 0.60593
wandb: test_balanced_accuracy0.25 0.56992
wandb:  test_balanced_accuracy0.5 0.54025
wandb: test_balanced_accuracy0.75 0.49153
wandb:         test_precision0.25 0.29412
wandb:          test_precision0.5 0.33333
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.75
wandb:             test_recall0.5 0.25
wandb:            test_recall0.75 0
wandb:                train_auroc 0.92093
wandb:                 train_loss 1.11589
wandb:           val_accuracy0.25 0.48571
wandb:            val_accuracy0.5 0.67619
wandb:           val_accuracy0.75 0.74286
wandb:                  val_auroc 0.55307
wandb:  val_balanced_accuracy0.25 0.59372
wandb:   val_balanced_accuracy0.5 0.51388
wandb:  val_balanced_accuracy0.75 0.49367
wandb:          val_precision0.25 0.3
wandb:           val_precision0.5 0.27778
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.80769
wandb:              val_recall0.5 0.19231
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet50_2d_78_20_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/36719zc6
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_20/wandb/run-20250702_224616-36719zc6/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_20/wandb/run-20250703_003022-abe0aks2
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_20_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/abe0aks2
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▁▃▃▃▅▃▅▆▅▅█
wandb:           test_accuracy0.5 ▃▂▃▂▂▃▂▁▄▄▄▄▄▆▆▆▆▆▇▇▇▆███▇▇▇▇▇▇▇▇▆▇▆▇▆▆▇
wandb:          test_accuracy0.75 ████████████████████████████▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▂▂▂▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▅▅▇▇▇▇█▇▆▇█▇███
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▂▁▃█▆▆▆
wandb:  test_balanced_accuracy0.5 ▅▇▄▃▁▃▃▂▄▃▅▄▆▅▆▆▅▇▆▄██▅█▇▅▅▄▄▄▄▄▄▄▁▄▇▇▇▁
wandb: test_balanced_accuracy0.75 ████████████████████████████▁█▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▃▂▂▅▅▅▅█
wandb:          test_precision0.5 ▄▃▃▂▂▄▅▅▄▅▅▆█▇▅▆▇▅▇█▅▅▅▅▅▅▄▅▅▄▄▅▄▂▁▄▅▅▆▅
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ██████████████████████▇▇▇▇▅▅▅▅▅▅▅▅▃▅▅▅▁▅
wandb:             test_recall0.5 █████████▇▅▅▅▅▅▅▅▅▅▅▃▃▃▃▃▃▃▄▇▁▁▃▅▂▅▅▁▄▁▅
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▁▁▁▂▂▂▃▄▄▄▄▅▅▄▆▆▇▇▇▇▇▇▇▇▇▇▇██▇██▇██████
wandb:                 train_loss █████▇█▇▇▇▇▇▇▇▆▆▇▆▆▆▆▅▅▅▅▄▄▃▃▃▃▃▃▃▃▂▂▂▂▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▄▇▂█▅▆
wandb:            val_accuracy0.5 ▆▆▁▁▂▂▁▁▂▂▃▃▃▆▆▄▇▆▆▆▆▆▇▆▆▇▆▆▆▇▇▆▆▇█▇▇▇▇█
wandb:           val_accuracy0.75 ▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆▆██▆▃▃▃▃▃▃▁▃▁▃▃▃
wandb:                  val_auroc ▇██▇▇▇▇▇▇▇▇▇▇▇▇▇██▇█▇▇▇▇▇▅▄▅▅▅▄▅▄▅▃▂▃▃▂▁
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▄▃▁▄▅▅▇▇█▇▆▇▄▇▃
wandb:   val_balanced_accuracy0.5 ▂▁▃▇▇▇▇▇██▇▅▇▆▇█▃▁▁▁▁▁▁▂▂▂▂▃▃▃▃▂▃▃▃▃▃▃▃▃
wandb:  val_balanced_accuracy0.75 ▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃▃███▆▆▅▅▅▅▃▅▃▅▁▃
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▁▄▃▇▃██▆▂▄▂
wandb:           val_precision0.5 █▇▆▆▅▆▆▆▇▆▇▇▇▄▂▃▃▁▁▂▃▃▂▃▃▃▅▅▃▅▄▅▅▄▅▅▅▅▃▅
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█████▃▃▃▃▃▃▃▃▃▂
wandb:             val_recall0.25 ███████████████████████████▇█▇▇▇▇▇▇▄▃▃▁▆
wandb:              val_recall0.5 ▁▄▇▇████████▇▇▇▆▆▆▆▆▆▃▃▃▂▂▂▂▂▃▃▃▃▃▃▃▃▅▃▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁████████████████
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.4557
wandb:           test_accuracy0.5 0.6962
wandb:          test_accuracy0.75 0.73418
wandb:                 test_auroc 0.62542
wandb: test_balanced_accuracy0.25 0.58602
wandb:  test_balanced_accuracy0.5 0.54873
wandb: test_balanced_accuracy0.75 0.49153
wandb:         test_precision0.25 0.29825
wandb:          test_precision0.5 0.35714
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.85
wandb:             test_recall0.5 0.25
wandb:            test_recall0.75 0
wandb:                train_auroc 0.91654
wandb:                 train_loss 1.17383
wandb:           val_accuracy0.25 0.40952
wandb:            val_accuracy0.5 0.67619
wandb:           val_accuracy0.75 0.72381
wandb:                  val_auroc 0.53797
wandb:  val_balanced_accuracy0.25 0.49148
wandb:   val_balanced_accuracy0.5 0.51388
wandb:  val_balanced_accuracy0.75 0.49391
wandb:          val_precision0.25 0.24286
wandb:           val_precision0.5 0.27778
wandb:          val_precision0.75 0.2
wandb:             val_recall0.25 0.65385
wandb:              val_recall0.5 0.19231
wandb:             val_recall0.75 0.03846
wandb: 
wandb: 🚀 View run resnet50_2d_78_20_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/abe0aks2
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_20/wandb/run-20250703_003022-abe0aks2/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_20/wandb/run-20250703_021529-ws7tad7e
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_20_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/ws7tad7e
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▂▂▁▂▁▁▁▁▁▂▁▁▁▁▁▃▂▄▄▂▄▄▆▇▆▆▇▆▇█▇█
wandb:           test_accuracy0.5 ████▄▁▃▃▁▄▂▂▇▅▆▆▅▅▅▆█▅▅▇██▇█▇▇▇▇▇▇▇▇▇▆▆▆
wandb:          test_accuracy0.75 ███████████████████████████████████████▁
wandb:                 test_auroc ▁▁▁▁▂▃▃▃▃▃▄▄▄▄▄▅▅▅▅▄▆▆▆▆▆▆▇▆▇▆██▇▇▇███▇█
wandb: test_balanced_accuracy0.25 ▄▄▄▄▄▄▄▄▄▄▃▃▄▄▄▄▄▄▄▂▁▁▁▄▂▃▄▄▄▅▄▇▄▆▇█▇▆▆█
wandb:  test_balanced_accuracy0.5 ▃▇▅▃▃▆▄▆██▆▆▄▆▆▇▆▆▇▆▇▆▆▆▆▆▆▆▆▆▆▅▆▆▅▄▁▄▂▆
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▄▄▄▄▄▂▃▃▃▃▃▃▃▃▁▁▃▁▁▁▂▁▂▂▂▂▁▂▃▃▄▅▅▆▅▅▅█▇▇
wandb:          test_precision0.5 ██▂▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▃▂▂▃▃▂▃▃▂▃▂▂▃▃▂▂▂▂▂▂▃
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ██████████▆▆▆▆▂▃▂▅▅▅▃▇▂▇▇▇▇▇▇▇▇▇▁▁▇▆▁▁▁▆
wandb:             test_recall0.5 ▄▆██████████▆▅▆▄▄▄▄▅▅▄▄▄▄▄▄▄▄▄▄▃▁▂▁▁▄▃▁▁
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▁▁▂▁▂▃▂▃▃▃▃▄▄▄▅▅▅▆▆▆▆▆▆▆▇▇▇▇▇▇▇█▇█▇████
wandb:                 train_loss █████▇▇▇▇▇▇▆▆▆▆▆▅▅▄▄▄▄▄▄▄▄▄▃▃▃▂▂▂▂▂▂▂▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▂▂▂▂▂▃▃▃▃▂▃▃▃▃▃▆▂▃▂▄▅▅▅▇▆▇▆▇▆▆▇▆███
wandb:            val_accuracy0.5 ▄▅▅▂▂▂▄▄▄▄▄▇▇▆▆▇▇▇▇█▅▄▄▄▄▄▅▅▅▇▅▅▅▂▄▄▄▁▄▄
wandb:           val_accuracy0.75 ▅▅▅▅▅▅▅▅▅▅▅▅▅▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅▁▅███▅█████
wandb:                  val_auroc ▂▃▂▂▁▁▁▁▁▁▂▂▂▂▂▃▃▄▄▄▃▄▄▅▅▆▆▆▇▇▇▇▆▇▇▇▇█▇█
wandb:  val_balanced_accuracy0.25 ▂▂▂▂▂▂▁▁▂▂▄▃▃▄▄▄▃▄▄▄▄▄▃▅█▆▇▆▆▆▆▇▆▆█▇▇▇▇█
wandb:   val_balanced_accuracy0.5 ▇██▇█▇▇▇▇▇▇▇▅▆▅▅▅▅▅▄▄▄▂▂▂▃▃▂▁▂▁▃▁▂▁▁▁▁▄▁
wandb:  val_balanced_accuracy0.75 ▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▅▅▂▅▅▅▅█▅▅
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▂▁▂▂▃▂▃▆▅▅▄▄▅▅▅▆▆▆▅▅▇█
wandb:           val_precision0.5 ▁▁▇▇▇▇█▇▇▇▇▇▇▇███▇▇█▇▇▆▇▆▆▆▅▆▆▆▅▆▆▅▆▆▅▅▆
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▅▁██████
wandb:             val_recall0.25 ███████▇▇▆▆▆▆▆▆▆▆▆▆▅▆▅▅▅▅▄▄▄▇▃▇▄▆▁▃▁▅▅▂▅
wandb:              val_recall0.5 ▁▁▂▃▄█▇▇▇▇▆▇▆▆▆▆▆▅▅▅▅▅▄▄▄▄▄▅▃▃▃▃▃▃▃▃▃▃▄▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁████████
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.44304
wandb:           test_accuracy0.5 0.6962
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.6
wandb: test_balanced_accuracy0.25 0.52797
wandb:  test_balanced_accuracy0.5 0.49915
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.26923
wandb:          test_precision0.5 0.25
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.7
wandb:             test_recall0.5 0.1
wandb:            test_recall0.75 0
wandb:                train_auroc 0.91007
wandb:                 train_loss 1.18992
wandb:           val_accuracy0.25 0.5619
wandb:            val_accuracy0.5 0.68571
wandb:           val_accuracy0.75 0.7619
wandb:                  val_auroc 0.63802
wandb:  val_balanced_accuracy0.25 0.61855
wandb:   val_balanced_accuracy0.5 0.4944
wandb:  val_balanced_accuracy0.75 0.51923
wandb:          val_precision0.25 0.32759
wandb:           val_precision0.5 0.23077
wandb:          val_precision0.75 1
wandb:             val_recall0.25 0.73077
wandb:              val_recall0.5 0.11538
wandb:             val_recall0.75 0.03846
wandb: 
wandb: 🚀 View run resnet50_2d_78_20_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/ws7tad7e
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_20/wandb/run-20250703_021529-ws7tad7e/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_20/execution_datetimes.json

**************************************************  Experiment 78 | Version 21 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 17, 1.0: 15}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 11, 1.0: 21}
    Batch label distribution: {0.0: 19, 1.0: 9}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 18, 1.0: 14}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 16, 1.0: 12}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 13, 1.0: 19}
    Batch label distribution: {0.0: 14, 1.0: 18}
    Batch label distribution: {0.0: 21, 1.0: 11}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 16, 1.0: 16}
    Batch label distribution: {0.0: 19, 1.0: 13}
    Batch label distribution: {0.0: 15, 1.0: 17}
    Batch label distribution: {0.0: 11, 1.0: 17}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 6, 1.0: 3}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 5, 1.0: 4}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 22, 1.0: 10}
    Batch label distribution: {0.0: 26, 1.0: 6}
    Batch label distribution: {0.0: 23, 1.0: 9}
    Batch label distribution: {0.0: 8, 1.0: 1}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_21/wandb/run-20250703_040025-oq7ct47u
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_21_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/oq7ct47u
    Batch label distribution: {0.0: 25, 1.0: 7}
    Batch label distribution: {0.0: 24, 1.0: 8}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading config.yaml
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ███▆▇▂▂▂▂▂▂▁▂▁▁▁▁▁▁▁▁▁▂▂▁▂▁▁▂▁▁▂▁▁▁▂▂▂▃▂
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▂▁▃▃▃▃▂▃▄▄▄▄▅▅▅▅▅▅▆▇▇▇▇▇▇▇▇▇▇▇▇██▇▇▇████
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▂▂▂▂▄█▆▆▆▄▄▄▆▄▃▃▁▃▃▁▂▁▁▁▁▁▁▁▁▁▁▁▂▂▁▂▂▁▃▃
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▄█▆▆▆▆▆▆▆▆▆▆▆▆▅▅▅▅▅▆▅▅▅▅▅▅▅▅▅▅▅▆▅▅▅▅▆▅▆
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▂▂▇▇█████████████████████████████████
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█▇▇█▇█▇▇▇▇▇▇▇██▇█▇███
wandb:                 train_loss █▆▆▆▆▅▅▅▅▅▅▄▄▄▄▄▃▃▃▃▃▃▃▃▂▂▃▂▂▂▂▂▂▂▁▂▁▁▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ████▇▆▂▁▁▁▁▁▁▁▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc █▇▅▄▃▃▃▂▂▁▂▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▆▆▇▅▁▃▄▃▃▅▇▇▇▆▆▆▆▇▇▇▇▅▅▅█▄▄▇▆▄▄▇▅▅▅▅▇▇▆▃
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁█▆▄▄▆▅▅▅▅▅▅▆▆▆▆▆▆▆▆▆▆▆▇▆▆▆▆▆▆▆▆▆▆▆▆▆
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▃▆██▇▇▇▇▇▇▇▇▇█▇▇▇▇▇▇▇█▇▆██▆█▇▆▆▇▆▇▆▆▆
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.5443
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.51356
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.51314
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.26471
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.45
wandb:            test_recall0.75 0
wandb:                train_auroc 0.67015
wandb:                 train_loss 1.92908
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.54286
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.46884
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.46397
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.21053
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.30769
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet50_2d_78_21_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/oq7ct47u
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_21/wandb/run-20250703_040025-oq7ct47u/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_21/wandb/run-20250703_043654-mwcf0j0z
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_21_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/mwcf0j0z
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb: uploading output.log; uploading config.yaml; uploading history steps 997-999, summary, console lines 4-5
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ▃▃▁▁▁▂▁▂▂▂▂▂▂▃▃▃▃▃▃▃▃▃▄▆▆▆▅▇▆▆▇▇▇▇▇██▇▇▇
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▂▁▃▄▄▄▄▄▅▅▅▅▅▅▅▅▅▅▅▅▅▆▆▆▆▆▆▆▆▆▇▇▇▇▇█████
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▃▃▃▂▃▂▂▂▂▃▃▃▃▃▃▃▃▅▃▅▃▄▂▅▄▆▇▄▅▆▆▆▆▆███▇
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▅▅▅▅▅▅▆▅▅▅▅▆████
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁████████████████████████▇▇▇▅▆▅▅▅▆▅▅▅▅
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▄▄▄▄▄▄▄▄▄▄▄▄▅▄▅▄▅▅▅▅▆▆▆▆▆▇▇▇▇██▇█████▇█
wandb:                 train_loss ███▇▇▇▇▇▇▇▆▆▇▆▆▆▆▆▅▆▅▆▅▅▅▄▄▄▄▄▃▃▃▃▂▂▂▁▁▂
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 █▃▃▂▁▁▁▁▁▂▂▂▃▃▂▂▃▄▃▄▅▇▆▇▆▅▆▆▆▆▆▆▅▆▅▆▆▆▆▆
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▃▅▅▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇██████████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▁▁▁▃▅▄▄▄▄▄▅▄▅▅▅▅▅▅▅▆▅▅▅▅▅▆█▇██▆▆▆▅▄▃▂▄▃▃
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▇▆▆▆▆▆▆▆▆▆▆▆▆▆▇▇▇▆▆▆▆▆▆▇████▇█▇▇▇▆▇▆▇▆
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▅▇▇███████████████████████████████▅▅▃▄▃
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.74684
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.59153
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.61568
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.5
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.35
wandb:            test_recall0.75 0
wandb:                train_auroc 0.79767
wandb:                 train_loss 1.71643
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.70476
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.65774
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.57157
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.38095
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.30769
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet50_2d_78_21_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/mwcf0j0z
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_21/wandb/run-20250703_043654-mwcf0j0z/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_21/wandb/run-20250703_062111-q6lsj8e8
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_21_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/q6lsj8e8
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ██████████▇▇▇▇▇▇▆▅▅▄▄▂▂▂▂▂▂▂▂▂▂▂▁▁▂▂▁▁▁▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▂▁▄▇▄█▇▆▅▅▄▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▇▇
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▃▃▅▅█▆▆▅▅▆▅▅▅▅▅▅▅▅▅▄▅▄▄▄▄▄▅▄▄▄▄▄
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁█▄▅▅▅▅▅▅▅▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄▄
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▂▃▃▃▇▇▇▇▇▇█████████████████████
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▄▃▅▅▆▅▅▅▅▄▄▂▄▃▅▅▄▅▃▁█▅▆▅▄▄▆█▆▃▆▅▃▂▃▅▁▅▅▇
wandb:                 train_loss █▅▅▅▅▅▅▄▄▄▄▄▄▄▄▄▄▃▃▃▃▃▃▃▃▃▃▃▃▂▃▂▂▂▂▂▂▂▁▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 █████▇▇▇▆▃▃▃▂▂▂▂▃▃▃▃▃▃▃▃▃▃▂▂▃▂▃▃▃▁▃▁▂▂▂▃
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▂▃▆▇▇▇▇▇███████████████████████████████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▂▂▂▂▂▂▂▂▂▂▁▂▁▂▁▃▃▄▄▄██▇██████▇█▇██▇▇▇█▇█
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▄▄▅▅▅▇▆▆▆▆▆███▇█████▇███▇▇██▇▇█
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▃▃▅▄▄▄▅▆▆████▆███████████
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.56962
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.50339
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.53008
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.28125
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.45
wandb:            test_recall0.75 0
wandb:                train_auroc 0.67722
wandb:                 train_loss 2.00696
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.67619
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.58544
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.61709
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.38235
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.5
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet50_2d_78_21_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/q6lsj8e8
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_21/wandb/run-20250703_062111-q6lsj8e8/logs
/nas-ctm01/homes/mipaiva/.conda/envs/pipeline/lib/python3.11/site-packages/albumentations/core/validation.py:87: UserWarning: ShiftScaleRotate is a special case of Affine transform. Please use Affine transform instead.
  original_init(self, **validated_kwargs)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:100: UserWarning: Argument(s) 'max_holes, max_height, max_width' are not valid for transform CoarseDropout
  A.CoarseDropout(max_holes=8, max_height=8, max_width=8, p=0.7)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:114: UserWarning: Argument(s) 'mean' are not valid for transform GaussNoise
  A.GaussNoise(std_range= (0.1, 0.15), mean = (0.0, 0.0), p=1.0), # Introduces too much noise
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:41: UserWarning: Argument(s) 'always_apply' are not valid for transform BasicTransform
  super().__init__(always_apply=always_apply, p=p)
/nas-ctm01/homes/mipaiva/pipeline_template_pl/src/modules/data/data_augmentation/ct_image_augmenter.py:133: UserWarning: Argument(s) 'shift_limit' are not valid for transform OpticalDistortion
  A.OpticalDistortion(distort_limit=0.2, shift_limit=0.0, p=0.7)
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_21/execution_datetimes.json

**************************************************  Experiment 78 | Version 22 **************************************************
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']

✅ Saved split assignments to 'lung_metadata_with_splits.csv'

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

Using regular DataLoader for train subset
Data Aug
Original shape: 210, New Shape: 316

✅ Set train dataloaders with 3 folds
  - Fold 1: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 36, 1.0: 28}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 31, 1.0: 33}
    Batch label distribution: {0.0: 32, 1.0: 32}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 2: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 29, 1.0: 35}
    Batch label distribution: {0.0: 33, 1.0: 31}
    Batch label distribution: {0.0: 30, 1.0: 30}
  - Fold 3: 316 samples
    Label distribution: {0: 158, 1: 158}
    Batch label distribution: {0.0: 27, 1.0: 37}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 35, 1.0: 29}
    Batch label distribution: {0.0: 26, 1.0: 34}

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

Using regular DataLoader for validation subset

✅ Set validation dataloaders with 3 folds
  - Fold 1: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 30, 1.0: 11}
  - Fold 2: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 52, 1.0: 12}
    Batch label distribution: {0.0: 27, 1.0: 14}
  - Fold 3: 105 samples
    Label distribution: {0: 79, 1: 26}
    Batch label distribution: {0.0: 48, 1.0: 16}
    Batch label distribution: {0.0: 31, 1.0: 10}

Using regular DataLoader for test subset

Using regular DataLoader for test subset

Using regular DataLoader for test subset

✅ Set test dataloaders with 3 folds
  - Fold 1: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 2: 79 samples
    Label distribution: {0: 59, 1: 20}
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}
  - Fold 3: 79 samples
    Label distribution: {0: 59, 1: 20}
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_22/wandb/run-20250703_063859-ssxk13c3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_22_fold1
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/ssxk13c3
    Batch label distribution: {0.0: 49, 1.0: 15}
    Batch label distribution: {0.0: 10, 1.0: 5}

Running model pipeline for data fold 1...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ██▇▆▅▄▂▂▂▂▁▁▁▁▁▁▁▁▁▁▂▂▂▂▂▃▃▃▃▃▃▄▄▅▅▅▅▅▅▅
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▇▇▇▇███████▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇█████████████
wandb: test_balanced_accuracy0.25 ██████████████████████████████▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▂█▇▆▂▂▂▂▂▂▂▂▁▃▃▃▃▄▃▄▄▄▄▄▄▅▅▅▅▆▆▆█████
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ██████████████████████████████████▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁█▇██▇▇▆▆▅▅▅▅▅▅▅▅▅▅▆▆▆▆▆▆▆▆▆▆▆▇▇▇▇▇▇▇▇
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ██████████████████████████████▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▂▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇██████
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▃▁▂▂▃▁▂▃▃▂▂▃▂▂▃▂▃▄▄▄▄▄▄▅▄▆▅▅▅▅▆▆▅▆▅▆▇▇██
wandb:                 train_loss ██████▇▇▇▇▇▇▆▆▆▅▅▅▅▅▅▅▅▅▅▄▄▃▄▄▃▃▃▃▃▂▂▂▂▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▆▆▆▆█
wandb:            val_accuracy0.5 ██▆▂▃▁▂▂▂▂▂▁▂▁▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc █▇▅▆▆▅▅▅▇▇▇█▇▇▇▆▆▆▇▇▆▆▆▆▅▅▅▄▄▄▄▂▁▁▁▁▁▂▃▃
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁██▃▃▃▃▄▄
wandb:   val_balanced_accuracy0.5 ▇▇▇▅▂▁▆▅▇▇▆▆▆▆▆▆▇█▇▇▇▅▅▅▅▅▅▅▆▅▅▂▂▂▂▂▂▂▂▃
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁█▃▃▃▃
wandb:           val_precision0.5 ▁▁▁▅▄▅▇▇▇▇▇███▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆▆▆▆▆▆▅▅▅▆
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ██████████████████████████████████▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▂▂▃▄▇▇█▇▇▇██▇▇▇▇▇▇▇▇▇▅▇▆▆▆▆▆▅▅▅▅▅▄▄▄▄▄
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.64557
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.51356
wandb: test_balanced_accuracy0.25 0.46695
wandb:  test_balanced_accuracy0.5 0.59746
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.24
wandb:          test_precision0.5 0.35714
wandb:         test_precision0.75 0
wandb:            test_recall0.25 0.9
wandb:             test_recall0.5 0.5
wandb:            test_recall0.75 0
wandb:                train_auroc 0.73772
wandb:                 train_loss 1.81641
wandb:           val_accuracy0.25 0.28571
wandb:            val_accuracy0.5 0.59048
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.45083
wandb:  val_balanced_accuracy0.25 0.51241
wandb:   val_balanced_accuracy0.5 0.45691
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.25253
wandb:           val_precision0.5 0.18519
wandb:          val_precision0.75 0
wandb:             val_recall0.25 0.96154
wandb:              val_recall0.5 0.19231
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet50_2d_78_22_fold1 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/ssxk13c3
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_22/wandb/run-20250703_063859-ssxk13c3/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_22/wandb/run-20250703_083854-7pyhj087
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_22_fold2
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/7pyhj087
...model pipeline for data fold 1 has run!

Running model pipeline for data fold 2...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: Finishing previous runs because reinit is set to True.
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ███████▇▆▆▅▅▅▆▄▃▃▂▂▂▂▂▂▂▁▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▂▂▂▃▅▅▅▅▅▅▆▆▆▆▇▇▇▇▇▇█▇▇▇███████████████
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▇▆▇█▅▄▆▄▇▇▇▇▇▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅▅
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▆▇▇████▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▃▃▃▃▃▄▆▆▆▇▇▇████████████████
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▂▅▃▂▁▄█▄▂▆▄▄▆▅▄▃▃▆▄▆▅▅▇▅▇▆▅▆▂▄▇▅▅▃▇▇▇▆▆▄
wandb:                 train_loss ██▇▇▇▇▇▇▇▇▇▇▆▆▆▆▆▆▅▅▅▅▄▄▄▄▄▄▄▄▃▃▂▂▁▂▂▂▂▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ███████▆▆▆▃▄▂▄▂▂▂▃▂▂▂▂▁▁▁▁▂▂▁▁▁▁▁▂▂▁▁▁▁▁
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▂▃▄▄▅▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇██████████▇█▇▇▇██
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▂▂▂▂▁▁▁▂▅▅▇▆▇▆▇██▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▆
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▃▆▇▇▇▇▇▇██████▇▇███▇▇▇▇▇▇▇▇▇▇▇
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▂▂▃▄▄▆▇▇▇▇██████████████████████
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.58228
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.51864
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.53856
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.29032
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.45
wandb:            test_recall0.75 0
wandb:                train_auroc 0.64913
wandb:                 train_loss 1.9852
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.61905
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.6261
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.60492
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.34091
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.57692
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet50_2d_78_22_fold2 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/7pyhj087
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_22/wandb/run-20250703_083854-7pyhj087/logs
wandb: Tracking run with wandb version 0.19.11
wandb: Run data is saved locally in /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_22/wandb/run-20250703_093641-7diwbqi3
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run resnet50_2d_78_22_fold3
wandb: ⭐️ View project at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: 🚀 View run at https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/7diwbqi3
...model pipeline for data fold 2 has run!

Running model pipeline for data fold 3...
Label column '5y' found in metadata. Available columns: ['pid', 'study_yr', 'path', 'sct_slice_num_og', 'stage', '1y', '2y', '5y', '10y', 'fup_days', 'lung_side', 'de_stag', 'de_stag_7thed', 'sct_slice_new', 'sct_nod_err']
Label weights: tensor([3.0204], device='cuda:0', dtype=torch.float64)
wandb: uploading data
wandb:                                                                                
wandb: 
wandb: Run history:
wandb:          test_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           test_accuracy0.5 ████████████████▆▇▇▅▄▄▅▅▅▃▃▂▂▂▂▂▂▁▂▁▁▁▂▁
wandb:          test_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                 test_auroc ▁▂▃▆▆▆▇▇▇▇▇▇██████████▇█████████████████
wandb: test_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:  test_balanced_accuracy0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▂▁▃▃▂▃▃▅▄▄█▅▇▇▇▇▇▇▇█▇▇
wandb: test_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:         test_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          test_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁██▅▃▃▃▃▃▄▄▄▄▄▄▄▄▄▄▄▄
wandb:         test_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            test_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             test_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▂▂▂▃▃▄▄▅▅▅▇▇▇▇▇▇▇▇▇▇█▇▇█
wandb:            test_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                train_auroc ▁▂▁▄▄▆▅▅▅▆▆▆█▆▅▅▅▆▆▇▇▆▆▆▅▅▅▆▅▆▆▆▆▇▆▆▇▆▅▇
wandb:                 train_loss █████▇▇▇▇▇▆▆▆▆▆▅▅▅▅▅▅▅▅▅▅▄▄▄▄▄▃▃▃▃▃▃▃▂▂▁
wandb:           val_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:            val_accuracy0.5 ████████████▇▇▇▆▆▆▅▅▃▅▁▁▁▂▂▁▁▂▃▃▃▃▃▂▃▃▃▃
wandb:           val_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:                  val_auroc ▁▁▄▄▅▆▆▆▇▇▇▇████████████████████████████
wandb:  val_balanced_accuracy0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:   val_balanced_accuracy0.5 ▄▄▄▄▄▄▄▄▄▄▄▄▄▄▃▃▃▃▂▄▁▁▂▂▅▅▆▅▅▆▆▅▇▇▅▇▇█▇█
wandb:  val_balanced_accuracy0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:          val_precision0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:           val_precision0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▅▅▄▄▄▄▅▅▅▅▅▅▄▄▄▇▇▇██
wandb:          val_precision0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:             val_recall0.25 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb:              val_recall0.5 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▃▃▃▃▃▃▃▃▃▆▇▆▆▇█
wandb:             val_recall0.75 ▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: 
wandb: Run summary:
wandb:          test_accuracy0.25 0.25316
wandb:           test_accuracy0.5 0.65823
wandb:          test_accuracy0.75 0.74684
wandb:                 test_auroc 0.49915
wandb: test_balanced_accuracy0.25 0.5
wandb:  test_balanced_accuracy0.5 0.58941
wandb: test_balanced_accuracy0.75 0.5
wandb:         test_precision0.25 0.25316
wandb:          test_precision0.5 0.36
wandb:         test_precision0.75 0
wandb:            test_recall0.25 1
wandb:             test_recall0.5 0.45
wandb:            test_recall0.75 0
wandb:                train_auroc 0.61757
wandb:                 train_loss 2.04975
wandb:           val_accuracy0.25 0.24762
wandb:            val_accuracy0.5 0.66667
wandb:           val_accuracy0.75 0.75238
wandb:                  val_auroc 0.57668
wandb:  val_balanced_accuracy0.25 0.5
wandb:   val_balanced_accuracy0.5 0.57205
wandb:  val_balanced_accuracy0.75 0.5
wandb:          val_precision0.25 0.24762
wandb:           val_precision0.5 0.34483
wandb:          val_precision0.75 0
wandb:             val_recall0.25 1
wandb:              val_recall0.5 0.38462
wandb:             val_recall0.75 0
wandb: 
wandb: 🚀 View run resnet50_2d_78_22_fold3 at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da/runs/7diwbqi3
wandb: ⭐️ View project at: https://wandb.ai/maria-i-paiva-inesc-tec/cs_lung_resnet50_da
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_22/wandb/run-20250703_093641-7diwbqi3/logs
...model pipeline for data fold 3 has run!
Saving execution datetimes to /nas-ctm01/homes/mipaiva/pipeline_template_pl/experiment_results/experiment_78/version_22/execution_datetimes.json
Finish time: 2025-07-03 10:00:47
